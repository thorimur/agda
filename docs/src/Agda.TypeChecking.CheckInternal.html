<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-comment">-- Initially authored by Andreas, 2013-10-22.</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-comment">-- | A bidirectional type checker for internal syntax.</span><span>
</span><span id="line-5"></span><span class="hs-comment">--</span><span>
</span><span id="line-6"></span><span class="hs-comment">--   Performs checking on unreduced terms.</span><span>
</span><span id="line-7"></span><span class="hs-comment">--   With the exception that projection-like function applications</span><span>
</span><span id="line-8"></span><span class="hs-comment">--   have to be reduced since they break bidirectionality.</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Agda.TypeChecking.CheckInternal</span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier">MonadCheckInternal</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#checkType"><span class="hs-identifier">checkType</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#checkType%27"><span class="hs-identifier">checkType'</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#checkSort"><span class="hs-identifier">checkSort</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#checkInternal"><span class="hs-identifier">checkInternal</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#checkInternal%27"><span class="hs-identifier">checkInternal'</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#checkInternalType%27"><span class="hs-identifier">checkInternalType'</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#Action"><span class="hs-identifier">Action</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#defaultAction"><span class="hs-identifier">defaultAction</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#eraseUnusedAction"><span class="hs-identifier">eraseUnusedAction</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#infer"><span class="hs-identifier">infer</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#inferSpine%27"><span class="hs-identifier">inferSpine'</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Sort.html#shouldBeSort"><span class="hs-identifier">shouldBeSort</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html"><span class="hs-identifier">Agda.Syntax.Common</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html"><span class="hs-identifier">Agda.Syntax.Internal</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Conversion.html"><span class="hs-identifier">Agda.TypeChecking.Conversion</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Datatypes.html"><span class="hs-identifier">Agda.TypeChecking.Datatypes</span></a></span><span> </span><span class="hs-comment">-- (getConType, getFullyAppliedConType)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Level.html"><span class="hs-identifier">Agda.TypeChecking.Level</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.html"><span class="hs-identifier">Agda.TypeChecking.Monad</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html"><span class="hs-identifier">Agda.TypeChecking.Pretty</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.ProjectionLike.html"><span class="hs-identifier">Agda.TypeChecking.ProjectionLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.ProjectionLike.html#elimView"><span class="hs-identifier">elimView</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.ProjectionLike.html#ProjEliminator"><span class="hs-identifier">ProjEliminator</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Records.html"><span class="hs-identifier">Agda.TypeChecking.Records</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Records.html#getDefType"><span class="hs-identifier">getDefType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Reduce.html"><span class="hs-identifier">Agda.TypeChecking.Reduce</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.html"><span class="hs-identifier">Agda.TypeChecking.Substitute</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Sort.html"><span class="hs-identifier">Agda.TypeChecking.Sort</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Telescope.html"><span class="hs-identifier">Agda.TypeChecking.Telescope</span></a></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Functor.html"><span class="hs-identifier">Agda.Utils.Functor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">($&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Pretty.html"><span class="hs-identifier">Agda.Utils.Pretty</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Pretty.html#prettyShow"><span class="hs-identifier">prettyShow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Size.html"><span class="hs-identifier">Agda.Utils.Size</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html"><span class="hs-identifier">Agda.Utils.Impossible</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">-- * Bidirectional rechecker</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">type</span><span> </span><span id="MonadCheckInternal"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier hs-var">MonadCheckInternal</span></a></span></span><span> </span><span id="local-6989586621681014482"><span class="annot"><a href="#local-6989586621681014482"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Conversion.html#MonadConversion"><span class="hs-identifier hs-type">MonadConversion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014482"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">-- -- | Entry point for e.g. checking WithFunctionType.</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- checkType :: Type -&gt; TCM ()</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- checkType t = -- dontAssignMetas $ ignoreSorts $</span><span>
</span><span id="line-56"></span><span class="hs-comment">--   checkInternal (unEl t) (sort Inf)</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- | Entry point for e.g. checking WithFunctionType.</span><span>
</span><span id="line-59"></span><span id="local-6989586621681014814"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#checkType"><span class="hs-identifier hs-type">checkType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier hs-type">MonadCheckInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014814"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014814"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-60"></span><span id="checkType"><span class="annot"><span class="annottext">checkType :: forall (m :: * -&gt; *). MonadCheckInternal m =&gt; Type -&gt; m ()
</span><a href="Agda.TypeChecking.CheckInternal.html#checkType"><span class="hs-identifier hs-var hs-var">checkType</span></a></span></span><span> </span><span id="local-6989586621681014466"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681014466"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Constraint -&gt; m () -&gt; m ()
forall (m :: * -&gt; *).
MonadConstraint m =&gt;
Constraint -&gt; m () -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Constraints.html#catchConstraint"><span class="hs-identifier hs-var">catchConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Constraint
</span><a href="Agda.TypeChecking.Monad.Base.html#CheckType"><span class="hs-identifier hs-var">CheckType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681014466"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-61"></span><span>  </span><span id="local-6989586621681014463"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681014463"><span class="hs-identifier hs-var">inferred</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m Sort
forall (m :: * -&gt; *). MonadCheckInternal m =&gt; Type -&gt; m Sort
</span><a href="Agda.TypeChecking.CheckInternal.html#checkType%27"><span class="hs-identifier hs-var">checkType'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681014466"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-62"></span><span>  </span><span class="annot"><span class="annottext">Sort -&gt; Sort -&gt; m ()
forall (m :: * -&gt; *). MonadConversion m =&gt; Sort -&gt; Sort -&gt; m ()
</span><a href="Agda.TypeChecking.Conversion.html#equalSort"><span class="hs-identifier hs-var">equalSort</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Sort
forall a. LensSort a =&gt; a -&gt; Sort
</span><a href="Agda.Syntax.Internal.html#getSort"><span class="hs-identifier hs-var">getSort</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681014466"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681014463"><span class="hs-identifier hs-var">inferred</span></a></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">-- | Check a type and infer its sort.</span><span>
</span><span id="line-65"></span><span class="hs-comment">--</span><span>
</span><span id="line-66"></span><span class="hs-comment">--   Necessary because of PTS rule @(SizeUniv, Set i, Set i)@</span><span>
</span><span id="line-67"></span><span class="hs-comment">--   but @SizeUniv@ is not included in any @Set i@.</span><span>
</span><span id="line-68"></span><span class="hs-comment">--</span><span>
</span><span id="line-69"></span><span class="hs-comment">--   This algorithm follows</span><span>
</span><span id="line-70"></span><span class="hs-comment">--     Abel, Coquand, Dybjer, MPC 08,</span><span>
</span><span id="line-71"></span><span class="hs-comment">--     Verifying a Semantic &#946;&#951;-Conversion Test for Martin-L&#246;f Type Theory</span><span>
</span><span id="line-72"></span><span class="hs-comment">--</span><span>
</span><span id="line-73"></span><span id="local-6989586621681014787"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#checkType%27"><span class="hs-identifier hs-type">checkType'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier hs-type">MonadCheckInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014787"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014787"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-type">Sort</span></a></span></span><span>
</span><span id="line-74"></span><span id="checkType%27"><span class="annot"><span class="annottext">checkType' :: forall (m :: * -&gt; *). MonadCheckInternal m =&gt; Type -&gt; m Sort
</span><a href="Agda.TypeChecking.CheckInternal.html#checkType%27"><span class="hs-identifier hs-var hs-var">checkType'</span></a></span></span><span> </span><span id="local-6989586621681014357"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681014357"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-75"></span><span>  </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;tc.check.internal&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; m ()) -&gt; TCMT IO Doc -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;checking internal type &quot;</span></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681014357"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-79"></span><span>  </span><span id="local-6989586621681014353"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681014353"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ProjEliminator -&gt; Term -&gt; m Term
forall (m :: * -&gt; *). PureTCM m =&gt; ProjEliminator -&gt; Term -&gt; m Term
</span><a href="Agda.TypeChecking.ProjectionLike.html#elimView"><span class="hs-identifier hs-var">elimView</span></a></span><span> </span><span class="annot"><span class="annottext">ProjEliminator
</span><a href="Agda.TypeChecking.ProjectionLike.html#EvenLone"><span class="hs-identifier hs-var">EvenLone</span></a></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; m Term) -&gt; Term -&gt; m Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Term
forall t a. Type'' t a -&gt; a
</span><a href="Agda.Syntax.Internal.html#unEl"><span class="hs-identifier hs-var">unEl</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681014357"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-comment">-- bring projection-like funs in post-fix form</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681014353"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Pi"><span class="hs-identifier hs-type">Pi</span></a></span><span> </span><span id="local-6989586621681014349"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681014349"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621681014348"><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681014348"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-82"></span><span>      </span><span id="local-6989586621681014347"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681014347"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m Sort
forall (m :: * -&gt; *). MonadCheckInternal m =&gt; Type -&gt; m Sort
</span><a href="Agda.TypeChecking.CheckInternal.html#checkType%27"><span class="hs-identifier hs-var">checkType'</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; m Sort) -&gt; Type -&gt; m Sort
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Type
forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681014349"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-83"></span><span>      </span><span id="local-6989586621681014345"><span class="annot"><span class="annottext">Abs Sort
</span><a href="#local-6989586621681014345"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681014348"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Type -&gt; Sort -&gt; Abs Sort
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Sort -&gt; Abs Sort) -&gt; m Sort -&gt; m (Abs Sort)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-84"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681014343"><span class="annot"><span class="annottext">goInside :: m Sort -&gt; m Sort
</span><a href="#local-6989586621681014343"><span class="hs-identifier hs-var hs-var">goInside</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681014348"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Abs"><span class="hs-identifier hs-type">Abs</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ArgName, Dom Type) -&gt; m Sort -&gt; m Sort
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs Type -&gt; ArgName
forall a. Abs a -&gt; ArgName
</span><a href="Agda.Syntax.Internal.html#absName"><span class="hs-identifier hs-var">absName</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681014348"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681014349"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>                                 </span><span class="annot"><a href="Agda.Syntax.Internal.html#NoAbs"><span class="hs-identifier hs-type">NoAbs</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m Sort -&gt; m Sort
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-86"></span><span>        </span><span class="annot"><span class="annottext">m Sort -&gt; m Sort
</span><a href="#local-6989586621681014343"><span class="hs-identifier hs-var">goInside</span></a></span><span> </span><span class="annot"><span class="annottext">(m Sort -&gt; m Sort) -&gt; m Sort -&gt; m Sort
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; m Sort
forall (m :: * -&gt; *). MonadCheckInternal m =&gt; Type -&gt; m Sort
</span><a href="Agda.TypeChecking.CheckInternal.html#checkType%27"><span class="hs-identifier hs-var">checkType'</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; m Sort) -&gt; Type -&gt; m Sort
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Abs Type -&gt; Type
forall a. Abs a -&gt; a
</span><a href="Agda.Syntax.Internal.html#unAbs"><span class="hs-identifier hs-var">unAbs</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681014348"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-87"></span><span>      </span><span class="annot"><span class="annottext">Dom Type -&gt; Abs Sort -&gt; m Sort
forall (m :: * -&gt; *). PureTCM m =&gt; Dom Type -&gt; Abs Sort -&gt; m Sort
</span><a href="Agda.TypeChecking.Sort.html#inferPiSort"><span class="hs-identifier hs-var">inferPiSort</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681014349"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Sort
</span><a href="#local-6989586621681014345"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-type">Sort</span></a></span><span> </span><span id="local-6989586621681014334"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681014334"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-89"></span><span>      </span><span class="annot"><span class="annottext">Sort
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Sort -&gt; m Sort
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Sort -&gt; m Sort
</span><a href="Agda.TypeChecking.CheckInternal.html#checkSort"><span class="hs-identifier hs-var">checkSort</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
forall (m :: * -&gt; *). PureTCM m =&gt; Action m
</span><a href="Agda.TypeChecking.CheckInternal.html#defaultAction"><span class="hs-identifier hs-var">defaultAction</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681014334"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-90"></span><span>      </span><span class="annot"><span class="annottext">Sort -&gt; m Sort
forall (m :: * -&gt; *).
(PureTCM m, MonadConstraint m) =&gt;
Sort -&gt; m Sort
</span><a href="Agda.TypeChecking.Sort.html#inferUnivSort"><span class="hs-identifier hs-var">inferUnivSort</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681014334"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621681014331"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681014331"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681014330"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681014330"><span class="hs-identifier hs-var">es</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-92"></span><span>      </span><span id="local-6989586621681014329"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681014329"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; m Type
forall (m :: * -&gt; *).
(Applicative m, MonadFail m, MonadTCEnv m) =&gt;
VerboseLevel -&gt; m Type
</span><a href="Agda.TypeChecking.Monad.Context.html#typeOfBV"><span class="hs-identifier hs-var">typeOfBV</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681014331"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-93"></span><span>      </span><span class="annot"><span class="annottext">Type -&gt; Term -&gt; Elims -&gt; m Sort
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Type -&gt; Term -&gt; Elims -&gt; m Sort
</span><a href="Agda.TypeChecking.CheckInternal.html#checkTypeSpine"><span class="hs-identifier hs-var">checkTypeSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681014329"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681014331"><span class="hs-identifier hs-var">i</span></a></span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681014330"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-type">Def</span></a></span><span> </span><span id="local-6989586621681014325"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681014325"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681014324"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681014324"><span class="hs-identifier hs-var">es</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-comment">-- not a projection-like fun</span><span>
</span><span id="line-95"></span><span>      </span><span id="local-6989586621681014323"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681014323"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Type
</span><a href="Agda.TypeChecking.Monad.Base.html#defType"><span class="hs-identifier hs-var">defType</span></a></span><span> </span><span class="annot"><span class="annottext">(Definition -&gt; Type) -&gt; m Definition -&gt; m Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m Definition
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Definition
</span><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo"><span class="hs-identifier hs-var">getConstInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681014325"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-96"></span><span>      </span><span class="annot"><span class="annottext">Type -&gt; Term -&gt; Elims -&gt; m Sort
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Type -&gt; Term -&gt; Elims -&gt; m Sort
</span><a href="Agda.TypeChecking.CheckInternal.html#checkTypeSpine"><span class="hs-identifier hs-var">checkTypeSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681014323"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-var">Def</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681014325"><span class="hs-identifier hs-var">f</span></a></span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681014324"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaV"><span class="hs-identifier hs-type">MetaV</span></a></span><span> </span><span id="local-6989586621681014319"><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681014319"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681014318"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681014318"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- we assume meta instantiations to be well-typed</span><span>
</span><span id="line-98"></span><span>      </span><span id="local-6989586621681014317"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681014317"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; m Type
forall (m :: * -&gt; *). ReadTCState m =&gt; MetaId -&gt; m Type
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#metaType"><span class="hs-identifier hs-var">metaType</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681014319"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-99"></span><span>      </span><span class="annot"><span class="annottext">Type -&gt; Term -&gt; Elims -&gt; m Sort
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Type -&gt; Term -&gt; Elims -&gt; m Sort
</span><a href="Agda.TypeChecking.CheckInternal.html#checkTypeSpine"><span class="hs-identifier hs-var">checkTypeSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681014317"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MetaId -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#MetaV"><span class="hs-identifier hs-var">MetaV</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681014319"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681014318"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span id="local-6989586621681014315"><span class="annot"><span class="annottext">v :: Term
</span><a href="#local-6989586621681014315"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Internal.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeError -&gt; m Sort
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
TypeError -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-var">typeError</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeError -&gt; m Sort) -&gt; TypeError -&gt; m Sort
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#InvalidType"><span class="hs-identifier hs-var">InvalidType</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681014315"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-101"></span><span>    </span><span id="local-6989586621681014311"><span class="annot"><span class="annottext">v :: Term
</span><a href="#local-6989586621681014311"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Internal.html#Con"><span class="hs-identifier hs-type">Con</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeError -&gt; m Sort
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
TypeError -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-var">typeError</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeError -&gt; m Sort) -&gt; TypeError -&gt; m Sort
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#InvalidType"><span class="hs-identifier hs-var">InvalidType</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681014311"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621681014309"><span class="annot"><span class="annottext">v :: Term
</span><a href="#local-6989586621681014309"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Internal.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeError -&gt; m Sort
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
TypeError -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-var">typeError</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeError -&gt; m Sort) -&gt; TypeError -&gt; m Sort
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#InvalidType"><span class="hs-identifier hs-var">InvalidType</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681014309"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621681014307"><span class="annot"><span class="annottext">v :: Term
</span><a href="#local-6989586621681014307"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Internal.html#Level"><span class="hs-identifier hs-type">Level</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeError -&gt; m Sort
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
TypeError -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-var">typeError</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeError -&gt; m Sort) -&gt; TypeError -&gt; m Sort
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#InvalidType"><span class="hs-identifier hs-var">InvalidType</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681014307"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#DontCare"><span class="hs-identifier hs-type">DontCare</span></a></span><span> </span><span id="local-6989586621681014304"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681014304"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m Sort
forall (m :: * -&gt; *). MonadCheckInternal m =&gt; Type -&gt; m Sort
</span><a href="Agda.TypeChecking.CheckInternal.html#checkType%27"><span class="hs-identifier hs-var">checkType'</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; m Sort) -&gt; Type -&gt; m Sort
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681014357"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Term -&gt; Type
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681014304"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Dummy"><span class="hs-identifier hs-type">Dummy</span></a></span><span> </span><span id="local-6989586621681014302"><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621681014302"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">Elims
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; m Sort
forall (m :: * -&gt; *) a.
(HasCallStack, MonadDebug m) =&gt;
ArgName -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Debug.html#__IMPOSSIBLE_VERBOSE__"><span class="hs-identifier hs-var">__IMPOSSIBLE_VERBOSE__</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621681014302"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span id="local-6989586621681014717"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#checkTypeSpine"><span class="hs-identifier hs-type">checkTypeSpine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier hs-type">MonadCheckInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014717"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Elims"><span class="hs-identifier hs-type">Elims</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014717"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-type">Sort</span></a></span></span><span>
</span><span id="line-108"></span><span id="checkTypeSpine"><span class="annot"><span class="annottext">checkTypeSpine :: forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Type -&gt; Term -&gt; Elims -&gt; m Sort
</span><a href="Agda.TypeChecking.CheckInternal.html#checkTypeSpine"><span class="hs-identifier hs-var hs-var">checkTypeSpine</span></a></span></span><span> </span><span id="local-6989586621681014284"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681014284"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621681014283"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681014283"><span class="hs-identifier hs-var">self</span></a></span></span><span> </span><span id="local-6989586621681014282"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681014282"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m Sort
forall (m :: * -&gt; *).
(PureTCM m, MonadBlock m, MonadError TCErr m) =&gt;
Type -&gt; m Sort
</span><a href="Agda.TypeChecking.Sort.html#shouldBeSort"><span class="hs-identifier hs-var">shouldBeSort</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; m Sort) -&gt; m Type -&gt; m Sort
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">(Term, Type) -&gt; Type
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Term, Type) -&gt; Type) -&gt; m (Term, Type) -&gt; m Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Term -&gt; Elims -&gt; m (Term, Type)
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Type -&gt; Term -&gt; Elims -&gt; m (Term, Type)
</span><a href="Agda.TypeChecking.CheckInternal.html#inferSpine"><span class="hs-identifier hs-var">inferSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681014284"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681014283"><span class="hs-identifier hs-var">self</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681014282"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span id="local-6989586621681014698"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#checkInternalType%27"><span class="hs-identifier hs-type">checkInternalType'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier hs-type">MonadCheckInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014698"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014698"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014698"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span></span><span>
</span><span id="line-111"></span><span id="checkInternalType%27"><span class="annot"><span class="annottext">checkInternalType' :: forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Type -&gt; m Type
</span><a href="Agda.TypeChecking.CheckInternal.html#checkInternalType%27"><span class="hs-identifier hs-var hs-var">checkInternalType'</span></a></span></span><span> </span><span id="local-6989586621681014271"><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681014271"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#El"><span class="hs-identifier hs-type">El</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">_getSort :: forall t a. Type'' t a -&gt; Sort' t
</span><a href="Agda.Syntax.Internal.html#_getSort"><span class="hs-identifier hs-var">_getSort</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621681014268"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681014268"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">unEl :: forall t a. Type'' t a -&gt; a
</span><a href="Agda.Syntax.Internal.html#unEl"><span class="hs-identifier hs-var">unEl</span></a></span><span class="hs-glyph">=</span><span id="local-6989586621681014267"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681014267"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-112"></span><span>  </span><span id="local-6989586621681014266"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681014266"><span class="hs-identifier hs-var">tAfterAct</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#checkInternal%27"><span class="hs-identifier hs-var">checkInternal'</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681014271"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681014267"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="Agda.TypeChecking.Monad.Base.html#CmpLeq"><span class="hs-identifier hs-var">CmpLeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sort -&gt; Type
</span><a href="Agda.TypeChecking.Substitute.html#sort"><span class="hs-identifier hs-var">sort</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681014268"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><span class="annottext">Type -&gt; m Type
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#El"><span class="hs-identifier hs-type">El</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">_getSort :: Sort
</span><a href="Agda.Syntax.Internal.html#_getSort"><span class="hs-identifier hs-var">_getSort</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681014268"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">unEl :: Term
</span><a href="Agda.Syntax.Internal.html#unEl"><span class="hs-identifier hs-var">unEl</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681014266"><span class="hs-identifier hs-var">tAfterAct</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-comment">-- | 'checkInternal' traverses the whole 'Term', and we can use this</span><span>
</span><span id="line-116"></span><span class="hs-comment">--   traversal to modify the term.</span><span>
</span><span id="line-117"></span><span class="hs-keyword">data</span><span> </span><span id="Action"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#Action"><span class="hs-identifier hs-var">Action</span></a></span></span><span> </span><span id="local-6989586621681014691"><span class="annot"><a href="#local-6989586621681014691"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Action"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#Action"><span class="hs-identifier hs-var">Action</span></a></span></span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="preAction"><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Action m -&gt; Type -&gt; Term -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#preAction"><span class="hs-identifier hs-var hs-var">preAction</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014691"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-comment">-- ^ Called on each subterm before the checker runs.</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="postAction"><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Action m -&gt; Type -&gt; Term -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#postAction"><span class="hs-identifier hs-var hs-var">postAction</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014691"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-comment">-- ^ Called on each subterm after the type checking.</span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="modalityAction"><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Action m -&gt; Modality -&gt; Modality -&gt; Modality
</span><a href="Agda.TypeChecking.CheckInternal.html#modalityAction"><span class="hs-identifier hs-var hs-var">modalityAction</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Modality"><span class="hs-identifier hs-type">Modality</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Modality"><span class="hs-identifier hs-type">Modality</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Modality"><span class="hs-identifier hs-type">Modality</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-comment">-- ^ Called for each @ArgInfo@.</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-comment">--   The first 'Modality' is from the type,</span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-comment">--   the second from the term.</span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="elimViewAction"><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Action m -&gt; Term -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#elimViewAction"><span class="hs-identifier hs-var hs-var">elimViewAction</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014691"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-comment">-- ^ Called for bringing projection-like funs in post-fix form</span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-comment">-- | The default action is to not change the 'Term' at all.</span><span>
</span><span id="line-131"></span><span id="local-6989586621681014721"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#defaultAction"><span class="hs-identifier hs-type">defaultAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Pure.html#PureTCM"><span class="hs-identifier hs-type">PureTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014721"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014721"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-132"></span><span class="hs-comment">--(MonadReduce m, MonadTCEnv m, HasConstInfo m) =&gt; Action m</span><span>
</span><span id="line-133"></span><span id="defaultAction"><span class="annot"><span class="annottext">defaultAction :: forall (m :: * -&gt; *). PureTCM m =&gt; Action m
</span><a href="Agda.TypeChecking.CheckInternal.html#defaultAction"><span class="hs-identifier hs-var hs-var">defaultAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">preAction :: Type -&gt; Term -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#preAction"><span class="hs-identifier hs-var">preAction</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term -&gt; m Term
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">postAction :: Type -&gt; Term -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#postAction"><span class="hs-identifier hs-var">postAction</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term -&gt; m Term
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">modalityAction :: Modality -&gt; Modality -&gt; Modality
</span><a href="Agda.TypeChecking.CheckInternal.html#modalityAction"><span class="hs-identifier hs-var">modalityAction</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="annot"><span class="annottext">Modality
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Modality
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">elimViewAction :: Term -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#elimViewAction"><span class="hs-identifier hs-var">elimViewAction</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProjEliminator -&gt; Term -&gt; m Term
forall (m :: * -&gt; *). PureTCM m =&gt; ProjEliminator -&gt; Term -&gt; m Term
</span><a href="Agda.TypeChecking.ProjectionLike.html#elimView"><span class="hs-identifier hs-var">elimView</span></a></span><span> </span><span class="annot"><span class="annottext">ProjEliminator
</span><a href="Agda.TypeChecking.ProjectionLike.html#EvenLone"><span class="hs-identifier hs-var">EvenLone</span></a></span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#eraseUnusedAction"><span class="hs-identifier hs-type">eraseUnusedAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span>
</span><span id="line-141"></span><span id="eraseUnusedAction"><span class="annot"><span class="annottext">eraseUnusedAction :: Action (TCMT IO)
</span><a href="Agda.TypeChecking.CheckInternal.html#eraseUnusedAction"><span class="hs-identifier hs-var hs-var">eraseUnusedAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Action (TCMT IO)
forall (m :: * -&gt; *). PureTCM m =&gt; Action m
</span><a href="Agda.TypeChecking.CheckInternal.html#defaultAction"><span class="hs-identifier hs-var">defaultAction</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">postAction :: Type -&gt; Term -&gt; TCMT IO Term
</span><a href="Agda.TypeChecking.CheckInternal.html#postAction"><span class="hs-identifier hs-var">postAction</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Term -&gt; TCMT IO Term
</span><a href="#local-6989586621681014250"><span class="hs-identifier hs-var">eraseUnused</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><a href="#local-6989586621681014250"><span class="hs-identifier hs-type">eraseUnused</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span>
</span><span id="line-144"></span><span>    </span><span id="local-6989586621681014250"><span class="annot"><span class="annottext">eraseUnused :: Type -&gt; Term -&gt; TCMT IO Term
</span><a href="#local-6989586621681014250"><span class="hs-identifier hs-var hs-var">eraseUnused</span></a></span></span><span> </span><span id="local-6989586621681014249"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681014249"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-145"></span><span>      </span><span class="annot"><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-type">Def</span></a></span><span> </span><span id="local-6989586621681014248"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681014248"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681014247"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681014247"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-146"></span><span>        </span><span id="local-6989586621681014246"><span class="annot"><span class="annottext">[Polarity]
</span><a href="#local-6989586621681014246"><span class="hs-identifier hs-var">pols</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCMT IO [Polarity]
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m [Polarity]
</span><a href="Agda.TypeChecking.Monad.Signature.html#getPolarity"><span class="hs-identifier hs-var">getPolarity</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681014248"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-147"></span><span>        </span><span class="annot"><span class="annottext">Term -&gt; TCMT IO Term
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; TCMT IO Term) -&gt; Term -&gt; TCMT IO Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-var">Def</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681014248"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Elims -&gt; Term) -&gt; Elims -&gt; Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Polarity] -&gt; Elims -&gt; Elims
</span><a href="#local-6989586621681014244"><span class="hs-identifier hs-var">eraseIfNonvariant</span></a></span><span> </span><span class="annot"><span class="annottext">[Polarity]
</span><a href="#local-6989586621681014246"><span class="hs-identifier hs-var">pols</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681014247"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-148"></span><span>      </span><span id="local-6989586621681014243"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681014243"><span class="hs-identifier hs-var">v</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term -&gt; TCMT IO Term
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681014243"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><a href="#local-6989586621681014244"><span class="hs-identifier hs-type">eraseIfNonvariant</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Polarity"><span class="hs-identifier hs-type">Polarity</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Elims"><span class="hs-identifier hs-type">Elims</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Elims"><span class="hs-identifier hs-type">Elims</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span id="local-6989586621681014244"><span class="annot"><span class="annottext">eraseIfNonvariant :: [Polarity] -&gt; Elims -&gt; Elims
</span><a href="#local-6989586621681014244"><span class="hs-identifier hs-var hs-var">eraseIfNonvariant</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                  </span><span id="local-6989586621681014242"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681014242"><span class="hs-identifier hs-var">es</span></a></span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681014242"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><a href="#local-6989586621681014244"><span class="hs-identifier hs-var">eraseIfNonvariant</span></a></span><span> </span><span id="local-6989586621681014241"><span class="annot"><span class="annottext">[Polarity]
</span><a href="#local-6989586621681014241"><span class="hs-identifier hs-var">pols</span></a></span></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><a href="#local-6989586621681014244"><span class="hs-identifier hs-var">eraseIfNonvariant</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polarity
</span><a href="Agda.TypeChecking.Monad.Base.html#Nonvariant"><span class="hs-identifier hs-var">Nonvariant</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681014239"><span class="annot"><span class="annottext">[Polarity]
</span><a href="#local-6989586621681014239"><span class="hs-identifier hs-var">pols</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681014238"><span class="annot"><span class="annottext">Elim
</span><a href="#local-6989586621681014238"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681014237"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681014237"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Term -&gt; Term) -&gt; Elim -&gt; Elim
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; Term
</span><a href="Agda.Syntax.Internal.html#dontCare"><span class="hs-identifier hs-var">dontCare</span></a></span><span> </span><span class="annot"><span class="annottext">Elim
</span><a href="#local-6989586621681014238"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Elim -&gt; Elims -&gt; Elims
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Polarity] -&gt; Elims -&gt; Elims
</span><a href="#local-6989586621681014244"><span class="hs-identifier hs-var">eraseIfNonvariant</span></a></span><span> </span><span class="annot"><span class="annottext">[Polarity]
</span><a href="#local-6989586621681014239"><span class="hs-identifier hs-var">pols</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681014237"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><a href="#local-6989586621681014244"><span class="hs-identifier hs-var">eraseIfNonvariant</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Polarity
</span><span class="hs-identifier">_</span></span><span>          </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681014235"><span class="annot"><span class="annottext">[Polarity]
</span><a href="#local-6989586621681014235"><span class="hs-identifier hs-var">pols</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681014234"><span class="annot"><span class="annottext">Elim
</span><a href="#local-6989586621681014234"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681014233"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681014233"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Elim
</span><a href="#local-6989586621681014234"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Elim -&gt; Elims -&gt; Elims
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Polarity] -&gt; Elims -&gt; Elims
</span><a href="#local-6989586621681014244"><span class="hs-identifier hs-var">eraseIfNonvariant</span></a></span><span> </span><span class="annot"><span class="annottext">[Polarity]
</span><a href="#local-6989586621681014235"><span class="hs-identifier hs-var">pols</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681014233"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-comment">-- | Entry point for term checking.</span><span>
</span><span id="line-157"></span><span id="local-6989586621681014678"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#checkInternal"><span class="hs-identifier hs-type">checkInternal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier hs-type">MonadCheckInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014678"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Comparison"><span class="hs-identifier hs-type">Comparison</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014678"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-158"></span><span id="checkInternal"><span class="annot"><span class="annottext">checkInternal :: forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Term -&gt; Comparison -&gt; Type -&gt; m ()
</span><a href="Agda.TypeChecking.CheckInternal.html#checkInternal"><span class="hs-identifier hs-var hs-var">checkInternal</span></a></span></span><span> </span><span id="local-6989586621681014225"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681014225"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621681014224"><span class="annot"><span class="annottext">Comparison
</span><a href="#local-6989586621681014224"><span class="hs-identifier hs-var">cmp</span></a></span></span><span> </span><span id="local-6989586621681014223"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681014223"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Term -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(m Term -&gt; m ()) -&gt; m Term -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#checkInternal%27"><span class="hs-identifier hs-var">checkInternal'</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
forall (m :: * -&gt; *). PureTCM m =&gt; Action m
</span><a href="Agda.TypeChecking.CheckInternal.html#defaultAction"><span class="hs-identifier hs-var">defaultAction</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681014225"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="#local-6989586621681014224"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681014223"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span id="local-6989586621681014694"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#checkInternal%27"><span class="hs-identifier hs-type">checkInternal'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier hs-type">MonadCheckInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014694"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014694"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Comparison"><span class="hs-identifier hs-type">Comparison</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014694"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span></span><span>
</span><span id="line-161"></span><span id="checkInternal%27"><span class="annot"><span class="annottext">checkInternal' :: forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#checkInternal%27"><span class="hs-identifier hs-var hs-var">checkInternal'</span></a></span></span><span> </span><span id="local-6989586621681014001"><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681014001"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span id="local-6989586621681014000"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681014000"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621681013999"><span class="annot"><span class="annottext">Comparison
</span><a href="#local-6989586621681013999"><span class="hs-identifier hs-var">cmp</span></a></span></span><span> </span><span id="local-6989586621681013998"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013998"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m Term -&gt; m Term
forall (m :: * -&gt; *) a.
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; ArgName -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Debug.html#verboseBracket"><span class="hs-identifier hs-var">verboseBracket</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;tc.check.internal&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">(m Term -&gt; m Term) -&gt; m Term -&gt; m Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-162"></span><span>  </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;tc.check.internal&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; m ()) -&gt; TCMT IO Doc -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;checking internal &quot;</span></span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; VerboseLevel -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Term -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681014000"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;:&quot;</span></span><span>
</span><span id="line-165"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; VerboseLevel -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013998"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-166"></span><span>  </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;tc.check.internal&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">60</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; m ()) -&gt; TCMT IO Doc -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;checking internal with DB indices&quot;</span></span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; VerboseLevel -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Term -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681014000"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;:&quot;</span></span><span>
</span><span id="line-169"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; VerboseLevel -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013998"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-170"></span><span>  </span><span id="local-6989586621681013993"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681013993"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Telescope
forall (m :: * -&gt; *). (Applicative m, MonadTCEnv m) =&gt; m Telescope
</span><a href="Agda.TypeChecking.Monad.Context.html#getContextTelescope"><span class="hs-identifier hs-var">getContextTelescope</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681013993"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;tc.check.internal&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">30</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; m ()) -&gt; TCMT IO Doc -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;In context&quot;</span></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; VerboseLevel -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681013993"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-comment">-- Bring projection-like funs in post-fix form,</span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-comment">-- (even lone ones by default).</span><span>
</span><span id="line-176"></span><span>  </span><span id="local-6989586621681013989"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013989"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Term -&gt; m Term
forall (m :: * -&gt; *). Action m -&gt; Term -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#elimViewAction"><span class="hs-identifier hs-var">elimViewAction</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681014001"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; m Term) -&gt; m Term -&gt; m Term
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Type -&gt; Term -&gt; m Term
forall (m :: * -&gt; *). Action m -&gt; Type -&gt; Term -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#preAction"><span class="hs-identifier hs-var">preAction</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681014001"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013998"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681014000"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-177"></span><span>  </span><span class="annot"><span class="annottext">Action m -&gt; Type -&gt; Term -&gt; m Term
forall (m :: * -&gt; *). Action m -&gt; Type -&gt; Term -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#postAction"><span class="hs-identifier hs-var">postAction</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681014001"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013998"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; m Term) -&gt; m Term -&gt; m Term
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013989"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621681013988"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681013988"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681013987"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013987"><span class="hs-identifier hs-var">es</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-179"></span><span>      </span><span id="local-6989586621681013986"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013986"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; m Type
forall (m :: * -&gt; *).
(Applicative m, MonadFail m, MonadTCEnv m) =&gt;
VerboseLevel -&gt; m Type
</span><a href="Agda.TypeChecking.Monad.Context.html#typeOfBV"><span class="hs-identifier hs-var">typeOfBV</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681013988"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-180"></span><span>      </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;tc.check.internal&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">30</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; m ()) -&gt; TCMT IO Doc -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#fsep"><span class="hs-identifier hs-var">fsep</span></a></span><span>
</span><span id="line-181"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;variable&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel -&gt; Term
</span><a href="Agda.Syntax.Internal.html#var"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681013988"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;has type&quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013986"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-182"></span><span>      </span><span class="annot"><span class="annottext">Action m -&gt; Type -&gt; Term -&gt; Elims -&gt; Comparison -&gt; Type -&gt; m Term
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Type -&gt; Term -&gt; Elims -&gt; Comparison -&gt; Type -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#checkSpine"><span class="hs-identifier hs-var">checkSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681014001"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013986"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681013988"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013987"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="#local-6989586621681013999"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013998"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-type">Def</span></a></span><span> </span><span id="local-6989586621681013982"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013982"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681013981"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013981"><span class="hs-identifier hs-var">es</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-comment">-- f is not projection(-like)!</span><span>
</span><span id="line-184"></span><span>      </span><span id="local-6989586621681013980"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013980"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Type
</span><a href="Agda.TypeChecking.Monad.Base.html#defType"><span class="hs-identifier hs-var">defType</span></a></span><span> </span><span class="annot"><span class="annottext">(Definition -&gt; Type) -&gt; m Definition -&gt; m Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m Definition
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Definition
</span><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo"><span class="hs-identifier hs-var">getConstInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013982"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-185"></span><span>      </span><span class="annot"><span class="annottext">Action m -&gt; Type -&gt; Term -&gt; Elims -&gt; Comparison -&gt; Type -&gt; m Term
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Type -&gt; Term -&gt; Elims -&gt; Comparison -&gt; Type -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#checkSpine"><span class="hs-identifier hs-var">checkSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681014001"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013980"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-var">Def</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013982"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013981"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="#local-6989586621681013999"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013998"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaV"><span class="hs-identifier hs-type">MetaV</span></a></span><span> </span><span id="local-6989586621681013979"><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681013979"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681013978"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013978"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- we assume meta instantiations to be well-typed</span><span>
</span><span id="line-187"></span><span>      </span><span id="local-6989586621681013977"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013977"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; m Type
forall (m :: * -&gt; *). ReadTCState m =&gt; MetaId -&gt; m Type
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#metaType"><span class="hs-identifier hs-var">metaType</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681013979"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-188"></span><span>      </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;tc.check.internal&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">30</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; m ()) -&gt; TCMT IO Doc -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;metavariable&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681013979"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;has type&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013977"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-189"></span><span>      </span><span class="annot"><span class="annottext">Action m -&gt; Type -&gt; Term -&gt; Elims -&gt; Comparison -&gt; Type -&gt; m Term
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Type -&gt; Term -&gt; Elims -&gt; Comparison -&gt; Type -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#checkSpine"><span class="hs-identifier hs-var">checkSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681014001"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013977"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MetaId -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#MetaV"><span class="hs-identifier hs-var">MetaV</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681013979"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013978"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="#local-6989586621681013999"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013998"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Con"><span class="hs-identifier hs-type">Con</span></a></span><span> </span><span id="local-6989586621681013976"><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681013976"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621681013975"><span class="annot"><span class="annottext">ConInfo
</span><a href="#local-6989586621681013975"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span id="local-6989586621681013974"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013974"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-191"></span><span>      </span><span class="hs-comment">-- We need to fully apply the constructor to make getConType work!</span><span>
</span><span id="line-192"></span><span>      </span><span class="annot"><span class="annottext">ConHead
-&gt; Elims
-&gt; Type
-&gt; (QName
    -&gt; Type -&gt; Args -&gt; Type -&gt; Elims -&gt; Telescope -&gt; Type -&gt; m Term)
-&gt; m Term
forall (m :: * -&gt; *) a.
MonadCheckInternal m =&gt;
ConHead
-&gt; Elims
-&gt; Type
-&gt; (QName
    -&gt; Type -&gt; Args -&gt; Type -&gt; Elims -&gt; Telescope -&gt; Type -&gt; m a)
-&gt; m a
</span><a href="Agda.TypeChecking.CheckInternal.html#fullyApplyCon"><span class="hs-identifier hs-var">fullyApplyCon</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681013976"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013974"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013998"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">((QName
  -&gt; Type -&gt; Args -&gt; Type -&gt; Elims -&gt; Telescope -&gt; Type -&gt; m Term)
 -&gt; m Term)
-&gt; (QName
    -&gt; Type -&gt; Args -&gt; Type -&gt; Elims -&gt; Telescope -&gt; Type -&gt; m Term)
-&gt; m Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681013972"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013972"><span class="hs-identifier hs-var">_d</span></a></span></span><span> </span><span id="local-6989586621681013971"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013971"><span class="hs-identifier hs-var">_dt</span></a></span></span><span> </span><span id="local-6989586621681013970"><span class="annot"><span class="annottext">Args
</span><a href="#local-6989586621681013970"><span class="hs-identifier hs-var">_pars</span></a></span></span><span> </span><span id="local-6989586621681013969"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013969"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621681013968"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013968"><span class="hs-identifier hs-var">vs'</span></a></span></span><span> </span><span id="local-6989586621681013967"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681013967"><span class="hs-identifier hs-var">tel</span></a></span></span><span> </span><span id="local-6989586621681013966"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013966"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-193"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Internal.html#Con"><span class="hs-identifier hs-type">Con</span></a></span><span> </span><span id="local-6989586621681013965"><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681013965"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621681013964"><span class="annot"><span class="annottext">ConInfo
</span><a href="#local-6989586621681013964"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span id="local-6989586621681013963"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013963"><span class="hs-identifier hs-var">vs2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Type -&gt; Term -&gt; Elims -&gt; Comparison -&gt; Type -&gt; m Term
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Type -&gt; Term -&gt; Elims -&gt; Comparison -&gt; Type -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#checkSpine"><span class="hs-identifier hs-var">checkSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681014001"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013969"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConHead -&gt; ConInfo -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Con"><span class="hs-identifier hs-var">Con</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681013976"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ConInfo
</span><a href="#local-6989586621681013975"><span class="hs-identifier hs-var">ci</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013968"><span class="hs-identifier hs-var">vs'</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="#local-6989586621681013999"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013966"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-194"></span><span>        </span><span class="hs-comment">-- Strip away the extra arguments</span><span>
</span><span id="line-195"></span><span>        </span><span class="annot"><span class="annottext">Term -&gt; m Term
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; m Term) -&gt; Term -&gt; m Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Substitution' (SubstArg Term) -&gt; Term -&gt; Term
forall a. Subst a =&gt; Substitution' (SubstArg a) -&gt; a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#applySubst"><span class="hs-identifier hs-var">applySubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Impossible -&gt; VerboseLevel -&gt; Substitution' Term
forall a. Impossible -&gt; VerboseLevel -&gt; Substitution' a
</span><a href="Agda.TypeChecking.Substitute.Class.html#strengthenS"><span class="hs-identifier hs-var">strengthenS</span></a></span><span> </span><span class="annot"><span class="annottext">Impossible
HasCallStack =&gt; Impossible
</span><a href="Agda.Utils.Impossible.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; VerboseLevel
forall a. Sized a =&gt; a -&gt; VerboseLevel
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681013967"><span class="hs-identifier hs-var">tel</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>          </span><span class="annot"><span class="annottext">(Term -&gt; Term) -&gt; Term -&gt; Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConHead -&gt; ConInfo -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Con"><span class="hs-identifier hs-var">Con</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681013965"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ConInfo
</span><a href="#local-6989586621681013964"><span class="hs-identifier hs-var">ci</span></a></span><span> </span><span class="annot"><span class="annottext">(Elims -&gt; Term) -&gt; Elims -&gt; Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Elims -&gt; Elims
forall a. VerboseLevel -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Elims -&gt; VerboseLevel
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; VerboseLevel
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013974"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013963"><span class="hs-identifier hs-var">vs2</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621681013956"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621681013956"><span class="hs-identifier hs-var">l</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-198"></span><span>      </span><span id="local-6989586621681013955"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013955"><span class="hs-identifier hs-var">lt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; m Type
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
Literal -&gt; m Type
</span><a href="Agda.TypeChecking.Monad.Builtin.html#litType"><span class="hs-identifier hs-var">litType</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621681013956"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-199"></span><span>      </span><span class="annot"><span class="annottext">Comparison -&gt; Type -&gt; Type -&gt; m ()
forall (m :: * -&gt; *).
MonadConversion m =&gt;
Comparison -&gt; Type -&gt; Type -&gt; m ()
</span><a href="Agda.TypeChecking.Conversion.html#compareType"><span class="hs-identifier hs-var">compareType</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="#local-6989586621681013999"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013955"><span class="hs-identifier hs-var">lt</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013998"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-200"></span><span>      </span><span class="annot"><span class="annottext">Term -&gt; m Term
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; m Term) -&gt; Term -&gt; m Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621681013956"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span id="local-6989586621681013952"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681013952"><span class="hs-identifier hs-var">ai</span></a></span></span><span> </span><span id="local-6989586621681013951"><span class="annot"><span class="annottext">Abs Term
</span><a href="#local-6989586621681013951"><span class="hs-identifier hs-var">vb</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-202"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681013950"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681013950"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681013949"><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681013949"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Dom Type, Abs Type)
-&gt; ((Dom Type, Abs Type) -&gt; m (Dom Type, Abs Type))
-&gt; Maybe (Dom Type, Abs Type)
-&gt; m (Dom Type, Abs Type)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; m (Dom Type, Abs Type)
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Type -&gt; m (Dom Type, Abs Type)
</span><a href="Agda.TypeChecking.CheckInternal.html#shouldBePi"><span class="hs-identifier hs-var">shouldBePi</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013998"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Dom Type, Abs Type) -&gt; m (Dom Type, Abs Type)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Dom Type, Abs Type) -&gt; m (Dom Type, Abs Type))
-&gt; m (Maybe (Dom Type, Abs Type)) -&gt; m (Dom Type, Abs Type)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; m (Maybe (Dom Type, Abs Type))
forall (m :: * -&gt; *).
PureTCM m =&gt;
Type -&gt; m (Maybe (Dom Type, Abs Type))
</span><a href="Agda.TypeChecking.Telescope.html#isPath"><span class="hs-identifier hs-var">isPath</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013998"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-203"></span><span>      </span><span id="local-6989586621681013945"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681013945"><span class="hs-identifier hs-var">ai</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Action m -&gt; ArgInfo -&gt; ArgInfo -&gt; m ArgInfo
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; ArgInfo -&gt; ArgInfo -&gt; m ArgInfo
</span><a href="Agda.TypeChecking.CheckInternal.html#checkArgInfo"><span class="hs-identifier hs-var">checkArgInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681014001"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681013952"><span class="hs-identifier hs-var">ai</span></a></span><span> </span><span class="annot"><span class="annottext">(ArgInfo -&gt; m ArgInfo) -&gt; ArgInfo -&gt; m ArgInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; ArgInfo
forall t e. Dom' t e -&gt; ArgInfo
</span><a href="Agda.Syntax.Internal.html#domInfo"><span class="hs-identifier hs-var">domInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681013950"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-204"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681013942"><span class="annot"><span class="annottext">name :: ArgName
</span><a href="#local-6989586621681013942"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Suggestion] -&gt; ArgName
</span><a href="Agda.Syntax.Internal.html#suggests"><span class="hs-identifier hs-var">suggests</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Abs Term -&gt; Suggestion
forall a. Suggest a =&gt; a -&gt; Suggestion
</span><a href="Agda.Syntax.Internal.html#Suggestion"><span class="hs-identifier hs-var">Suggestion</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Term
</span><a href="#local-6989586621681013951"><span class="hs-identifier hs-var">vb</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Abs Type -&gt; Suggestion
forall a. Suggest a =&gt; a -&gt; Suggestion
</span><a href="Agda.Syntax.Internal.html#Suggestion"><span class="hs-identifier hs-var">Suggestion</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681013949"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-205"></span><span>      </span><span class="annot"><span class="annottext">(ArgName, Dom Type) -&gt; m Term -&gt; m Term
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621681013942"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681013950"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m Term -&gt; m Term) -&gt; m Term -&gt; m Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-206"></span><span>        </span><span class="annot"><span class="annottext">ArgInfo -&gt; Abs Term -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Lam"><span class="hs-identifier hs-var">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681013945"><span class="hs-identifier hs-var">ai</span></a></span><span> </span><span class="annot"><span class="annottext">(Abs Term -&gt; Term) -&gt; (Term -&gt; Abs Term) -&gt; Term -&gt; Term
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; Term -&gt; Abs Term
forall a. ArgName -&gt; a -&gt; Abs a
</span><a href="Agda.Syntax.Internal.html#Abs"><span class="hs-identifier hs-var">Abs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs Term -&gt; ArgName
forall a. Abs a -&gt; ArgName
</span><a href="Agda.Syntax.Internal.html#absName"><span class="hs-identifier hs-var">absName</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Term
</span><a href="#local-6989586621681013951"><span class="hs-identifier hs-var">vb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Term -&gt; Term) -&gt; m Term -&gt; m Term
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#checkInternal%27"><span class="hs-identifier hs-var">checkInternal'</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681014001"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs Term -&gt; Term
forall a. Subst a =&gt; Abs a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#absBody"><span class="hs-identifier hs-var">absBody</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Term
</span><a href="#local-6989586621681013951"><span class="hs-identifier hs-var">vb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="#local-6989586621681013999"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs Type -&gt; Type
forall a. Subst a =&gt; Abs a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#absBody"><span class="hs-identifier hs-var">absBody</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681013949"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Pi"><span class="hs-identifier hs-type">Pi</span></a></span><span> </span><span id="local-6989586621681013937"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681013937"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621681013936"><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681013936"><span class="hs-identifier hs-var">b</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-208"></span><span>      </span><span id="local-6989586621681013935"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013935"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m Sort
forall (m :: * -&gt; *).
(PureTCM m, MonadBlock m, MonadError TCErr m) =&gt;
Type -&gt; m Sort
</span><a href="Agda.TypeChecking.Sort.html#shouldBeSort"><span class="hs-identifier hs-var">shouldBeSort</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013998"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-209"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013935"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Sort -&gt; Sort -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Sort
forall t. Sort' t
</span><a href="Agda.Syntax.Internal.html#SizeUniv"><span class="hs-identifier hs-var">SizeUniv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeError -&gt; m ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
TypeError -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-var">typeError</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeError -&gt; m ()) -&gt; TypeError -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#FunctionTypeInSizeUniv"><span class="hs-identifier hs-var">FunctionTypeInSizeUniv</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013989"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-210"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681013931"><span class="annot"><span class="annottext">sa :: Sort
</span><a href="#local-6989586621681013931"><span class="hs-identifier hs-var hs-var">sa</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Sort
forall a. LensSort a =&gt; a -&gt; Sort
</span><a href="Agda.Syntax.Internal.html#getSort"><span class="hs-identifier hs-var">getSort</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681013937"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-211"></span><span>          </span><span id="local-6989586621681013930"><span class="annot"><span class="annottext">sb :: Sort
</span><a href="#local-6989586621681013930"><span class="hs-identifier hs-var hs-var">sb</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Sort
forall a. LensSort a =&gt; a -&gt; Sort
</span><a href="Agda.Syntax.Internal.html#getSort"><span class="hs-identifier hs-var">getSort</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs Type -&gt; Type
forall a. Abs a -&gt; a
</span><a href="Agda.Syntax.Internal.html#unAbs"><span class="hs-identifier hs-var">unAbs</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681013936"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>          </span><span id="local-6989586621681013929"><span class="annot"><span class="annottext">mkDom :: Term -&gt; Dom Type
</span><a href="#local-6989586621681013929"><span class="hs-identifier hs-var hs-var">mkDom</span></a></span></span><span> </span><span id="local-6989586621681013928"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013928"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sort -&gt; Term -&gt; Type
forall t a. Sort' t -&gt; a -&gt; Type'' t a
</span><a href="Agda.Syntax.Internal.html#El"><span class="hs-identifier hs-var">El</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013931"><span class="hs-identifier hs-var">sa</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013928"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Dom Type -&gt; Dom Type
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681013937"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-213"></span><span>          </span><span id="local-6989586621681013926"><span class="annot"><span class="annottext">mkRng :: Term -&gt; Abs Type
</span><a href="#local-6989586621681013926"><span class="hs-identifier hs-var hs-var">mkRng</span></a></span></span><span> </span><span id="local-6989586621681013925"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013925"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Abs Type -&gt; Abs Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013925"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Term -&gt; Type -&gt; Type
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681013936"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-214"></span><span>          </span><span class="hs-comment">-- Preserve NoAbs</span><span>
</span><span id="line-215"></span><span>          </span><span id="local-6989586621681013924"><span class="annot"><span class="annottext">goInside :: m Term -&gt; m Term
</span><a href="#local-6989586621681013924"><span class="hs-identifier hs-var hs-var">goInside</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681013936"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Abs"><span class="hs-identifier hs-type">Abs</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ArgName, Dom Type) -&gt; m Term -&gt; m Term
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs Type -&gt; ArgName
forall a. Abs a -&gt; ArgName
</span><a href="Agda.Syntax.Internal.html#absName"><span class="hs-identifier hs-var">absName</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681013936"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681013937"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>                               </span><span class="annot"><a href="Agda.Syntax.Internal.html#NoAbs"><span class="hs-identifier hs-type">NoAbs</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m Term -&gt; m Term
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-217"></span><span>      </span><span id="local-6989586621681013923"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681013923"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term -&gt; Dom Type
</span><a href="#local-6989586621681013929"><span class="hs-identifier hs-var">mkDom</span></a></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; Dom Type) -&gt; m Term -&gt; m (Dom Type)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#checkInternal%27"><span class="hs-identifier hs-var">checkInternal'</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681014001"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Term
forall t a. Type'' t a -&gt; a
</span><a href="Agda.Syntax.Internal.html#unEl"><span class="hs-identifier hs-var">unEl</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Term) -&gt; Type -&gt; Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Type
forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681013937"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="Agda.TypeChecking.Monad.Base.html#CmpLeq"><span class="hs-identifier hs-var">CmpLeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sort -&gt; Type
</span><a href="Agda.TypeChecking.Substitute.html#sort"><span class="hs-identifier hs-var">sort</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013931"><span class="hs-identifier hs-var">sa</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>      </span><span id="local-6989586621681013922"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013922"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Term -&gt; m Term
</span><a href="#local-6989586621681013924"><span class="hs-identifier hs-var">goInside</span></a></span><span> </span><span class="annot"><span class="annottext">(m Term -&gt; m Term) -&gt; m Term -&gt; m Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Abs Type -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Pi"><span class="hs-identifier hs-var">Pi</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681013923"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">(Abs Type -&gt; Term) -&gt; (Term -&gt; Abs Type) -&gt; Term -&gt; Term
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; Abs Type
</span><a href="#local-6989586621681013926"><span class="hs-identifier hs-var">mkRng</span></a></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; Term) -&gt; m Term -&gt; m Term
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#checkInternal%27"><span class="hs-identifier hs-var">checkInternal'</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681014001"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Term
forall t a. Type'' t a -&gt; a
</span><a href="Agda.Syntax.Internal.html#unEl"><span class="hs-identifier hs-var">unEl</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Term) -&gt; Type -&gt; Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Abs Type -&gt; Type
forall a. Abs a -&gt; a
</span><a href="Agda.Syntax.Internal.html#unAbs"><span class="hs-identifier hs-var">unAbs</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681013936"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="Agda.TypeChecking.Monad.Base.html#CmpLeq"><span class="hs-identifier hs-var">CmpLeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sort -&gt; Type
</span><a href="Agda.TypeChecking.Substitute.html#sort"><span class="hs-identifier hs-var">sort</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013930"><span class="hs-identifier hs-var">sb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>      </span><span id="local-6989586621681013921"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013921"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term -&gt; m Sort
forall (m :: * -&gt; *). (PureTCM m, MonadBlock m) =&gt; Term -&gt; m Sort
</span><a href="Agda.TypeChecking.Sort.html#sortOf"><span class="hs-identifier hs-var">sortOf</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013922"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-220"></span><span>      </span><span class="annot"><span class="annottext">Comparison -&gt; Sort -&gt; Sort -&gt; m ()
forall (m :: * -&gt; *).
MonadConversion m =&gt;
Comparison -&gt; Sort -&gt; Sort -&gt; m ()
</span><a href="Agda.TypeChecking.Conversion.html#compareSort"><span class="hs-identifier hs-var">compareSort</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="#local-6989586621681013999"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013921"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013935"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-221"></span><span>      </span><span class="annot"><span class="annottext">Term -&gt; m Term
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013922"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-type">Sort</span></a></span><span> </span><span id="local-6989586621681013918"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013918"><span class="hs-identifier hs-var">s</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-223"></span><span>      </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;tc.check.internal&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">30</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; m ()) -&gt; TCMT IO Doc -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;checking sort&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Sort -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013918"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-224"></span><span>      </span><span id="local-6989586621681013917"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013917"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Sort -&gt; m Sort
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Sort -&gt; m Sort
</span><a href="Agda.TypeChecking.CheckInternal.html#checkSort"><span class="hs-identifier hs-var">checkSort</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681014001"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013918"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-225"></span><span>      </span><span id="local-6989586621681013916"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013916"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Sort -&gt; m Sort
forall (m :: * -&gt; *).
(PureTCM m, MonadConstraint m) =&gt;
Sort -&gt; m Sort
</span><a href="Agda.TypeChecking.Sort.html#inferUnivSort"><span class="hs-identifier hs-var">inferUnivSort</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013917"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-226"></span><span>      </span><span id="local-6989586621681013915"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013915"><span class="hs-identifier hs-var">s''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m Sort
forall (m :: * -&gt; *).
(PureTCM m, MonadBlock m, MonadError TCErr m) =&gt;
Type -&gt; m Sort
</span><a href="Agda.TypeChecking.Sort.html#shouldBeSort"><span class="hs-identifier hs-var">shouldBeSort</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013998"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-227"></span><span>      </span><span class="annot"><span class="annottext">Comparison -&gt; Sort -&gt; Sort -&gt; m ()
forall (m :: * -&gt; *).
MonadConversion m =&gt;
Comparison -&gt; Sort -&gt; Sort -&gt; m ()
</span><a href="Agda.TypeChecking.Conversion.html#compareSort"><span class="hs-identifier hs-var">compareSort</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="#local-6989586621681013999"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013916"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013915"><span class="hs-identifier hs-var">s''</span></a></span><span>
</span><span id="line-228"></span><span>      </span><span class="annot"><span class="annottext">Term -&gt; m Term
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; m Term) -&gt; Term -&gt; m Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Sort -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-var">Sort</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013917"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Level"><span class="hs-identifier hs-type">Level</span></a></span><span> </span><span id="local-6989586621681013914"><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621681013914"><span class="hs-identifier hs-var">l</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-230"></span><span>      </span><span id="local-6989586621681013913"><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621681013913"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Level -&gt; m Level
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Level -&gt; m Level
</span><a href="Agda.TypeChecking.CheckInternal.html#checkLevel"><span class="hs-identifier hs-var">checkLevel</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681014001"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621681013914"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-231"></span><span>      </span><span id="local-6989586621681013911"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013911"><span class="hs-identifier hs-var">lt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Type
forall (m :: * -&gt; *). HasBuiltins m =&gt; m Type
</span><a href="Agda.TypeChecking.Level.html#levelType"><span class="hs-identifier hs-var">levelType</span></a></span><span>
</span><span id="line-232"></span><span>      </span><span class="annot"><span class="annottext">Comparison -&gt; Type -&gt; Type -&gt; m ()
forall (m :: * -&gt; *).
MonadConversion m =&gt;
Comparison -&gt; Type -&gt; Type -&gt; m ()
</span><a href="Agda.TypeChecking.Conversion.html#compareType"><span class="hs-identifier hs-var">compareType</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="#local-6989586621681013999"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013911"><span class="hs-identifier hs-var">lt</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013998"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-233"></span><span>      </span><span class="annot"><span class="annottext">Term -&gt; m Term
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; m Term) -&gt; Term -&gt; m Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Level -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Level"><span class="hs-identifier hs-var">Level</span></a></span><span> </span><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621681013913"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-234"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#DontCare"><span class="hs-identifier hs-type">DontCare</span></a></span><span> </span><span id="local-6989586621681013909"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013909"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term -&gt; Term
</span><a href="Agda.Syntax.Internal.html#DontCare"><span class="hs-identifier hs-var">DontCare</span></a></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; Term) -&gt; m Term -&gt; m Term
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#checkInternal%27"><span class="hs-identifier hs-var">checkInternal'</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681014001"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013909"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="#local-6989586621681013999"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013998"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-235"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Dummy"><span class="hs-identifier hs-type">Dummy</span></a></span><span> </span><span id="local-6989586621681013908"><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621681013908"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">Elims
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; m Term
forall (m :: * -&gt; *) a.
(HasCallStack, MonadDebug m) =&gt;
ArgName -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Debug.html#__IMPOSSIBLE_VERBOSE__"><span class="hs-identifier hs-var">__IMPOSSIBLE_VERBOSE__</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621681013908"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">-- | Make sure a constructor is fully applied</span><span>
</span><span id="line-238"></span><span class="hs-comment">--   and infer the type of the constructor.</span><span>
</span><span id="line-239"></span><span class="hs-comment">--   Raises a type error if the constructor does not belong to the given type.</span><span>
</span><span id="line-240"></span><span id="local-6989586621681014645"><span id="local-6989586621681014646"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#fullyApplyCon"><span class="hs-identifier hs-type">fullyApplyCon</span></a></span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier hs-type">MonadCheckInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014646"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#ConHead"><span class="hs-identifier hs-type">ConHead</span></a></span><span> </span><span class="hs-comment">-- ^ Constructor.</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Elims"><span class="hs-identifier hs-type">Elims</span></a></span><span>    </span><span class="hs-comment">-- ^ Constructor arguments.</span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>    </span><span class="hs-comment">-- ^ Type of the constructor application.</span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Args"><span class="hs-identifier hs-type">Args</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Elims"><span class="hs-identifier hs-type">Elims</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014646"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014645"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>       </span><span class="hs-comment">-- ^ Name of the data/record type,</span><span>
</span><span id="line-247"></span><span>       </span><span class="hs-comment">--   type of the data/record type,</span><span>
</span><span id="line-248"></span><span>       </span><span class="hs-comment">--   reconstructed parameters,</span><span>
</span><span id="line-249"></span><span>       </span><span class="hs-comment">--   type of the constructor (applied to parameters),</span><span>
</span><span id="line-250"></span><span>       </span><span class="hs-comment">--   full application arguments,</span><span>
</span><span id="line-251"></span><span>       </span><span class="hs-comment">--   types of missing arguments (already added to context),</span><span>
</span><span id="line-252"></span><span>       </span><span class="hs-comment">--   type of the full application.</span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014646"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014645"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-254"></span><span id="fullyApplyCon"><span class="annot"><span class="annottext">fullyApplyCon :: forall (m :: * -&gt; *) a.
MonadCheckInternal m =&gt;
ConHead
-&gt; Elims
-&gt; Type
-&gt; (QName
    -&gt; Type -&gt; Args -&gt; Type -&gt; Elims -&gt; Telescope -&gt; Type -&gt; m a)
-&gt; m a
</span><a href="Agda.TypeChecking.CheckInternal.html#fullyApplyCon"><span class="hs-identifier hs-var hs-var">fullyApplyCon</span></a></span></span><span> </span><span id="local-6989586621681013867"><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681013867"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621681013866"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013866"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621681013865"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013865"><span class="hs-identifier hs-var">t0</span></a></span></span><span> </span><span id="local-6989586621681013864"><span class="annot"><span class="annottext">QName -&gt; Type -&gt; Args -&gt; Type -&gt; Elims -&gt; Telescope -&gt; Type -&gt; m a
</span><a href="#local-6989586621681013864"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Substitute.html#TelV"><span class="hs-identifier hs-type">TelV</span></a></span><span> </span><span id="local-6989586621681013862"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681013862"><span class="hs-identifier hs-var">tel</span></a></span></span><span> </span><span id="local-6989586621681013861"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013861"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681013860"><span class="annot"><span class="annottext">Boundary
</span><a href="#local-6989586621681013860"><span class="hs-identifier hs-var">boundary</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m (TelView, Boundary)
forall (m :: * -&gt; *). PureTCM m =&gt; Type -&gt; m (TelView, Boundary)
</span><a href="Agda.TypeChecking.Telescope.html#telViewPathBoundaryP"><span class="hs-identifier hs-var">telViewPathBoundaryP</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013865"><span class="hs-identifier hs-var">t0</span></a></span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-comment">-- The type of the constructor application may still be a function</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-comment">-- type.  In this case, we introduce the domains @tel@ into the context</span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-comment">-- and apply the constructor to these fresh variables.</span><span>
</span><span id="line-259"></span><span>  </span><span class="annot"><span class="annottext">Telescope -&gt; m a -&gt; m a
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681013862"><span class="hs-identifier hs-var">tel</span></a></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; m a) -&gt; m a -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-260"></span><span>    </span><span id="local-6989586621681013858"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013858"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m Type
forall (m :: * -&gt; *) t.
(MonadReduce m, MonadBlock m, IsMeta t, Reduce t) =&gt;
t -&gt; m t
</span><a href="Agda.TypeChecking.Reduce.html#abortIfBlocked"><span class="hs-identifier hs-var">abortIfBlocked</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013861"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span class="annot"><span class="annottext">ConHead -&gt; Type -&gt; m (Maybe ((QName, Type, Args), Type))
forall (m :: * -&gt; *).
PureTCM m =&gt;
ConHead -&gt; Type -&gt; m (Maybe ((QName, Type, Args), Type))
</span><a href="Agda.TypeChecking.Datatypes.html#getFullyAppliedConType"><span class="hs-identifier hs-var">getFullyAppliedConType</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681013867"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013858"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">m (Maybe ((QName, Type, Args), Type))
-&gt; (Maybe ((QName, Type, Args), Type) -&gt; m a) -&gt; m a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-262"></span><span>      </span><span class="annot"><span class="annottext">Maybe ((QName, Type, Args), Type)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-263"></span><span>        </span><span class="annot"><span class="annottext">TypeError -&gt; m a
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
TypeError -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-var">typeError</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeError -&gt; m a) -&gt; TypeError -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Type -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#DoesNotConstructAnElementOf"><span class="hs-identifier hs-var">DoesNotConstructAnElementOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConHead -&gt; QName
</span><a href="Agda.Syntax.Internal.html#conName"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681013867"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013858"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-264"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681013853"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013853"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681013852"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013852"><span class="hs-identifier hs-var">dt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681013851"><span class="annot"><span class="annottext">Args
</span><a href="#local-6989586621681013851"><span class="hs-identifier hs-var">pars</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681013850"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013850"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-265"></span><span>        </span><span class="annot"><span class="annottext">QName -&gt; Type -&gt; Args -&gt; Type -&gt; Elims -&gt; Telescope -&gt; Type -&gt; m a
</span><a href="#local-6989586621681013864"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013853"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013852"><span class="hs-identifier hs-var">dt</span></a></span><span> </span><span class="annot"><span class="annottext">Args
</span><a href="#local-6989586621681013851"><span class="hs-identifier hs-var">pars</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013850"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel -&gt; Elims -&gt; Elims
forall a. Subst a =&gt; VerboseLevel -&gt; a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#raise"><span class="hs-identifier hs-var">raise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; VerboseLevel
forall a. Sized a =&gt; a -&gt; VerboseLevel
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681013862"><span class="hs-identifier hs-var">tel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013866"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">Elims -&gt; Elims -&gt; Elims
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Boundary -&gt; Elims
forall a. DeBruijn a =&gt; Telescope -&gt; Boundary' (a, a) -&gt; [Elim' a]
</span><a href="Agda.TypeChecking.Telescope.html#teleElims"><span class="hs-identifier hs-var">teleElims</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681013862"><span class="hs-identifier hs-var">tel</span></a></span><span> </span><span class="annot"><span class="annottext">Boundary
</span><a href="#local-6989586621681013860"><span class="hs-identifier hs-var">boundary</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681013862"><span class="hs-identifier hs-var">tel</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013858"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span id="local-6989586621681014650"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#checkSpine"><span class="hs-identifier hs-type">checkSpine</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier hs-type">MonadCheckInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014650"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014650"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>       </span><span class="hs-comment">-- ^ Type of the head @self@.</span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span>       </span><span class="hs-comment">-- ^ The head @self@.</span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Elims"><span class="hs-identifier hs-type">Elims</span></a></span><span>      </span><span class="hs-comment">-- ^ The eliminations @es@.</span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Comparison"><span class="hs-identifier hs-type">Comparison</span></a></span><span> </span><span class="hs-comment">-- ^ Check (@CmpLeq@) or infer (@CmpEq@) the final type.</span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>       </span><span class="hs-comment">-- ^ Expected type of the application @self es@.</span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014650"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span></span><span>     </span><span class="hs-comment">-- ^ The application after modification by the @Action@.</span><span>
</span><span id="line-276"></span><span id="checkSpine"><span class="annot"><span class="annottext">checkSpine :: forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Type -&gt; Term -&gt; Elims -&gt; Comparison -&gt; Type -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#checkSpine"><span class="hs-identifier hs-var hs-var">checkSpine</span></a></span></span><span> </span><span id="local-6989586621681013790"><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013790"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span id="local-6989586621681013789"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013789"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621681013788"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013788"><span class="hs-identifier hs-var">self</span></a></span></span><span> </span><span id="local-6989586621681013787"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013787"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span id="local-6989586621681013786"><span class="annot"><span class="annottext">Comparison
</span><a href="#local-6989586621681013786"><span class="hs-identifier hs-var">cmp</span></a></span></span><span> </span><span id="local-6989586621681013785"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013785"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-277"></span><span>  </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;tc.check.internal&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; m ()) -&gt; TCMT IO Doc -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;checking spine &quot;</span></span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; VerboseLevel -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Term -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013788"><span class="hs-identifier hs-var">self</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;:&quot;</span></span><span>
</span><span id="line-280"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; VerboseLevel -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013789"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; VerboseLevel -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Elims -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013787"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;:&quot;</span></span><span>
</span><span id="line-282"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; VerboseLevel -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013785"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681013783"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013783"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681013782"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013782"><span class="hs-identifier hs-var">v'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681013781"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013781"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Type -&gt; Term -&gt; Term -&gt; Elims -&gt; m ((Term, Term), Type)
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Type -&gt; Term -&gt; Term -&gt; Elims -&gt; m ((Term, Term), Type)
</span><a href="Agda.TypeChecking.CheckInternal.html#inferSpine%27"><span class="hs-identifier hs-var">inferSpine'</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013790"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013789"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013788"><span class="hs-identifier hs-var">self</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013788"><span class="hs-identifier hs-var">self</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013787"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-284"></span><span>  </span><span id="local-6989586621681013780"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013780"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m Type
forall a (m :: * -&gt; *). (Reduce a, MonadReduce m) =&gt; a -&gt; m a
</span><a href="Agda.TypeChecking.Reduce.html#reduce"><span class="hs-identifier hs-var">reduce</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013781"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-285"></span><span>  </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013782"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Term -&gt; m () -&gt; m Term
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; m ()) -&gt; Term -&gt; Type -&gt; Type -&gt; m ()
forall (m :: * -&gt; *).
MonadConversion m =&gt;
(Type -&gt; Type -&gt; m ()) -&gt; Term -&gt; Type -&gt; Type -&gt; m ()
</span><a href="Agda.TypeChecking.Conversion.html#coerceSize"><span class="hs-identifier hs-var">coerceSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Comparison -&gt; Type -&gt; Type -&gt; m ()
forall (m :: * -&gt; *).
MonadConversion m =&gt;
Comparison -&gt; Type -&gt; Type -&gt; m ()
</span><a href="Agda.TypeChecking.Conversion.html#compareType"><span class="hs-identifier hs-var">compareType</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="#local-6989586621681013786"><span class="hs-identifier hs-var">cmp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013783"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013780"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013785"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-286"></span><span class="hs-comment">--UNUSED Liang-Ting Chen 2019-07-16</span><span>
</span><span id="line-287"></span><span class="hs-comment">--checkArgs</span><span>
</span><span id="line-288"></span><span class="hs-comment">--  :: (MonadCheckInternal m)</span><span>
</span><span id="line-289"></span><span class="hs-comment">--  =&gt; Action m</span><span>
</span><span id="line-290"></span><span class="hs-comment">--  -&gt; Type      -- ^ Type of the head.</span><span>
</span><span id="line-291"></span><span class="hs-comment">--  -&gt; Term      -- ^ The head.</span><span>
</span><span id="line-292"></span><span class="hs-comment">--  -&gt; Args      -- ^ The arguments.</span><span>
</span><span id="line-293"></span><span class="hs-comment">--  -&gt; Type      -- ^ Expected type of the application.</span><span>
</span><span id="line-294"></span><span class="hs-comment">--  -&gt; m Term    -- ^ The application after modification by the @Action@.</span><span>
</span><span id="line-295"></span><span class="hs-comment">--checkArgs action a self vs t = checkSpine action a self (map Apply vs) t</span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="hs-comment">-- | @checkArgInfo actual expected@.</span><span>
</span><span id="line-298"></span><span class="hs-comment">--</span><span>
</span><span id="line-299"></span><span class="hs-comment">--   The @expected@ 'ArgInfo' comes from the type.</span><span>
</span><span id="line-300"></span><span class="hs-comment">--   The @actual@ 'ArgInfo' comes from the term and can be updated</span><span>
</span><span id="line-301"></span><span class="hs-comment">--   by an action.</span><span>
</span><span id="line-302"></span><span id="local-6989586621681014629"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#checkArgInfo"><span class="hs-identifier hs-type">checkArgInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier hs-type">MonadCheckInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014629"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014629"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#ArgInfo"><span class="hs-identifier hs-type">ArgInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#ArgInfo"><span class="hs-identifier hs-type">ArgInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014629"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#ArgInfo"><span class="hs-identifier hs-type">ArgInfo</span></a></span></span><span>
</span><span id="line-303"></span><span id="checkArgInfo"><span class="annot"><span class="annottext">checkArgInfo :: forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; ArgInfo -&gt; ArgInfo -&gt; m ArgInfo
</span><a href="Agda.TypeChecking.CheckInternal.html#checkArgInfo"><span class="hs-identifier hs-var hs-var">checkArgInfo</span></a></span></span><span> </span><span id="local-6989586621681013760"><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013760"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span id="local-6989586621681013759"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681013759"><span class="hs-identifier hs-var">ai</span></a></span></span><span> </span><span id="local-6989586621681013758"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681013758"><span class="hs-identifier hs-var">ai'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-304"></span><span>  </span><span class="annot"><span class="annottext">Hiding -&gt; Hiding -&gt; m ()
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Hiding -&gt; Hiding -&gt; m ()
</span><a href="Agda.TypeChecking.CheckInternal.html#checkHiding"><span class="hs-identifier hs-var">checkHiding</span></a></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgInfo -&gt; Hiding
forall a. LensHiding a =&gt; a -&gt; Hiding
</span><a href="Agda.Syntax.Common.html#getHiding"><span class="hs-identifier hs-var">getHiding</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681013759"><span class="hs-identifier hs-var">ai</span></a></span><span class="hs-special">)</span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgInfo -&gt; Hiding
forall a. LensHiding a =&gt; a -&gt; Hiding
</span><a href="Agda.Syntax.Common.html#getHiding"><span class="hs-identifier hs-var">getHiding</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681013758"><span class="hs-identifier hs-var">ai'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>  </span><span id="local-6989586621681013755"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681013755"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Modality -&gt; Modality -&gt; m Modality
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Modality -&gt; Modality -&gt; m Modality
</span><a href="Agda.TypeChecking.CheckInternal.html#checkModality"><span class="hs-identifier hs-var">checkModality</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013760"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgInfo -&gt; Modality
forall a. LensModality a =&gt; a -&gt; Modality
</span><a href="Agda.Syntax.Common.html#getModality"><span class="hs-identifier hs-var">getModality</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681013759"><span class="hs-identifier hs-var">ai</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgInfo -&gt; Modality
forall a. LensModality a =&gt; a -&gt; Modality
</span><a href="Agda.Syntax.Common.html#getModality"><span class="hs-identifier hs-var">getModality</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681013758"><span class="hs-identifier hs-var">ai'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>  </span><span class="annot"><span class="annottext">ArgInfo -&gt; m ArgInfo
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ArgInfo -&gt; m ArgInfo) -&gt; ArgInfo -&gt; m ArgInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; ArgInfo -&gt; ArgInfo
forall a. LensModality a =&gt; Modality -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#setModality"><span class="hs-identifier hs-var">setModality</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681013755"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681013759"><span class="hs-identifier hs-var">ai</span></a></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span id="local-6989586621681014581"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#checkHiding"><span class="hs-identifier hs-type">checkHiding</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier hs-type">MonadCheckInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014581"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Hiding"><span class="hs-identifier hs-type">Hiding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Hiding"><span class="hs-identifier hs-type">Hiding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014581"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-309"></span><span id="checkHiding"><span class="annot"><span class="annottext">checkHiding :: forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Hiding -&gt; Hiding -&gt; m ()
</span><a href="Agda.TypeChecking.CheckInternal.html#checkHiding"><span class="hs-identifier hs-var hs-var">checkHiding</span></a></span></span><span>    </span><span id="local-6989586621681013734"><span class="annot"><span class="annottext">Hiding
</span><a href="#local-6989586621681013734"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621681013733"><span class="annot"><span class="annottext">Hiding
</span><a href="#local-6989586621681013733"><span class="hs-identifier hs-var">h'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Hiding -&gt; Hiding -&gt; Bool
forall a b. (LensHiding a, LensHiding b) =&gt; a -&gt; b -&gt; Bool
</span><a href="Agda.Syntax.Common.html#sameHiding"><span class="hs-identifier hs-var">sameHiding</span></a></span><span> </span><span class="annot"><span class="annottext">Hiding
</span><a href="#local-6989586621681013734"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Hiding
</span><a href="#local-6989586621681013733"><span class="hs-identifier hs-var">h'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeError -&gt; m ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
TypeError -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-var">typeError</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeError -&gt; m ()) -&gt; TypeError -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Hiding -&gt; Hiding -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#HidingMismatch"><span class="hs-identifier hs-var">HidingMismatch</span></a></span><span> </span><span class="annot"><span class="annottext">Hiding
</span><a href="#local-6989586621681013734"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Hiding
</span><a href="#local-6989586621681013733"><span class="hs-identifier hs-var">h'</span></a></span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="hs-comment">-- | @checkRelevance action term type@.</span><span>
</span><span id="line-312"></span><span class="hs-comment">--</span><span>
</span><span id="line-313"></span><span class="hs-comment">--   The @term@ 'Relevance' can be updated by the @action@.</span><span>
</span><span id="line-314"></span><span id="local-6989586621681014579"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#checkModality"><span class="hs-identifier hs-type">checkModality</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier hs-type">MonadCheckInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014579"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014579"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Modality"><span class="hs-identifier hs-type">Modality</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Modality"><span class="hs-identifier hs-type">Modality</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014579"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Modality"><span class="hs-identifier hs-type">Modality</span></a></span></span><span>
</span><span id="line-315"></span><span id="checkModality"><span class="annot"><span class="annottext">checkModality :: forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Modality -&gt; Modality -&gt; m Modality
</span><a href="Agda.TypeChecking.CheckInternal.html#checkModality"><span class="hs-identifier hs-var hs-var">checkModality</span></a></span></span><span> </span><span id="local-6989586621681013701"><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013701"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span id="local-6989586621681013700"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681013700"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span id="local-6989586621681013699"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681013699"><span class="hs-identifier hs-var">mod'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681013698"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681013698"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681013697"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681013697"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681013700"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681013699"><span class="hs-identifier hs-var">mod'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681013695"><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621681013695"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681013694"><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621681013694"><span class="hs-identifier hs-var">q'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality -&gt; Quantity
forall a. LensQuantity a =&gt; a -&gt; Quantity
</span><a href="Agda.Syntax.Common.html#getQuantity"><span class="hs-identifier hs-var">getQuantity</span></a></span><span>  </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681013700"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Quantity
forall a. LensQuantity a =&gt; a -&gt; Quantity
</span><a href="Agda.Syntax.Common.html#getQuantity"><span class="hs-identifier hs-var">getQuantity</span></a></span><span>  </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681013699"><span class="hs-identifier hs-var">mod'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality -&gt; Modality -&gt; Bool
forall a b. (LensModality a, LensModality b) =&gt; a -&gt; b -&gt; Bool
</span><a href="Agda.Syntax.Common.html#sameModality"><span class="hs-identifier hs-var">sameModality</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681013700"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681013699"><span class="hs-identifier hs-var">mod'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeError -&gt; m ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
TypeError -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-var">typeError</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeError -&gt; m ()) -&gt; TypeError -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Relevance -&gt; Relevance -&gt; Bool
</span><a href="Agda.Syntax.Common.html#sameRelevance"><span class="hs-identifier hs-var">sameRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681013698"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681013697"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Relevance -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#RelevanceMismatch"><span class="hs-identifier hs-var">RelevanceMismatch</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681013698"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681013697"><span class="hs-identifier hs-var">r'</span></a></span><span>
</span><span id="line-320"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Quantity -&gt; Quantity -&gt; Bool
</span><a href="Agda.Syntax.Common.html#sameQuantity"><span class="hs-identifier hs-var">sameQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621681013695"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621681013694"><span class="hs-identifier hs-var">q'</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Quantity -&gt; Quantity -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#QuantityMismatch"><span class="hs-identifier hs-var">QuantityMismatch</span></a></span><span>  </span><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621681013695"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621681013694"><span class="hs-identifier hs-var">q'</span></a></span><span>
</span><span id="line-321"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeError
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="hs-comment">-- add more cases when adding new modalities</span><span>
</span><span id="line-322"></span><span>  </span><span class="annot"><span class="annottext">Modality -&gt; m Modality
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Modality -&gt; m Modality) -&gt; Modality -&gt; m Modality
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Modality -&gt; Modality -&gt; Modality
forall (m :: * -&gt; *). Action m -&gt; Modality -&gt; Modality -&gt; Modality
</span><a href="Agda.TypeChecking.CheckInternal.html#modalityAction"><span class="hs-identifier hs-var">modalityAction</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013701"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681013699"><span class="hs-identifier hs-var">mod'</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681013700"><span class="hs-identifier hs-var">mod</span></a></span><span>  </span><span class="hs-comment">-- Argument order for actions: @type@ @term@</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="hs-comment">-- | Infer type of a neutral term.</span><span>
</span><span id="line-325"></span><span id="local-6989586621681014564"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#infer"><span class="hs-identifier hs-type">infer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier hs-type">MonadCheckInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014564"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014564"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span></span><span>
</span><span id="line-326"></span><span id="infer"><span class="annot"><span class="annottext">infer :: forall (m :: * -&gt; *). MonadCheckInternal m =&gt; Term -&gt; m Type
</span><a href="Agda.TypeChecking.CheckInternal.html#infer"><span class="hs-identifier hs-var hs-var">infer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-327"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621681013654"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681013654"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681013653"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013653"><span class="hs-identifier hs-var">es</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-328"></span><span>      </span><span id="local-6989586621681013652"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013652"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; m Type
forall (m :: * -&gt; *).
(Applicative m, MonadFail m, MonadTCEnv m) =&gt;
VerboseLevel -&gt; m Type
</span><a href="Agda.TypeChecking.Monad.Context.html#typeOfBV"><span class="hs-identifier hs-var">typeOfBV</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681013654"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-329"></span><span>      </span><span class="annot"><span class="annottext">(Term, Type) -&gt; Type
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Term, Type) -&gt; Type) -&gt; m (Term, Type) -&gt; m Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Term -&gt; Elims -&gt; m (Term, Type)
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Type -&gt; Term -&gt; Elims -&gt; m (Term, Type)
</span><a href="Agda.TypeChecking.CheckInternal.html#inferSpine"><span class="hs-identifier hs-var">inferSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013652"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681013654"><span class="hs-identifier hs-var">i</span></a></span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013653"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-330"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-type">Def</span></a></span><span> </span><span id="local-6989586621681013651"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013651"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#Apply"><span class="hs-identifier hs-type">Apply</span></a></span><span> </span><span id="local-6989586621681013649"><span class="annot"><span class="annottext">Arg Term
</span><a href="#local-6989586621681013649"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681013648"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013648"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Arg Term -&gt; Elims -&gt; m Type
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
QName -&gt; Arg Term -&gt; Elims -&gt; m Type
</span><a href="Agda.TypeChecking.CheckInternal.html#inferDef%27"><span class="hs-identifier hs-var">inferDef'</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013651"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Arg Term
</span><a href="#local-6989586621681013649"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013648"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-comment">-- possibly proj.like</span><span>
</span><span id="line-331"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-type">Def</span></a></span><span> </span><span id="local-6989586621681013646"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013646"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681013645"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013645"><span class="hs-identifier hs-var">es</span></a></span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Elims -&gt; m Type
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
QName -&gt; Elims -&gt; m Type
</span><a href="Agda.TypeChecking.CheckInternal.html#inferDef"><span class="hs-identifier hs-var">inferDef</span></a></span><span>  </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013646"><span class="hs-identifier hs-var">f</span></a></span><span>   </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013645"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-comment">-- not a projection-like fun</span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaV"><span class="hs-identifier hs-type">MetaV</span></a></span><span> </span><span id="local-6989586621681013643"><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681013643"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681013642"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013642"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- we assume meta instantiations to be well-typed</span><span>
</span><span id="line-333"></span><span>      </span><span id="local-6989586621681013641"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013641"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; m Type
forall (m :: * -&gt; *). ReadTCState m =&gt; MetaId -&gt; m Type
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#metaType"><span class="hs-identifier hs-var">metaType</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681013643"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-334"></span><span>      </span><span class="annot"><span class="annottext">(Term, Type) -&gt; Type
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Term, Type) -&gt; Type) -&gt; m (Term, Type) -&gt; m Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Term -&gt; Elims -&gt; m (Term, Type)
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Type -&gt; Term -&gt; Elims -&gt; m (Term, Type)
</span><a href="Agda.TypeChecking.CheckInternal.html#inferSpine"><span class="hs-identifier hs-var">inferSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013641"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MetaId -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#MetaV"><span class="hs-identifier hs-var">MetaV</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681013643"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013642"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-335"></span><span>    </span><span id="local-6989586621681013640"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013640"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; m Type
forall (m :: * -&gt; *) a.
(HasCallStack, MonadDebug m) =&gt;
ArgName -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Debug.html#__IMPOSSIBLE_VERBOSE__"><span class="hs-identifier hs-var">__IMPOSSIBLE_VERBOSE__</span></a></span><span> </span><span class="annot"><span class="annottext">(ArgName -&gt; m Type) -&gt; ArgName -&gt; m Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ArgName] -&gt; ArgName
</span><span class="hs-identifier hs-var">unlines</span></span><span>
</span><span id="line-336"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;CheckInternal.infer: non-inferable term:&quot;</span></span><span>
</span><span id="line-337"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;  &quot;</span></span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; ArgName -&gt; ArgName
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; ArgName
forall a. Pretty a =&gt; a -&gt; ArgName
</span><a href="Agda.Utils.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013640"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-338"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="hs-comment">-- | Infer ordinary function application.</span><span>
</span><span id="line-341"></span><span id="local-6989586621681014559"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#inferDef"><span class="hs-identifier hs-type">inferDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier hs-type">MonadCheckInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014559"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Elims"><span class="hs-identifier hs-type">Elims</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014559"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span></span><span>
</span><span id="line-342"></span><span id="inferDef"><span class="annot"><span class="annottext">inferDef :: forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
QName -&gt; Elims -&gt; m Type
</span><a href="Agda.TypeChecking.CheckInternal.html#inferDef"><span class="hs-identifier hs-var hs-var">inferDef</span></a></span></span><span> </span><span id="local-6989586621681013626"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013626"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681013625"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013625"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-343"></span><span>  </span><span id="local-6989586621681013624"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013624"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Type
</span><a href="Agda.TypeChecking.Monad.Base.html#defType"><span class="hs-identifier hs-var">defType</span></a></span><span> </span><span class="annot"><span class="annottext">(Definition -&gt; Type) -&gt; m Definition -&gt; m Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m Definition
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Definition
</span><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo"><span class="hs-identifier hs-var">getConstInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013626"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-344"></span><span>  </span><span class="annot"><span class="annottext">(Term, Type) -&gt; Type
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Term, Type) -&gt; Type) -&gt; m (Term, Type) -&gt; m Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Term -&gt; Elims -&gt; m (Term, Type)
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Type -&gt; Term -&gt; Elims -&gt; m (Term, Type)
</span><a href="Agda.TypeChecking.CheckInternal.html#inferSpine"><span class="hs-identifier hs-var">inferSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013624"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-var">Def</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013626"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013625"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span class="hs-comment">-- | Infer possibly projection-like function application</span><span>
</span><span id="line-347"></span><span id="local-6989586621681014560"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#inferDef%27"><span class="hs-identifier hs-type">inferDef'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier hs-type">MonadCheckInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014560"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Elims"><span class="hs-identifier hs-type">Elims</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014560"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span></span><span>
</span><span id="line-348"></span><span id="inferDef%27"><span class="annot"><span class="annottext">inferDef' :: forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
QName -&gt; Arg Term -&gt; Elims -&gt; m Type
</span><a href="Agda.TypeChecking.CheckInternal.html#inferDef%27"><span class="hs-identifier hs-var hs-var">inferDef'</span></a></span></span><span> </span><span id="local-6989586621681013605"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013605"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681013604"><span class="annot"><span class="annottext">Arg Term
</span><a href="#local-6989586621681013604"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621681013603"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013603"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-349"></span><span>  </span><span class="hs-comment">-- Andreas, 2022-03-07, issue #5809: don't drop parameters of irrelevant projections.</span><span>
</span><span id="line-350"></span><span>  </span><span class="annot"><span class="annottext">QName -&gt; m (Maybe Projection)
forall (m :: * -&gt; *).
HasConstInfo m =&gt;
QName -&gt; m (Maybe Projection)
</span><a href="Agda.TypeChecking.Monad.Signature.html#isRelevantProjection"><span class="hs-identifier hs-var">isRelevantProjection</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013605"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">m (Maybe Projection) -&gt; (Maybe Projection -&gt; m Type) -&gt; m Type
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-351"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">projIndex :: Projection -&gt; VerboseLevel
</span><a href="Agda.TypeChecking.Monad.Base.html#projIndex"><span class="hs-identifier hs-var">projIndex</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681013599"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681013599"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681013599"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-352"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681013597"><span class="annot"><span class="annottext">self :: Term
</span><a href="#local-6989586621681013597"><span class="hs-identifier hs-var hs-var">self</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Arg Term -&gt; Term
forall e. Arg e -&gt; e
</span><a href="Agda.Syntax.Common.html#unArg"><span class="hs-identifier hs-var">unArg</span></a></span><span> </span><span class="annot"><span class="annottext">Arg Term
</span><a href="#local-6989586621681013604"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-353"></span><span>      </span><span id="local-6989586621681013595"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013595"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term -&gt; m Type
forall (m :: * -&gt; *). MonadCheckInternal m =&gt; Term -&gt; m Type
</span><a href="Agda.TypeChecking.CheckInternal.html#infer"><span class="hs-identifier hs-var">infer</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013597"><span class="hs-identifier hs-var">self</span></a></span><span>
</span><span id="line-354"></span><span>      </span><span class="annot"><span class="annottext">(Term, Type) -&gt; Type
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Term, Type) -&gt; Type) -&gt; m (Term, Type) -&gt; m Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Term -&gt; Elims -&gt; m (Term, Type)
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Type -&gt; Term -&gt; Elims -&gt; m (Term, Type)
</span><a href="Agda.TypeChecking.CheckInternal.html#inferSpine"><span class="hs-identifier hs-var">inferSpine</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013595"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013597"><span class="hs-identifier hs-var">self</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProjOrigin -&gt; QName -&gt; Elim
forall a. ProjOrigin -&gt; QName -&gt; Elim' a
</span><a href="Agda.Syntax.Internal.Elim.html#Proj"><span class="hs-identifier hs-var">Proj</span></a></span><span> </span><span class="annot"><span class="annottext">ProjOrigin
</span><a href="Agda.Syntax.Common.html#ProjSystem"><span class="hs-identifier hs-var">ProjSystem</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013605"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Elim -&gt; Elims -&gt; Elims
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013603"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>    </span><span class="annot"><span class="annottext">Maybe Projection
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Elims -&gt; m Type
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
QName -&gt; Elims -&gt; m Type
</span><a href="Agda.TypeChecking.CheckInternal.html#inferDef"><span class="hs-identifier hs-var">inferDef</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013605"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arg Term -&gt; Elim
forall a. Arg a -&gt; Elim' a
</span><a href="Agda.Syntax.Internal.Elim.html#Apply"><span class="hs-identifier hs-var">Apply</span></a></span><span> </span><span class="annot"><span class="annottext">Arg Term
</span><a href="#local-6989586621681013604"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Elim -&gt; Elims -&gt; Elims
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013603"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="hs-comment">-- | @inferSpine t self es@ checks that spine @es@ eliminates</span><span>
</span><span id="line-359"></span><span class="hs-comment">--   value @self@ of type @t@ and returns the remaining type</span><span>
</span><span id="line-360"></span><span class="hs-comment">--   (target of elimination) and the final self (has that type).</span><span>
</span><span id="line-361"></span><span id="local-6989586621681014699"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#inferSpine"><span class="hs-identifier hs-type">inferSpine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier hs-type">MonadCheckInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014699"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Elims"><span class="hs-identifier hs-type">Elims</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014699"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-362"></span><span id="inferSpine"><span class="annot"><span class="annottext">inferSpine :: forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Type -&gt; Term -&gt; Elims -&gt; m (Term, Type)
</span><a href="Agda.TypeChecking.CheckInternal.html#inferSpine"><span class="hs-identifier hs-var hs-var">inferSpine</span></a></span></span><span> </span><span id="local-6989586621681013583"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013583"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621681013582"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013582"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621681013581"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013581"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Term, Term) -&gt; Term) -&gt; ((Term, Term), Type) -&gt; (Term, Type)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">(Term, Term) -&gt; Term
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(((Term, Term), Type) -&gt; (Term, Type))
-&gt; m ((Term, Term), Type) -&gt; m (Term, Type)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Type -&gt; Term -&gt; Term -&gt; Elims -&gt; m ((Term, Term), Type)
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Type -&gt; Term -&gt; Term -&gt; Elims -&gt; m ((Term, Term), Type)
</span><a href="Agda.TypeChecking.CheckInternal.html#inferSpine%27"><span class="hs-identifier hs-var">inferSpine'</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
forall (m :: * -&gt; *). PureTCM m =&gt; Action m
</span><a href="Agda.TypeChecking.CheckInternal.html#defaultAction"><span class="hs-identifier hs-var">defaultAction</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013583"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013582"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013582"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013581"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="hs-comment">-- | Returns both the real term (first) and the transformed term (second). The</span><span>
</span><span id="line-365"></span><span class="hs-comment">--   transformed term is not necessarily a valid term, so it must not be used</span><span>
</span><span id="line-366"></span><span class="hs-comment">--   in types.</span><span>
</span><span id="line-367"></span><span id="local-6989586621681014589"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#inferSpine%27"><span class="hs-identifier hs-type">inferSpine'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier hs-type">MonadCheckInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014589"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014589"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Elims"><span class="hs-identifier hs-type">Elims</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014589"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-369"></span><span id="inferSpine%27"><span class="annot"><span class="annottext">inferSpine' :: forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Type -&gt; Term -&gt; Term -&gt; Elims -&gt; m ((Term, Term), Type)
</span><a href="Agda.TypeChecking.CheckInternal.html#inferSpine%27"><span class="hs-identifier hs-var hs-var">inferSpine'</span></a></span></span><span> </span><span id="local-6989586621681013489"><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013489"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span id="local-6989586621681013488"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013488"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621681013487"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013487"><span class="hs-identifier hs-var">self</span></a></span></span><span> </span><span id="local-6989586621681013486"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013486"><span class="hs-identifier hs-var">self'</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Term, Term), Type) -&gt; m ((Term, Term), Type)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013487"><span class="hs-identifier hs-var">self</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013486"><span class="hs-identifier hs-var">self'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013488"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#inferSpine%27"><span class="hs-identifier hs-var">inferSpine'</span></a></span><span> </span><span id="local-6989586621681013485"><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013485"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span id="local-6989586621681013484"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013484"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621681013483"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013483"><span class="hs-identifier hs-var">self</span></a></span></span><span> </span><span id="local-6989586621681013482"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013482"><span class="hs-identifier hs-var">self'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681013481"><span class="annot"><span class="annottext">Elim
</span><a href="#local-6989586621681013481"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681013480"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013480"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-371"></span><span>  </span><span class="annot"><span class="annottext">ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
ArgName -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><span class="hs-string">&quot;tc.infer.internal&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">30</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; m ()) -&gt; TCMT IO Doc -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;inferSpine': &quot;</span></span><span>
</span><span id="line-373"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;type t = &quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013484"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;self  = &quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013483"><span class="hs-identifier hs-var">self</span></a></span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;self' = &quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013482"><span class="hs-identifier hs-var">self'</span></a></span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;eliminated by e = &quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Elim -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Elim
</span><a href="#local-6989586621681013481"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-377"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-378"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Elim
</span><a href="#local-6989586621681013481"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-379"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#IApply"><span class="hs-identifier hs-type">IApply</span></a></span><span> </span><span id="local-6989586621681013478"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013478"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681013477"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013477"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621681013476"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013476"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-380"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681013475"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681013475"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681013474"><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681013474"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m (Dom Type, Abs Type)
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Type -&gt; m (Dom Type, Abs Type)
</span><a href="Agda.TypeChecking.CheckInternal.html#shouldBePath"><span class="hs-identifier hs-var">shouldBePath</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013484"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-381"></span><span>      </span><span id="local-6989586621681013472"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013472"><span class="hs-identifier hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#checkInternal%27"><span class="hs-identifier hs-var">checkInternal'</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013485"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013476"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="Agda.TypeChecking.Monad.Base.html#CmpLeq"><span class="hs-identifier hs-var">CmpLeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dom Type -&gt; Type
forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681013475"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>      </span><span id="local-6989586621681013471"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013471"><span class="hs-identifier hs-var">izero</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primIZero"><span class="hs-identifier hs-var">primIZero</span></a></span><span>
</span><span id="line-383"></span><span>      </span><span id="local-6989586621681013469"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013469"><span class="hs-identifier hs-var">ione</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primIOne"><span class="hs-identifier hs-var">primIOne</span></a></span><span>
</span><span id="line-384"></span><span>      </span><span id="local-6989586621681013467"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013467"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#checkInternal%27"><span class="hs-identifier hs-var">checkInternal'</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013485"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013478"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="Agda.TypeChecking.Monad.Base.html#CmpLeq"><span class="hs-identifier hs-var">CmpLeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681013474"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Type -&gt; SubstArg Type -&gt; Type
forall a. Subst a =&gt; Abs a -&gt; SubstArg a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#absApp"><span class="hs-operator hs-var">`absApp`</span></a></span><span> </span><span class="annot"><span class="annottext">Term
SubstArg Type
</span><a href="#local-6989586621681013471"><span class="hs-identifier hs-var">izero</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>      </span><span id="local-6989586621681013465"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013465"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#checkInternal%27"><span class="hs-identifier hs-var">checkInternal'</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013485"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013477"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="Agda.TypeChecking.Monad.Base.html#CmpLeq"><span class="hs-identifier hs-var">CmpLeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681013474"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Type -&gt; SubstArg Type -&gt; Type
forall a. Subst a =&gt; Abs a -&gt; SubstArg a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#absApp"><span class="hs-operator hs-var">`absApp`</span></a></span><span> </span><span class="annot"><span class="annottext">Term
SubstArg Type
</span><a href="#local-6989586621681013469"><span class="hs-identifier hs-var">ione</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span>      </span><span class="annot"><span class="annottext">Action m -&gt; Type -&gt; Term -&gt; Term -&gt; Elims -&gt; m ((Term, Term), Type)
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Type -&gt; Term -&gt; Term -&gt; Elims -&gt; m ((Term, Term), Type)
</span><a href="Agda.TypeChecking.CheckInternal.html#inferSpine%27"><span class="hs-identifier hs-var">inferSpine'</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013485"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681013474"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Type -&gt; SubstArg Type -&gt; Type
forall a. Subst a =&gt; Abs a -&gt; SubstArg a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#absApp"><span class="hs-operator hs-var">`absApp`</span></a></span><span> </span><span class="annot"><span class="annottext">Term
SubstArg Type
</span><a href="#local-6989586621681013476"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013483"><span class="hs-identifier hs-var">self</span></a></span><span> </span><span class="annot"><span class="annottext">Term -&gt; Elims -&gt; Term
forall t. Apply t =&gt; t -&gt; Elims -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#applyE"><span class="hs-operator hs-var">`applyE`</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Elim
</span><a href="#local-6989586621681013481"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013482"><span class="hs-identifier hs-var">self'</span></a></span><span> </span><span class="annot"><span class="annottext">Term -&gt; Elims -&gt; Term
forall t. Apply t =&gt; t -&gt; Elims -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#applyE"><span class="hs-operator hs-var">`applyE`</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Term -&gt; Term -&gt; Term -&gt; Elim
forall a. a -&gt; a -&gt; a -&gt; Elim' a
</span><a href="Agda.Syntax.Internal.Elim.html#IApply"><span class="hs-identifier hs-var">IApply</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013467"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013465"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013472"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013480"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-387"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#Apply"><span class="hs-identifier hs-type">Apply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span id="local-6989586621681013462"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681013462"><span class="hs-identifier hs-var">ai</span></a></span></span><span> </span><span id="local-6989586621681013461"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013461"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-388"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681013460"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681013460"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681013459"><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681013459"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m (Dom Type, Abs Type)
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Type -&gt; m (Dom Type, Abs Type)
</span><a href="Agda.TypeChecking.CheckInternal.html#shouldBePi"><span class="hs-identifier hs-var">shouldBePi</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013484"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-389"></span><span>      </span><span id="local-6989586621681013458"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681013458"><span class="hs-identifier hs-var">ai</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Action m -&gt; ArgInfo -&gt; ArgInfo -&gt; m ArgInfo
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; ArgInfo -&gt; ArgInfo -&gt; m ArgInfo
</span><a href="Agda.TypeChecking.CheckInternal.html#checkArgInfo"><span class="hs-identifier hs-var">checkArgInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013485"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681013462"><span class="hs-identifier hs-var">ai</span></a></span><span> </span><span class="annot"><span class="annottext">(ArgInfo -&gt; m ArgInfo) -&gt; ArgInfo -&gt; m ArgInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; ArgInfo
forall t e. Dom' t e -&gt; ArgInfo
</span><a href="Agda.Syntax.Internal.html#domInfo"><span class="hs-identifier hs-var">domInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681013460"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-390"></span><span>      </span><span id="local-6989586621681013457"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013457"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#checkInternal%27"><span class="hs-identifier hs-var">checkInternal'</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013485"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013461"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="Agda.TypeChecking.Monad.Base.html#CmpLeq"><span class="hs-identifier hs-var">CmpLeq</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; m Term) -&gt; Type -&gt; m Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Type
forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681013460"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-391"></span><span>      </span><span class="annot"><span class="annottext">Action m -&gt; Type -&gt; Term -&gt; Term -&gt; Elims -&gt; m ((Term, Term), Type)
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Type -&gt; Term -&gt; Term -&gt; Elims -&gt; m ((Term, Term), Type)
</span><a href="Agda.TypeChecking.CheckInternal.html#inferSpine%27"><span class="hs-identifier hs-var">inferSpine'</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013485"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681013459"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Type -&gt; SubstArg Type -&gt; Type
forall a. Subst a =&gt; Abs a -&gt; SubstArg a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#absApp"><span class="hs-operator hs-var">`absApp`</span></a></span><span> </span><span class="annot"><span class="annottext">Term
SubstArg Type
</span><a href="#local-6989586621681013461"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013483"><span class="hs-identifier hs-var">self</span></a></span><span> </span><span class="annot"><span class="annottext">Term -&gt; Elims -&gt; Term
forall t. Apply t =&gt; t -&gt; Elims -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#applyE"><span class="hs-operator hs-var">`applyE`</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Elim
</span><a href="#local-6989586621681013481"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013482"><span class="hs-identifier hs-var">self'</span></a></span><span> </span><span class="annot"><span class="annottext">Term -&gt; Elims -&gt; Term
forall t. Apply t =&gt; t -&gt; Elims -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#applyE"><span class="hs-operator hs-var">`applyE`</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Arg Term -&gt; Elim
forall a. Arg a -&gt; Elim' a
</span><a href="Agda.Syntax.Internal.Elim.html#Apply"><span class="hs-identifier hs-var">Apply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgInfo -&gt; Term -&gt; Arg Term
forall e. ArgInfo -&gt; e -&gt; Arg e
</span><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-var">Arg</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681013458"><span class="hs-identifier hs-var">ai</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013457"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013480"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-392"></span><span>    </span><span class="hs-comment">-- case: projection or projection-like</span><span>
</span><span id="line-393"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#Proj"><span class="hs-identifier hs-type">Proj</span></a></span><span> </span><span id="local-6989586621681013456"><span class="annot"><span class="annottext">ProjOrigin
</span><a href="#local-6989586621681013456"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621681013455"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013455"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-394"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681013454"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681013454"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681013453"><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681013453"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m (Dom Type, Abs Type)
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Type -&gt; m (Dom Type, Abs Type)
</span><a href="Agda.TypeChecking.CheckInternal.html#shouldBePi"><span class="hs-identifier hs-var">shouldBePi</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; m (Dom Type, Abs Type))
-&gt; m Type -&gt; m (Dom Type, Abs Type)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; QName -&gt; m Type
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Type -&gt; QName -&gt; m Type
</span><a href="Agda.TypeChecking.CheckInternal.html#shouldBeProjectible"><span class="hs-identifier hs-var">shouldBeProjectible</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013484"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013455"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-395"></span><span>      </span><span id="local-6989586621681013451"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013451"><span class="hs-identifier hs-var">u</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ProjOrigin -&gt; QName -&gt; Arg Term -&gt; m Term
forall (m :: * -&gt; *).
HasConstInfo m =&gt;
ProjOrigin -&gt; QName -&gt; Arg Term -&gt; m Term
</span><a href="Agda.TypeChecking.Monad.Signature.html#applyDef"><span class="hs-identifier hs-var">applyDef</span></a></span><span> </span><span class="annot"><span class="annottext">ProjOrigin
</span><a href="#local-6989586621681013456"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013455"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dom Type -&gt; Arg Type
forall t a. Dom' t a -&gt; Arg a
</span><a href="Agda.Syntax.Internal.html#argFromDom"><span class="hs-identifier hs-var">argFromDom</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681013454"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Arg Type -&gt; Term -&gt; Arg Term
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013483"><span class="hs-identifier hs-var">self</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>      </span><span id="local-6989586621681013448"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013448"><span class="hs-identifier hs-var">u'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ProjOrigin -&gt; QName -&gt; Arg Term -&gt; m Term
forall (m :: * -&gt; *).
HasConstInfo m =&gt;
ProjOrigin -&gt; QName -&gt; Arg Term -&gt; m Term
</span><a href="Agda.TypeChecking.Monad.Signature.html#applyDef"><span class="hs-identifier hs-var">applyDef</span></a></span><span> </span><span class="annot"><span class="annottext">ProjOrigin
</span><a href="#local-6989586621681013456"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013455"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dom Type -&gt; Arg Type
forall t a. Dom' t a -&gt; Arg a
</span><a href="Agda.Syntax.Internal.html#argFromDom"><span class="hs-identifier hs-var">argFromDom</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681013454"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Arg Type -&gt; Term -&gt; Arg Term
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013482"><span class="hs-identifier hs-var">self'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>      </span><span class="annot"><span class="annottext">Action m -&gt; Type -&gt; Term -&gt; Term -&gt; Elims -&gt; m ((Term, Term), Type)
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Type -&gt; Term -&gt; Term -&gt; Elims -&gt; m ((Term, Term), Type)
</span><a href="Agda.TypeChecking.CheckInternal.html#inferSpine%27"><span class="hs-identifier hs-var">inferSpine'</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013485"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681013453"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Type -&gt; SubstArg Type -&gt; Type
forall a. Subst a =&gt; Abs a -&gt; SubstArg a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#absApp"><span class="hs-operator hs-var">`absApp`</span></a></span><span> </span><span class="annot"><span class="annottext">Term
SubstArg Type
</span><a href="#local-6989586621681013483"><span class="hs-identifier hs-var">self</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013451"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013448"><span class="hs-identifier hs-var">u'</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013480"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="hs-comment">-- | Type should either be a record type of a type eligible for</span><span>
</span><span id="line-400"></span><span class="hs-comment">--   the principal argument of projection-like functions.</span><span>
</span><span id="line-401"></span><span id="local-6989586621681014535"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#shouldBeProjectible"><span class="hs-identifier hs-type">shouldBeProjectible</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier hs-type">MonadCheckInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014535"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014535"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span></span><span>
</span><span id="line-402"></span><span class="hs-comment">-- shouldBeProjectible t f = maybe failure return =&lt;&lt; projectionType t f</span><span>
</span><span id="line-403"></span><span id="shouldBeProjectible"><span class="annot"><span class="annottext">shouldBeProjectible :: forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Type -&gt; QName -&gt; m Type
</span><a href="Agda.TypeChecking.CheckInternal.html#shouldBeProjectible"><span class="hs-identifier hs-var hs-var">shouldBeProjectible</span></a></span></span><span> </span><span id="local-6989586621681013423"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013423"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621681013422"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013422"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-404"></span><span>    </span><span id="local-6989586621681013421"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013421"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m Type
forall (m :: * -&gt; *) t.
(MonadReduce m, MonadBlock m, IsMeta t, Reduce t) =&gt;
t -&gt; m t
</span><a href="Agda.TypeChecking.Reduce.html#abortIfBlocked"><span class="hs-identifier hs-var">abortIfBlocked</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013423"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-405"></span><span>    </span><span class="annot"><span class="annottext">m Type -&gt; (Type -&gt; m Type) -&gt; Maybe Type -&gt; m Type
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">m Type
</span><a href="#local-6989586621681013420"><span class="hs-identifier hs-var">failure</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; m Type
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Type -&gt; m Type) -&gt; m (Maybe Type) -&gt; m Type
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Type -&gt; m (Maybe Type)
forall (m :: * -&gt; *). PureTCM m =&gt; QName -&gt; Type -&gt; m (Maybe Type)
</span><a href="Agda.TypeChecking.Records.html#getDefType"><span class="hs-identifier hs-var">getDefType</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013422"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013421"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681013420"><span class="annot"><span class="annottext">failure :: m Type
</span><a href="#local-6989586621681013420"><span class="hs-identifier hs-var hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeError -&gt; m Type
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
TypeError -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-var">typeError</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeError -&gt; m Type) -&gt; TypeError -&gt; m Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#ShouldBeRecordType"><span class="hs-identifier hs-var">ShouldBeRecordType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013423"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-407"></span><span>    </span><span class="hs-comment">-- TODO: more accurate error that makes sense also for proj.-like funs.</span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span id="local-6989586621681013418"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#shouldBePath"><span class="hs-identifier hs-type">shouldBePath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier hs-type">MonadCheckInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681013418"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681013418"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Abs"><span class="hs-identifier hs-type">Abs</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-410"></span><span id="shouldBePath"><span class="annot"><span class="annottext">shouldBePath :: forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Type -&gt; m (Dom Type, Abs Type)
</span><a href="Agda.TypeChecking.CheckInternal.html#shouldBePath"><span class="hs-identifier hs-var hs-var">shouldBePath</span></a></span></span><span> </span><span id="local-6989586621681013393"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013393"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-411"></span><span>  </span><span id="local-6989586621681013392"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013392"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m Type
forall (m :: * -&gt; *) t.
(MonadReduce m, MonadBlock m, IsMeta t, Reduce t) =&gt;
t -&gt; m t
</span><a href="Agda.TypeChecking.Reduce.html#abortIfBlocked"><span class="hs-identifier hs-var">abortIfBlocked</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013393"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-412"></span><span>  </span><span id="local-6989586621681013391"><span class="annot"><span class="annottext">Maybe (Dom Type, Abs Type)
</span><a href="#local-6989586621681013391"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m (Maybe (Dom Type, Abs Type))
forall (m :: * -&gt; *).
PureTCM m =&gt;
Type -&gt; m (Maybe (Dom Type, Abs Type))
</span><a href="Agda.TypeChecking.Telescope.html#isPath"><span class="hs-identifier hs-var">isPath</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013392"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-413"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Dom Type, Abs Type)
</span><a href="#local-6989586621681013391"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-414"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681013390"><span class="annot"><span class="annottext">(Dom Type, Abs Type)
</span><a href="#local-6989586621681013390"><span class="hs-identifier hs-var">p</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Dom Type, Abs Type) -&gt; m (Dom Type, Abs Type)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Dom Type, Abs Type)
</span><a href="#local-6989586621681013390"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-415"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Dom Type, Abs Type)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeError -&gt; m (Dom Type, Abs Type)
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
TypeError -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-var">typeError</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeError -&gt; m (Dom Type, Abs Type))
-&gt; TypeError -&gt; m (Dom Type, Abs Type)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#ShouldBePath"><span class="hs-identifier hs-var">ShouldBePath</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013392"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span id="local-6989586621681014631"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#shouldBePi"><span class="hs-identifier hs-type">shouldBePi</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier hs-type">MonadCheckInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014631"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014631"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Abs"><span class="hs-identifier hs-type">Abs</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-418"></span><span id="shouldBePi"><span class="annot"><span class="annottext">shouldBePi :: forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Type -&gt; m (Dom Type, Abs Type)
</span><a href="Agda.TypeChecking.CheckInternal.html#shouldBePi"><span class="hs-identifier hs-var hs-var">shouldBePi</span></a></span></span><span> </span><span id="local-6989586621681013366"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013366"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; m Type
forall (m :: * -&gt; *) t.
(MonadReduce m, MonadBlock m, IsMeta t, Reduce t) =&gt;
t -&gt; m t
</span><a href="Agda.TypeChecking.Reduce.html#abortIfBlocked"><span class="hs-identifier hs-var">abortIfBlocked</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013366"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">m Type
-&gt; (Type -&gt; m (Dom Type, Abs Type)) -&gt; m (Dom Type, Abs Type)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">case</span><span>
</span><span id="line-419"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#El"><span class="hs-identifier hs-type">El</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Pi"><span class="hs-identifier hs-type">Pi</span></a></span><span> </span><span id="local-6989586621681013365"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681013365"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621681013364"><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681013364"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Dom Type, Abs Type) -&gt; m (Dom Type, Abs Type)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681013365"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681013364"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>  </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeError -&gt; m (Dom Type, Abs Type)
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
TypeError -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-var">typeError</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeError -&gt; m (Dom Type, Abs Type))
-&gt; TypeError -&gt; m (Dom Type, Abs Type)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#ShouldBePi"><span class="hs-identifier hs-var">ShouldBePi</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013366"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="hs-comment">-- | Check if sort is well-formed.</span><span>
</span><span id="line-423"></span><span id="local-6989586621681014722"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#checkSort"><span class="hs-identifier hs-type">checkSort</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier hs-type">MonadCheckInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014722"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014722"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-type">Sort</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014722"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-type">Sort</span></a></span></span><span>
</span><span id="line-424"></span><span id="checkSort"><span class="annot"><span class="annottext">checkSort :: forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Sort -&gt; m Sort
</span><a href="Agda.TypeChecking.CheckInternal.html#checkSort"><span class="hs-identifier hs-var hs-var">checkSort</span></a></span></span><span> </span><span id="local-6989586621681013297"><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013297"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span id="local-6989586621681013296"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013296"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-425"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013296"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-426"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span id="local-6989586621681013294"><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621681013294"><span class="hs-identifier hs-var">l</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Level -&gt; Sort
forall t. Level' t -&gt; Sort' t
</span><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="annot"><span class="annottext">(Level -&gt; Sort) -&gt; m Level -&gt; m Sort
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Level -&gt; m Level
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Level -&gt; m Level
</span><a href="Agda.TypeChecking.CheckInternal.html#checkLevel"><span class="hs-identifier hs-var">checkLevel</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013297"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621681013294"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-427"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span><span> </span><span id="local-6989586621681013292"><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621681013292"><span class="hs-identifier hs-var">l</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Level -&gt; Sort
forall t. Level' t -&gt; Sort' t
</span><a href="Agda.Syntax.Internal.html#Prop"><span class="hs-identifier hs-var">Prop</span></a></span><span> </span><span class="annot"><span class="annottext">(Level -&gt; Sort) -&gt; m Level -&gt; m Sort
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Level -&gt; m Level
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Level -&gt; m Level
</span><a href="Agda.TypeChecking.CheckInternal.html#checkLevel"><span class="hs-identifier hs-var">checkLevel</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013297"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621681013292"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-428"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Inf"><span class="hs-identifier hs-type">Inf</span></a></span><span> </span><span id="local-6989586621681013290"><span class="annot"><span class="annottext">IsFibrant
</span><a href="#local-6989586621681013290"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681013289"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681013289"><span class="hs-identifier hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sort -&gt; m Sort
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Sort -&gt; m Sort) -&gt; Sort -&gt; m Sort
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IsFibrant -&gt; Integer -&gt; Sort
forall t. IsFibrant -&gt; Integer -&gt; Sort' t
</span><a href="Agda.Syntax.Internal.html#Inf"><span class="hs-identifier hs-var">Inf</span></a></span><span> </span><span class="annot"><span class="annottext">IsFibrant
</span><a href="#local-6989586621681013290"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681013289"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-429"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span id="local-6989586621681013287"><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621681013287"><span class="hs-identifier hs-var">l</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Level -&gt; Sort
forall t. Level' t -&gt; Sort' t
</span><a href="Agda.Syntax.Internal.html#SSet"><span class="hs-identifier hs-var">SSet</span></a></span><span> </span><span class="annot"><span class="annottext">(Level -&gt; Sort) -&gt; m Level -&gt; m Sort
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Level -&gt; m Level
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Level -&gt; m Level
</span><a href="Agda.TypeChecking.CheckInternal.html#checkLevel"><span class="hs-identifier hs-var">checkLevel</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013297"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621681013287"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-430"></span><span>    </span><span class="annot"><span class="annottext">Sort
</span><a href="Agda.Syntax.Internal.html#SizeUniv"><span class="hs-identifier hs-var">SizeUniv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sort -&gt; m Sort
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Sort
forall t. Sort' t
</span><a href="Agda.Syntax.Internal.html#SizeUniv"><span class="hs-identifier hs-var">SizeUniv</span></a></span><span>
</span><span id="line-431"></span><span>    </span><span class="annot"><span class="annottext">Sort
</span><a href="Agda.Syntax.Internal.html#LockUniv"><span class="hs-identifier hs-var">LockUniv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sort -&gt; m Sort
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Sort
forall t. Sort' t
</span><a href="Agda.Syntax.Internal.html#LockUniv"><span class="hs-identifier hs-var">LockUniv</span></a></span><span>
</span><span id="line-432"></span><span>    </span><span class="annot"><span class="annottext">Sort
</span><a href="Agda.Syntax.Internal.html#IntervalUniv"><span class="hs-identifier hs-var">IntervalUniv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sort -&gt; m Sort
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Sort
forall t. Sort' t
</span><a href="Agda.Syntax.Internal.html#IntervalUniv"><span class="hs-identifier hs-var">IntervalUniv</span></a></span><span>
</span><span id="line-433"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#PiSort"><span class="hs-identifier hs-type">PiSort</span></a></span><span> </span><span id="local-6989586621681013283"><span class="annot"><span class="annottext">Dom' Term Term
</span><a href="#local-6989586621681013283"><span class="hs-identifier hs-var">dom</span></a></span></span><span> </span><span id="local-6989586621681013282"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013282"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621681013281"><span class="annot"><span class="annottext">Abs Sort
</span><a href="#local-6989586621681013281"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-434"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681013280"><span class="annot"><span class="annottext">a :: Term
</span><a href="#local-6989586621681013280"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dom' Term Term -&gt; Term
forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="annot"><span class="annottext">Dom' Term Term
</span><a href="#local-6989586621681013283"><span class="hs-identifier hs-var">dom</span></a></span><span>
</span><span id="line-435"></span><span>      </span><span id="local-6989586621681013279"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013279"><span class="hs-identifier hs-var">s1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Sort -&gt; m Sort
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Sort -&gt; m Sort
</span><a href="Agda.TypeChecking.CheckInternal.html#checkSort"><span class="hs-identifier hs-var">checkSort</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013297"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013282"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-436"></span><span>      </span><span id="local-6989586621681013278"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013278"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#checkInternal%27"><span class="hs-identifier hs-var">checkInternal'</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013297"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013280"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="Agda.TypeChecking.Monad.Base.html#CmpLeq"><span class="hs-identifier hs-var">CmpLeq</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; m Term) -&gt; Type -&gt; m Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Sort -&gt; Type
</span><a href="Agda.TypeChecking.Substitute.html#sort"><span class="hs-identifier hs-var">sort</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013279"><span class="hs-identifier hs-var">s1'</span></a></span><span>
</span><span id="line-437"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681013277"><span class="annot"><span class="annottext">dom' :: Dom' Term Term
</span><a href="#local-6989586621681013277"><span class="hs-identifier hs-var hs-var">dom'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dom' Term Term
</span><a href="#local-6989586621681013283"><span class="hs-identifier hs-var">dom</span></a></span><span> </span><span class="annot"><span class="annottext">Dom' Term Term -&gt; Term -&gt; Dom' Term Term
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013278"><span class="hs-identifier hs-var">a'</span></a></span><span>
</span><span id="line-438"></span><span>      </span><span id="local-6989586621681013276"><span class="annot"><span class="annottext">Abs Sort
</span><a href="#local-6989586621681013276"><span class="hs-identifier hs-var">s2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; (Sort -&gt; m Sort) -&gt; Abs Sort -&gt; m (Abs Sort)
forall a b (m :: * -&gt; *).
(Subst a, Subst b, MonadAddContext m) =&gt;
Dom Type -&gt; (a -&gt; m b) -&gt; Abs a -&gt; m (Abs b)
</span><a href="Agda.TypeChecking.Monad.Context.html#mapAbstraction"><span class="hs-identifier hs-var">mapAbstraction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sort -&gt; Term -&gt; Type
forall t a. Sort' t -&gt; a -&gt; Type'' t a
</span><a href="Agda.Syntax.Internal.html#El"><span class="hs-identifier hs-var">El</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013279"><span class="hs-identifier hs-var">s1'</span></a></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; Type) -&gt; Dom' Term Term -&gt; Dom Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Dom' Term Term
</span><a href="#local-6989586621681013277"><span class="hs-identifier hs-var">dom'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Action m -&gt; Sort -&gt; m Sort
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Sort -&gt; m Sort
</span><a href="Agda.TypeChecking.CheckInternal.html#checkSort"><span class="hs-identifier hs-var">checkSort</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013297"><span class="hs-identifier hs-var">action</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Abs Sort
</span><a href="#local-6989586621681013281"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-439"></span><span>      </span><span class="annot"><span class="annottext">Sort -&gt; m Sort
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Sort -&gt; m Sort) -&gt; Sort -&gt; m Sort
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom' Term Term -&gt; Sort -&gt; Abs Sort -&gt; Sort
forall t. Dom' t t -&gt; Sort' t -&gt; Abs (Sort' t) -&gt; Sort' t
</span><a href="Agda.Syntax.Internal.html#PiSort"><span class="hs-identifier hs-var">PiSort</span></a></span><span> </span><span class="annot"><span class="annottext">Dom' Term Term
</span><a href="#local-6989586621681013277"><span class="hs-identifier hs-var">dom'</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013279"><span class="hs-identifier hs-var">s1'</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Sort
</span><a href="#local-6989586621681013276"><span class="hs-identifier hs-var">s2'</span></a></span><span>
</span><span id="line-440"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#FunSort"><span class="hs-identifier hs-type">FunSort</span></a></span><span> </span><span id="local-6989586621681013273"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013273"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621681013272"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013272"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-441"></span><span>      </span><span id="local-6989586621681013271"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013271"><span class="hs-identifier hs-var">s1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Sort -&gt; m Sort
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Sort -&gt; m Sort
</span><a href="Agda.TypeChecking.CheckInternal.html#checkSort"><span class="hs-identifier hs-var">checkSort</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013297"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013273"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-442"></span><span>      </span><span id="local-6989586621681013270"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013270"><span class="hs-identifier hs-var">s2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Sort -&gt; m Sort
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Sort -&gt; m Sort
</span><a href="Agda.TypeChecking.CheckInternal.html#checkSort"><span class="hs-identifier hs-var">checkSort</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013297"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013272"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-443"></span><span>      </span><span class="annot"><span class="annottext">Sort -&gt; m Sort
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Sort -&gt; m Sort) -&gt; Sort -&gt; m Sort
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Sort -&gt; Sort -&gt; Sort
forall t. Sort' t -&gt; Sort' t -&gt; Sort' t
</span><a href="Agda.Syntax.Internal.html#FunSort"><span class="hs-identifier hs-var">FunSort</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013271"><span class="hs-identifier hs-var">s1'</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013270"><span class="hs-identifier hs-var">s2'</span></a></span><span>
</span><span id="line-444"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#UnivSort"><span class="hs-identifier hs-type">UnivSort</span></a></span><span> </span><span id="local-6989586621681013268"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013268"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sort -&gt; Sort
forall t. Sort' t -&gt; Sort' t
</span><a href="Agda.Syntax.Internal.html#UnivSort"><span class="hs-identifier hs-var">UnivSort</span></a></span><span> </span><span class="annot"><span class="annottext">(Sort -&gt; Sort) -&gt; m Sort -&gt; m Sort
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Sort -&gt; m Sort
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Sort -&gt; m Sort
</span><a href="Agda.TypeChecking.CheckInternal.html#checkSort"><span class="hs-identifier hs-var">checkSort</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013297"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013268"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-445"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaS"><span class="hs-identifier hs-type">MetaS</span></a></span><span> </span><span id="local-6989586621681013266"><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681013266"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681013265"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013265"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- we assume sort meta instantiations to be well-formed</span><span>
</span><span id="line-446"></span><span>      </span><span id="local-6989586621681013264"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013264"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; m Type
forall (m :: * -&gt; *). ReadTCState m =&gt; MetaId -&gt; m Type
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#metaType"><span class="hs-identifier hs-var">metaType</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681013266"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-447"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681013263"><span class="annot"><span class="annottext">self :: Term
</span><a href="#local-6989586621681013263"><span class="hs-identifier hs-var hs-var">self</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sort -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-var">Sort</span></a></span><span> </span><span class="annot"><span class="annottext">(Sort -&gt; Term) -&gt; Sort -&gt; Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; Elims -&gt; Sort
forall t. MetaId -&gt; [Elim' t] -&gt; Sort' t
</span><a href="Agda.Syntax.Internal.html#MetaS"><span class="hs-identifier hs-var">MetaS</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681013266"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-448"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621681013262"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013262"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Type -&gt; Term -&gt; Term -&gt; Elims -&gt; m ((Term, Term), Type)
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Type -&gt; Term -&gt; Term -&gt; Elims -&gt; m ((Term, Term), Type)
</span><a href="Agda.TypeChecking.CheckInternal.html#inferSpine%27"><span class="hs-identifier hs-var">inferSpine'</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013297"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013264"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013263"><span class="hs-identifier hs-var">self</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013263"><span class="hs-identifier hs-var">self</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013265"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-449"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013262"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-450"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-type">Sort</span></a></span><span> </span><span id="local-6989586621681013261"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013261"><span class="hs-identifier hs-var">s</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sort -&gt; m Sort
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013261"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-451"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaV"><span class="hs-identifier hs-type">MetaV</span></a></span><span> </span><span id="local-6989586621681013260"><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681013260"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681013259"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013259"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sort -&gt; m Sort
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Sort -&gt; m Sort) -&gt; Sort -&gt; m Sort
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; Elims -&gt; Sort
forall t. MetaId -&gt; [Elim' t] -&gt; Sort' t
</span><a href="Agda.Syntax.Internal.html#MetaS"><span class="hs-identifier hs-var">MetaS</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681013260"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013259"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-452"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-type">Def</span></a></span><span> </span><span id="local-6989586621681013258"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013258"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621681013257"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013257"><span class="hs-identifier hs-var">es</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sort -&gt; m Sort
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Sort -&gt; m Sort) -&gt; Sort -&gt; m Sort
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Elims -&gt; Sort
forall t. QName -&gt; [Elim' t] -&gt; Sort' t
</span><a href="Agda.Syntax.Internal.html#DefS"><span class="hs-identifier hs-var">DefS</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013258"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013257"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-453"></span><span>        </span><span class="annot"><span class="annottext">Term
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m Sort
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-454"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#DefS"><span class="hs-identifier hs-type">DefS</span></a></span><span> </span><span id="local-6989586621681013255"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013255"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621681013254"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013254"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-455"></span><span>      </span><span id="local-6989586621681013253"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013253"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Type
</span><a href="Agda.TypeChecking.Monad.Base.html#defType"><span class="hs-identifier hs-var">defType</span></a></span><span> </span><span class="annot"><span class="annottext">(Definition -&gt; Type) -&gt; m Definition -&gt; m Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; m Definition
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Definition
</span><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo"><span class="hs-identifier hs-var">getConstInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013255"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-456"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681013252"><span class="annot"><span class="annottext">self :: Term
</span><a href="#local-6989586621681013252"><span class="hs-identifier hs-var hs-var">self</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sort -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-var">Sort</span></a></span><span> </span><span class="annot"><span class="annottext">(Sort -&gt; Term) -&gt; Sort -&gt; Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Elims -&gt; Sort
forall t. QName -&gt; [Elim' t] -&gt; Sort' t
</span><a href="Agda.Syntax.Internal.html#DefS"><span class="hs-identifier hs-var">DefS</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013255"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-457"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621681013251"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013251"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Action m -&gt; Type -&gt; Term -&gt; Term -&gt; Elims -&gt; m ((Term, Term), Type)
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Type -&gt; Term -&gt; Term -&gt; Elims -&gt; m ((Term, Term), Type)
</span><a href="Agda.TypeChecking.CheckInternal.html#inferSpine%27"><span class="hs-identifier hs-var">inferSpine'</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013297"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013253"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013252"><span class="hs-identifier hs-var">self</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013252"><span class="hs-identifier hs-var">self</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013254"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-458"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013251"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-459"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-type">Sort</span></a></span><span> </span><span id="local-6989586621681013250"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013250"><span class="hs-identifier hs-var">s</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sort -&gt; m Sort
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681013250"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-460"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaV"><span class="hs-identifier hs-type">MetaV</span></a></span><span> </span><span id="local-6989586621681013249"><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681013249"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681013248"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013248"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sort -&gt; m Sort
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Sort -&gt; m Sort) -&gt; Sort -&gt; m Sort
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; Elims -&gt; Sort
forall t. MetaId -&gt; [Elim' t] -&gt; Sort' t
</span><a href="Agda.Syntax.Internal.html#MetaS"><span class="hs-identifier hs-var">MetaS</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681013249"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013248"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-461"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-type">Def</span></a></span><span> </span><span id="local-6989586621681013247"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013247"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621681013246"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013246"><span class="hs-identifier hs-var">es</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sort -&gt; m Sort
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Sort -&gt; m Sort) -&gt; Sort -&gt; m Sort
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Elims -&gt; Sort
forall t. QName -&gt; [Elim' t] -&gt; Sort' t
</span><a href="Agda.Syntax.Internal.html#DefS"><span class="hs-identifier hs-var">DefS</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681013247"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681013246"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-462"></span><span>        </span><span class="annot"><span class="annottext">Term
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m Sort
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-463"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#DummyS"><span class="hs-identifier hs-type">DummyS</span></a></span><span> </span><span id="local-6989586621681013244"><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621681013244"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ArgName -&gt; m Sort
forall (m :: * -&gt; *) a.
(HasCallStack, MonadDebug m) =&gt;
ArgName -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Debug.html#__IMPOSSIBLE_VERBOSE__"><span class="hs-identifier hs-var">__IMPOSSIBLE_VERBOSE__</span></a></span><span> </span><span class="annot"><span class="annottext">ArgName
</span><a href="#local-6989586621681013244"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span class="hs-comment">-- | Check if level is well-formed.</span><span>
</span><span id="line-466"></span><span id="local-6989586621681014615"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#checkLevel"><span class="hs-identifier hs-type">checkLevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier hs-type">MonadCheckInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014615"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681014615"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Level"><span class="hs-identifier hs-type">Level</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681014615"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Level"><span class="hs-identifier hs-type">Level</span></a></span></span><span>
</span><span id="line-467"></span><span id="checkLevel"><span class="annot"><span class="annottext">checkLevel :: forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Level -&gt; m Level
</span><a href="Agda.TypeChecking.CheckInternal.html#checkLevel"><span class="hs-identifier hs-var hs-var">checkLevel</span></a></span></span><span> </span><span id="local-6989586621681013229"><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013229"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Max"><span class="hs-identifier hs-type">Max</span></a></span><span> </span><span id="local-6989586621681013227"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681013227"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681013226"><span class="annot"><span class="annottext">[PlusLevel' Term]
</span><a href="#local-6989586621681013226"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; [PlusLevel' Term] -&gt; Level
forall t. Integer -&gt; [PlusLevel' t] -&gt; Level' t
</span><a href="Agda.Syntax.Internal.html#Max"><span class="hs-identifier hs-var">Max</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681013227"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">([PlusLevel' Term] -&gt; Level) -&gt; m [PlusLevel' Term] -&gt; m Level
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(PlusLevel' Term -&gt; m (PlusLevel' Term))
-&gt; [PlusLevel' Term] -&gt; m [PlusLevel' Term]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">PlusLevel' Term -&gt; m (PlusLevel' Term)
</span><a href="#local-6989586621681013224"><span class="hs-identifier hs-var">checkPlusLevel</span></a></span><span> </span><span class="annot"><span class="annottext">[PlusLevel' Term]
</span><a href="#local-6989586621681013226"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-468"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-469"></span><span>    </span><span id="local-6989586621681013224"><span class="annot"><span class="annottext">checkPlusLevel :: PlusLevel' Term -&gt; m (PlusLevel' Term)
</span><a href="#local-6989586621681013224"><span class="hs-identifier hs-var hs-var">checkPlusLevel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Plus"><span class="hs-identifier hs-type">Plus</span></a></span><span> </span><span id="local-6989586621681013222"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681013222"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621681013221"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013221"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Term -&gt; PlusLevel' Term
forall t. Integer -&gt; t -&gt; PlusLevel' t
</span><a href="Agda.Syntax.Internal.html#Plus"><span class="hs-identifier hs-var">Plus</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681013222"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; PlusLevel' Term) -&gt; m Term -&gt; m (PlusLevel' Term)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; m Term
</span><a href="#local-6989586621681013220"><span class="hs-identifier hs-var">checkLevelAtom</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013221"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span>    </span><span id="local-6989586621681013220"><span class="annot"><span class="annottext">checkLevelAtom :: Term -&gt; m Term
</span><a href="#local-6989586621681013220"><span class="hs-identifier hs-var hs-var">checkLevelAtom</span></a></span></span><span> </span><span id="local-6989586621681013219"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013219"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-472"></span><span>      </span><span id="local-6989586621681013218"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013218"><span class="hs-identifier hs-var">lvl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Type
forall (m :: * -&gt; *). HasBuiltins m =&gt; m Type
</span><a href="Agda.TypeChecking.Level.html#levelType"><span class="hs-identifier hs-var">levelType</span></a></span><span>
</span><span id="line-473"></span><span>      </span><span class="annot"><span class="annottext">Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
forall (m :: * -&gt; *).
MonadCheckInternal m =&gt;
Action m -&gt; Term -&gt; Comparison -&gt; Type -&gt; m Term
</span><a href="Agda.TypeChecking.CheckInternal.html#checkInternal%27"><span class="hs-identifier hs-var">checkInternal'</span></a></span><span> </span><span class="annot"><span class="annottext">Action m
</span><a href="#local-6989586621681013229"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681013219"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="Agda.TypeChecking.Monad.Base.html#CmpLeq"><span class="hs-identifier hs-var">CmpLeq</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013218"><span class="hs-identifier hs-var">lvl</span></a></span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span class="hs-comment">-- | Universe subsumption and type equality (subtyping for sizes, resp.).</span><span>
</span><span id="line-476"></span><span id="local-6989586621681013217"><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#cmptype"><span class="hs-identifier hs-type">cmptype</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CheckInternal.html#MonadCheckInternal"><span class="hs-identifier hs-type">MonadCheckInternal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681013217"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Comparison"><span class="hs-identifier hs-type">Comparison</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681013217"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-477"></span><span id="cmptype"><span class="annot"><span class="annottext">cmptype :: forall (m :: * -&gt; *).
MonadConversion m =&gt;
Comparison -&gt; Type -&gt; Type -&gt; m ()
</span><a href="Agda.TypeChecking.CheckInternal.html#cmptype"><span class="hs-identifier hs-var hs-var">cmptype</span></a></span></span><span> </span><span id="local-6989586621681013204"><span class="annot"><span class="annottext">Comparison
</span><a href="#local-6989586621681013204"><span class="hs-identifier hs-var">cmp</span></a></span></span><span> </span><span id="local-6989586621681013203"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013203"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621681013202"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013202"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-478"></span><span>    </span><span class="hs-comment">-- Andreas, 2017-03-09, issue #2493</span><span>
</span><span id="line-479"></span><span>    </span><span class="hs-comment">-- Only check subtyping, do not solve any metas!</span><span>
</span><span id="line-480"></span><span>    </span><span class="annot"><span class="annottext">m () -&gt; m ()
forall (m :: * -&gt; *) a.
(MonadTCEnv m, HasOptions m, MonadDebug m) =&gt;
m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#dontAssignMetas"><span class="hs-identifier hs-var">dontAssignMetas</span></a></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; Type -&gt; Type -&gt; m ()
forall (m :: * -&gt; *).
MonadConversion m =&gt;
Comparison -&gt; Type -&gt; Type -&gt; m ()
</span><a href="Agda.TypeChecking.Conversion.html#compareType"><span class="hs-identifier hs-var">compareType</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="#local-6989586621681013204"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013203"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681013202"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-481"></span></pre></body></html>