<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Agda.Compiler.MAlonzo.Compiler</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">throwError</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MonadIO</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MonadReader</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">asks</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ReaderT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runReaderT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">withReaderT</span></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans</span></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">lift</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Writer</span></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MonadWriter</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">WriterT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runWriterT</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HashSet</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Monoid</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mappend</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html"><span class="hs-identifier">Agda.Utils.Haskell.Syntax</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HS</span></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Directory</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">createDirectoryIfMissing</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Environment</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">setEnv</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.FilePath</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">normalise</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">utf8</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.CallCompiler.html"><span class="hs-identifier">Agda.Compiler.CallCompiler</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.Common.html"><span class="hs-identifier">Agda.Compiler.Common</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Coerce.html"><span class="hs-identifier">Agda.Compiler.MAlonzo.Coerce</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html"><span class="hs-identifier">Agda.Compiler.MAlonzo.Misc</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pretty.html"><span class="hs-identifier">Agda.Compiler.MAlonzo.Pretty</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Primitives.html"><span class="hs-identifier">Agda.Compiler.MAlonzo.Primitives</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.HaskellTypes.html"><span class="hs-identifier">Agda.Compiler.MAlonzo.HaskellTypes</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html"><span class="hs-identifier">Agda.Compiler.MAlonzo.Pragmas</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Strict.html"><span class="hs-identifier">Agda.Compiler.MAlonzo.Strict</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.ToTreeless.html"><span class="hs-identifier">Agda.Compiler.ToTreeless</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.Treeless.Unused.html"><span class="hs-identifier">Agda.Compiler.Treeless.Unused</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.Treeless.Erase.html"><span class="hs-identifier">Agda.Compiler.Treeless.Erase</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.Backend.html"><span class="hs-identifier">Agda.Compiler.Backend</span></a></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.Imports.html"><span class="hs-identifier">Agda.Interaction.Imports</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.html"><span class="hs-identifier">Agda.Interaction.Options</span></a></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html"><span class="hs-identifier">Agda.Syntax.Common</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html"><span class="hs-identifier">Agda.Syntax.Abstract.Name</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html"><span class="hs-identifier">Agda.Syntax.Internal</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">I</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.Names.html"><span class="hs-identifier">Agda.Syntax.Internal.Names</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.Names.html#namesIn"><span class="hs-identifier">namesIn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html"><span class="hs-identifier">Agda.Syntax.Treeless</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Literal.html"><span class="hs-identifier">Agda.Syntax.Literal</span></a></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Datatypes.html"><span class="hs-identifier">Agda.TypeChecking.Datatypes</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.html"><span class="hs-identifier">Agda.TypeChecking.Primitive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier">getBuiltinName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Reduce.html"><span class="hs-identifier">Agda.TypeChecking.Reduce</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html"><span class="hs-identifier">Agda.TypeChecking.Pretty</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.html"><span class="hs-identifier">Agda.TypeChecking.Substitute</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Telescope.html"><span class="hs-identifier">Agda.TypeChecking.Telescope</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Warnings.html"><span class="hs-identifier">Agda.TypeChecking.Warnings</span></a></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.FileName.html"><span class="hs-identifier">Agda.Utils.FileName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.FileName.html#isNewerThan"><span class="hs-identifier">isNewerThan</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Function.html"><span class="hs-identifier">Agda.Utils.Function</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Functor.html"><span class="hs-identifier">Agda.Utils.Functor</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Float.html"><span class="hs-identifier">Agda.Utils.Float</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.IO.Directory.html"><span class="hs-identifier">Agda.Utils.IO.Directory</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html"><span class="hs-identifier">Agda.Utils.Lens</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.List.html"><span class="hs-identifier">Agda.Utils.List</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Maybe.html"><span class="hs-identifier">Agda.Utils.Maybe</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html"><span class="hs-identifier">Agda.Utils.Monad</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Pretty.html"><span class="hs-identifier">Agda.Utils.Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Pretty.html#prettyShow"><span class="hs-identifier">prettyShow</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">render</span></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Singleton.html"><span class="hs-identifier">Agda.Utils.Singleton</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.IO.UTF8.html"><span class="hs-identifier">Agda.Utils.IO.UTF8</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UTF8</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.String.html"><span class="hs-identifier">Agda.Utils.String</span></a></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Paths_Agda.html"><span class="hs-identifier">Paths_Agda</span></a></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html"><span class="hs-identifier">Agda.Utils.Impossible</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">-- The backend callbacks --------------------------------------------------</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcBackend"><span class="hs-identifier hs-type">ghcBackend</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span>
</span><span id="line-87"></span><span id="ghcBackend"><span class="annot"><span class="annottext">ghcBackend :: Backend
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcBackend"><span class="hs-identifier hs-var hs-var">ghcBackend</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Backend' GHCFlags GHCEnv GHCModuleEnv GHCModule GHCDefinition
-&gt; Backend
forall opts env menv mod def.
NFData opts =&gt;
Backend' opts env menv mod def -&gt; Backend
</span><a href="Agda.Compiler.Backend.html#Backend"><span class="hs-identifier hs-var">Backend</span></a></span><span> </span><span class="annot"><span class="annottext">Backend' GHCFlags GHCEnv GHCModuleEnv GHCModule GHCDefinition
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcBackend%27"><span class="hs-identifier hs-var">ghcBackend'</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcBackend%27"><span class="hs-identifier hs-type">ghcBackend'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.Backend.html#Backend%27"><span class="hs-identifier hs-type">Backend'</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-type">GHCFlags</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCEnv"><span class="hs-identifier hs-type">GHCEnv</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-type">GHCModule</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCDefinition"><span class="hs-identifier hs-type">GHCDefinition</span></a></span><span>
</span><span id="line-90"></span><span id="ghcBackend%27"><span class="annot"><span class="annottext">ghcBackend' :: Backend' GHCFlags GHCEnv GHCModuleEnv GHCModule GHCDefinition
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcBackend%27"><span class="hs-identifier hs-var hs-var">ghcBackend'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Compiler.Backend.html#Backend%27"><span class="hs-identifier hs-type">Backend'</span></a></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">backendName :: FilePath
</span><a href="Agda.Compiler.Backend.html#backendName"><span class="hs-identifier hs-var">backendName</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GHC&quot;</span></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">backendVersion :: Maybe FilePath
</span><a href="Agda.Compiler.Backend.html#backendVersion"><span class="hs-identifier hs-var">backendVersion</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">options :: GHCFlags
</span><a href="Agda.Compiler.Backend.html#options"><span class="hs-identifier hs-var">options</span></a></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#defaultGHCFlags"><span class="hs-identifier hs-var">defaultGHCFlags</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">commandLineFlags :: [OptDescr (Flag GHCFlags)]
</span><a href="Agda.Compiler.Backend.html#commandLineFlags"><span class="hs-identifier hs-var">commandLineFlags</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[OptDescr (Flag GHCFlags)]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcCommandLineFlags"><span class="hs-identifier hs-var">ghcCommandLineFlags</span></a></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">isEnabled :: GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.Backend.html#isEnabled"><span class="hs-identifier hs-var">isEnabled</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCompile"><span class="hs-identifier hs-var">flagGhcCompile</span></a></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">preCompile :: GHCFlags -&gt; TCM GHCEnv
</span><a href="Agda.Compiler.Backend.html#preCompile"><span class="hs-identifier hs-var">preCompile</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; TCM GHCEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPreCompile"><span class="hs-identifier hs-var">ghcPreCompile</span></a></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">postCompile :: GHCEnv -&gt; IsMain -&gt; Map ModuleName GHCModule -&gt; TCM ()
</span><a href="Agda.Compiler.Backend.html#postCompile"><span class="hs-identifier hs-var">postCompile</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; IsMain -&gt; Map ModuleName GHCModule -&gt; TCM ()
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPostCompile"><span class="hs-identifier hs-var">ghcPostCompile</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">preModule :: GHCEnv
-&gt; IsMain
-&gt; ModuleName
-&gt; Maybe FilePath
-&gt; TCM (Recompile GHCModuleEnv GHCModule)
</span><a href="Agda.Compiler.Backend.html#preModule"><span class="hs-identifier hs-var">preModule</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCEnv
-&gt; IsMain
-&gt; ModuleName
-&gt; Maybe FilePath
-&gt; TCM (Recompile GHCModuleEnv GHCModule)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPreModule"><span class="hs-identifier hs-var">ghcPreModule</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">postModule :: GHCEnv
-&gt; GHCModuleEnv
-&gt; IsMain
-&gt; ModuleName
-&gt; [GHCDefinition]
-&gt; TCM GHCModule
</span><a href="Agda.Compiler.Backend.html#postModule"><span class="hs-identifier hs-var">postModule</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCEnv
-&gt; GHCModuleEnv
-&gt; IsMain
-&gt; ModuleName
-&gt; [GHCDefinition]
-&gt; TCM GHCModule
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPostModule"><span class="hs-identifier hs-var">ghcPostModule</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">compileDef :: GHCEnv -&gt; GHCModuleEnv -&gt; IsMain -&gt; Definition -&gt; TCM GHCDefinition
</span><a href="Agda.Compiler.Backend.html#compileDef"><span class="hs-identifier hs-var">compileDef</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; GHCModuleEnv -&gt; IsMain -&gt; Definition -&gt; TCM GHCDefinition
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcCompileDef"><span class="hs-identifier hs-var">ghcCompileDef</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">scopeCheckingSuffices :: Bool
</span><a href="Agda.Compiler.Backend.html#scopeCheckingSuffices"><span class="hs-identifier hs-var">scopeCheckingSuffices</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mayEraseType :: QName -&gt; TCM Bool
</span><a href="Agda.Compiler.Backend.html#mayEraseType"><span class="hs-identifier hs-var">mayEraseType</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcMayEraseType"><span class="hs-identifier hs-var">ghcMayEraseType</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">--- Command-line flags ---</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span id="local-6989586621681134480"><span id="local-6989586621681134481"></span></span><span class="hs-keyword">data</span><span> </span><span id="GHCFlags"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-var">GHCFlags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GHCFlags"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-var">GHCFlags</span></a></span></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="flagGhcCompile"><span class="annot"><span class="annottext">GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCompile"><span class="hs-identifier hs-var hs-var">flagGhcCompile</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="flagGhcCallGhc"><span class="annot"><span class="annottext">GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCallGhc"><span class="hs-identifier hs-var hs-var">flagGhcCallGhc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="flagGhcBin"><span class="annot"><span class="annottext">GHCFlags -&gt; Maybe FilePath
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcBin"><span class="hs-identifier hs-var hs-var">flagGhcBin</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-comment">-- ^ Use the compiler at PATH instead of &quot;ghc&quot;</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="flagGhcFlags"><span class="annot"><span class="annottext">GHCFlags -&gt; [FilePath]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcFlags"><span class="hs-identifier hs-var hs-var">flagGhcFlags</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="flagGhcStrictData"><span class="annot"><span class="annottext">GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcStrictData"><span class="hs-identifier hs-var hs-var">flagGhcStrictData</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-comment">-- ^ Make inductive constructors strict?</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="flagGhcStrict"><span class="annot"><span class="annottext">GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcStrict"><span class="hs-identifier hs-var hs-var">flagGhcStrict</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-comment">-- ^ Make functions strict?</span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="annottext">(forall x. GHCFlags -&gt; Rep GHCFlags x)
-&gt; (forall x. Rep GHCFlags x -&gt; GHCFlags) -&gt; Generic GHCFlags
forall x. Rep GHCFlags x -&gt; GHCFlags
forall x. GHCFlags -&gt; Rep GHCFlags x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep GHCFlags x -&gt; GHCFlags
$cfrom :: forall x. GHCFlags -&gt; Rep GHCFlags x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681134469"><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-type">GHCFlags</span></a></span></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#defaultGHCFlags"><span class="hs-identifier hs-type">defaultGHCFlags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-type">GHCFlags</span></a></span><span>
</span><span id="line-123"></span><span id="defaultGHCFlags"><span class="annot"><span class="annottext">defaultGHCFlags :: GHCFlags
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#defaultGHCFlags"><span class="hs-identifier hs-var hs-var">defaultGHCFlags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-type">GHCFlags</span></a></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">flagGhcCompile :: Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCompile"><span class="hs-identifier hs-var">flagGhcCompile</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">flagGhcCallGhc :: Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCallGhc"><span class="hs-identifier hs-var">flagGhcCallGhc</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">flagGhcBin :: Maybe FilePath
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcBin"><span class="hs-identifier hs-var">flagGhcBin</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">flagGhcFlags :: [FilePath]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcFlags"><span class="hs-identifier hs-var">flagGhcFlags</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">flagGhcStrictData :: Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcStrictData"><span class="hs-identifier hs-var">flagGhcStrictData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">flagGhcStrict :: Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcStrict"><span class="hs-identifier hs-var">flagGhcStrict</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcCommandLineFlags"><span class="hs-identifier hs-type">ghcCommandLineFlags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">OptDescr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.Options.Base.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-type">GHCFlags</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-133"></span><span id="ghcCommandLineFlags"><span class="annot"><span class="annottext">ghcCommandLineFlags :: [OptDescr (Flag GHCFlags)]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcCommandLineFlags"><span class="hs-identifier hs-var hs-var">ghcCommandLineFlags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; [FilePath]
-&gt; ArgDescr (Flag GHCFlags)
-&gt; FilePath
-&gt; OptDescr (Flag GHCFlags)
forall a.
FilePath -&gt; [FilePath] -&gt; ArgDescr a -&gt; FilePath -&gt; OptDescr a
</span><span class="hs-identifier hs-var">Option</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'c'</span></span><span class="hs-special">]</span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;compile&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;ghc&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Flag GHCFlags -&gt; ArgDescr (Flag GHCFlags)
forall a. a -&gt; ArgDescr a
</span><span class="hs-identifier hs-var">NoArg</span></span><span> </span><span class="annot"><span class="annottext">Flag GHCFlags
forall {f :: * -&gt; *}. Applicative f =&gt; GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621681134465"><span class="hs-identifier hs-var">enable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>                    </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;compile program using the GHC backend&quot;</span></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; [FilePath]
-&gt; ArgDescr (Flag GHCFlags)
-&gt; FilePath
-&gt; OptDescr (Flag GHCFlags)
forall a.
FilePath -&gt; [FilePath] -&gt; ArgDescr a -&gt; FilePath -&gt; OptDescr a
</span><span class="hs-identifier hs-var">Option</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;ghc-dont-call-ghc&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Flag GHCFlags -&gt; ArgDescr (Flag GHCFlags)
forall a. a -&gt; ArgDescr a
</span><span class="hs-identifier hs-var">NoArg</span></span><span> </span><span class="annot"><span class="annottext">Flag GHCFlags
forall {f :: * -&gt; *}. Applicative f =&gt; GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621681134464"><span class="hs-identifier hs-var">dontCallGHC</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>                    </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;don't call GHC, just write the GHC Haskell files.&quot;</span></span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; [FilePath]
-&gt; ArgDescr (Flag GHCFlags)
-&gt; FilePath
-&gt; OptDescr (Flag GHCFlags)
forall a.
FilePath -&gt; [FilePath] -&gt; ArgDescr a -&gt; FilePath -&gt; OptDescr a
</span><span class="hs-identifier hs-var">Option</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;ghc-flag&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FilePath -&gt; Flag GHCFlags) -&gt; FilePath -&gt; ArgDescr (Flag GHCFlags)
forall a. (FilePath -&gt; a) -&gt; FilePath -&gt; ArgDescr a
</span><span class="hs-identifier hs-var">ReqArg</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Flag GHCFlags
forall {f :: * -&gt; *}.
Applicative f =&gt;
FilePath -&gt; GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621681134462"><span class="hs-identifier hs-var">ghcFlag</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GHC-FLAG&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>                    </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;give the flag GHC-FLAG to GHC&quot;</span></span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; [FilePath]
-&gt; ArgDescr (Flag GHCFlags)
-&gt; FilePath
-&gt; OptDescr (Flag GHCFlags)
forall a.
FilePath -&gt; [FilePath] -&gt; ArgDescr a -&gt; FilePath -&gt; OptDescr a
</span><span class="hs-identifier hs-var">Option</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;with-compiler&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FilePath -&gt; Flag GHCFlags) -&gt; FilePath -&gt; ArgDescr (Flag GHCFlags)
forall a. (FilePath -&gt; a) -&gt; FilePath -&gt; ArgDescr a
</span><span class="hs-identifier hs-var">ReqArg</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Flag GHCFlags
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#withCompilerFlag"><span class="hs-identifier hs-var">withCompilerFlag</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;PATH&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>                    </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;use the compiler available at PATH&quot;</span></span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; [FilePath]
-&gt; ArgDescr (Flag GHCFlags)
-&gt; FilePath
-&gt; OptDescr (Flag GHCFlags)
forall a.
FilePath -&gt; [FilePath] -&gt; ArgDescr a -&gt; FilePath -&gt; OptDescr a
</span><span class="hs-identifier hs-var">Option</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;ghc-strict-data&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Flag GHCFlags -&gt; ArgDescr (Flag GHCFlags)
forall a. a -&gt; ArgDescr a
</span><span class="hs-identifier hs-var">NoArg</span></span><span> </span><span class="annot"><span class="annottext">Flag GHCFlags
forall {f :: * -&gt; *}. Applicative f =&gt; GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621681134460"><span class="hs-identifier hs-var">strictData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>                    </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;make inductive constructors strict&quot;</span></span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; [FilePath]
-&gt; ArgDescr (Flag GHCFlags)
-&gt; FilePath
-&gt; OptDescr (Flag GHCFlags)
forall a.
FilePath -&gt; [FilePath] -&gt; ArgDescr a -&gt; FilePath -&gt; OptDescr a
</span><span class="hs-identifier hs-var">Option</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;ghc-strict&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Flag GHCFlags -&gt; ArgDescr (Flag GHCFlags)
forall a. a -&gt; ArgDescr a
</span><span class="hs-identifier hs-var">NoArg</span></span><span> </span><span class="annot"><span class="annottext">Flag GHCFlags
forall {f :: * -&gt; *}. Applicative f =&gt; GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621681134459"><span class="hs-identifier hs-var">strict</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>                    </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;make functions strict&quot;</span></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-148"></span><span>    </span><span id="local-6989586621681134465"><span class="annot"><span class="annottext">enable :: GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621681134465"><span class="hs-identifier hs-var hs-var">enable</span></a></span></span><span>      </span><span id="local-6989586621681134456"><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621681134456"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; f GHCFlags
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621681134456"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">flagGhcCompile :: Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCompile"><span class="hs-identifier hs-var">flagGhcCompile</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-149"></span><span>    </span><span id="local-6989586621681134464"><span class="annot"><span class="annottext">dontCallGHC :: GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621681134464"><span class="hs-identifier hs-var hs-var">dontCallGHC</span></a></span></span><span> </span><span id="local-6989586621681134453"><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621681134453"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; f GHCFlags
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621681134453"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">flagGhcCallGhc :: Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCallGhc"><span class="hs-identifier hs-var">flagGhcCallGhc</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-150"></span><span>    </span><span id="local-6989586621681134462"><span class="annot"><span class="annottext">ghcFlag :: FilePath -&gt; GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621681134462"><span class="hs-identifier hs-var hs-var">ghcFlag</span></a></span></span><span> </span><span id="local-6989586621681134450"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681134450"><span class="hs-identifier hs-var">f</span></a></span></span><span>   </span><span id="local-6989586621681134449"><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621681134449"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; f GHCFlags
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621681134449"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">flagGhcFlags :: [FilePath]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcFlags"><span class="hs-identifier hs-var">flagGhcFlags</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; [FilePath]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcFlags"><span class="hs-identifier hs-var">flagGhcFlags</span></a></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621681134449"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681134450"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-151"></span><span>    </span><span id="local-6989586621681134460"><span class="annot"><span class="annottext">strictData :: GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621681134460"><span class="hs-identifier hs-var hs-var">strictData</span></a></span></span><span>  </span><span id="local-6989586621681134446"><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621681134446"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; f GHCFlags
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621681134446"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">flagGhcStrictData :: Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcStrictData"><span class="hs-identifier hs-var">flagGhcStrictData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-152"></span><span>    </span><span id="local-6989586621681134459"><span class="annot"><span class="annottext">strict :: GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621681134459"><span class="hs-identifier hs-var hs-var">strict</span></a></span></span><span>      </span><span id="local-6989586621681134443"><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621681134443"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; f GHCFlags
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621681134443"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">flagGhcStrictData :: Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcStrictData"><span class="hs-identifier hs-var">flagGhcStrictData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-153"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">flagGhcStrict :: Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcStrict"><span class="hs-identifier hs-var">flagGhcStrict</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-154"></span><span>                          </span><span class="hs-special">}</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#withCompilerFlag"><span class="hs-identifier hs-type">withCompilerFlag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Base.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-type">GHCFlags</span></a></span><span>
</span><span id="line-157"></span><span id="withCompilerFlag"><span class="annot"><span class="annottext">withCompilerFlag :: FilePath -&gt; Flag GHCFlags
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#withCompilerFlag"><span class="hs-identifier hs-var hs-var">withCompilerFlag</span></a></span></span><span> </span><span id="local-6989586621681134442"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681134442"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621681134441"><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621681134441"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; Maybe FilePath
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcBin"><span class="hs-identifier hs-var">flagGhcBin</span></a></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621681134441"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-158"></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Flag GHCFlags
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621681134441"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">flagGhcBin :: Maybe FilePath
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcBin"><span class="hs-identifier hs-var">flagGhcBin</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681134442"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-159"></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; OptM GHCFlags
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;only one compiler path allowed&quot;</span></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-comment">--- Context types ---</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">-- | Monads that can read @GHCOptions@</span><span>
</span><span id="line-164"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621681135857"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="ReadGHCOpts"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ReadGHCOpts"><span class="hs-identifier hs-var">ReadGHCOpts</span></a></span></span><span> </span><span id="local-6989586621681135857"><span class="annot"><a href="#local-6989586621681135857"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-165"></span><span>  </span><span id="askGhcOpts"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-type">askGhcOpts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681135857"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCOptions"><span class="hs-identifier hs-type">GHCOptions</span></a></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681135854"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621681135854"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ReadGHCOpts"><span class="hs-identifier hs-type">ReadGHCOpts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCOptions"><span class="hs-identifier hs-type">GHCOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681135854"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-168"></span><span>  </span><span id="local-6989586621681134431"><span class="annot"><span class="annottext">askGhcOpts :: ReaderT GHCOptions m GHCOptions
</span><a href="#local-6989586621681134431"><span class="hs-identifier hs-var hs-var hs-var hs-var">askGhcOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCOptions m GHCOptions
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681135850"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621681135850"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ReadGHCOpts"><span class="hs-identifier hs-type">ReadGHCOpts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCEnv"><span class="hs-identifier hs-type">GHCEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681135850"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-171"></span><span>  </span><span id="local-6989586621681134423"><span class="annot"><span class="annottext">askGhcOpts :: ReaderT GHCEnv m GHCOptions
</span><a href="#local-6989586621681134423"><span class="hs-identifier hs-var hs-var hs-var hs-var">askGhcOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; GHCOptions)
-&gt; ReaderT GHCOptions m GHCOptions -&gt; ReaderT GHCEnv m GHCOptions
forall r' r (m :: * -&gt; *) a.
(r' -&gt; r) -&gt; ReaderT r m a -&gt; ReaderT r' m a
</span><span class="hs-identifier hs-var">withReaderT</span></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvOpts"><span class="hs-identifier hs-var">ghcEnvOpts</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCOptions m GHCOptions
forall (m :: * -&gt; *). ReadGHCOpts m =&gt; m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var">askGhcOpts</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681135893"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621681135893"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ReadGHCOpts"><span class="hs-identifier hs-type">ReadGHCOpts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681135893"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-174"></span><span>  </span><span id="local-6989586621681134416"><span class="annot"><span class="annottext">askGhcOpts :: ReaderT GHCModuleEnv m GHCOptions
</span><a href="#local-6989586621681134416"><span class="hs-identifier hs-var hs-var hs-var hs-var">askGhcOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GHCModuleEnv -&gt; GHCEnv)
-&gt; ReaderT GHCEnv m GHCOptions -&gt; ReaderT GHCModuleEnv m GHCOptions
forall r' r (m :: * -&gt; *) a.
(r' -&gt; r) -&gt; ReaderT r m a -&gt; ReaderT r' m a
</span><span class="hs-identifier hs-var">withReaderT</span></span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv -&gt; GHCEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcModEnv"><span class="hs-identifier hs-var">ghcModEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCEnv m GHCOptions
forall (m :: * -&gt; *). ReadGHCOpts m =&gt; m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var">askGhcOpts</span></a></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-keyword">data</span><span> </span><span id="GHCModule"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-var">GHCModule</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GHCModule"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-var">GHCModule</span></a></span></span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="ghcModModuleEnv"><span class="annot"><span class="annottext">GHCModule -&gt; GHCModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcModModuleEnv"><span class="hs-identifier hs-var hs-var">ghcModModuleEnv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcModMainFuncs"><span class="annot"><span class="annottext">GHCModule -&gt; [MainFunctionDef]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcModMainFuncs"><span class="hs-identifier hs-var hs-var">ghcModMainFuncs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Primitives.html#MainFunctionDef"><span class="hs-identifier hs-type">MainFunctionDef</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-comment">-- ^ The `main` function definition(s), if both the module is</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-comment">--   the @IsMain@ module (root/focused) and a suitable `main`</span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-comment">--   function was defined.</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681135891"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621681135891"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ReadGHCOpts"><span class="hs-identifier hs-type">ReadGHCOpts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-type">GHCModule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681135891"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-185"></span><span>  </span><span id="local-6989586621681134406"><span class="annot"><span class="annottext">askGhcOpts :: ReaderT GHCModule m GHCOptions
</span><a href="#local-6989586621681134406"><span class="hs-identifier hs-var hs-var hs-var hs-var">askGhcOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GHCModule -&gt; GHCModuleEnv)
-&gt; ReaderT GHCModuleEnv m GHCOptions
-&gt; ReaderT GHCModule m GHCOptions
forall r' r (m :: * -&gt; *) a.
(r' -&gt; r) -&gt; ReaderT r m a -&gt; ReaderT r' m a
</span><span class="hs-identifier hs-var">withReaderT</span></span><span> </span><span class="annot"><span class="annottext">GHCModule -&gt; GHCModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcModModuleEnv"><span class="hs-identifier hs-var">ghcModModuleEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv m GHCOptions
forall (m :: * -&gt; *). ReadGHCOpts m =&gt; m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var">askGhcOpts</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681134399"><span id="local-6989586621681134401"><span id="local-6989586621681135892"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621681135892"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadGHCModuleEnv"><span class="hs-identifier hs-type">ReadGHCModuleEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-type">GHCModule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681135892"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-188"></span><span>  </span><span id="local-6989586621681134396"><span class="annot"><span class="annottext">askGHCModuleEnv :: ReaderT GHCModule m GHCModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#askGHCModuleEnv"><span class="hs-identifier hs-var hs-var hs-var hs-var">askGHCModuleEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GHCModule -&gt; GHCModuleEnv)
-&gt; ReaderT GHCModuleEnv m GHCModuleEnv
-&gt; ReaderT GHCModule m GHCModuleEnv
forall r' r (m :: * -&gt; *) a.
(r' -&gt; r) -&gt; ReaderT r m a -&gt; ReaderT r' m a
</span><span class="hs-identifier hs-var">withReaderT</span></span><span> </span><span class="annot"><span class="annottext">GHCModule -&gt; GHCModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcModModuleEnv"><span class="hs-identifier hs-var">ghcModModuleEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv m GHCModuleEnv
forall (m :: * -&gt; *). ReadGHCModuleEnv m =&gt; m GHCModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#askGHCModuleEnv"><span class="hs-identifier hs-var">askGHCModuleEnv</span></a></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-keyword">data</span><span> </span><span id="GHCDefinition"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCDefinition"><span class="hs-identifier hs-var">GHCDefinition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GHCDefinition"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCDefinition"><span class="hs-identifier hs-var">GHCDefinition</span></a></span></span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="ghcDefUsesFloat"><span class="annot"><span class="annottext">GHCDefinition -&gt; UsesFloat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcDefUsesFloat"><span class="hs-identifier hs-var hs-var">ghcDefUsesFloat</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcDefDecls"><span class="annot"><span class="annottext">GHCDefinition -&gt; [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcDefDecls"><span class="hs-identifier hs-var hs-var">ghcDefDecls</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcDefDefinition"><span class="annot"><span class="annottext">GHCDefinition -&gt; Definition
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcDefDefinition"><span class="hs-identifier hs-var hs-var">ghcDefDefinition</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcDefMainDef"><span class="annot"><span class="annottext">GHCDefinition -&gt; Maybe MainFunctionDef
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcDefMainDef"><span class="hs-identifier hs-var hs-var">ghcDefMainDef</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Primitives.html#MainFunctionDef"><span class="hs-identifier hs-type">MainFunctionDef</span></a></span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcDefImports"><span class="annot"><span class="annottext">GHCDefinition -&gt; Set ModuleName
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcDefImports"><span class="hs-identifier hs-var hs-var">ghcDefImports</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-comment">--- Top-level compilation ---</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPreCompile"><span class="hs-identifier hs-type">ghcPreCompile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-type">GHCFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCEnv"><span class="hs-identifier hs-type">GHCEnv</span></a></span><span>
</span><span id="line-201"></span><span id="ghcPreCompile"><span class="annot"><span class="annottext">ghcPreCompile :: GHCFlags -&gt; TCM GHCEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPreCompile"><span class="hs-identifier hs-var hs-var">ghcPreCompile</span></a></span></span><span> </span><span id="local-6989586621681134388"><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621681134388"><span class="hs-identifier hs-var">flags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-202"></span><span>  </span><span id="local-6989586621681134387"><span class="annot"><span class="annottext">Maybe Cubical
</span><a href="#local-6989586621681134387"><span class="hs-identifier hs-var">cubical</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PragmaOptions -&gt; Maybe Cubical
</span><a href="Agda.Interaction.Options.Base.html#optCubical"><span class="hs-identifier hs-var">optCubical</span></a></span><span> </span><span class="annot"><span class="annottext">(PragmaOptions -&gt; Maybe Cubical)
-&gt; TCMT IO PragmaOptions -&gt; TCMT IO (Maybe Cubical)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO PragmaOptions
forall (m :: * -&gt; *). HasOptions m =&gt; m PragmaOptions
</span><a href="Agda.Interaction.Options.HasOptions.html#pragmaOptions"><span class="hs-identifier hs-var">pragmaOptions</span></a></span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681134371"><span class="annot"><span class="annottext">notSupported :: FilePath -&gt; m a
</span><a href="#local-6989586621681134371"><span class="hs-identifier hs-var hs-var">notSupported</span></a></span></span><span> </span><span id="local-6989586621681134370"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681134370"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-204"></span><span>        </span><span class="annot"><span class="annottext">TypeError -&gt; m a
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
TypeError -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-var">typeError</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeError -&gt; m a) -&gt; TypeError -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#GenericError"><span class="hs-identifier hs-var">GenericError</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; TypeError) -&gt; FilePath -&gt; TypeError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-205"></span><span>          </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Compilation of code that uses &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681134370"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot; is not supported.&quot;</span></span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Cubical
</span><a href="#local-6989586621681134387"><span class="hs-identifier hs-var">cubical</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><span class="annottext">Maybe Cubical
</span><span class="hs-identifier hs-var">Nothing</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; TCM ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Cubical
</span><a href="Agda.Syntax.Common.html#CErased"><span class="hs-identifier hs-var">CErased</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; TCM ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Cubical
</span><a href="Agda.Syntax.Common.html#CFull"><span class="hs-identifier hs-var">CFull</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCM ()
forall {m :: * -&gt; *} {a}.
(MonadTCEnv m, ReadTCState m, MonadError TCErr m) =&gt;
FilePath -&gt; m a
</span><a href="#local-6989586621681134371"><span class="hs-identifier hs-var">notSupported</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;--cubical&quot;</span></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span>  </span><span id="local-6989586621681134365"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681134365"><span class="hs-identifier hs-var">outDir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO FilePath
forall (m :: * -&gt; *). HasOptions m =&gt; m FilePath
</span><a href="Agda.Compiler.Common.html#compileDir"><span class="hs-identifier hs-var">compileDir</span></a></span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681134363"><span class="annot"><span class="annottext">ghcOpts :: GHCOptions
</span><a href="#local-6989586621681134363"><span class="hs-identifier hs-var hs-var">ghcOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCOptions"><span class="hs-identifier hs-type">GHCOptions</span></a></span><span>
</span><span id="line-213"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">optGhcCallGhc :: Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcCallGhc"><span class="hs-identifier hs-var">optGhcCallGhc</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCallGhc"><span class="hs-identifier hs-var">flagGhcCallGhc</span></a></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621681134388"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-214"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">optGhcBin :: FilePath
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcBin"><span class="hs-identifier hs-var">optGhcBin</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath -&gt; FilePath
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;ghc&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GHCFlags -&gt; Maybe FilePath
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcBin"><span class="hs-identifier hs-var">flagGhcBin</span></a></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621681134388"><span class="hs-identifier hs-var">flags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">optGhcFlags :: [FilePath]
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcFlags"><span class="hs-identifier hs-var">optGhcFlags</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; [FilePath]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcFlags"><span class="hs-identifier hs-var">flagGhcFlags</span></a></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621681134388"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-216"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">optGhcCompileDir :: FilePath
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcCompileDir"><span class="hs-identifier hs-var">optGhcCompileDir</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681134365"><span class="hs-identifier hs-var">outDir</span></a></span><span>
</span><span id="line-217"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">optGhcStrictData :: Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcStrictData"><span class="hs-identifier hs-var">optGhcStrictData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcStrictData"><span class="hs-identifier hs-var">flagGhcStrictData</span></a></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621681134388"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-218"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">optGhcStrict :: Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcStrict"><span class="hs-identifier hs-var">optGhcStrict</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcStrict"><span class="hs-identifier hs-var">flagGhcStrict</span></a></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621681134388"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-219"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span>  </span><span id="local-6989586621681134354"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134354"><span class="hs-identifier hs-var">mbool</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinBool"><span class="hs-identifier hs-var">builtinBool</span></a></span><span>
</span><span id="line-222"></span><span>  </span><span id="local-6989586621681134352"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134352"><span class="hs-identifier hs-var">mtrue</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinTrue"><span class="hs-identifier hs-var">builtinTrue</span></a></span><span>
</span><span id="line-223"></span><span>  </span><span id="local-6989586621681134350"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134350"><span class="hs-identifier hs-var">mfalse</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinFalse"><span class="hs-identifier hs-var">builtinFalse</span></a></span><span>
</span><span id="line-224"></span><span>  </span><span id="local-6989586621681134348"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134348"><span class="hs-identifier hs-var">mlist</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinList"><span class="hs-identifier hs-var">builtinList</span></a></span><span>
</span><span id="line-225"></span><span>  </span><span id="local-6989586621681134346"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134346"><span class="hs-identifier hs-var">mnil</span></a></span></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinNil"><span class="hs-identifier hs-var">builtinNil</span></a></span><span>
</span><span id="line-226"></span><span>  </span><span id="local-6989586621681134344"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134344"><span class="hs-identifier hs-var">mcons</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinCons"><span class="hs-identifier hs-var">builtinCons</span></a></span><span>
</span><span id="line-227"></span><span>  </span><span id="local-6989586621681134342"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134342"><span class="hs-identifier hs-var">mmaybe</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinMaybe"><span class="hs-identifier hs-var">builtinMaybe</span></a></span><span>
</span><span id="line-228"></span><span>  </span><span id="local-6989586621681134340"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134340"><span class="hs-identifier hs-var">mnothing</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinNothing"><span class="hs-identifier hs-var">builtinNothing</span></a></span><span>
</span><span id="line-229"></span><span>  </span><span id="local-6989586621681134338"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134338"><span class="hs-identifier hs-var">mjust</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinJust"><span class="hs-identifier hs-var">builtinJust</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span id="local-6989586621681134336"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134336"><span class="hs-identifier hs-var">mnat</span></a></span></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinNat"><span class="hs-identifier hs-var">builtinNat</span></a></span><span>
</span><span id="line-231"></span><span>  </span><span id="local-6989586621681134334"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134334"><span class="hs-identifier hs-var">minteger</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinInteger"><span class="hs-identifier hs-var">builtinInteger</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span id="local-6989586621681134332"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134332"><span class="hs-identifier hs-var">mword64</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinWord64"><span class="hs-identifier hs-var">builtinWord64</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span id="local-6989586621681134330"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134330"><span class="hs-identifier hs-var">minf</span></a></span></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinInf"><span class="hs-identifier hs-var">builtinInf</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span id="local-6989586621681134328"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134328"><span class="hs-identifier hs-var">msharp</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinSharp"><span class="hs-identifier hs-var">builtinSharp</span></a></span><span>
</span><span id="line-235"></span><span>  </span><span id="local-6989586621681134326"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134326"><span class="hs-identifier hs-var">mflat</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinFlat"><span class="hs-identifier hs-var">builtinFlat</span></a></span><span>
</span><span id="line-236"></span><span>  </span><span id="local-6989586621681134324"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134324"><span class="hs-identifier hs-var">minterval</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinInterval"><span class="hs-identifier hs-var">builtinInterval</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span id="local-6989586621681134322"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134322"><span class="hs-identifier hs-var">mizero</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinIZero"><span class="hs-identifier hs-var">builtinIZero</span></a></span><span>
</span><span id="line-238"></span><span>  </span><span id="local-6989586621681134320"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134320"><span class="hs-identifier hs-var">mione</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinIOne"><span class="hs-identifier hs-var">builtinIOne</span></a></span><span>
</span><span id="line-239"></span><span>  </span><span id="local-6989586621681134318"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134318"><span class="hs-identifier hs-var">misone</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinIsOne"><span class="hs-identifier hs-var">builtinIsOne</span></a></span><span>
</span><span id="line-240"></span><span>  </span><span id="local-6989586621681134316"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134316"><span class="hs-identifier hs-var">mitisone</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinItIsOne"><span class="hs-identifier hs-var">builtinItIsOne</span></a></span><span>
</span><span id="line-241"></span><span>  </span><span id="local-6989586621681134314"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134314"><span class="hs-identifier hs-var">misone1</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinIsOne1"><span class="hs-identifier hs-var">builtinIsOne1</span></a></span><span>
</span><span id="line-242"></span><span>  </span><span id="local-6989586621681134312"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134312"><span class="hs-identifier hs-var">misone2</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinIsOne2"><span class="hs-identifier hs-var">builtinIsOne2</span></a></span><span>
</span><span id="line-243"></span><span>  </span><span id="local-6989586621681134310"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134310"><span class="hs-identifier hs-var">misoneempty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinIsOneEmpty"><span class="hs-identifier hs-var">builtinIsOneEmpty</span></a></span><span>
</span><span id="line-244"></span><span>  </span><span id="local-6989586621681134308"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134308"><span class="hs-identifier hs-var">mpathp</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinPathP"><span class="hs-identifier hs-var">builtinPathP</span></a></span><span>
</span><span id="line-245"></span><span>  </span><span id="local-6989586621681134306"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134306"><span class="hs-identifier hs-var">msub</span></a></span></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinSub"><span class="hs-identifier hs-var">builtinSub</span></a></span><span>
</span><span id="line-246"></span><span>  </span><span id="local-6989586621681134304"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134304"><span class="hs-identifier hs-var">msubin</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinSubIn"><span class="hs-identifier hs-var">builtinSubIn</span></a></span><span>
</span><span id="line-247"></span><span>  </span><span id="local-6989586621681134302"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134302"><span class="hs-identifier hs-var">mid</span></a></span></span><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinId"><span class="hs-identifier hs-var">builtinId</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span id="local-6989586621681134300"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134300"><span class="hs-identifier hs-var">mconid</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *). HasBuiltins m =&gt; FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Monad.Builtin.html#getPrimitiveName%27"><span class="hs-identifier hs-var">getPrimitiveName'</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinConId"><span class="hs-identifier hs-var">builtinConId</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span>  </span><span id="local-6989586621681134297"><span class="annot"><span class="annottext">QName -&gt; Bool
</span><a href="#local-6989586621681134297"><span class="hs-identifier hs-var">istcbuiltin</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-251"></span><span>    </span><span id="local-6989586621681134296"><span class="annot"><span class="annottext">[Maybe QName]
</span><a href="#local-6989586621681134296"><span class="hs-identifier hs-var">builtins</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; TCMT IO (Maybe QName))
-&gt; [FilePath] -&gt; TCMT IO [Maybe QName]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span>
</span><span id="line-252"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMReturn"><span class="hs-identifier hs-var">builtinAgdaTCMReturn</span></a></span><span>
</span><span id="line-253"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMBind"><span class="hs-identifier hs-var">builtinAgdaTCMBind</span></a></span><span>
</span><span id="line-254"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMUnify"><span class="hs-identifier hs-var">builtinAgdaTCMUnify</span></a></span><span>
</span><span id="line-255"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMTypeError"><span class="hs-identifier hs-var">builtinAgdaTCMTypeError</span></a></span><span>
</span><span id="line-256"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMInferType"><span class="hs-identifier hs-var">builtinAgdaTCMInferType</span></a></span><span>
</span><span id="line-257"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMCheckType"><span class="hs-identifier hs-var">builtinAgdaTCMCheckType</span></a></span><span>
</span><span id="line-258"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMNormalise"><span class="hs-identifier hs-var">builtinAgdaTCMNormalise</span></a></span><span>
</span><span id="line-259"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMReduce"><span class="hs-identifier hs-var">builtinAgdaTCMReduce</span></a></span><span>
</span><span id="line-260"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMCatchError"><span class="hs-identifier hs-var">builtinAgdaTCMCatchError</span></a></span><span>
</span><span id="line-261"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMQuoteTerm"><span class="hs-identifier hs-var">builtinAgdaTCMQuoteTerm</span></a></span><span>
</span><span id="line-262"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMUnquoteTerm"><span class="hs-identifier hs-var">builtinAgdaTCMUnquoteTerm</span></a></span><span>
</span><span id="line-263"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMQuoteOmegaTerm"><span class="hs-identifier hs-var">builtinAgdaTCMQuoteOmegaTerm</span></a></span><span>
</span><span id="line-264"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMGetContext"><span class="hs-identifier hs-var">builtinAgdaTCMGetContext</span></a></span><span>
</span><span id="line-265"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMExtendContext"><span class="hs-identifier hs-var">builtinAgdaTCMExtendContext</span></a></span><span>
</span><span id="line-266"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMInContext"><span class="hs-identifier hs-var">builtinAgdaTCMInContext</span></a></span><span>
</span><span id="line-267"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMFreshName"><span class="hs-identifier hs-var">builtinAgdaTCMFreshName</span></a></span><span>
</span><span id="line-268"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMDeclareDef"><span class="hs-identifier hs-var">builtinAgdaTCMDeclareDef</span></a></span><span>
</span><span id="line-269"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMDeclarePostulate"><span class="hs-identifier hs-var">builtinAgdaTCMDeclarePostulate</span></a></span><span>
</span><span id="line-270"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMDefineFun"><span class="hs-identifier hs-var">builtinAgdaTCMDefineFun</span></a></span><span>
</span><span id="line-271"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMGetType"><span class="hs-identifier hs-var">builtinAgdaTCMGetType</span></a></span><span>
</span><span id="line-272"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMGetDefinition"><span class="hs-identifier hs-var">builtinAgdaTCMGetDefinition</span></a></span><span>
</span><span id="line-273"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMBlockOnMeta"><span class="hs-identifier hs-var">builtinAgdaTCMBlockOnMeta</span></a></span><span>
</span><span id="line-274"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMCommit"><span class="hs-identifier hs-var">builtinAgdaTCMCommit</span></a></span><span>
</span><span id="line-275"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMIsMacro"><span class="hs-identifier hs-var">builtinAgdaTCMIsMacro</span></a></span><span>
</span><span id="line-276"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMWithNormalisation"><span class="hs-identifier hs-var">builtinAgdaTCMWithNormalisation</span></a></span><span>
</span><span id="line-277"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMWithReconsParams"><span class="hs-identifier hs-var">builtinAgdaTCMWithReconsParams</span></a></span><span>
</span><span id="line-278"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMFormatErrorParts"><span class="hs-identifier hs-var">builtinAgdaTCMFormatErrorParts</span></a></span><span>
</span><span id="line-279"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMDebugPrint"><span class="hs-identifier hs-var">builtinAgdaTCMDebugPrint</span></a></span><span>
</span><span id="line-280"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMOnlyReduceDefs"><span class="hs-identifier hs-var">builtinAgdaTCMOnlyReduceDefs</span></a></span><span>
</span><span id="line-281"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMDontReduceDefs"><span class="hs-identifier hs-var">builtinAgdaTCMDontReduceDefs</span></a></span><span>
</span><span id="line-282"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMNoConstraints"><span class="hs-identifier hs-var">builtinAgdaTCMNoConstraints</span></a></span><span>
</span><span id="line-283"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMRunSpeculative"><span class="hs-identifier hs-var">builtinAgdaTCMRunSpeculative</span></a></span><span>
</span><span id="line-284"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMExec"><span class="hs-identifier hs-var">builtinAgdaTCMExec</span></a></span><span>
</span><span id="line-285"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinAgdaTCMGetInstances"><span class="hs-identifier hs-var">builtinAgdaTCMGetInstances</span></a></span><span>
</span><span id="line-286"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-287"></span><span>    </span><span class="annot"><span class="annottext">(QName -&gt; Bool) -&gt; TCMT IO (QName -&gt; Bool)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((QName -&gt; Bool) -&gt; TCMT IO (QName -&gt; Bool))
-&gt; (QName -&gt; Bool) -&gt; TCMT IO (QName -&gt; Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-288"></span><span>      </span><span class="annot"><span class="annottext">(QName -&gt; HashSet QName -&gt; Bool) -&gt; HashSet QName -&gt; QName -&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; HashSet QName -&gt; Bool
forall a. (Eq a, Hashable a) =&gt; a -&gt; HashSet a -&gt; Bool
</span><span class="hs-identifier hs-var">HashSet.member</span></span><span> </span><span class="annot"><span class="annottext">(HashSet QName -&gt; QName -&gt; Bool) -&gt; HashSet QName -&gt; QName -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-289"></span><span>      </span><span class="annot"><span class="annottext">[QName] -&gt; HashSet QName
forall a. (Eq a, Hashable a) =&gt; [a] -&gt; HashSet a
</span><span class="hs-identifier hs-var">HashSet.fromList</span></span><span> </span><span class="annot"><span class="annottext">([QName] -&gt; HashSet QName) -&gt; [QName] -&gt; HashSet QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-290"></span><span>      </span><span class="annot"><span class="annottext">[Maybe QName] -&gt; [QName]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">[Maybe QName]
</span><a href="#local-6989586621681134296"><span class="hs-identifier hs-var">builtins</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span>  </span><span class="annot"><span class="annottext">GHCEnv -&gt; TCM GHCEnv
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; TCM GHCEnv) -&gt; GHCEnv -&gt; TCM GHCEnv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCEnv"><span class="hs-identifier hs-type">GHCEnv</span></a></span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ghcEnvOpts :: GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvOpts"><span class="hs-identifier hs-var">ghcEnvOpts</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCOptions
</span><a href="#local-6989586621681134363"><span class="hs-identifier hs-var">ghcOpts</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvBool :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvBool"><span class="hs-identifier hs-var">ghcEnvBool</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134354"><span class="hs-identifier hs-var">mbool</span></a></span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvTrue :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvTrue"><span class="hs-identifier hs-var">ghcEnvTrue</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134352"><span class="hs-identifier hs-var">mtrue</span></a></span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvFalse :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvFalse"><span class="hs-identifier hs-var">ghcEnvFalse</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134350"><span class="hs-identifier hs-var">mfalse</span></a></span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvMaybe :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvMaybe"><span class="hs-identifier hs-var">ghcEnvMaybe</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134342"><span class="hs-identifier hs-var">mmaybe</span></a></span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvNothing :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvNothing"><span class="hs-identifier hs-var">ghcEnvNothing</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134340"><span class="hs-identifier hs-var">mnothing</span></a></span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvJust :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvJust"><span class="hs-identifier hs-var">ghcEnvJust</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134338"><span class="hs-identifier hs-var">mjust</span></a></span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvList :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvList"><span class="hs-identifier hs-var">ghcEnvList</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134348"><span class="hs-identifier hs-var">mlist</span></a></span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvNil :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvNil"><span class="hs-identifier hs-var">ghcEnvNil</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134346"><span class="hs-identifier hs-var">mnil</span></a></span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvCons :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvCons"><span class="hs-identifier hs-var">ghcEnvCons</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134344"><span class="hs-identifier hs-var">mcons</span></a></span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvNat :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvNat"><span class="hs-identifier hs-var">ghcEnvNat</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134336"><span class="hs-identifier hs-var">mnat</span></a></span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvInteger :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvInteger"><span class="hs-identifier hs-var">ghcEnvInteger</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134334"><span class="hs-identifier hs-var">minteger</span></a></span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvWord64 :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvWord64"><span class="hs-identifier hs-var">ghcEnvWord64</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134332"><span class="hs-identifier hs-var">mword64</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvInf :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvInf"><span class="hs-identifier hs-var">ghcEnvInf</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134330"><span class="hs-identifier hs-var">minf</span></a></span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvSharp :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvSharp"><span class="hs-identifier hs-var">ghcEnvSharp</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134328"><span class="hs-identifier hs-var">msharp</span></a></span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvFlat :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvFlat"><span class="hs-identifier hs-var">ghcEnvFlat</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134326"><span class="hs-identifier hs-var">mflat</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvInterval :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvInterval"><span class="hs-identifier hs-var">ghcEnvInterval</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134324"><span class="hs-identifier hs-var">minterval</span></a></span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvIZero :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIZero"><span class="hs-identifier hs-var">ghcEnvIZero</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134322"><span class="hs-identifier hs-var">mizero</span></a></span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvIOne :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIOne"><span class="hs-identifier hs-var">ghcEnvIOne</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134320"><span class="hs-identifier hs-var">mione</span></a></span><span>
</span><span id="line-312"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvIsOne :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsOne"><span class="hs-identifier hs-var">ghcEnvIsOne</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134318"><span class="hs-identifier hs-var">misone</span></a></span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvItIsOne :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvItIsOne"><span class="hs-identifier hs-var">ghcEnvItIsOne</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134316"><span class="hs-identifier hs-var">mitisone</span></a></span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvIsOne1 :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsOne1"><span class="hs-identifier hs-var">ghcEnvIsOne1</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134314"><span class="hs-identifier hs-var">misone1</span></a></span><span>
</span><span id="line-315"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvIsOne2 :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsOne2"><span class="hs-identifier hs-var">ghcEnvIsOne2</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134312"><span class="hs-identifier hs-var">misone2</span></a></span><span>
</span><span id="line-316"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvIsOneEmpty :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsOneEmpty"><span class="hs-identifier hs-var">ghcEnvIsOneEmpty</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134310"><span class="hs-identifier hs-var">misoneempty</span></a></span><span>
</span><span id="line-317"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvPathP :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvPathP"><span class="hs-identifier hs-var">ghcEnvPathP</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134308"><span class="hs-identifier hs-var">mpathp</span></a></span><span>
</span><span id="line-318"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvSub :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvSub"><span class="hs-identifier hs-var">ghcEnvSub</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134306"><span class="hs-identifier hs-var">msub</span></a></span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvSubIn :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvSubIn"><span class="hs-identifier hs-var">ghcEnvSubIn</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134304"><span class="hs-identifier hs-var">msubin</span></a></span><span>
</span><span id="line-320"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvId :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvId"><span class="hs-identifier hs-var">ghcEnvId</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134302"><span class="hs-identifier hs-var">mid</span></a></span><span>
</span><span id="line-321"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvConId :: Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvConId"><span class="hs-identifier hs-var">ghcEnvConId</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681134300"><span class="hs-identifier hs-var">mconid</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ghcEnvIsTCBuiltin :: QName -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsTCBuiltin"><span class="hs-identifier hs-var">ghcEnvIsTCBuiltin</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Bool
</span><a href="#local-6989586621681134297"><span class="hs-identifier hs-var">istcbuiltin</span></a></span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPostCompile"><span class="hs-identifier hs-type">ghcPostCompile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCEnv"><span class="hs-identifier hs-type">GHCEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.Common.html#IsMain"><span class="hs-identifier hs-type">IsMain</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-type">GHCModule</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span id="ghcPostCompile"><span class="annot"><span class="annottext">ghcPostCompile :: GHCEnv -&gt; IsMain -&gt; Map ModuleName GHCModule -&gt; TCM ()
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPostCompile"><span class="hs-identifier hs-var hs-var">ghcPostCompile</span></a></span></span><span> </span><span id="local-6989586621681134226"><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621681134226"><span class="hs-identifier hs-var">_cenv</span></a></span></span><span> </span><span id="local-6989586621681134225"><span class="annot"><span class="annottext">IsMain
</span><a href="#local-6989586621681134225"><span class="hs-identifier hs-var">_isMain</span></a></span></span><span> </span><span id="local-6989586621681134224"><span class="annot"><span class="annottext">Map ModuleName GHCModule
</span><a href="#local-6989586621681134224"><span class="hs-identifier hs-var">mods</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-327"></span><span>  </span><span class="hs-comment">-- FIXME: @curMName@ and @curIF@ are evil TCM state, but there does not appear to be</span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-comment">--------- another way to retrieve the compilation root (&quot;main&quot; module or interaction focused).</span><span>
</span><span id="line-329"></span><span>  </span><span id="local-6989586621681134223"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681134223"><span class="hs-identifier hs-var">rootModuleName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO ModuleName
forall (m :: * -&gt; *). ReadTCState m =&gt; m ModuleName
</span><a href="Agda.Compiler.Common.html#curMName"><span class="hs-identifier hs-var">curMName</span></a></span><span>
</span><span id="line-330"></span><span>  </span><span id="local-6989586621681134221"><span class="annot"><span class="annottext">GHCModule
</span><a href="#local-6989586621681134221"><span class="hs-identifier hs-var">rootModule</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe GHCModule
-&gt; (GHCModule -&gt; TCM GHCModule) -&gt; TCM GHCModule -&gt; TCM GHCModule
forall a b. Maybe a -&gt; (a -&gt; b) -&gt; b -&gt; b
</span><a href="Agda.Utils.Maybe.html#ifJust"><span class="hs-identifier hs-var">ifJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; Map ModuleName GHCModule -&gt; Maybe GHCModule
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681134223"><span class="hs-identifier hs-var">rootModuleName</span></a></span><span> </span><span class="annot"><span class="annottext">Map ModuleName GHCModule
</span><a href="#local-6989586621681134224"><span class="hs-identifier hs-var">mods</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GHCModule -&gt; TCM GHCModule
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-331"></span><span>                </span><span class="annot"><span class="annottext">(TCM GHCModule -&gt; TCM GHCModule) -&gt; TCM GHCModule -&gt; TCM GHCModule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCM GHCModule
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
FilePath -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#genericError"><span class="hs-identifier hs-var">genericError</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; TCM GHCModule) -&gt; FilePath -&gt; TCM GHCModule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Module &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; FilePath
forall a. Pretty a =&gt; a -&gt; FilePath
</span><a href="Agda.Utils.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681134223"><span class="hs-identifier hs-var">rootModuleName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot; was not compiled!&quot;</span></span><span>
</span><span id="line-332"></span><span>  </span><span class="annot"><span class="annottext">(ReaderT GHCModule TCM () -&gt; GHCModule -&gt; TCM ())
-&gt; GHCModule -&gt; ReaderT GHCModule TCM () -&gt; TCM ()
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModule TCM () -&gt; GHCModule -&gt; TCM ()
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">GHCModule
</span><a href="#local-6989586621681134221"><span class="hs-identifier hs-var">rootModule</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT GHCModule TCM () -&gt; TCM ())
-&gt; ReaderT GHCModule TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-333"></span><span>    </span><span class="annot"><span class="annottext">ReaderT GHCModule TCM ()
forall (m :: * -&gt; *). MonadGHCIO m =&gt; m ()
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#copyRTEModules"><span class="hs-identifier hs-var">copyRTEModules</span></a></span><span>
</span><span id="line-334"></span><span>    </span><span class="annot"><span class="annottext">ReaderT GHCModule TCM ()
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#callGHC"><span class="hs-identifier hs-var">callGHC</span></a></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="hs-comment">--- Module compilation ---</span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPreModule"><span class="hs-identifier hs-type">ghcPreModule</span></a></span><span>
</span><span id="line-339"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCEnv"><span class="hs-identifier hs-type">GHCEnv</span></a></span><span>
</span><span id="line-340"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.Common.html#IsMain"><span class="hs-identifier hs-type">IsMain</span></a></span><span>      </span><span class="hs-comment">-- ^ Are we looking at the main module?</span><span>
</span><span id="line-341"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span>
</span><span id="line-342"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>    </span><span class="hs-comment">-- ^ Path to the @.agdai@ file.</span><span>
</span><span id="line-343"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.Backend.html#Recompile"><span class="hs-identifier hs-type">Recompile</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-type">GHCModule</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>                 </span><span class="hs-comment">-- ^ Could we confirm the existence of a main function?</span><span>
</span><span id="line-345"></span><span id="ghcPreModule"><span class="annot"><span class="annottext">ghcPreModule :: GHCEnv
-&gt; IsMain
-&gt; ModuleName
-&gt; Maybe FilePath
-&gt; TCM (Recompile GHCModuleEnv GHCModule)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPreModule"><span class="hs-identifier hs-var hs-var">ghcPreModule</span></a></span></span><span> </span><span id="local-6989586621681134215"><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621681134215"><span class="hs-identifier hs-var">cenv</span></a></span></span><span> </span><span id="local-6989586621681134214"><span class="annot"><span class="annottext">IsMain
</span><a href="#local-6989586621681134214"><span class="hs-identifier hs-var">isMain</span></a></span></span><span> </span><span id="local-6989586621681134213"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681134213"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681134212"><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621681134212"><span class="hs-identifier hs-var">mifile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-346"></span><span>  </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681134211"><span class="annot"><span class="annottext">check :: ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
</span><a href="#local-6989586621681134211"><span class="hs-identifier hs-var hs-var">check</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM Bool
-&gt; ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
-&gt; ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
-&gt; ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
forall (m :: * -&gt; *) a. Monad m =&gt; m Bool -&gt; m a -&gt; m a -&gt; m a
</span><a href="Agda.Utils.Monad.html#ifM"><span class="hs-identifier hs-var">ifM</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM Bool
</span><a href="#local-6989586621681134209"><span class="hs-identifier hs-var">uptodate</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
forall {menv}. ReaderT GHCModuleEnv TCM (Recompile menv GHCModule)
</span><a href="#local-6989586621681134208"><span class="hs-identifier hs-var">noComp</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
</span><a href="#local-6989586621681134207"><span class="hs-identifier hs-var">yesComp</span></a></span><span>
</span><span id="line-347"></span><span>      </span><span id="local-6989586621681134206"><span class="annot"><span class="annottext">Maybe Cubical
</span><a href="#local-6989586621681134206"><span class="hs-identifier hs-var">cubical</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PragmaOptions -&gt; Maybe Cubical
</span><a href="Agda.Interaction.Options.Base.html#optCubical"><span class="hs-identifier hs-var">optCubical</span></a></span><span> </span><span class="annot"><span class="annottext">(PragmaOptions -&gt; Maybe Cubical)
-&gt; ReaderT GHCModuleEnv TCM PragmaOptions
-&gt; ReaderT GHCModuleEnv TCM (Maybe Cubical)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM PragmaOptions
forall (m :: * -&gt; *). HasOptions m =&gt; m PragmaOptions
</span><a href="Agda.Interaction.Options.HasOptions.html#pragmaOptions"><span class="hs-identifier hs-var">pragmaOptions</span></a></span><span>
</span><span id="line-348"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Cubical
</span><a href="#local-6989586621681134206"><span class="hs-identifier hs-var">cubical</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-349"></span><span>        </span><span class="hs-comment">-- Code that uses --cubical is not compiled.</span><span>
</span><span id="line-350"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Cubical
</span><a href="Agda.Syntax.Common.html#CFull"><span class="hs-identifier hs-var">CFull</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
forall {menv}. ReaderT GHCModuleEnv TCM (Recompile menv GHCModule)
</span><a href="#local-6989586621681134208"><span class="hs-identifier hs-var">noComp</span></a></span><span>
</span><span id="line-351"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Cubical
</span><a href="Agda.Syntax.Common.html#CErased"><span class="hs-identifier hs-var">CErased</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
</span><a href="#local-6989586621681134211"><span class="hs-identifier hs-var">check</span></a></span><span>
</span><span id="line-352"></span><span>        </span><span class="annot"><span class="annottext">Maybe Cubical
</span><span class="hs-identifier hs-var">Nothing</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
</span><a href="#local-6989586621681134211"><span class="hs-identifier hs-var">check</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>    </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
-&gt; GHCModuleEnv -&gt; TCM (Recompile GHCModuleEnv GHCModule)
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-operator hs-var">`runReaderT`</span></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; HsModuleEnv -&gt; GHCModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#GHCModuleEnv"><span class="hs-identifier hs-var">GHCModuleEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621681134215"><span class="hs-identifier hs-var">cenv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; Bool -&gt; HsModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#HsModuleEnv"><span class="hs-identifier hs-var">HsModuleEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681134213"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IsMain
</span><a href="#local-6989586621681134214"><span class="hs-identifier hs-var">isMain</span></a></span><span> </span><span class="annot"><span class="annottext">IsMain -&gt; IsMain -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">IsMain
</span><a href="Agda.Compiler.Common.html#IsMain"><span class="hs-identifier hs-var">IsMain</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-355"></span><span>    </span><span id="local-6989586621681134209"><span class="annot"><span class="annottext">uptodate :: ReaderT GHCModuleEnv TCM Bool
</span><a href="#local-6989586621681134209"><span class="hs-identifier hs-var hs-var">uptodate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621681134212"><span class="hs-identifier hs-var">mifile</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-356"></span><span>      </span><span class="annot"><span class="annottext">Maybe FilePath
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ReaderT GHCModuleEnv TCM Bool
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-357"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681134202"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681134202"><span class="hs-identifier hs-var">ifile</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; ReaderT GHCModuleEnv TCM Bool
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO Bool -&gt; ReaderT GHCModuleEnv TCM Bool)
-&gt; ReaderT GHCModuleEnv TCM (IO Bool)
-&gt; ReaderT GHCModuleEnv TCM Bool
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO Bool
</span><a href="Agda.Utils.FileName.html#isNewerThan"><span class="hs-identifier hs-var">isNewerThan</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath -&gt; IO Bool)
-&gt; ReaderT GHCModuleEnv TCM FilePath
-&gt; ReaderT GHCModuleEnv TCM (FilePath -&gt; IO Bool)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM FilePath
forall (m :: * -&gt; *).
(MonadGHCIO m, ReadGHCModuleEnv m) =&gt;
m FilePath
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFile"><span class="hs-identifier hs-var">curOutFile</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM (FilePath -&gt; IO Bool)
-&gt; ReaderT GHCModuleEnv TCM FilePath
-&gt; ReaderT GHCModuleEnv TCM (IO Bool)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ReaderT GHCModuleEnv TCM FilePath
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681134202"><span class="hs-identifier hs-var">ifile</span></a></span><span>
</span><span id="line-358"></span><span>    </span><span id="local-6989586621681134198"><span class="annot"><span class="annottext">ifileDesc :: FilePath
</span><a href="#local-6989586621681134198"><span class="hs-identifier hs-var hs-var">ifileDesc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath -&gt; FilePath
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;(memory)&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621681134212"><span class="hs-identifier hs-var">mifile</span></a></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span>    </span><span id="local-6989586621681134208"><span class="annot"><span class="annottext">noComp :: ReaderT GHCModuleEnv TCM (Recompile menv GHCModule)
</span><a href="#local-6989586621681134208"><span class="hs-identifier hs-var hs-var">noComp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-361"></span><span>      </span><span class="annot"><span class="annottext">FilePath -&gt; Nat -&gt; FilePath -&gt; ReaderT GHCModuleEnv TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
FilePath -&gt; Nat -&gt; FilePath -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;compile.ghc&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; ReaderT GHCModuleEnv TCM ())
-&gt; (ModuleName -&gt; FilePath)
-&gt; ModuleName
-&gt; ReaderT GHCModuleEnv TCM ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot; : no compilation is needed.&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath)
-&gt; (ModuleName -&gt; FilePath) -&gt; ModuleName -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; FilePath
forall a. Pretty a =&gt; a -&gt; FilePath
</span><a href="Agda.Utils.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; FilePath)
-&gt; (ModuleName -&gt; QName) -&gt; ModuleName -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#mnameToConcrete"><span class="hs-identifier hs-var">A.mnameToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">(ModuleName -&gt; ReaderT GHCModuleEnv TCM ())
-&gt; ReaderT GHCModuleEnv TCM ModuleName
-&gt; ReaderT GHCModuleEnv TCM ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM ModuleName
forall (m :: * -&gt; *). ReadTCState m =&gt; m ModuleName
</span><a href="Agda.Compiler.Common.html#curMName"><span class="hs-identifier hs-var">curMName</span></a></span><span>
</span><span id="line-362"></span><span>      </span><span id="local-6989586621681134178"><span class="annot"><span class="annottext">GHCModuleEnv
</span><a href="#local-6989586621681134178"><span class="hs-identifier hs-var">menv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM GHCModuleEnv
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-363"></span><span>      </span><span id="local-6989586621681134177"><span class="annot"><span class="annottext">[MainFunctionDef]
</span><a href="#local-6989586621681134177"><span class="hs-identifier hs-var">mainDefs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM Bool
-&gt; ReaderT GHCModuleEnv TCM [MainFunctionDef]
-&gt; ReaderT GHCModuleEnv TCM [MainFunctionDef]
-&gt; ReaderT GHCModuleEnv TCM [MainFunctionDef]
forall (m :: * -&gt; *) a. Monad m =&gt; m Bool -&gt; m a -&gt; m a -&gt; m a
</span><a href="Agda.Utils.Monad.html#ifM"><span class="hs-identifier hs-var">ifM</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM Bool
forall (m :: * -&gt; *). ReadGHCModuleEnv m =&gt; m Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#curIsMainModule"><span class="hs-identifier hs-var">curIsMainModule</span></a></span><span>
</span><span id="line-364"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Interface -&gt; [MainFunctionDef]
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#mainFunctionDefs"><span class="hs-identifier hs-var">mainFunctionDefs</span></a></span><span> </span><span class="annot"><span class="annottext">(Interface -&gt; [MainFunctionDef])
-&gt; ReaderT GHCModuleEnv TCM Interface
-&gt; ReaderT GHCModuleEnv TCM [MainFunctionDef]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM Interface
forall (m :: * -&gt; *). ReadTCState m =&gt; m Interface
</span><a href="Agda.Compiler.Common.html#curIF"><span class="hs-identifier hs-var">curIF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MainFunctionDef] -&gt; ReaderT GHCModuleEnv TCM [MainFunctionDef]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>      </span><span class="annot"><span class="annottext">Recompile menv GHCModule
-&gt; ReaderT GHCModuleEnv TCM (Recompile menv GHCModule)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Recompile menv GHCModule
 -&gt; ReaderT GHCModuleEnv TCM (Recompile menv GHCModule))
-&gt; (GHCModule -&gt; Recompile menv GHCModule)
-&gt; GHCModule
-&gt; ReaderT GHCModuleEnv TCM (Recompile menv GHCModule)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GHCModule -&gt; Recompile menv GHCModule
forall menv mod. mod -&gt; Recompile menv mod
</span><a href="Agda.Compiler.Backend.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span><span> </span><span class="annot"><span class="annottext">(GHCModule -&gt; ReaderT GHCModuleEnv TCM (Recompile menv GHCModule))
-&gt; GHCModule -&gt; ReaderT GHCModuleEnv TCM (Recompile menv GHCModule)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv -&gt; [MainFunctionDef] -&gt; GHCModule
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-var">GHCModule</span></a></span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv
</span><a href="#local-6989586621681134178"><span class="hs-identifier hs-var">menv</span></a></span><span> </span><span class="annot"><span class="annottext">[MainFunctionDef]
</span><a href="#local-6989586621681134177"><span class="hs-identifier hs-var">mainDefs</span></a></span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span>    </span><span id="local-6989586621681134207"><span class="annot"><span class="annottext">yesComp :: ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
</span><a href="#local-6989586621681134207"><span class="hs-identifier hs-var hs-var">yesComp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-369"></span><span>      </span><span id="local-6989586621681134172"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681134172"><span class="hs-identifier hs-var">m</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; FilePath
forall a. Pretty a =&gt; a -&gt; FilePath
</span><a href="Agda.Utils.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; FilePath)
-&gt; (ModuleName -&gt; QName) -&gt; ModuleName -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#mnameToConcrete"><span class="hs-identifier hs-var">A.mnameToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">(ModuleName -&gt; FilePath)
-&gt; ReaderT GHCModuleEnv TCM ModuleName
-&gt; ReaderT GHCModuleEnv TCM FilePath
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM ModuleName
forall (m :: * -&gt; *). ReadTCState m =&gt; m ModuleName
</span><a href="Agda.Compiler.Common.html#curMName"><span class="hs-identifier hs-var">curMName</span></a></span><span>
</span><span id="line-370"></span><span>      </span><span id="local-6989586621681134171"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681134171"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM FilePath
forall (m :: * -&gt; *).
(MonadGHCIO m, ReadGHCModuleEnv m) =&gt;
m FilePath
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFile"><span class="hs-identifier hs-var">curOutFile</span></a></span><span>
</span><span id="line-371"></span><span>      </span><span class="annot"><span class="annottext">FilePath -&gt; Nat -&gt; FilePath -&gt; ReaderT GHCModuleEnv TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
FilePath -&gt; Nat -&gt; FilePath -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;compile.ghc&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; ReaderT GHCModuleEnv TCM ())
-&gt; FilePath -&gt; ReaderT GHCModuleEnv TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; FilePath -&gt; FilePath
</span><a href="Agda.Compiler.Common.html#repl"><span class="hs-identifier hs-var">repl</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681134172"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681134198"><span class="hs-identifier hs-var">ifileDesc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681134171"><span class="hs-identifier hs-var">out</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Compiling &lt;&lt;0&gt;&gt; in &lt;&lt;1&gt;&gt; to &lt;&lt;2&gt;&gt;&quot;</span></span><span>
</span><span id="line-372"></span><span>      </span><span class="annot"><span class="annottext">(GHCModuleEnv -&gt; Recompile GHCModuleEnv GHCModule)
-&gt; ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv -&gt; Recompile GHCModuleEnv GHCModule
forall menv mod. menv -&gt; Recompile menv mod
</span><a href="Agda.Compiler.Backend.html#Recompile"><span class="hs-identifier hs-var">Recompile</span></a></span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPostModule"><span class="hs-identifier hs-type">ghcPostModule</span></a></span><span>
</span><span id="line-375"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCEnv"><span class="hs-identifier hs-type">GHCEnv</span></a></span><span>
</span><span id="line-376"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span>
</span><span id="line-377"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.Common.html#IsMain"><span class="hs-identifier hs-type">IsMain</span></a></span><span>        </span><span class="hs-comment">-- ^ Are we looking at the main module?</span><span>
</span><span id="line-378"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span>
</span><span id="line-379"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCDefinition"><span class="hs-identifier hs-type">GHCDefinition</span></a></span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- ^ Compiled module content.</span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-type">GHCModule</span></a></span><span>
</span><span id="line-381"></span><span id="ghcPostModule"><span class="annot"><span class="annottext">ghcPostModule :: GHCEnv
-&gt; GHCModuleEnv
-&gt; IsMain
-&gt; ModuleName
-&gt; [GHCDefinition]
-&gt; TCM GHCModule
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPostModule"><span class="hs-identifier hs-var hs-var">ghcPostModule</span></a></span></span><span> </span><span id="local-6989586621681134168"><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621681134168"><span class="hs-identifier hs-var">_cenv</span></a></span></span><span> </span><span id="local-6989586621681134167"><span class="annot"><span class="annottext">GHCModuleEnv
</span><a href="#local-6989586621681134167"><span class="hs-identifier hs-var">menv</span></a></span></span><span> </span><span id="local-6989586621681134166"><span class="annot"><span class="annottext">IsMain
</span><a href="#local-6989586621681134166"><span class="hs-identifier hs-var">_isMain</span></a></span></span><span> </span><span id="local-6989586621681134165"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681134165"><span class="hs-identifier hs-var">_moduleName</span></a></span></span><span> </span><span id="local-6989586621681134164"><span class="annot"><span class="annottext">[GHCDefinition]
</span><a href="#local-6989586621681134164"><span class="hs-identifier hs-var">ghcDefs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-382"></span><span>  </span><span id="local-6989586621681134163"><span class="annot"><span class="annottext">BuiltinThings PrimFun
</span><a href="#local-6989586621681134163"><span class="hs-identifier hs-var">builtinThings</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TCState -&gt; BuiltinThings PrimFun)
-&gt; TCMT IO (BuiltinThings PrimFun)
forall (m :: * -&gt; *) a. ReadTCState m =&gt; (TCState -&gt; a) -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#getsTC"><span class="hs-identifier hs-var">getsTC</span></a></span><span> </span><span class="annot"><span class="annottext">TCState -&gt; BuiltinThings PrimFun
</span><a href="Agda.TypeChecking.Monad.Base.html#stBuiltinThings"><span class="hs-identifier hs-var">stBuiltinThings</span></a></span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span>  </span><span class="hs-comment">-- Accumulate all of the modules, definitions, declarations, etc.</span><span>
</span><span id="line-385"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681134160"><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621681134160"><span class="hs-identifier hs-var">usedFloat</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681134159"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681134159"><span class="hs-identifier hs-var">decls</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681134158"><span class="annot"><span class="annottext">[Definition]
</span><a href="#local-6989586621681134158"><span class="hs-identifier hs-var">defs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681134157"><span class="annot"><span class="annottext">[MainFunctionDef]
</span><a href="#local-6989586621681134157"><span class="hs-identifier hs-var">mainDefs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681134156"><span class="annot"><span class="annottext">Set ModuleName
</span><a href="#local-6989586621681134156"><span class="hs-identifier hs-var">usedModules</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(UsesFloat, [Decl], [Definition], [MainFunctionDef],
  Set ModuleName)]
-&gt; (UsesFloat, [Decl], [Definition], [MainFunctionDef],
    Set ModuleName)
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([(UsesFloat, [Decl], [Definition], [MainFunctionDef],
   Set ModuleName)]
 -&gt; (UsesFloat, [Decl], [Definition], [MainFunctionDef],
     Set ModuleName))
-&gt; [(UsesFloat, [Decl], [Definition], [MainFunctionDef],
     Set ModuleName)]
-&gt; (UsesFloat, [Decl], [Definition], [MainFunctionDef],
    Set ModuleName)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-386"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCDefinition"><span class="hs-identifier hs-type">GHCDefinition</span></a></span><span> </span><span id="local-6989586621681134155"><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621681134155"><span class="hs-identifier hs-var">useFloat'</span></a></span></span><span> </span><span id="local-6989586621681134154"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681134154"><span class="hs-identifier hs-var">decls'</span></a></span></span><span> </span><span id="local-6989586621681134153"><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681134153"><span class="hs-identifier hs-var">def'</span></a></span></span><span> </span><span id="local-6989586621681134152"><span class="annot"><span class="annottext">Maybe MainFunctionDef
</span><a href="#local-6989586621681134152"><span class="hs-identifier hs-var">md'</span></a></span></span><span> </span><span id="local-6989586621681134151"><span class="annot"><span class="annottext">Set ModuleName
</span><a href="#local-6989586621681134151"><span class="hs-identifier hs-var">imps'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621681134155"><span class="hs-identifier hs-var">useFloat'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681134154"><span class="hs-identifier hs-var">decls'</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681134153"><span class="hs-identifier hs-var">def'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe MainFunctionDef -&gt; [MainFunctionDef]
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span> </span><span class="annot"><span class="annottext">Maybe MainFunctionDef
</span><a href="#local-6989586621681134152"><span class="hs-identifier hs-var">md'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set ModuleName
</span><a href="#local-6989586621681134151"><span class="hs-identifier hs-var">imps'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>        </span><span class="annot"><span class="annottext">(GHCDefinition
 -&gt; (UsesFloat, [Decl], [Definition], [MainFunctionDef],
     Set ModuleName))
-&gt; [GHCDefinition]
-&gt; [(UsesFloat, [Decl], [Definition], [MainFunctionDef],
     Set ModuleName)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[GHCDefinition]
</span><a href="#local-6989586621681134164"><span class="hs-identifier hs-var">ghcDefs</span></a></span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681134149"><span class="annot"><span class="annottext">imps :: [ImportDecl]
</span><a href="#local-6989586621681134149"><span class="hs-identifier hs-var hs-var">imps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UsesFloat -&gt; [ImportDecl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#mazRTEFloatImport"><span class="hs-identifier hs-var">mazRTEFloatImport</span></a></span><span> </span><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621681134160"><span class="hs-identifier hs-var">usedFloat</span></a></span><span> </span><span class="annot"><span class="annottext">[ImportDecl] -&gt; [ImportDecl] -&gt; [ImportDecl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">BuiltinThings PrimFun
-&gt; Set ModuleName -&gt; [Definition] -&gt; [ImportDecl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#imports"><span class="hs-identifier hs-var">imports</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinThings PrimFun
</span><a href="#local-6989586621681134163"><span class="hs-identifier hs-var">builtinThings</span></a></span><span> </span><span class="annot"><span class="annottext">Set ModuleName
</span><a href="#local-6989586621681134156"><span class="hs-identifier hs-var">usedModules</span></a></span><span> </span><span class="annot"><span class="annottext">[Definition]
</span><a href="#local-6989586621681134158"><span class="hs-identifier hs-var">defs</span></a></span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span>  </span><span id="local-6989586621681134146"><span class="annot"><span class="annottext">Interface
</span><a href="#local-6989586621681134146"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO Interface
forall (m :: * -&gt; *). ReadTCState m =&gt; m Interface
</span><a href="Agda.Compiler.Common.html#curIF"><span class="hs-identifier hs-var">curIF</span></a></span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-comment">-- Get content of FOREIGN pragmas.</span><span>
</span><span id="line-395"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681134145"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681134145"><span class="hs-identifier hs-var">headerPragmas</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681134144"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681134144"><span class="hs-identifier hs-var">hsImps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681134143"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681134143"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Interface -&gt; ([FilePath], [FilePath], [FilePath])
</span><a href="Agda.Compiler.MAlonzo.Pragmas.html#foreignHaskell"><span class="hs-identifier hs-var">foreignHaskell</span></a></span><span> </span><span class="annot"><span class="annottext">Interface
</span><a href="#local-6989586621681134146"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span>  </span><span class="annot"><span class="annottext">(ReaderT GHCModuleEnv TCM () -&gt; GHCModuleEnv -&gt; TCM ())
-&gt; GHCModuleEnv -&gt; ReaderT GHCModuleEnv TCM () -&gt; TCM ()
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM () -&gt; GHCModuleEnv -&gt; TCM ()
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv
</span><a href="#local-6989586621681134167"><span class="hs-identifier hs-var">menv</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT GHCModuleEnv TCM () -&gt; TCM ())
-&gt; ReaderT GHCModuleEnv TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-398"></span><span>    </span><span id="local-6989586621681134141"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681134141"><span class="hs-identifier hs-var">hsModuleName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM ModuleName
forall (m :: * -&gt; *). ReadGHCModuleEnv m =&gt; m ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#curHsMod"><span class="hs-identifier hs-var">curHsMod</span></a></span><span>
</span><span id="line-399"></span><span>    </span><span class="annot"><span class="annottext">Module -&gt; ReaderT GHCModuleEnv TCM ()
forall (m :: * -&gt; *). MonadGHCIO m =&gt; Module -&gt; m ()
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#writeModule"><span class="hs-identifier hs-var">writeModule</span></a></span><span> </span><span class="annot"><span class="annottext">(Module -&gt; ReaderT GHCModuleEnv TCM ())
-&gt; Module -&gt; ReaderT GHCModuleEnv TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; [ModulePragma] -&gt; [ImportDecl] -&gt; [Decl] -&gt; Module
</span><a href="Agda.Utils.Haskell.Syntax.html#Module"><span class="hs-identifier hs-var">HS.Module</span></a></span><span>
</span><span id="line-400"></span><span>      </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681134141"><span class="hs-identifier hs-var">hsModuleName</span></a></span><span>
</span><span id="line-401"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FilePath -&gt; ModulePragma) -&gt; [FilePath] -&gt; [ModulePragma]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ModulePragma
</span><a href="Agda.Utils.Haskell.Syntax.html#OtherPragma"><span class="hs-identifier hs-var">HS.OtherPragma</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681134145"><span class="hs-identifier hs-var">headerPragmas</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>      </span><span class="annot"><span class="annottext">[ImportDecl]
</span><a href="#local-6989586621681134149"><span class="hs-identifier hs-var">imps</span></a></span><span>
</span><span id="line-403"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FilePath -&gt; Decl) -&gt; [FilePath] -&gt; [Decl]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Misc.html#fakeDecl"><span class="hs-identifier hs-var">fakeDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681134144"><span class="hs-identifier hs-var">hsImps</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681134143"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681134159"><span class="hs-identifier hs-var">decls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span>  </span><span class="annot"><span class="annottext">GHCModule -&gt; TCM GHCModule
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(GHCModule -&gt; TCM GHCModule) -&gt; GHCModule -&gt; TCM GHCModule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv -&gt; [MainFunctionDef] -&gt; GHCModule
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-var">GHCModule</span></a></span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv
</span><a href="#local-6989586621681134167"><span class="hs-identifier hs-var">menv</span></a></span><span> </span><span class="annot"><span class="annottext">[MainFunctionDef]
</span><a href="#local-6989586621681134157"><span class="hs-identifier hs-var">mainDefs</span></a></span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcCompileDef"><span class="hs-identifier hs-type">ghcCompileDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCEnv"><span class="hs-identifier hs-type">GHCEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.Common.html#IsMain"><span class="hs-identifier hs-type">IsMain</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCDefinition"><span class="hs-identifier hs-type">GHCDefinition</span></a></span><span>
</span><span id="line-408"></span><span id="ghcCompileDef"><span class="annot"><span class="annottext">ghcCompileDef :: GHCEnv -&gt; GHCModuleEnv -&gt; IsMain -&gt; Definition -&gt; TCM GHCDefinition
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcCompileDef"><span class="hs-identifier hs-var hs-var">ghcCompileDef</span></a></span></span><span> </span><span id="local-6989586621681134135"><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621681134135"><span class="hs-identifier hs-var">_cenv</span></a></span></span><span> </span><span id="local-6989586621681134134"><span class="annot"><span class="annottext">GHCModuleEnv
</span><a href="#local-6989586621681134134"><span class="hs-identifier hs-var">menv</span></a></span></span><span> </span><span id="local-6989586621681134133"><span class="annot"><span class="annottext">IsMain
</span><a href="#local-6989586621681134133"><span class="hs-identifier hs-var">_isMain</span></a></span></span><span> </span><span id="local-6989586621681134132"><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681134132"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-409"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681134131"><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621681134131"><span class="hs-identifier hs-var">usesFloat</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681134130"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681134130"><span class="hs-identifier hs-var">decls</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681134129"><span class="annot"><span class="annottext">Maybe CheckedMainFunctionDef
</span><a href="#local-6989586621681134129"><span class="hs-identifier hs-var">mainFuncDef</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileState"><span class="hs-identifier hs-type">HsCompileState</span></a></span><span> </span><span id="local-6989586621681134127"><span class="annot"><span class="annottext">Set ModuleName
</span><a href="#local-6989586621681134127"><span class="hs-identifier hs-var">imps</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-410"></span><span>    </span><span class="annot"><span class="annottext">Definition
-&gt; HsCompileM (UsesFloat, [Decl], Maybe CheckedMainFunctionDef)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#definition"><span class="hs-identifier hs-var">definition</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681134132"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">HsCompileM (UsesFloat, [Decl], Maybe CheckedMainFunctionDef)
-&gt; GHCModuleEnv
-&gt; TCMT
     IO
     ((UsesFloat, [Decl], Maybe CheckedMainFunctionDef), HsCompileState)
forall (m :: * -&gt; *) a.
HsCompileT m a -&gt; GHCModuleEnv -&gt; m (a, HsCompileState)
</span><a href="Agda.Compiler.MAlonzo.Misc.html#runHsCompileT"><span class="hs-operator hs-var">`runHsCompileT`</span></a></span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv
</span><a href="#local-6989586621681134134"><span class="hs-identifier hs-var">menv</span></a></span><span>
</span><span id="line-411"></span><span>  </span><span class="annot"><span class="annottext">GHCDefinition -&gt; TCM GHCDefinition
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(GHCDefinition -&gt; TCM GHCDefinition)
-&gt; GHCDefinition -&gt; TCM GHCDefinition
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UsesFloat
-&gt; [Decl]
-&gt; Definition
-&gt; Maybe MainFunctionDef
-&gt; Set ModuleName
-&gt; GHCDefinition
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCDefinition"><span class="hs-identifier hs-var">GHCDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621681134131"><span class="hs-identifier hs-var">usesFloat</span></a></span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681134130"><span class="hs-identifier hs-var">decls</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681134132"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckedMainFunctionDef -&gt; MainFunctionDef
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#checkedMainDef"><span class="hs-identifier hs-var">checkedMainDef</span></a></span><span> </span><span class="annot"><span class="annottext">(CheckedMainFunctionDef -&gt; MainFunctionDef)
-&gt; Maybe CheckedMainFunctionDef -&gt; Maybe MainFunctionDef
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe CheckedMainFunctionDef
</span><a href="#local-6989586621681134129"><span class="hs-identifier hs-var">mainFuncDef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set ModuleName
</span><a href="#local-6989586621681134127"><span class="hs-identifier hs-var">imps</span></a></span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span class="hs-comment">-- | We do not erase types that have a 'HsData' pragma.</span><span>
</span><span id="line-414"></span><span class="hs-comment">--   This is to ensure a stable interface to third-party code.</span><span>
</span><span id="line-415"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcMayEraseType"><span class="hs-identifier hs-type">ghcMayEraseType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-416"></span><span id="ghcMayEraseType"><span class="annot"><span class="annottext">ghcMayEraseType :: QName -&gt; TCM Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcMayEraseType"><span class="hs-identifier hs-var hs-var">ghcMayEraseType</span></a></span></span><span> </span><span id="local-6989586621681134123"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134123"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM (Maybe HaskellPragma)
</span><a href="Agda.Compiler.MAlonzo.Pragmas.html#getHaskellPragma"><span class="hs-identifier hs-var">getHaskellPragma</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134123"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">TCM (Maybe HaskellPragma)
-&gt; (Maybe HaskellPragma -&gt; Bool) -&gt; TCM Bool
forall (m :: * -&gt; *) a b. Functor m =&gt; m a -&gt; (a -&gt; b) -&gt; m b
</span><a href="Agda.Utils.Functor.html#%3C%26%3E"><span class="hs-operator hs-var">&lt;&amp;&gt;</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-417"></span><span>  </span><span class="hs-comment">-- Andreas, 2019-05-09, issue #3732.</span><span>
</span><span id="line-418"></span><span>  </span><span class="hs-comment">-- We restrict this to 'HsData' since types like @Size@, @Level@</span><span>
</span><span id="line-419"></span><span>  </span><span class="hs-comment">-- should be erased although they have a 'HsType' binding to the</span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-comment">-- Haskell unit type.</span><span>
</span><span id="line-421"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HsData"><span class="hs-identifier hs-type">HsData</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-422"></span><span>  </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span class="hs-comment">-- Compilation ------------------------------------------------------------</span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#imports"><span class="hs-identifier hs-type">imports</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#BuiltinThings"><span class="hs-identifier hs-type">BuiltinThings</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#PrimFun"><span class="hs-identifier hs-type">PrimFun</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-type">HS.ImportDecl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-427"></span><span id="imports"><span class="annot"><span class="annottext">imports :: BuiltinThings PrimFun
-&gt; Set ModuleName -&gt; [Definition] -&gt; [ImportDecl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#imports"><span class="hs-identifier hs-var hs-var">imports</span></a></span></span><span> </span><span id="local-6989586621681134119"><span class="annot"><span class="annottext">BuiltinThings PrimFun
</span><a href="#local-6989586621681134119"><span class="hs-identifier hs-var">builtinThings</span></a></span></span><span> </span><span id="local-6989586621681134118"><span class="annot"><span class="annottext">Set ModuleName
</span><a href="#local-6989586621681134118"><span class="hs-identifier hs-var">usedModules</span></a></span></span><span> </span><span id="local-6989586621681134117"><span class="annot"><span class="annottext">[Definition]
</span><a href="#local-6989586621681134117"><span class="hs-identifier hs-var">defs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ImportDecl]
</span><a href="#local-6989586621681134116"><span class="hs-identifier hs-var">hsImps</span></a></span><span> </span><span class="annot"><span class="annottext">[ImportDecl] -&gt; [ImportDecl] -&gt; [ImportDecl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[ImportDecl]
</span><a href="#local-6989586621681134115"><span class="hs-identifier hs-var">imps</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-428"></span><span>  </span><span class="annot"><a href="#local-6989586621681134116"><span class="hs-identifier hs-type">hsImps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-type">HS.ImportDecl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-429"></span><span>  </span><span id="local-6989586621681134116"><span class="annot"><span class="annottext">hsImps :: [ImportDecl]
</span><a href="#local-6989586621681134116"><span class="hs-identifier hs-var hs-var">hsImps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ImportDecl
</span><a href="#local-6989586621681134114"><span class="hs-identifier hs-var">unqualRTE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; ImportDecl
</span><a href="#local-6989586621681134113"><span class="hs-identifier hs-var">decl</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTE"><span class="hs-identifier hs-var">mazRTE</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span>  </span><span class="annot"><a href="#local-6989586621681134114"><span class="hs-identifier hs-type">unqualRTE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-type">HS.ImportDecl</span></a></span><span>
</span><span id="line-432"></span><span>  </span><span id="local-6989586621681134114"><span class="annot"><span class="annottext">unqualRTE :: ImportDecl
</span><a href="#local-6989586621681134114"><span class="hs-identifier hs-var hs-var">unqualRTE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; Bool -&gt; Maybe (Bool, [ImportSpec]) -&gt; ImportDecl
</span><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-var">HS.ImportDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTE"><span class="hs-identifier hs-var">mazRTE</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Bool, [ImportSpec]) -&gt; ImportDecl)
-&gt; Maybe (Bool, [ImportSpec]) -&gt; ImportDecl
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Bool, [ImportSpec]) -&gt; Maybe (Bool, [ImportSpec])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((Bool, [ImportSpec]) -&gt; Maybe (Bool, [ImportSpec]))
-&gt; (Bool, [ImportSpec]) -&gt; Maybe (Bool, [ImportSpec])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-433"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ImportSpec
</span><a href="Agda.Utils.Haskell.Syntax.html#IVar"><span class="hs-identifier hs-var">HS.IVar</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; ImportSpec) -&gt; Name -&gt; ImportSpec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681134108"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-434"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681134108"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681134108"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazCoerceName"><span class="hs-identifier hs-var">mazCoerceName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazErasedName"><span class="hs-identifier hs-var">mazErasedName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazAnyTypeName"><span class="hs-identifier hs-var">mazAnyTypeName</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-435"></span><span>                             </span><span class="annot"><span class="annottext">(TPrim -&gt; FilePath) -&gt; [TPrim] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TPrim -&gt; FilePath
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#treelessPrimName"><span class="hs-identifier hs-var">treelessPrimName</span></a></span><span> </span><span class="annot"><span class="annottext">[TPrim]
</span><a href="#local-6989586621681134103"><span class="hs-identifier hs-var">rtePrims</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span>  </span><span id="local-6989586621681134103"><span class="annot"><span class="annottext">rtePrims :: [TPrim]
</span><a href="#local-6989586621681134103"><span class="hs-identifier hs-var hs-var">rtePrims</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PAdd"><span class="hs-identifier hs-var">T.PAdd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PSub"><span class="hs-identifier hs-var">T.PSub</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PMul"><span class="hs-identifier hs-var">T.PMul</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PQuot"><span class="hs-identifier hs-var">T.PQuot</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PRem"><span class="hs-identifier hs-var">T.PRem</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PGeq"><span class="hs-identifier hs-var">T.PGeq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PLt"><span class="hs-identifier hs-var">T.PLt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PEqI"><span class="hs-identifier hs-var">T.PEqI</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-438"></span><span>              </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PAdd64"><span class="hs-identifier hs-var">T.PAdd64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PSub64"><span class="hs-identifier hs-var">T.PSub64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PMul64"><span class="hs-identifier hs-var">T.PMul64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PQuot64"><span class="hs-identifier hs-var">T.PQuot64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PRem64"><span class="hs-identifier hs-var">T.PRem64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PLt64"><span class="hs-identifier hs-var">T.PLt64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PEq64"><span class="hs-identifier hs-var">T.PEq64</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-439"></span><span>              </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PITo64"><span class="hs-identifier hs-var">T.PITo64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#P64ToI"><span class="hs-identifier hs-var">T.P64ToI</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Excludes T.PEqF, which is defined in MAlonzo.RTE.Float</span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span>  </span><span class="annot"><a href="#local-6989586621681134115"><span class="hs-identifier hs-type">imps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-type">HS.ImportDecl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-442"></span><span>  </span><span id="local-6989586621681134115"><span class="annot"><span class="annottext">imps :: [ImportDecl]
</span><a href="#local-6989586621681134115"><span class="hs-identifier hs-var hs-var">imps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ModuleName -&gt; ImportDecl) -&gt; [ModuleName] -&gt; [ImportDecl]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; ImportDecl
</span><a href="#local-6989586621681134113"><span class="hs-identifier hs-var">decl</span></a></span><span> </span><span class="annot"><span class="annottext">([ModuleName] -&gt; [ImportDecl]) -&gt; [ModuleName] -&gt; [ImportDecl]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ModuleName] -&gt; [ModuleName]
</span><a href="#local-6989586621681134085"><span class="hs-identifier hs-var">uniq</span></a></span><span> </span><span class="annot"><span class="annottext">([ModuleName] -&gt; [ModuleName]) -&gt; [ModuleName] -&gt; [ModuleName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BuiltinThings PrimFun -&gt; [Definition] -&gt; [ModuleName]
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#importsForPrim"><span class="hs-identifier hs-var">importsForPrim</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinThings PrimFun
</span><a href="#local-6989586621681134119"><span class="hs-identifier hs-var">builtinThings</span></a></span><span> </span><span class="annot"><span class="annottext">[Definition]
</span><a href="#local-6989586621681134117"><span class="hs-identifier hs-var">defs</span></a></span><span> </span><span class="annot"><span class="annottext">[ModuleName] -&gt; [ModuleName] -&gt; [ModuleName]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(ModuleName -&gt; ModuleName) -&gt; [ModuleName] -&gt; [ModuleName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazMod"><span class="hs-identifier hs-var">mazMod</span></a></span><span> </span><span class="annot"><span class="annottext">[ModuleName]
</span><a href="#local-6989586621681134082"><span class="hs-identifier hs-var">mnames</span></a></span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span>  </span><span class="annot"><a href="#local-6989586621681134113"><span class="hs-identifier hs-type">decl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-type">HS.ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-type">HS.ImportDecl</span></a></span><span>
</span><span id="line-445"></span><span>  </span><span id="local-6989586621681134113"><span class="annot"><span class="annottext">decl :: ModuleName -&gt; ImportDecl
</span><a href="#local-6989586621681134113"><span class="hs-identifier hs-var hs-var">decl</span></a></span></span><span> </span><span id="local-6989586621681134081"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681134081"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; Bool -&gt; Maybe (Bool, [ImportSpec]) -&gt; ImportDecl
</span><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-var">HS.ImportDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681134081"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Bool, [ImportSpec])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span>  </span><span class="annot"><a href="#local-6989586621681134082"><span class="hs-identifier hs-type">mnames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-448"></span><span>  </span><span id="local-6989586621681134082"><span class="annot"><span class="annottext">mnames :: [ModuleName]
</span><a href="#local-6989586621681134082"><span class="hs-identifier hs-var hs-var">mnames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set ModuleName -&gt; [ModuleName]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.elems</span></span><span> </span><span class="annot"><span class="annottext">Set ModuleName
</span><a href="#local-6989586621681134118"><span class="hs-identifier hs-var">usedModules</span></a></span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span>  </span><span class="annot"><a href="#local-6989586621681134085"><span class="hs-identifier hs-type">uniq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-type">HS.ModuleName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-type">HS.ModuleName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-451"></span><span>  </span><span id="local-6989586621681134085"><span class="annot"><span class="annottext">uniq :: [ModuleName] -&gt; [ModuleName]
</span><a href="#local-6989586621681134085"><span class="hs-identifier hs-var hs-var">uniq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([ModuleName] -&gt; ModuleName) -&gt; [[ModuleName]] -&gt; [ModuleName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">List.map</span></span><span> </span><span class="annot"><span class="annottext">[ModuleName] -&gt; ModuleName
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([[ModuleName]] -&gt; [ModuleName])
-&gt; ([ModuleName] -&gt; [[ModuleName]]) -&gt; [ModuleName] -&gt; [ModuleName]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[ModuleName] -&gt; [[ModuleName]]
forall a. Eq a =&gt; [a] -&gt; [[a]]
</span><span class="hs-identifier hs-var">List.group</span></span><span> </span><span class="annot"><span class="annottext">([ModuleName] -&gt; [[ModuleName]])
-&gt; ([ModuleName] -&gt; [ModuleName]) -&gt; [ModuleName] -&gt; [[ModuleName]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[ModuleName] -&gt; [ModuleName]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.sort</span></span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span class="hs-comment">-- Should we import MAlonzo.RTE.Float</span><span>
</span><span id="line-454"></span><span class="hs-keyword">newtype</span><span> </span><span id="UsesFloat"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-var">UsesFloat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="UsesFloat"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-var">UsesFloat</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681134070"><span id="local-6989586621681134074"><span class="annot"><span class="annottext">UsesFloat -&gt; UsesFloat -&gt; Bool
(UsesFloat -&gt; UsesFloat -&gt; Bool)
-&gt; (UsesFloat -&gt; UsesFloat -&gt; Bool) -&gt; Eq UsesFloat
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: UsesFloat -&gt; UsesFloat -&gt; Bool
$c/= :: UsesFloat -&gt; UsesFloat -&gt; Bool
== :: UsesFloat -&gt; UsesFloat -&gt; Bool
$c== :: UsesFloat -&gt; UsesFloat -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681134057"><span id="local-6989586621681134059"><span id="local-6989586621681134064"><span class="annot"><span class="annottext">Nat -&gt; UsesFloat -&gt; FilePath -&gt; FilePath
[UsesFloat] -&gt; FilePath -&gt; FilePath
UsesFloat -&gt; FilePath
(Nat -&gt; UsesFloat -&gt; FilePath -&gt; FilePath)
-&gt; (UsesFloat -&gt; FilePath)
-&gt; ([UsesFloat] -&gt; FilePath -&gt; FilePath)
-&gt; Show UsesFloat
forall a.
(Nat -&gt; a -&gt; FilePath -&gt; FilePath)
-&gt; (a -&gt; FilePath) -&gt; ([a] -&gt; FilePath -&gt; FilePath) -&gt; Show a
showList :: [UsesFloat] -&gt; FilePath -&gt; FilePath
$cshowList :: [UsesFloat] -&gt; FilePath -&gt; FilePath
show :: UsesFloat -&gt; FilePath
$cshow :: UsesFloat -&gt; FilePath
showsPrec :: Nat -&gt; UsesFloat -&gt; FilePath -&gt; FilePath
$cshowsPrec :: Nat -&gt; UsesFloat -&gt; FilePath -&gt; FilePath
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#YesFloat"><span class="hs-identifier hs-type">YesFloat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span>
</span><span id="line-457"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bYesFloat"><span id="%24mYesFloat"><span id="YesFloat"><span class="annot"><span class="annottext">$bYesFloat :: UsesFloat
$mYesFloat :: forall {r}. UsesFloat -&gt; ((# #) -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#%24bYesFloat"><span class="hs-identifier hs-var hs-var hs-var">YesFloat</span></a></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#NoFloat"><span class="hs-identifier hs-type">NoFloat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span>
</span><span id="line-460"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bNoFloat"><span id="%24mNoFloat"><span id="NoFloat"><span class="annot"><span class="annottext">$bNoFloat :: UsesFloat
$mNoFloat :: forall {r}. UsesFloat -&gt; ((# #) -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#%24bNoFloat"><span class="hs-identifier hs-var hs-var hs-var">NoFloat</span></a></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>
</span><span id="line-461"></span><span>
</span><span id="line-462"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681134045"><span id="local-6989586621681134047"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-463"></span><span>  </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span> </span><span id="local-6989586621681134043"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681134043"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621681134042"><span class="annot"><span class="annottext">&lt;&gt; :: UsesFloat -&gt; UsesFloat -&gt; UsesFloat
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span> </span><span id="local-6989586621681134041"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681134041"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; UsesFloat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-var">UsesFloat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681134043"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681134041"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681134034"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-466"></span><span>  </span><span id="local-6989586621681134032"><span class="annot"><span class="annottext">mempty :: UsesFloat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UsesFloat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#NoFloat"><span class="hs-identifier hs-var">NoFloat</span></a></span><span>
</span><span id="line-467"></span><span>  </span><span id="local-6989586621681134030"><span class="annot"><span class="annottext">mappend :: UsesFloat -&gt; UsesFloat -&gt; UsesFloat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UsesFloat -&gt; UsesFloat -&gt; UsesFloat
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span>
</span><span id="line-468"></span><span>
</span><span id="line-469"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#mazRTEFloatImport"><span class="hs-identifier hs-type">mazRTEFloatImport</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-type">HS.ImportDecl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-470"></span><span id="mazRTEFloatImport"><span class="annot"><span class="annottext">mazRTEFloatImport :: UsesFloat -&gt; [ImportDecl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#mazRTEFloatImport"><span class="hs-identifier hs-var hs-var">mazRTEFloatImport</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span> </span><span id="local-6989586621681134029"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681134029"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; Bool -&gt; Maybe (Bool, [ImportSpec]) -&gt; ImportDecl
</span><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-var">HS.ImportDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTEFloat"><span class="hs-identifier hs-var">mazRTEFloat</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Bool, [ImportSpec])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681134029"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-471"></span><span>
</span><span id="line-472"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-473"></span><span class="hs-comment">-- Main compiling clauses</span><span>
</span><span id="line-474"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-475"></span><span>
</span><span id="line-476"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#definition"><span class="hs-identifier hs-type">definition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Primitives.html#CheckedMainFunctionDef"><span class="hs-identifier hs-type">CheckedMainFunctionDef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-477"></span><span class="hs-comment">-- ignore irrelevant definitions</span><span>
</span><span id="line-478"></span><span class="hs-comment">{- Andreas, 2012-10-02: Invariant no longer holds
definition kit (Defn NonStrict _ _  _ _ _ _ _ _) = __IMPOSSIBLE__
-}</span><span>
</span><span id="line-481"></span><span id="definition"><span class="annot"><span class="annottext">definition :: Definition
-&gt; HsCompileM (UsesFloat, [Decl], Maybe CheckedMainFunctionDef)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#definition"><span class="hs-identifier hs-var hs-var">definition</span></a></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Defn"><span class="hs-identifier hs-type">Defn</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">defArgInfo :: Definition -&gt; ArgInfo
</span><a href="Agda.TypeChecking.Monad.Base.html#defArgInfo"><span class="hs-identifier hs-var">defArgInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681134025"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681134025"><span class="hs-identifier hs-var">info</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">defName :: Definition -&gt; QName
</span><a href="Agda.TypeChecking.Monad.Base.html#defName"><span class="hs-identifier hs-var">defName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681134023"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134023"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; Bool
forall a. LensModality a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#usableModality"><span class="hs-identifier hs-var">usableModality</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681134025"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-482"></span><span>  </span><span class="annot"><span class="annottext">FilePath
-&gt; Nat
-&gt; TCM Doc
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
FilePath -&gt; Nat -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;compile.ghc.definition&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; TCM Doc -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-483"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;Not compiling&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134023"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-484"></span><span>  </span><span class="annot"><span class="annottext">(UsesFloat, [Decl], Maybe CheckedMainFunctionDef)
-&gt; HsCompileM (UsesFloat, [Decl], Maybe CheckedMainFunctionDef)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UsesFloat
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Decl]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe CheckedMainFunctionDef
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#definition"><span class="hs-identifier hs-var">definition</span></a></span><span> </span><span id="local-6989586621681134017"><span class="annot"><span class="annottext">def :: Definition
</span><a href="#local-6989586621681134017"><span class="hs-identifier hs-var">def</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Defn"><span class="hs-identifier hs-type">Defn</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">defName :: Definition -&gt; QName
</span><a href="Agda.TypeChecking.Monad.Base.html#defName"><span class="hs-identifier hs-var">defName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681134016"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">defType :: Definition -&gt; Type
</span><a href="Agda.TypeChecking.Monad.Base.html#defType"><span class="hs-identifier hs-var">defType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681134014"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681134014"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">theDef :: Definition -&gt; Defn
</span><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var">theDef</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681134012"><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681134012"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-486"></span><span>  </span><span class="annot"><span class="annottext">FilePath
-&gt; Nat
-&gt; TCM Doc
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
FilePath -&gt; Nat -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;compile.ghc.definition&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; TCM Doc -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCM Doc] -&gt; TCM Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-487"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;Compiling&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;:&quot;</span></span><span>
</span><span id="line-488"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Functor m =&gt; Nat -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCM Doc) -&gt; TCM Doc -&gt; TCM Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Defn -&gt; TCM Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681134012"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-489"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-490"></span><span>  </span><span id="local-6989586621681134008"><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621681134008"><span class="hs-identifier hs-var">pragma</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM (Maybe HaskellPragma)
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (Maybe HaskellPragma)
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM (Maybe HaskellPragma)
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (Maybe HaskellPragma))
-&gt; TCM (Maybe HaskellPragma)
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (Maybe HaskellPragma)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM (Maybe HaskellPragma)
</span><a href="Agda.Compiler.MAlonzo.Pragmas.html#getHaskellPragma"><span class="hs-identifier hs-var">getHaskellPragma</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-491"></span><span>  </span><span id="local-6989586621681134006"><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621681134006"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) GHCEnv
forall (m :: * -&gt; *). ReadGHCModuleEnv m =&gt; m GHCEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#askGHCEnv"><span class="hs-identifier hs-var">askGHCEnv</span></a></span><span>
</span><span id="line-492"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681134004"><span class="annot"><span class="annottext">is :: (GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621681134004"><span class="hs-identifier hs-var hs-var">is</span></a></span></span><span> </span><span id="local-6989586621681134003"><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="#local-6989586621681134003"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; Maybe QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="#local-6989586621681134003"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621681134006"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-493"></span><span>  </span><span id="local-6989586621681134002"><span class="annot"><span class="annottext">Maybe CheckedMainFunctionDef
</span><a href="#local-6989586621681134002"><span class="hs-identifier hs-var">typeCheckedMainDef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Definition -&gt; HsCompileM (Maybe CheckedMainFunctionDef)
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#checkTypeOfMain"><span class="hs-identifier hs-var">checkTypeOfMain</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681134017"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-494"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681134000"><span class="annot"><span class="annottext">mainDecl :: [Decl]
</span><a href="#local-6989586621681134000"><span class="hs-identifier hs-var hs-var">mainDecl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Decl -&gt; [Decl]
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Decl -&gt; [Decl]) -&gt; Maybe Decl -&gt; [Decl]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CheckedMainFunctionDef -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#checkedMainDecl"><span class="hs-identifier hs-var">checkedMainDecl</span></a></span><span> </span><span class="annot"><span class="annottext">(CheckedMainFunctionDef -&gt; Decl)
-&gt; Maybe CheckedMainFunctionDef -&gt; Maybe Decl
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe CheckedMainFunctionDef
</span><a href="#local-6989586621681134002"><span class="hs-identifier hs-var">typeCheckedMainDef</span></a></span><span>
</span><span id="line-495"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133994"><span class="annot"><span class="annottext">retDecls :: b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var hs-var">retDecls</span></a></span></span><span> </span><span id="local-6989586621681133993"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681133993"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; m (a, b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681133993"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UsesFloat
 -&gt; [Decl] -&gt; (UsesFloat, [Decl], Maybe CheckedMainFunctionDef))
-&gt; (UsesFloat, [Decl])
-&gt; (UsesFloat, [Decl], Maybe CheckedMainFunctionDef)
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe CheckedMainFunctionDef
</span><a href="#local-6989586621681134002"><span class="hs-identifier hs-var">typeCheckedMainDef</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((UsesFloat, [Decl])
 -&gt; (UsesFloat, [Decl], Maybe CheckedMainFunctionDef))
-&gt; ((UsesFloat, [Decl]) -&gt; (UsesFloat, [Decl]))
-&gt; (UsesFloat, [Decl])
-&gt; (UsesFloat, [Decl], Maybe CheckedMainFunctionDef)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([Decl] -&gt; [Decl]) -&gt; (UsesFloat, [Decl]) -&gt; (UsesFloat, [Decl])
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681134000"><span class="hs-identifier hs-var">mainDecl</span></a></span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Decl] -&gt; [Decl]) -&gt; ([Decl] -&gt; [Decl]) -&gt; [Decl] -&gt; [Decl]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; [Decl] -&gt; [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#infodecl"><span class="hs-identifier hs-var">infodecl</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((UsesFloat, [Decl])
 -&gt; (UsesFloat, [Decl], Maybe CheckedMainFunctionDef))
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; HsCompileM (UsesFloat, [Decl], Maybe CheckedMainFunctionDef)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-497"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681134012"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span>      </span><span class="annot"><span class="annottext">Defn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HsDefn"><span class="hs-identifier hs-type">HsDefn</span></a></span><span> </span><span id="local-6989586621681133989"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681133989"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681133988"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133988"><span class="hs-identifier hs-var">hs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621681134008"><span class="hs-identifier hs-var">pragma</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) x a.
(MonadTrace m, HasRange x) =&gt;
x -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-var">setCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681133989"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-500"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621681134004"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvFlat"><span class="hs-identifier hs-var">ghcEnvFlat</span></a></span><span>
</span><span id="line-501"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
FilePath -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#genericError"><span class="hs-identifier hs-var">genericError</span></a></span><span>
</span><span id="line-502"></span><span>                </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;\&quot;COMPILE GHC\&quot; pragmas are not allowed for the FLAT builtin.&quot;</span></span><span>
</span><span id="line-503"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-504"></span><span>            </span><span class="hs-comment">-- Make sure we have imports for all names mentioned in the type.</span><span>
</span><span id="line-505"></span><span>            </span><span id="local-6989586621681133986"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681133986"><span class="hs-identifier hs-var">hsty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; HsCompileM Type
</span><a href="Agda.Compiler.MAlonzo.HaskellTypes.html#haskellType"><span class="hs-identifier hs-var">haskellType</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-506"></span><span>            </span><span class="annot"><span class="annottext">(QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) QName)
-&gt; Set QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName
-&gt; Name -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#xqual"><span class="hs-operator hs-var">`xqual`</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;_&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Set QName
forall a m. (NamesIn a, Collection QName m) =&gt; a -&gt; m
</span><a href="Agda.Syntax.Internal.Names.html#namesIn"><span class="hs-identifier hs-var">namesIn</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681134014"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span>          </span><span class="hs-comment">-- Check that the function isn't INLINE (since that will make this</span><span>
</span><span id="line-509"></span><span>          </span><span class="hs-comment">-- definition pointless).</span><span>
</span><span id="line-510"></span><span>            </span><span id="local-6989586621681133982"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133982"><span class="hs-identifier hs-var">inline</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Defn -&gt; Lens' Bool Defn -&gt; Bool
forall o i. o -&gt; Lens' i o -&gt; i
</span><a href="Agda.Utils.Lens.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' Bool Defn
</span><a href="Agda.TypeChecking.Monad.Base.html#funInline"><span class="hs-identifier hs-var">funInline</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Defn -&gt; Bool) -&gt; (Definition -&gt; Defn) -&gt; Definition -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Defn
</span><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var">theDef</span></a></span><span> </span><span class="annot"><span class="annottext">(Definition -&gt; Bool)
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Definition
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Definition
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Definition
</span><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo"><span class="hs-identifier hs-var">getConstInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-511"></span><span>            </span><span class="annot"><span class="annottext">Bool
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133982"><span class="hs-identifier hs-var">inline</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Warning -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *).
(HasCallStack, MonadWarning m) =&gt;
Warning -&gt; m ()
</span><a href="Agda.TypeChecking.Warnings.html#warning"><span class="hs-identifier hs-var">warning</span></a></span><span> </span><span class="annot"><span class="annottext">(Warning -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; Warning -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Warning
</span><a href="Agda.TypeChecking.Monad.Base.html#UselessInline"><span class="hs-identifier hs-var">UselessInline</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span>            </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Exp -&gt; [Decl]
</span><a href="#local-6989586621681133973"><span class="hs-identifier hs-var">fbWithType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681133986"><span class="hs-identifier hs-var">hsty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#fakeExp"><span class="hs-identifier hs-var">fakeExp</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133988"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span>      </span><span class="hs-comment">-- Compiling Bool</span><span>
</span><span id="line-516"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621681134004"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvBool"><span class="hs-identifier hs-var">ghcEnvBool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-517"></span><span>        </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primTrue"><span class="hs-identifier hs-var">primTrue</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primFalse"><span class="hs-identifier hs-var">primFalse</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Just to get the proper error for missing TRUE/FALSE</span><span>
</span><span id="line-518"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133967"><span class="annot"><span class="annottext">d :: Name
</span><a href="#local-6989586621681133967"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-519"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681133965"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133965"><span class="hs-identifier hs-var">true</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinTrue"><span class="hs-identifier hs-var">builtinTrue</span></a></span><span>
</span><span id="line-520"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681133964"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133964"><span class="hs-identifier hs-var">false</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinFalse"><span class="hs-identifier hs-var">builtinFalse</span></a></span><span>
</span><span id="line-521"></span><span>        </span><span id="local-6989586621681133963"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133963"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Decl)
-&gt; [QName]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Nat
-&gt; QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-var">compiledcondecl</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Nat
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133964"><span class="hs-identifier hs-var">false</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133965"><span class="hs-identifier hs-var">true</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-522"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">QName -&gt; FilePath -&gt; Nat -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledTypeSynonym"><span class="hs-identifier hs-var">compiledTypeSynonym</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Bool&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span>
</span><span id="line-523"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133967"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-var">HS.unit_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-524"></span><span>                   </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133963"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-525"></span><span>
</span><span id="line-526"></span><span>      </span><span class="hs-comment">-- Compiling List</span><span>
</span><span id="line-527"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dataPars :: Defn -&gt; Nat
</span><a href="Agda.TypeChecking.Monad.Base.html#dataPars"><span class="hs-identifier hs-var">dataPars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681133954"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133954"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621681134004"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvList"><span class="hs-identifier hs-var">ghcEnvList</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-528"></span><span>        </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primNil"><span class="hs-identifier hs-var">primNil</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primCons"><span class="hs-identifier hs-var">primCons</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Just to get the proper error for missing NIL/CONS</span><span>
</span><span id="line-529"></span><span>        </span><span class="annot"><span class="annottext">Maybe HaskellPragma
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
-&gt; (HaskellPragma
    -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. Maybe a -&gt; b -&gt; (a -&gt; b) -&gt; b
</span><a href="Agda.Utils.Maybe.html#caseMaybe"><span class="hs-identifier hs-var">caseMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621681134008"><span class="hs-identifier hs-var">pragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((HaskellPragma
  -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; (HaskellPragma
    -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681133950"><span class="annot"><span class="annottext">HaskellPragma
</span><a href="#local-6989586621681133950"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HaskellPragma
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *) x a.
(MonadTrace m, HasRange x) =&gt;
x -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-var">setCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellPragma
</span><a href="#local-6989586621681133950"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Warning -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *).
(HasCallStack, MonadWarning m) =&gt;
Warning -&gt; m ()
</span><a href="Agda.TypeChecking.Warnings.html#warning"><span class="hs-identifier hs-var">warning</span></a></span><span> </span><span class="annot"><span class="annottext">(Warning -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; (Doc -&gt; Warning)
-&gt; Doc
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Warning
</span><a href="Agda.TypeChecking.Monad.Base.html#GenericWarning"><span class="hs-identifier hs-var">GenericWarning</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Doc
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-530"></span><span>          </span><span class="annot"><span class="annottext">[ReaderT GHCModuleEnv (StateT HsCompileState TCM) Doc]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#fsep"><span class="hs-identifier hs-var">fsep</span></a></span><span> </span><span class="annot"><span class="annottext">([ReaderT GHCModuleEnv (StateT HsCompileState TCM) Doc]
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Doc)
-&gt; [ReaderT GHCModuleEnv (StateT HsCompileState TCM) Doc]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [ReaderT GHCModuleEnv (StateT HsCompileState TCM) Doc]
forall (m :: * -&gt; *). Applicative m =&gt; FilePath -&gt; [m Doc]
</span><a href="Agda.TypeChecking.Pretty.html#pwords"><span class="hs-identifier hs-var">pwords</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Ignoring GHC pragma for builtin lists; they always compile to Haskell lists.&quot;</span></span><span>
</span><span id="line-531"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133946"><span class="annot"><span class="annottext">d :: Name
</span><a href="#local-6989586621681133946"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-532"></span><span>            </span><span id="local-6989586621681133945"><span class="annot"><span class="annottext">t :: Name
</span><a href="#local-6989586621681133945"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#TypeK"><span class="hs-identifier hs-var">TypeK</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-533"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681133942"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133942"><span class="hs-identifier hs-var">nil</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinNil"><span class="hs-identifier hs-var">builtinNil</span></a></span><span>
</span><span id="line-534"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681133941"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133941"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinCons"><span class="hs-identifier hs-var">builtinCons</span></a></span><span>
</span><span id="line-535"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133936"><span class="annot"><span class="annottext">vars :: (Name -&gt; b) -&gt; Nat -&gt; [b]
</span><a href="#local-6989586621681133936"><span class="hs-identifier hs-var hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621681133935"><span class="annot"><span class="annottext">Name -&gt; b
</span><a href="#local-6989586621681133935"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681133934"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133934"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Nat -&gt; b) -&gt; [Nat] -&gt; [b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; b
</span><a href="#local-6989586621681133935"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; b) -&gt; (Nat -&gt; Name) -&gt; Nat -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-var">A</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133934"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-536"></span><span>        </span><span id="local-6989586621681133931"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133931"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Decl)
-&gt; [QName]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Nat
-&gt; QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-var">compiledcondecl</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Nat
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133942"><span class="hs-identifier hs-var">nil</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133941"><span class="hs-identifier hs-var">cons</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-537"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [TyVarBind] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeDecl"><span class="hs-identifier hs-var">HS.TypeDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133945"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; TyVarBind) -&gt; Nat -&gt; [TyVarBind]
forall {b}. (Name -&gt; b) -&gt; Nat -&gt; [b]
</span><a href="#local-6989586621681133936"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; TyVarBind
</span><a href="Agda.Utils.Haskell.Syntax.html#UnkindedVar"><span class="hs-identifier hs-var">HS.UnkindedVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133954"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeType"><span class="hs-identifier hs-var">HS.FakeType</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;[]&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-538"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133946"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Pat) -&gt; Nat -&gt; [Pat]
forall {b}. (Name -&gt; b) -&gt; Nat -&gt; [b]
</span><a href="#local-6989586621681133936"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-var">HS.PVar</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133954"><span class="hs-identifier hs-var">np</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-var">HS.unit_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-539"></span><span>                   </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133931"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span>      </span><span class="hs-comment">-- Compiling Maybe</span><span>
</span><span id="line-542"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dataPars :: Defn -&gt; Nat
</span><a href="Agda.TypeChecking.Monad.Base.html#dataPars"><span class="hs-identifier hs-var">dataPars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681133926"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133926"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621681134004"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvMaybe"><span class="hs-identifier hs-var">ghcEnvMaybe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-543"></span><span>        </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primNothing"><span class="hs-identifier hs-var">primNothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primJust"><span class="hs-identifier hs-var">primJust</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Just to get the proper error for missing NOTHING/JUST</span><span>
</span><span id="line-544"></span><span>        </span><span class="annot"><span class="annottext">Maybe HaskellPragma
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
-&gt; (HaskellPragma
    -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. Maybe a -&gt; b -&gt; (a -&gt; b) -&gt; b
</span><a href="Agda.Utils.Maybe.html#caseMaybe"><span class="hs-identifier hs-var">caseMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621681134008"><span class="hs-identifier hs-var">pragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((HaskellPragma
  -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; (HaskellPragma
    -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681133923"><span class="annot"><span class="annottext">HaskellPragma
</span><a href="#local-6989586621681133923"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HaskellPragma
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *) x a.
(MonadTrace m, HasRange x) =&gt;
x -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-var">setCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellPragma
</span><a href="#local-6989586621681133923"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Warning -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *).
(HasCallStack, MonadWarning m) =&gt;
Warning -&gt; m ()
</span><a href="Agda.TypeChecking.Warnings.html#warning"><span class="hs-identifier hs-var">warning</span></a></span><span> </span><span class="annot"><span class="annottext">(Warning -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; (Doc -&gt; Warning)
-&gt; Doc
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Warning
</span><a href="Agda.TypeChecking.Monad.Base.html#GenericWarning"><span class="hs-identifier hs-var">GenericWarning</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Doc
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-545"></span><span>          </span><span class="annot"><span class="annottext">[ReaderT GHCModuleEnv (StateT HsCompileState TCM) Doc]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#fsep"><span class="hs-identifier hs-var">fsep</span></a></span><span> </span><span class="annot"><span class="annottext">([ReaderT GHCModuleEnv (StateT HsCompileState TCM) Doc]
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Doc)
-&gt; [ReaderT GHCModuleEnv (StateT HsCompileState TCM) Doc]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [ReaderT GHCModuleEnv (StateT HsCompileState TCM) Doc]
forall (m :: * -&gt; *). Applicative m =&gt; FilePath -&gt; [m Doc]
</span><a href="Agda.TypeChecking.Pretty.html#pwords"><span class="hs-identifier hs-var">pwords</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Ignoring GHC pragma for builtin maybe; they always compile to Haskell lists.&quot;</span></span><span>
</span><span id="line-546"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133922"><span class="annot"><span class="annottext">d :: Name
</span><a href="#local-6989586621681133922"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-547"></span><span>            </span><span id="local-6989586621681133921"><span class="annot"><span class="annottext">t :: Name
</span><a href="#local-6989586621681133921"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#TypeK"><span class="hs-identifier hs-var">TypeK</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-548"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681133920"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133920"><span class="hs-identifier hs-var">nothing</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinNothing"><span class="hs-identifier hs-var">builtinNothing</span></a></span><span>
</span><span id="line-549"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681133919"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133919"><span class="hs-identifier hs-var">just</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinJust"><span class="hs-identifier hs-var">builtinJust</span></a></span><span>
</span><span id="line-550"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133914"><span class="annot"><span class="annottext">vars :: (Name -&gt; b) -&gt; Nat -&gt; [b]
</span><a href="#local-6989586621681133914"><span class="hs-identifier hs-var hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621681133913"><span class="annot"><span class="annottext">Name -&gt; b
</span><a href="#local-6989586621681133913"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681133912"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133912"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Nat -&gt; b) -&gt; [Nat] -&gt; [b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; b
</span><a href="#local-6989586621681133913"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; b) -&gt; (Nat -&gt; Name) -&gt; Nat -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-var">A</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133912"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-551"></span><span>        </span><span id="local-6989586621681133911"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133911"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Decl)
-&gt; [QName]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Nat
-&gt; QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-var">compiledcondecl</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Nat
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133920"><span class="hs-identifier hs-var">nothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133919"><span class="hs-identifier hs-var">just</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-552"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [TyVarBind] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeDecl"><span class="hs-identifier hs-var">HS.TypeDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133921"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; TyVarBind) -&gt; Nat -&gt; [TyVarBind]
forall {b}. (Name -&gt; b) -&gt; Nat -&gt; [b]
</span><a href="#local-6989586621681133914"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; TyVarBind
</span><a href="Agda.Utils.Haskell.Syntax.html#UnkindedVar"><span class="hs-identifier hs-var">HS.UnkindedVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133926"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeType"><span class="hs-identifier hs-var">HS.FakeType</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Maybe&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-553"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133922"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Pat) -&gt; Nat -&gt; [Pat]
forall {b}. (Name -&gt; b) -&gt; Nat -&gt; [b]
</span><a href="#local-6989586621681133914"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-var">HS.PVar</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133926"><span class="hs-identifier hs-var">np</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-var">HS.unit_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-554"></span><span>                   </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133911"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-555"></span><span>
</span><span id="line-556"></span><span>      </span><span class="hs-comment">-- Compiling Inf</span><span>
</span><span id="line-557"></span><span>      </span><span class="annot"><span class="annottext">Defn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621681134004"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvInf"><span class="hs-identifier hs-var">ghcEnvInf</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-558"></span><span>        </span><span class="annot"><span class="annottext">Term
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primSharp"><span class="hs-identifier hs-var">primSharp</span></a></span><span> </span><span class="hs-comment">-- To get a proper error for missing SHARP.</span><span>
</span><span id="line-559"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681133909"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133909"><span class="hs-identifier hs-var">sharp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinSharp"><span class="hs-identifier hs-var">builtinSharp</span></a></span><span>
</span><span id="line-560"></span><span>        </span><span id="local-6989586621681133908"><span class="annot"><span class="annottext">Decl
</span><a href="#local-6989586621681133908"><span class="hs-identifier hs-var">sharpC</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Nat
-&gt; QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-var">compiledcondecl</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Nat
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133909"><span class="hs-identifier hs-var">sharp</span></a></span><span>
</span><span id="line-561"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133907"><span class="annot"><span class="annottext">d :: Name
</span><a href="#local-6989586621681133907"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-562"></span><span>            </span><span id="local-6989586621681133905"><span class="annot"><span class="annottext">err :: FilePath
</span><a href="#local-6989586621681133905"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;No term-level implementation of the INFINITY builtin.&quot;</span></span><span>
</span><span id="line-563"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">QName -&gt; FilePath -&gt; Nat -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledTypeSynonym"><span class="hs-identifier hs-var">compiledTypeSynonym</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;MAlonzo.RTE.Infinity&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span>
</span><span id="line-564"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133907"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-var">HS.PVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-565"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeExp"><span class="hs-identifier hs-var">HS.FakeExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;error &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133905"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-566"></span><span>                       </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-567"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Decl
</span><a href="#local-6989586621681133908"><span class="hs-identifier hs-var">sharpC</span></a></span><span>
</span><span id="line-568"></span><span>                   </span><span class="hs-special">]</span><span>
</span><span id="line-569"></span><span>
</span><span id="line-570"></span><span>      </span><span class="hs-comment">-- The interval is compiled as the type of booleans: 0 is</span><span>
</span><span id="line-571"></span><span>      </span><span class="hs-comment">-- compiled as False and 1 as True.</span><span>
</span><span id="line-572"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621681134004"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvInterval"><span class="hs-identifier hs-var">ghcEnvInterval</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-573"></span><span>        </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primIZero"><span class="hs-identifier hs-var">primIZero</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primIOne"><span class="hs-identifier hs-var">primIOne</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-574"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681133899"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133899"><span class="hs-identifier hs-var">i0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinIZero"><span class="hs-identifier hs-var">builtinIZero</span></a></span><span>
</span><span id="line-575"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681133898"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133898"><span class="hs-identifier hs-var">i1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinIOne"><span class="hs-identifier hs-var">builtinIOne</span></a></span><span>
</span><span id="line-576"></span><span>        </span><span id="local-6989586621681133897"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133897"><span class="hs-identifier hs-var">cs</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Decl)
-&gt; [QName]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Nat
-&gt; QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-var">compiledcondecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat -&gt; Maybe Nat
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133899"><span class="hs-identifier hs-var">i0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133898"><span class="hs-identifier hs-var">i1</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-577"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-578"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">QName -&gt; FilePath -&gt; Nat -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledTypeSynonym"><span class="hs-identifier hs-var">compiledTypeSynonym</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Bool&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span>
</span><span id="line-579"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span>
</span><span id="line-580"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-581"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-var">HS.unit_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-582"></span><span>          </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-583"></span><span>          </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133897"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-584"></span><span>
</span><span id="line-585"></span><span>      </span><span class="hs-comment">-- IsOne is compiled as the constant function to the unit type.</span><span>
</span><span id="line-586"></span><span>      </span><span class="hs-comment">-- Partial/PartialP are compiled as functions from the unit type</span><span>
</span><span id="line-587"></span><span>      </span><span class="hs-comment">-- to the underlying type.</span><span>
</span><span id="line-588"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621681134004"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsOne"><span class="hs-identifier hs-var">ghcEnvIsOne</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-589"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-590"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [TyVarBind] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeDecl"><span class="hs-identifier hs-var">HS.TypeDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#TypeK"><span class="hs-identifier hs-var">TypeK</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; TyVarBind
</span><a href="Agda.Utils.Haskell.Syntax.html#UnkindedVar"><span class="hs-identifier hs-var">HS.UnkindedVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-591"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeType"><span class="hs-identifier hs-var">HS.FakeType</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;()&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-592"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span>
</span><span id="line-593"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-594"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-var">HS.unit_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-595"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-596"></span><span>
</span><span id="line-597"></span><span>      </span><span class="hs-comment">-- itIsOne.</span><span>
</span><span id="line-598"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621681134004"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvItIsOne"><span class="hs-identifier hs-var">ghcEnvItIsOne</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-599"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-600"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span>
</span><span id="line-601"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-602"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-var">HS.unit_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-603"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-604"></span><span>
</span><span id="line-605"></span><span>      </span><span class="hs-comment">-- IsOne1/IsOne2.</span><span>
</span><span id="line-606"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621681134004"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsOne1"><span class="hs-identifier hs-var">ghcEnvIsOne1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621681134004"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsOne2"><span class="hs-identifier hs-var">ghcEnvIsOne2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-607"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-608"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span>
</span><span id="line-609"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-610"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeExp"><span class="hs-identifier hs-var">HS.FakeExp</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;\\_ _ _ -&gt; ()&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>                 </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-612"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-613"></span><span>
</span><span id="line-614"></span><span>      </span><span class="hs-comment">-- isOneEmpty.</span><span>
</span><span id="line-615"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621681134004"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsOneEmpty"><span class="hs-identifier hs-var">ghcEnvIsOneEmpty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-616"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-617"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span>
</span><span id="line-618"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-619"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeExp"><span class="hs-identifier hs-var">HS.FakeExp</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;\\_ x _ -&gt; x ()&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-620"></span><span>                 </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-621"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-622"></span><span>
</span><span id="line-623"></span><span>      </span><span class="hs-comment">-- PathP is compiled as a function from the interval (booleans)</span><span>
</span><span id="line-624"></span><span>      </span><span class="hs-comment">-- to the underlying type.</span><span>
</span><span id="line-625"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621681134004"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvPathP"><span class="hs-identifier hs-var">ghcEnvPathP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-626"></span><span>        </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primInterval"><span class="hs-identifier hs-var">primInterval</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-627"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681133895"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133895"><span class="hs-identifier hs-var">int</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinInterval"><span class="hs-identifier hs-var">builtinInterval</span></a></span><span>
</span><span id="line-628"></span><span>        </span><span id="local-6989586621681133894"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133894"><span class="hs-identifier hs-var">int</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameKind
-&gt; QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#xhqn"><span class="hs-identifier hs-var">xhqn</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#TypeK"><span class="hs-identifier hs-var">TypeK</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133895"><span class="hs-identifier hs-var">int</span></a></span><span>
</span><span id="line-629"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-630"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [TyVarBind] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeDecl"><span class="hs-identifier hs-var">HS.TypeDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#TypeK"><span class="hs-identifier hs-var">TypeK</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-631"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; TyVarBind
</span><a href="Agda.Utils.Haskell.Syntax.html#UnkindedVar"><span class="hs-identifier hs-var">HS.UnkindedVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133892"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681133892"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133892"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">3</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-632"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyFun"><span class="hs-identifier hs-var">HS.TyFun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyCon"><span class="hs-identifier hs-var">HS.TyCon</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133894"><span class="hs-identifier hs-var">int</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazAnyType"><span class="hs-identifier hs-var">mazAnyType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span>
</span><span id="line-634"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-635"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeExp"><span class="hs-identifier hs-var">HS.FakeExp</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;\\_ _ _ _ -&gt; ()&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-636"></span><span>                 </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-637"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-638"></span><span>
</span><span id="line-639"></span><span>      </span><span class="hs-comment">-- Sub is compiled as the underlying type.</span><span>
</span><span id="line-640"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621681134004"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvSub"><span class="hs-identifier hs-var">ghcEnvSub</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-641"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-642"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [TyVarBind] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeDecl"><span class="hs-identifier hs-var">HS.TypeDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#TypeK"><span class="hs-identifier hs-var">TypeK</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-643"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; TyVarBind
</span><a href="Agda.Utils.Haskell.Syntax.html#UnkindedVar"><span class="hs-identifier hs-var">HS.UnkindedVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133888"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681133888"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133888"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">3</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-644"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyVar"><span class="hs-identifier hs-var">HS.TyVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-645"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span>
</span><span id="line-646"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-647"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeExp"><span class="hs-identifier hs-var">HS.FakeExp</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;\\_ _ _ _ -&gt; ()&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-648"></span><span>                 </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-649"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-650"></span><span>
</span><span id="line-651"></span><span>      </span><span class="hs-comment">-- subIn.</span><span>
</span><span id="line-652"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621681134004"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvSubIn"><span class="hs-identifier hs-var">ghcEnvSubIn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-653"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-654"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span>
</span><span id="line-655"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-656"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeExp"><span class="hs-identifier hs-var">HS.FakeExp</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;\\_ _ _ x -&gt; x&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span>                 </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-658"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-659"></span><span>
</span><span id="line-660"></span><span>      </span><span class="hs-comment">-- Id&#160;x&#160;y is compiled as a pair of a boolean and whatever</span><span>
</span><span id="line-661"></span><span>      </span><span class="hs-comment">-- Path&#160;x&#160;y is compiled to.</span><span>
</span><span id="line-662"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621681134004"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvId"><span class="hs-identifier hs-var">ghcEnvId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-663"></span><span>        </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primInterval"><span class="hs-identifier hs-var">primInterval</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-664"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681133886"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133886"><span class="hs-identifier hs-var">int</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
FilePath -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Syntax.Builtin.html#builtinInterval"><span class="hs-identifier hs-var">builtinInterval</span></a></span><span>
</span><span id="line-665"></span><span>        </span><span id="local-6989586621681133885"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133885"><span class="hs-identifier hs-var">int</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameKind
-&gt; QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#xhqn"><span class="hs-identifier hs-var">xhqn</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#TypeK"><span class="hs-identifier hs-var">TypeK</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133886"><span class="hs-identifier hs-var">int</span></a></span><span>
</span><span id="line-666"></span><span>        </span><span class="hs-comment">-- re  #3733: implement reflId</span><span>
</span><span id="line-667"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-668"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [TyVarBind] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeDecl"><span class="hs-identifier hs-var">HS.TypeDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#TypeK"><span class="hs-identifier hs-var">TypeK</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-669"></span><span>              </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- [HS.UnkindedVar (ihname A i) | i &lt;- [0..3]]</span><span>
</span><span id="line-670"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyApp"><span class="hs-identifier hs-var">HS.TyApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeType"><span class="hs-identifier hs-var">HS.FakeType</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;(,) Bool&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-671"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyFun"><span class="hs-identifier hs-var">HS.TyFun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyCon"><span class="hs-identifier hs-var">HS.TyCon</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133885"><span class="hs-identifier hs-var">int</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazAnyType"><span class="hs-identifier hs-var">mazAnyType</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-672"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span>
</span><span id="line-673"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-674"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeExp"><span class="hs-identifier hs-var">HS.FakeExp</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;\\_ _ _ _ -&gt; ()&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-675"></span><span>                 </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-676"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-677"></span><span>
</span><span id="line-678"></span><span>      </span><span class="hs-comment">-- conid.</span><span>
</span><span id="line-679"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Primitive"><span class="hs-identifier hs-type">Primitive</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(GHCEnv -&gt; Maybe QName) -&gt; Bool
</span><a href="#local-6989586621681134004"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvConId"><span class="hs-identifier hs-var">ghcEnvConId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-680"></span><span>        </span><span id="local-6989586621681133882"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133882"><span class="hs-identifier hs-var">strict</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GHCOptions -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcStrictData"><span class="hs-identifier hs-var">optGhcStrictData</span></a></span><span> </span><span class="annot"><span class="annottext">(GHCOptions -&gt; Bool)
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) GHCOptions
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) GHCOptions
forall (m :: * -&gt; *). ReadGHCOpts m =&gt; m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var">askGhcOpts</span></a></span><span>
</span><span id="line-681"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133881"><span class="annot"><span class="annottext">var :: Name -&gt; Pat
</span><a href="#local-6989586621681133881"><span class="hs-identifier hs-var hs-var">var</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133882"><span class="hs-identifier hs-var">strict</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PBangPat"><span class="hs-identifier hs-var">HS.PBangPat</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Pat
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Pat -&gt; Pat) -&gt; (Name -&gt; Pat) -&gt; Name -&gt; Pat
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-var">HS.PVar</span></a></span><span>
</span><span id="line-682"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-683"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span>
</span><span id="line-684"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-685"></span><span>                 </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="#local-6989586621681133881"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133878"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681133878"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133878"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-686"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Rhs) -&gt; Exp -&gt; Rhs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-687"></span><span>                  </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-identifier hs-var">HS.App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-identifier hs-var">HS.App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeExp"><span class="hs-identifier hs-var">HS.FakeExp</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;(,)&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-688"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-var">HS.UnQual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-689"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-var">HS.UnQual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-690"></span><span>                 </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-691"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-692"></span><span>
</span><span id="line-693"></span><span>      </span><span class="hs-comment">-- TC builtins are compiled to erased, which is an &#8734;-ary</span><span>
</span><span id="line-694"></span><span>      </span><span class="hs-comment">-- function.</span><span>
</span><span id="line-695"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; QName -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvIsTCBuiltin"><span class="hs-identifier hs-var">ghcEnvIsTCBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621681134006"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-696"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-697"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span>
</span><span id="line-698"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-699"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeExp"><span class="hs-identifier hs-var">HS.FakeExp</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazErasedName"><span class="hs-identifier hs-var">mazErasedName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-700"></span><span>                 </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-701"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-702"></span><span>
</span><span id="line-703"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#DataOrRecSig"><span class="hs-identifier hs-type">DataOrRecSig</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ReaderT
  GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-704"></span><span>
</span><span id="line-705"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-706"></span><span>        </span><span id="local-6989586621681133872"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133872"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM Nat -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Nat
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM Nat -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Nat)
-&gt; TCM Nat -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Nat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCM Nat
</span><a href="Agda.TypeChecking.Telescope.html#typeArity"><span class="hs-identifier hs-var">typeArity</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681134014"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-707"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">QName -&gt; FilePath -&gt; Nat -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledTypeSynonym"><span class="hs-identifier hs-var">compiledTypeSynonym</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133870"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133872"><span class="hs-identifier hs-var">ar</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HsType"><span class="hs-identifier hs-type">HsType</span></a></span><span> </span><span id="local-6989586621681133868"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681133868"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681133870"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133870"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621681134008"><span class="hs-identifier hs-var">pragma</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-708"></span><span>                   </span><span class="annot"><span class="annottext">Exp -&gt; [Decl]
</span><a href="#local-6989586621681133867"><span class="hs-identifier hs-var">fb</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133866"><span class="hs-identifier hs-var">axiomErr</span></a></span><span>
</span><span id="line-709"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Primitive"><span class="hs-identifier hs-type">Primitive</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">primName :: Defn -&gt; FilePath
</span><a href="Agda.TypeChecking.Monad.Base.html#primName"><span class="hs-identifier hs-var">primName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681133864"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133864"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UsesFloat
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Decl] -&gt; (UsesFloat, [Decl]))
-&gt; (Exp -&gt; [Decl]) -&gt; Exp -&gt; (UsesFloat, [Decl])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Decl]
</span><a href="#local-6989586621681133867"><span class="hs-identifier hs-var">fb</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; (UsesFloat, [Decl]))
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCM Exp -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM Exp -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp)
-&gt; (FilePath -&gt; TCM Exp)
-&gt; FilePath
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; TCM Exp
forall (m :: * -&gt; *). MonadTCError m =&gt; FilePath -&gt; m Exp
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#primBody"><span class="hs-identifier hs-var">primBody</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133864"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-710"></span><span>
</span><span id="line-711"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#PrimitiveSort"><span class="hs-identifier hs-type">PrimitiveSort</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">primName :: Defn -&gt; FilePath
</span><a href="Agda.TypeChecking.Monad.Base.html#primName"><span class="hs-identifier hs-var">primName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681133861"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133861"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-712"></span><span>
</span><span id="line-713"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
</span><a href="#local-6989586621681133859"><span class="hs-identifier hs-var">function</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621681134008"><span class="hs-identifier hs-var">pragma</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
</span><a href="#local-6989586621681133858"><span class="hs-identifier hs-var">functionViaTreeless</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-714"></span><span>
</span><span id="line-715"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dataPars :: Defn -&gt; Nat
</span><a href="Agda.TypeChecking.Monad.Base.html#dataPars"><span class="hs-identifier hs-var">dataPars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681133857"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133857"><span class="hs-identifier hs-var">np</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dataIxs :: Defn -&gt; Nat
</span><a href="Agda.TypeChecking.Monad.Base.html#dataIxs"><span class="hs-identifier hs-var">dataIxs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681133855"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133855"><span class="hs-identifier hs-var">ni</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dataClause :: Defn -&gt; Maybe Clause
</span><a href="Agda.TypeChecking.Monad.Base.html#dataClause"><span class="hs-identifier hs-var">dataClause</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681133853"><span class="annot"><span class="annottext">Maybe Clause
</span><a href="#local-6989586621681133853"><span class="hs-identifier hs-var">cl</span></a></span></span><span>
</span><span id="line-716"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dataPathCons :: Defn -&gt; [QName]
</span><a href="Agda.TypeChecking.Monad.Base.html#dataPathCons"><span class="hs-identifier hs-var">dataPathCons</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681133851"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681133851"><span class="hs-identifier hs-var">pcs</span></a></span></span><span>
</span><span id="line-717"></span><span>              </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681133850"><span class="annot"><span class="annottext">hsdata :: HaskellPragma
</span><a href="#local-6989586621681133850"><span class="hs-identifier hs-var">hsdata</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HsData"><span class="hs-identifier hs-type">HsData</span></a></span><span> </span><span id="local-6989586621681133849"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681133849"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681133848"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133848"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621681133847"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681133847"><span class="hs-identifier hs-var">hsCons</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621681134008"><span class="hs-identifier hs-var">pragma</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-718"></span><span>        </span><span class="annot"><span class="annottext">Range
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) x a.
(MonadTrace m, HasRange x) =&gt;
x -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-var">setCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681133849"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-719"></span><span>        </span><span class="annot"><span class="annottext">FilePath
-&gt; Nat
-&gt; TCM Doc
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
FilePath -&gt; Nat -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;compile.ghc.definition&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; TCM Doc -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCM Doc] -&gt; TCM Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="annot"><span class="annottext">([TCM Doc] -&gt; TCM Doc) -&gt; [TCM Doc] -&gt; TCM Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-720"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;Compiling data type with COMPILE pragma ...&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HaskellPragma -&gt; TCM Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellPragma
</span><a href="#local-6989586621681133850"><span class="hs-identifier hs-var">hsdata</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-721"></span><span>        </span><span class="annot"><span class="annottext">TCM () -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; TCM () -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM ()
</span><a href="Agda.Compiler.Treeless.Erase.html#computeErasedConstructorArgs"><span class="hs-identifier hs-var">computeErasedConstructorArgs</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-722"></span><span>        </span><span id="local-6989586621681133844"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681133844"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM [QName]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [QName]
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM [QName]
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [QName])
-&gt; TCM [QName]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [QName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM [QName]
</span><a href="Agda.TypeChecking.Datatypes.html#getNotErasedConstructors"><span class="hs-identifier hs-var">getNotErasedConstructors</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-723"></span><span>        </span><span id="local-6989586621681133842"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133842"><span class="hs-identifier hs-var">ccscov</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName
-&gt; Nat
-&gt; [QName]
-&gt; FilePath
-&gt; [FilePath]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#constructorCoverageCode"><span class="hs-identifier hs-var">constructorCoverageCode</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133857"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133855"><span class="hs-identifier hs-var">ni</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681133844"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133848"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681133847"><span class="hs-identifier hs-var">hsCons</span></a></span><span>
</span><span id="line-724"></span><span>        </span><span id="local-6989586621681133839"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133839"><span class="hs-identifier hs-var">cds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Decl)
-&gt; [QName]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Nat
-&gt; QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-var">compiledcondecl</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Nat
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681133844"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-725"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133838"><span class="annot"><span class="annottext">result :: [Decl]
</span><a href="#local-6989586621681133838"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Decl]] -&gt; [Decl]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[Decl]] -&gt; [Decl]) -&gt; [[Decl]] -&gt; [Decl]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-726"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Induction -&gt; Nat -&gt; [ConDecl] -&gt; Maybe Clause -&gt; [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#tvaldecl"><span class="hs-identifier hs-var">tvaldecl</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.html#Inductive"><span class="hs-identifier hs-var">Inductive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133857"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133855"><span class="hs-identifier hs-var">ni</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Clause -&gt; Maybe Clause
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Clause
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-727"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">QName -&gt; FilePath -&gt; Nat -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledTypeSynonym"><span class="hs-identifier hs-var">compiledTypeSynonym</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133848"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133857"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-728"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133839"><span class="hs-identifier hs-var">cds</span></a></span><span>
</span><span id="line-729"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133842"><span class="hs-identifier hs-var">ccscov</span></a></span><span>
</span><span id="line-730"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-731"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133838"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-732"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dataPars :: Defn -&gt; Nat
</span><a href="Agda.TypeChecking.Monad.Base.html#dataPars"><span class="hs-identifier hs-var">dataPars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681133834"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133834"><span class="hs-identifier hs-var">np</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dataIxs :: Defn -&gt; Nat
</span><a href="Agda.TypeChecking.Monad.Base.html#dataIxs"><span class="hs-identifier hs-var">dataIxs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681133833"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133833"><span class="hs-identifier hs-var">ni</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dataClause :: Defn -&gt; Maybe Clause
</span><a href="Agda.TypeChecking.Monad.Base.html#dataClause"><span class="hs-identifier hs-var">dataClause</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681133832"><span class="annot"><span class="annottext">Maybe Clause
</span><a href="#local-6989586621681133832"><span class="hs-identifier hs-var">cl</span></a></span></span><span>
</span><span id="line-733"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dataPathCons :: Defn -&gt; [QName]
</span><a href="Agda.TypeChecking.Monad.Base.html#dataPathCons"><span class="hs-identifier hs-var">dataPathCons</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681133831"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681133831"><span class="hs-identifier hs-var">pcs</span></a></span></span><span>
</span><span id="line-734"></span><span>              </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-735"></span><span>        </span><span class="annot"><span class="annottext">TCM () -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; TCM () -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM ()
</span><a href="Agda.Compiler.Treeless.Erase.html#computeErasedConstructorArgs"><span class="hs-identifier hs-var">computeErasedConstructorArgs</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-736"></span><span>        </span><span id="local-6989586621681133830"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681133830"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM [QName]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [QName]
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM [QName]
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [QName])
-&gt; TCM [QName]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [QName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM [QName]
</span><a href="Agda.TypeChecking.Datatypes.html#getNotErasedConstructors"><span class="hs-identifier hs-var">getNotErasedConstructors</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-737"></span><span>        </span><span id="local-6989586621681133829"><span class="annot"><span class="annottext">[ConDecl]
</span><a href="#local-6989586621681133829"><span class="hs-identifier hs-var">cds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ConDecl)
-&gt; [QName]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [ConDecl]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(QName
 -&gt; Induction
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ConDecl)
-&gt; Induction
-&gt; QName
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ConDecl
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">QName
-&gt; Induction
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ConDecl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#condecl"><span class="hs-identifier hs-var">condecl</span></a></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.html#Inductive"><span class="hs-identifier hs-var">Inductive</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681133830"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-738"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Induction -&gt; Nat -&gt; [ConDecl] -&gt; Maybe Clause -&gt; [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#tvaldecl"><span class="hs-identifier hs-var">tvaldecl</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.html#Inductive"><span class="hs-identifier hs-var">Inductive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133834"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133833"><span class="hs-identifier hs-var">ni</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ConDecl]
</span><a href="#local-6989586621681133829"><span class="hs-identifier hs-var">cds</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Clause
</span><a href="#local-6989586621681133832"><span class="hs-identifier hs-var">cl</span></a></span><span>
</span><span id="line-739"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Constructor"><span class="hs-identifier hs-type">Constructor</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-740"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#GeneralizableVar"><span class="hs-identifier hs-type">GeneralizableVar</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-741"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Record"><span class="hs-identifier hs-type">Record</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">recPars :: Defn -&gt; Nat
</span><a href="Agda.TypeChecking.Monad.Base.html#recPars"><span class="hs-identifier hs-var">recPars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681133823"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133823"><span class="hs-identifier hs-var">np</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recClause :: Defn -&gt; Maybe Clause
</span><a href="Agda.TypeChecking.Monad.Base.html#recClause"><span class="hs-identifier hs-var">recClause</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681133821"><span class="annot"><span class="annottext">Maybe Clause
</span><a href="#local-6989586621681133821"><span class="hs-identifier hs-var">cl</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recConHead :: Defn -&gt; ConHead
</span><a href="Agda.TypeChecking.Monad.Base.html#recConHead"><span class="hs-identifier hs-var">recConHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681133819"><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681133819"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-742"></span><span>              </span><span class="annot"><span class="annottext">recInduction :: Defn -&gt; Maybe Induction
</span><a href="Agda.TypeChecking.Monad.Base.html#recInduction"><span class="hs-identifier hs-var">recInduction</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681133817"><span class="annot"><span class="annottext">Maybe Induction
</span><a href="#local-6989586621681133817"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-743"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- Non-recursive record types are treated as being</span><span>
</span><span id="line-744"></span><span>            </span><span class="hs-comment">-- inductive.</span><span>
</span><span id="line-745"></span><span>            </span><span id="local-6989586621681133816"><span class="annot"><span class="annottext">inductionKind :: Induction
</span><a href="#local-6989586621681133816"><span class="hs-identifier hs-var hs-var">inductionKind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Induction -&gt; Maybe Induction -&gt; Induction
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.html#Inductive"><span class="hs-identifier hs-var">Inductive</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Induction
</span><a href="#local-6989586621681133817"><span class="hs-identifier hs-var">ind</span></a></span><span>
</span><span id="line-746"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621681134008"><span class="hs-identifier hs-var">pragma</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-747"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HsData"><span class="hs-identifier hs-type">HsData</span></a></span><span> </span><span id="local-6989586621681133815"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681133815"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681133814"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133814"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621681133813"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681133813"><span class="hs-identifier hs-var">hsCons</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) x a.
(MonadTrace m, HasRange x) =&gt;
x -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-var">setCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681133815"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-748"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133812"><span class="annot"><span class="annottext">cs :: [QName]
</span><a href="#local-6989586621681133812"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ConHead -&gt; QName
</span><a href="Agda.Syntax.Internal.html#conName"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681133819"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-749"></span><span>            </span><span class="annot"><span class="annottext">TCM () -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; TCM () -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM ()
</span><a href="Agda.Compiler.Treeless.Erase.html#computeErasedConstructorArgs"><span class="hs-identifier hs-var">computeErasedConstructorArgs</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-750"></span><span>            </span><span id="local-6989586621681133810"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133810"><span class="hs-identifier hs-var">ccscov</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName
-&gt; Nat
-&gt; [QName]
-&gt; FilePath
-&gt; [FilePath]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#constructorCoverageCode"><span class="hs-identifier hs-var">constructorCoverageCode</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133823"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681133812"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133814"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681133813"><span class="hs-identifier hs-var">hsCons</span></a></span><span>
</span><span id="line-751"></span><span>            </span><span id="local-6989586621681133809"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133809"><span class="hs-identifier hs-var">cds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Decl)
-&gt; [QName]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Nat
-&gt; QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-var">compiledcondecl</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Nat
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681133812"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-752"></span><span>            </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-753"></span><span>              </span><span class="annot"><span class="annottext">QName -&gt; Induction -&gt; Nat -&gt; [ConDecl] -&gt; Maybe Clause -&gt; [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#tvaldecl"><span class="hs-identifier hs-var">tvaldecl</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621681133816"><span class="hs-identifier hs-var">inductionKind</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133823"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Clause -&gt; Maybe Clause
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Clause
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-754"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">QName -&gt; FilePath -&gt; Nat -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledTypeSynonym"><span class="hs-identifier hs-var">compiledTypeSynonym</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133814"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133823"><span class="hs-identifier hs-var">np</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133809"><span class="hs-identifier hs-var">cds</span></a></span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133810"><span class="hs-identifier hs-var">ccscov</span></a></span><span>
</span><span id="line-755"></span><span>          </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-756"></span><span>            </span><span class="annot"><span class="annottext">TCM () -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; TCM () -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM ()
</span><a href="Agda.Compiler.Treeless.Erase.html#computeErasedConstructorArgs"><span class="hs-identifier hs-var">computeErasedConstructorArgs</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-757"></span><span>            </span><span id="local-6989586621681133808"><span class="annot"><span class="annottext">ConDecl
</span><a href="#local-6989586621681133808"><span class="hs-identifier hs-var">cd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName
-&gt; Induction
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ConDecl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#condecl"><span class="hs-identifier hs-var">condecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConHead -&gt; QName
</span><a href="Agda.Syntax.Internal.html#conName"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681133819"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621681133816"><span class="hs-identifier hs-var">inductionKind</span></a></span><span>
</span><span id="line-758"></span><span>            </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall {m :: * -&gt; *} {a} {b}. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621681133994"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Induction -&gt; Nat -&gt; [ConDecl] -&gt; Maybe Clause -&gt; [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#tvaldecl"><span class="hs-identifier hs-var">tvaldecl</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621681133816"><span class="hs-identifier hs-var">inductionKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Nat
</span><a href="Agda.Syntax.Internal.html#arity"><span class="hs-identifier hs-var">I.arity</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681134014"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ConDecl
</span><a href="#local-6989586621681133808"><span class="hs-identifier hs-var">cd</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe Clause
</span><a href="#local-6989586621681133821"><span class="hs-identifier hs-var">cl</span></a></span><span>
</span><span id="line-759"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#AbstractDefn"><span class="hs-identifier hs-type">AbstractDefn</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ReaderT
  GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-760"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-761"></span><span>  </span><span class="annot"><a href="#local-6989586621681133859"><span class="hs-identifier hs-type">function</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HaskellPragma"><span class="hs-identifier hs-type">HaskellPragma</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-762"></span><span>  </span><span id="local-6989586621681133859"><span class="annot"><span class="annottext">function :: Maybe HaskellPragma
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
</span><a href="#local-6989586621681133859"><span class="hs-identifier hs-var hs-var">function</span></a></span></span><span> </span><span id="local-6989586621681133805"><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621681133805"><span class="hs-identifier hs-var">mhe</span></a></span></span><span> </span><span id="local-6989586621681133804"><span class="annot"><span class="annottext">ReaderT
  GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
</span><a href="#local-6989586621681133804"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-763"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681133803"><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621681133803"><span class="hs-identifier hs-var">imp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681133802"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133802"><span class="hs-identifier hs-var">ccls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT
  GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
</span><a href="#local-6989586621681133804"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-764"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621681133805"><span class="hs-identifier hs-var">mhe</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-765"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HsExport"><span class="hs-identifier hs-type">HsExport</span></a></span><span> </span><span id="local-6989586621681133800"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681133800"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681133799"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133799"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) x a.
(MonadTrace m, HasRange x) =&gt;
x -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-var">setCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681133800"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-766"></span><span>        </span><span id="local-6989586621681133798"><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621681133798"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) GHCEnv
forall (m :: * -&gt; *). ReadGHCModuleEnv m =&gt; m GHCEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#askGHCEnv"><span class="hs-identifier hs-var">askGHCEnv</span></a></span><span>
</span><span id="line-767"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; Maybe QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvFlat"><span class="hs-identifier hs-var">ghcEnvFlat</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621681133798"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-768"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
FilePath -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#genericError"><span class="hs-identifier hs-var">genericError</span></a></span><span>
</span><span id="line-769"></span><span>              </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;\&quot;COMPILE GHC as\&quot; pragmas are not allowed for the FLAT builtin.&quot;</span></span><span>
</span><span id="line-770"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-771"></span><span>          </span><span id="local-6989586621681133797"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681133797"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Range -&gt; HsCompileM Type -&gt; HsCompileM Type
forall (m :: * -&gt; *) x a.
(MonadTrace m, HasRange x) =&gt;
x -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-var">setCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681133800"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(HsCompileM Type -&gt; HsCompileM Type)
-&gt; HsCompileM Type -&gt; HsCompileM Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; HsCompileM Type
</span><a href="Agda.Compiler.MAlonzo.HaskellTypes.html#haskellType"><span class="hs-identifier hs-var">haskellType</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-772"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621681133796"><span class="hs-identifier hs-type">tsig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span>
</span><span id="line-773"></span><span>              </span><span id="local-6989586621681133796"><span class="annot"><span class="annottext">tsig :: Decl
</span><a href="#local-6989586621681133796"><span class="hs-identifier hs-var hs-var">tsig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeSig"><span class="hs-identifier hs-var">HS.TypeSig</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133799"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681133797"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-774"></span><span>
</span><span id="line-775"></span><span>              </span><span class="annot"><a href="#local-6989586621681133794"><span class="hs-identifier hs-type">def</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span>
</span><span id="line-776"></span><span>              </span><span id="local-6989586621681133794"><span class="annot"><span class="annottext">def :: Decl
</span><a href="#local-6989586621681133794"><span class="hs-identifier hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133799"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hsCoerce"><span class="hs-identifier hs-var">hsCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp) -&gt; Exp -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsVarUQ"><span class="hs-identifier hs-var">hsVarUQ</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Exp) -&gt; Name -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-777"></span><span>          </span><span class="annot"><span class="annottext">(UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621681133803"><span class="hs-identifier hs-var">imp</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Decl
</span><a href="#local-6989586621681133796"><span class="hs-identifier hs-var">tsig</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Decl
</span><a href="#local-6989586621681133794"><span class="hs-identifier hs-var">def</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133802"><span class="hs-identifier hs-var">ccls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-778"></span><span>      </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621681133803"><span class="hs-identifier hs-var">imp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133802"><span class="hs-identifier hs-var">ccls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-779"></span><span>
</span><span id="line-780"></span><span>  </span><span class="annot"><a href="#local-6989586621681133858"><span class="hs-identifier hs-type">functionViaTreeless</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-781"></span><span>  </span><span id="local-6989586621681133858"><span class="annot"><span class="annottext">functionViaTreeless :: QName
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
</span><a href="#local-6989586621681133858"><span class="hs-identifier hs-var hs-var">functionViaTreeless</span></a></span></span><span> </span><span id="local-6989586621681133791"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133791"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-782"></span><span>    </span><span id="local-6989586621681133790"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133790"><span class="hs-identifier hs-var">strict</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GHCOptions -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcStrict"><span class="hs-identifier hs-var">optGhcStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(GHCOptions -&gt; Bool)
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) GHCOptions
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) GHCOptions
forall (m :: * -&gt; *). ReadGHCOpts m =&gt; m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var">askGhcOpts</span></a></span><span>
</span><span id="line-783"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133789"><span class="annot"><span class="annottext">eval :: EvaluationStrategy
</span><a href="#local-6989586621681133789"><span class="hs-identifier hs-var hs-var">eval</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133790"><span class="hs-identifier hs-var">strict</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">EvaluationStrategy
</span><a href="Agda.Syntax.Treeless.html#EagerEvaluation"><span class="hs-identifier hs-var">EagerEvaluation</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">EvaluationStrategy
</span><a href="Agda.Syntax.Treeless.html#LazyEvaluation"><span class="hs-identifier hs-var">LazyEvaluation</span></a></span><span>
</span><span id="line-784"></span><span>    </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) (Maybe TTerm)
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; (TTerm
    -&gt; ReaderT
         GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a b.
Monad m =&gt;
m (Maybe a) -&gt; m b -&gt; (a -&gt; m b) -&gt; m b
</span><a href="Agda.Utils.Maybe.html#caseMaybeM"><span class="hs-identifier hs-var">caseMaybeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCM (Maybe TTerm)
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) (Maybe TTerm)
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM (Maybe TTerm)
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) (Maybe TTerm))
-&gt; TCM (Maybe TTerm)
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) (Maybe TTerm)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EvaluationStrategy -&gt; QName -&gt; TCM (Maybe TTerm)
</span><a href="Agda.Compiler.ToTreeless.html#toTreeless"><span class="hs-identifier hs-var">toTreeless</span></a></span><span> </span><span class="annot"><span class="annottext">EvaluationStrategy
</span><a href="#local-6989586621681133789"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133791"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(UsesFloat, [Decl])
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((TTerm
  -&gt; ReaderT
       GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
 -&gt; ReaderT
      GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; (TTerm
    -&gt; ReaderT
         GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681133784"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133784"><span class="hs-identifier hs-var">treeless</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-785"></span><span>
</span><span id="line-786"></span><span>      </span><span id="local-6989586621681133783"><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621681133783"><span class="hs-identifier hs-var">used</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ArgUsage] -&gt; Maybe [ArgUsage] -&gt; [ArgUsage]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Maybe [ArgUsage] -&gt; [ArgUsage])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (Maybe [ArgUsage])
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [ArgUsage]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (Maybe [ArgUsage])
forall (m :: * -&gt; *).
HasConstInfo m =&gt;
QName -&gt; m (Maybe [ArgUsage])
</span><a href="Agda.TypeChecking.Monad.Signature.html#getCompiledArgUse"><span class="hs-identifier hs-var">getCompiledArgUse</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133791"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-787"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133781"><span class="annot"><span class="annottext">dostrip :: Bool
</span><a href="#local-6989586621681133781"><span class="hs-identifier hs-var hs-var">dostrip</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgUsage
</span><a href="Agda.Syntax.Treeless.html#ArgUnused"><span class="hs-identifier hs-var">ArgUnused</span></a></span><span> </span><span class="annot"><span class="annottext">ArgUsage -&gt; [ArgUsage] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621681133783"><span class="hs-identifier hs-var">used</span></a></span><span>
</span><span id="line-788"></span><span>
</span><span id="line-789"></span><span>      </span><span class="hs-comment">-- Compute the type approximation</span><span>
</span><span id="line-790"></span><span>      </span><span id="local-6989586621681133778"><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681133778"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Definition
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Definition
</span><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo"><span class="hs-identifier hs-var">getConstInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133791"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-791"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681133777"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681133777"><span class="hs-identifier hs-var">argTypes0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681133776"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681133776"><span class="hs-identifier hs-var">resType</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; HsCompileM ([Type], Type)
</span><a href="Agda.Compiler.MAlonzo.HaskellTypes.html#hsTelApproximation"><span class="hs-identifier hs-var">hsTelApproximation</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; HsCompileM ([Type], Type))
-&gt; Type -&gt; HsCompileM ([Type], Type)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Type
</span><a href="Agda.TypeChecking.Monad.Base.html#defType"><span class="hs-identifier hs-var">defType</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681133778"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-792"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133774"><span class="annot"><span class="annottext">pars :: Nat
</span><a href="#local-6989586621681133774"><span class="hs-identifier hs-var hs-var">pars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Defn
</span><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var">theDef</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681133778"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-793"></span><span>                   </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funProjection :: Defn -&gt; Maybe Projection
</span><a href="Agda.TypeChecking.Monad.Base.html#funProjection"><span class="hs-identifier hs-var">funProjection</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">projIndex :: Projection -&gt; Nat
</span><a href="Agda.TypeChecking.Monad.Base.html#projIndex"><span class="hs-identifier hs-var">projIndex</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681133770"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133770"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133770"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133770"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span>
</span><span id="line-794"></span><span>                   </span><span class="annot"><span class="annottext">Defn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span>
</span><span id="line-795"></span><span>          </span><span id="local-6989586621681133768"><span class="annot"><span class="annottext">argTypes :: [Type]
</span><a href="#local-6989586621681133768"><span class="hs-identifier hs-var hs-var">argTypes</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; [Type] -&gt; [Type]
forall a. Nat -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133774"><span class="hs-identifier hs-var">pars</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681133777"><span class="hs-identifier hs-var">argTypes0</span></a></span><span>
</span><span id="line-796"></span><span>          </span><span id="local-6989586621681133766"><span class="annot"><span class="annottext">argTypesS :: [Type]
</span><a href="#local-6989586621681133766"><span class="hs-identifier hs-var hs-var">argTypesS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ArgUsage] -&gt; [Type] -&gt; [Type]
forall a. [ArgUsage] -&gt; [a] -&gt; [a]
</span><a href="Agda.Syntax.Treeless.html#filterUsed"><span class="hs-identifier hs-var">filterUsed</span></a></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621681133783"><span class="hs-identifier hs-var">used</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681133768"><span class="hs-identifier hs-var">argTypes</span></a></span><span>
</span><span id="line-797"></span><span>
</span><span id="line-798"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681133764"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133764"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681133763"><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621681133763"><span class="hs-identifier hs-var">useFloat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133781"><span class="hs-identifier hs-var">dostrip</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; HsCompileM (Exp, UsesFloat)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm"><span class="hs-identifier hs-var">closedTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ArgUsage] -&gt; TTerm -&gt; TTerm
</span><a href="Agda.Compiler.Treeless.Unused.html#stripUnusedArguments"><span class="hs-identifier hs-var">stripUnusedArguments</span></a></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621681133783"><span class="hs-identifier hs-var">used</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133784"><span class="hs-identifier hs-var">treeless</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-799"></span><span>                                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; HsCompileM (Exp, UsesFloat)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm"><span class="hs-identifier hs-var">closedTerm</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133784"><span class="hs-identifier hs-var">treeless</span></a></span><span>
</span><span id="line-800"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681133760"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621681133760"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681133759"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133759"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; ([Pat], Exp)
</span><a href="#local-6989586621681133758"><span class="hs-identifier hs-var">lamView</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133764"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-801"></span><span>          </span><span id="local-6989586621681133758"><span class="annot"><span class="annottext">lamView :: Exp -&gt; ([Pat], Exp)
</span><a href="#local-6989586621681133758"><span class="hs-identifier hs-var hs-var">lamView</span></a></span></span><span> </span><span id="local-6989586621681133757"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133757"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-802"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133757"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-803"></span><span>              </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Lambda"><span class="hs-identifier hs-type">HS.Lambda</span></a></span><span> </span><span id="local-6989586621681133755"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621681133755"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621681133754"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133754"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621681133755"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133754"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-804"></span><span>              </span><span id="local-6989586621681133753"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133753"><span class="hs-identifier hs-var">b</span></a></span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133753"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-805"></span><span>
</span><span id="line-806"></span><span>          </span><span id="local-6989586621681133750"><span class="annot"><span class="annottext">tydecl :: Name -&gt; t Type -&gt; Type -&gt; Decl
</span><a href="#local-6989586621681133750"><span class="hs-identifier hs-var hs-var">tydecl</span></a></span></span><span>  </span><span id="local-6989586621681133749"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133749"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681133748"><span class="annot"><span class="annottext">t Type
</span><a href="#local-6989586621681133748"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span id="local-6989586621681133747"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681133747"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeSig"><span class="hs-identifier hs-var">HS.TypeSig</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133749"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; t Type -&gt; Type
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyFun"><span class="hs-identifier hs-var">HS.TyFun</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681133747"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">t Type
</span><a href="#local-6989586621681133748"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-807"></span><span>          </span><span id="local-6989586621681133745"><span class="annot"><span class="annottext">funbind :: Name -&gt; [Pat] -&gt; Exp -&gt; Decl
</span><a href="#local-6989586621681133745"><span class="hs-identifier hs-var hs-var">funbind</span></a></span></span><span> </span><span id="local-6989586621681133744"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133744"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681133743"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621681133743"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621681133742"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133742"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133744"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621681133743"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133742"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-808"></span><span>          </span><span id="local-6989586621681133737"><span class="annot"><span class="annottext">tyfunbind :: Name -&gt; [Type] -&gt; Type -&gt; [Pat] -&gt; Exp -&gt; [Decl]
</span><a href="#local-6989586621681133737"><span class="hs-identifier hs-var hs-var">tyfunbind</span></a></span></span><span> </span><span id="local-6989586621681133736"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133736"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681133735"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681133735"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span id="local-6989586621681133734"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681133734"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621681133733"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621681133733"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621681133732"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133732"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-809"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133731"><span class="annot"><span class="annottext">ts' :: [Type]
</span><a href="#local-6989586621681133731"><span class="hs-identifier hs-var hs-var">ts'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681133735"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; [Type]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat -&gt; Type -&gt; [Type]
forall a. Nat -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pat] -&gt; Nat
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Nat
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621681133733"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Nat
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Nat
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681133735"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazAnyType"><span class="hs-identifier hs-var">mazAnyType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-810"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Type] -&gt; Type -&gt; Decl
forall {t :: * -&gt; *}. Foldable t =&gt; Name -&gt; t Type -&gt; Type -&gt; Decl
</span><a href="#local-6989586621681133750"><span class="hs-identifier hs-var">tydecl</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133736"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681133731"><span class="hs-identifier hs-var">ts'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681133734"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Exp -&gt; Decl
</span><a href="#local-6989586621681133745"><span class="hs-identifier hs-var">funbind</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133736"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621681133733"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133732"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-811"></span><span>
</span><span id="line-812"></span><span>      </span><span class="hs-comment">-- The definition of the non-stripped function</span><span>
</span><span id="line-813"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681133728"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621681133728"><span class="hs-identifier hs-var">ps0</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; ([Pat], Exp)
</span><a href="#local-6989586621681133758"><span class="hs-identifier hs-var">lamView</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; ([Pat], Exp))
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ([Pat], Exp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm_"><span class="hs-identifier hs-var">closedTerm_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((TTerm -&gt; TTerm) -&gt; TTerm -&gt; TTerm)
-&gt; TTerm -&gt; [TTerm -&gt; TTerm] -&gt; TTerm
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">(TTerm -&gt; TTerm) -&gt; TTerm -&gt; TTerm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">($)</span></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="Agda.Syntax.Treeless.html#TErased"><span class="hs-identifier hs-var">T.TErased</span></a></span><span> </span><span class="annot"><span class="annottext">([TTerm -&gt; TTerm] -&gt; TTerm) -&gt; [TTerm -&gt; TTerm] -&gt; TTerm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; (TTerm -&gt; TTerm) -&gt; [TTerm -&gt; TTerm]
forall a. Nat -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ArgUsage] -&gt; Nat
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Nat
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621681133783"><span class="hs-identifier hs-var">used</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#TLam"><span class="hs-identifier hs-var">T.TLam</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-814"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133724"><span class="annot"><span class="annottext">b0 :: Exp
</span><a href="#local-6989586621681133724"><span class="hs-identifier hs-var hs-var">b0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp -&gt; Exp) -&gt; Exp -&gt; [Exp] -&gt; Exp
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-identifier hs-var">HS.App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsVarUQ"><span class="hs-identifier hs-var">hsVarUQ</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Exp) -&gt; Name -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#duname"><span class="hs-identifier hs-var">duname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133791"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsVarUQ"><span class="hs-identifier hs-var">hsVarUQ</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133721"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-type">HS.PVar</span></a></span><span> </span><span id="local-6989586621681133721"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133721"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ArgUsage
</span><a href="Agda.Syntax.Treeless.html#ArgUsed"><span class="hs-identifier hs-var">ArgUsed</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; [ArgUsage] -&gt; [(Pat, ArgUsage)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621681133728"><span class="hs-identifier hs-var">ps0</span></a></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621681133783"><span class="hs-identifier hs-var">used</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-815"></span><span>          </span><span id="local-6989586621681133719"><span class="annot"><span class="annottext">ps0' :: [Pat]
</span><a href="#local-6989586621681133719"><span class="hs-identifier hs-var hs-var">ps0'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Pat -&gt; ArgUsage -&gt; Pat) -&gt; [Pat] -&gt; [ArgUsage] -&gt; [Pat]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681133717"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621681133717"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621681133716"><span class="annot"><span class="annottext">ArgUsage
</span><a href="#local-6989586621681133716"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ArgUsage
</span><a href="#local-6989586621681133716"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-816"></span><span>                                    </span><span class="annot"><span class="annottext">ArgUsage
</span><a href="Agda.Syntax.Treeless.html#ArgUsed"><span class="hs-identifier hs-var">ArgUsed</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621681133717"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-817"></span><span>                                    </span><span class="annot"><span class="annottext">ArgUsage
</span><a href="Agda.Syntax.Treeless.html#ArgUnused"><span class="hs-identifier hs-var">ArgUnused</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PIrrPat"><span class="hs-identifier hs-var">HS.PIrrPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621681133717"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-818"></span><span>                   </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621681133728"><span class="hs-identifier hs-var">ps0</span></a></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621681133783"><span class="hs-identifier hs-var">used</span></a></span><span>
</span><span id="line-819"></span><span>
</span><span id="line-820"></span><span>      </span><span class="annot"><span class="annottext">(UsesFloat, [Decl])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621681133763"><span class="hs-identifier hs-var">useFloat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-821"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133781"><span class="hs-identifier hs-var">dostrip</span></a></span><span>
</span><span id="line-822"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Type] -&gt; Type -&gt; [Pat] -&gt; Exp -&gt; [Decl]
</span><a href="#local-6989586621681133737"><span class="hs-identifier hs-var">tyfunbind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133791"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681133768"><span class="hs-identifier hs-var">argTypes</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681133776"><span class="hs-identifier hs-var">resType</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621681133719"><span class="hs-identifier hs-var">ps0'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133724"><span class="hs-identifier hs-var">b0</span></a></span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-823"></span><span>                     </span><span class="annot"><span class="annottext">Name -&gt; [Type] -&gt; Type -&gt; [Pat] -&gt; Exp -&gt; [Decl]
</span><a href="#local-6989586621681133737"><span class="hs-identifier hs-var">tyfunbind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#duname"><span class="hs-identifier hs-var">duname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133791"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681133766"><span class="hs-identifier hs-var">argTypesS</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681133776"><span class="hs-identifier hs-var">resType</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621681133760"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133759"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-824"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Type] -&gt; Type -&gt; [Pat] -&gt; Exp -&gt; [Decl]
</span><a href="#local-6989586621681133737"><span class="hs-identifier hs-var">tyfunbind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133791"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681133768"><span class="hs-identifier hs-var">argTypes</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681133776"><span class="hs-identifier hs-var">resType</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621681133760"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133759"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-825"></span><span>
</span><span id="line-826"></span><span>  </span><span class="annot"><a href="#local-6989586621681133973"><span class="hs-identifier hs-type">fbWithType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Type"><span class="hs-identifier hs-type">HS.Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-827"></span><span>  </span><span id="local-6989586621681133973"><span class="annot"><span class="annottext">fbWithType :: Type -&gt; Exp -&gt; [Decl]
</span><a href="#local-6989586621681133973"><span class="hs-identifier hs-var hs-var">fbWithType</span></a></span></span><span> </span><span id="local-6989586621681133714"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681133714"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621681133713"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133713"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-828"></span><span>    </span><span class="annot"><span class="annottext">[Name] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeSig"><span class="hs-identifier hs-var">HS.TypeSig</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681133714"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Decl -&gt; [Decl] -&gt; [Decl]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Decl]
</span><a href="#local-6989586621681133867"><span class="hs-identifier hs-var">fb</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133713"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-829"></span><span>
</span><span id="line-830"></span><span>  </span><span class="annot"><a href="#local-6989586621681133867"><span class="hs-identifier hs-type">fb</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-831"></span><span>  </span><span id="local-6989586621681133867"><span class="annot"><span class="annottext">fb :: Exp -&gt; [Decl]
</span><a href="#local-6989586621681133867"><span class="hs-identifier hs-var hs-var">fb</span></a></span></span><span> </span><span id="local-6989586621681133712"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133712"><span class="hs-identifier hs-var">e</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-832"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133712"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-833"></span><span>
</span><span id="line-834"></span><span>  </span><span class="annot"><a href="#local-6989586621681133866"><span class="hs-identifier hs-type">axiomErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-835"></span><span>  </span><span id="local-6989586621681133866"><span class="annot"><span class="annottext">axiomErr :: Exp
</span><a href="#local-6989586621681133866"><span class="hs-identifier hs-var hs-var">axiomErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#rtmError"><span class="hs-identifier hs-var">rtmError</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Exp) -&gt; Text -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Text) -&gt; FilePath -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;postulate evaluated: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; FilePath
forall a. Pretty a =&gt; a -&gt; FilePath
</span><a href="Agda.Utils.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681134016"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-836"></span><span>
</span><span id="line-837"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#constructorCoverageCode"><span class="hs-identifier hs-type">constructorCoverageCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HaskellType"><span class="hs-identifier hs-type">HaskellType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HaskellCode"><span class="hs-identifier hs-type">HaskellCode</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-838"></span><span id="constructorCoverageCode"><span class="annot"><span class="annottext">constructorCoverageCode :: QName
-&gt; Nat
-&gt; [QName]
-&gt; FilePath
-&gt; [FilePath]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#constructorCoverageCode"><span class="hs-identifier hs-var hs-var">constructorCoverageCode</span></a></span></span><span> </span><span id="local-6989586621681133707"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133707"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621681133706"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133706"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span id="local-6989586621681133705"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681133705"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621681133704"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133704"><span class="hs-identifier hs-var">hsTy</span></a></span></span><span> </span><span id="local-6989586621681133703"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681133703"><span class="hs-identifier hs-var">hsCons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-839"></span><span>  </span><span class="annot"><span class="annottext">TCM () -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ())
-&gt; TCM () -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; [QName] -&gt; [FilePath] -&gt; TCM ()
</span><a href="Agda.Compiler.MAlonzo.HaskellTypes.html#checkConstructorCount"><span class="hs-identifier hs-var">checkConstructorCount</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133707"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681133705"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681133703"><span class="hs-identifier hs-var">hsCons</span></a></span><span>
</span><span id="line-840"></span><span>  </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Bool
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
forall (m :: * -&gt; *) a. Monad m =&gt; m Bool -&gt; m a -&gt; m a -&gt; m a
</span><a href="Agda.Utils.Monad.html#ifM"><span class="hs-identifier hs-var">ifM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCM Bool -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Bool
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM Bool -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Bool)
-&gt; TCM Bool
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM Bool
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
QName -&gt; m Bool
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#noCheckCover"><span class="hs-identifier hs-var">noCheckCover</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133707"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Decl] -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl])
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-841"></span><span>    </span><span id="local-6989586621681133700"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133700"><span class="hs-identifier hs-var">ccs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[[Decl]] -&gt; [Decl]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.concat</span></span><span> </span><span class="annot"><span class="annottext">([[Decl]] -&gt; [Decl])
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [[Decl]]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(QName
 -&gt; FilePath
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl])
-&gt; [QName]
-&gt; [FilePath]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [[Decl]]
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; b -&gt; m c) -&gt; [a] -&gt; [b] -&gt; m [c]
</span><span class="hs-identifier hs-var">zipWithM</span></span><span> </span><span class="annot"><span class="annottext">QName
-&gt; FilePath
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#checkConstructorType"><span class="hs-identifier hs-var">checkConstructorType</span></a></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681133705"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681133703"><span class="hs-identifier hs-var">hsCons</span></a></span><span>
</span><span id="line-842"></span><span>    </span><span id="local-6989586621681133697"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133697"><span class="hs-identifier hs-var">cov</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM [Decl]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM [Decl]
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl])
-&gt; TCM [Decl]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; FilePath -&gt; Nat -&gt; [QName] -&gt; [FilePath] -&gt; TCM [Decl]
forall (m :: * -&gt; *).
HasConstInfo m =&gt;
QName -&gt; FilePath -&gt; Nat -&gt; [QName] -&gt; [FilePath] -&gt; m [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#checkCover"><span class="hs-identifier hs-var">checkCover</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133707"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133704"><span class="hs-identifier hs-var">hsTy</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133706"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681133705"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681133703"><span class="hs-identifier hs-var">hsCons</span></a></span><span>
</span><span id="line-843"></span><span>    </span><span class="annot"><span class="annottext">[Decl] -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([Decl] -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl])
-&gt; [Decl]
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133700"><span class="hs-identifier hs-var">ccs</span></a></span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133697"><span class="hs-identifier hs-var">cov</span></a></span><span>
</span><span id="line-844"></span><span>
</span><span id="line-845"></span><span class="hs-comment">-- | Environment for naming of local variables.</span><span>
</span><span id="line-846"></span><span class="hs-comment">--   Invariant: @reverse ccCxt ++ ccNameSupply@</span><span>
</span><span id="line-847"></span><span class="hs-keyword">data</span><span> </span><span id="CCEnv"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCEnv"><span class="hs-identifier hs-var">CCEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CCEnv"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCEnv"><span class="hs-identifier hs-var">CCEnv</span></a></span></span><span>
</span><span id="line-848"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_ccNameSupply"><span class="annot"><span class="annottext">CCEnv -&gt; [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccNameSupply"><span class="hs-identifier hs-var hs-var">_ccNameSupply</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#NameSupply"><span class="hs-identifier hs-type">NameSupply</span></a></span><span>  </span><span class="hs-comment">-- ^ Supply of fresh names</span><span>
</span><span id="line-849"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_ccContext"><span class="annot"><span class="annottext">CCEnv -&gt; [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccContext"><span class="hs-identifier hs-var hs-var">_ccContext</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCContext"><span class="hs-identifier hs-type">CCContext</span></a></span><span>   </span><span class="hs-comment">-- ^ Names currently in scope</span><span>
</span><span id="line-850"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-851"></span><span>
</span><span id="line-852"></span><span class="hs-keyword">type</span><span> </span><span id="NameSupply"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#NameSupply"><span class="hs-identifier hs-var">NameSupply</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Name"><span class="hs-identifier hs-type">HS.Name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-853"></span><span class="hs-keyword">type</span><span> </span><span id="CCContext"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCContext"><span class="hs-identifier hs-var">CCContext</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Name"><span class="hs-identifier hs-type">HS.Name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-854"></span><span>
</span><span id="line-855"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ccNameSupply"><span class="hs-identifier hs-type">ccNameSupply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#NameSupply"><span class="hs-identifier hs-type">NameSupply</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCEnv"><span class="hs-identifier hs-type">CCEnv</span></a></span><span>
</span><span id="line-856"></span><span id="ccNameSupply"><span class="annot"><span class="annottext">ccNameSupply :: Lens' [Name] CCEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ccNameSupply"><span class="hs-identifier hs-var hs-var">ccNameSupply</span></a></span></span><span> </span><span id="local-6989586621681133687"><span class="annot"><span class="annottext">[Name] -&gt; f [Name]
</span><a href="#local-6989586621681133687"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681133686"><span class="annot"><span class="annottext">CCEnv
</span><a href="#local-6989586621681133686"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681133685"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681133685"><span class="hs-identifier hs-var">ns'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CCEnv
</span><a href="#local-6989586621681133686"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_ccNameSupply :: [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccNameSupply"><span class="hs-identifier hs-var">_ccNameSupply</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681133685"><span class="hs-identifier hs-var">ns'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; CCEnv) -&gt; f [Name] -&gt; f CCEnv
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; f [Name]
</span><a href="#local-6989586621681133687"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CCEnv -&gt; [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccNameSupply"><span class="hs-identifier hs-var">_ccNameSupply</span></a></span><span> </span><span class="annot"><span class="annottext">CCEnv
</span><a href="#local-6989586621681133686"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-857"></span><span>
</span><span id="line-858"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ccContext"><span class="hs-identifier hs-type">ccContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCContext"><span class="hs-identifier hs-type">CCContext</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCEnv"><span class="hs-identifier hs-type">CCEnv</span></a></span><span>
</span><span id="line-859"></span><span id="ccContext"><span class="annot"><span class="annottext">ccContext :: Lens' [Name] CCEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ccContext"><span class="hs-identifier hs-var hs-var">ccContext</span></a></span></span><span> </span><span id="local-6989586621681133681"><span class="annot"><span class="annottext">[Name] -&gt; f [Name]
</span><a href="#local-6989586621681133681"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681133680"><span class="annot"><span class="annottext">CCEnv
</span><a href="#local-6989586621681133680"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681133679"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681133679"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CCEnv
</span><a href="#local-6989586621681133680"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_ccContext :: [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccContext"><span class="hs-identifier hs-var">_ccContext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681133679"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; CCEnv) -&gt; f [Name] -&gt; f CCEnv
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; f [Name]
</span><a href="#local-6989586621681133681"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CCEnv -&gt; [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccContext"><span class="hs-identifier hs-var">_ccContext</span></a></span><span> </span><span class="annot"><span class="annottext">CCEnv
</span><a href="#local-6989586621681133680"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-860"></span><span>
</span><span id="line-861"></span><span class="hs-comment">-- | Initial environment for expression generation.</span><span>
</span><span id="line-862"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#initCCEnv"><span class="hs-identifier hs-type">initCCEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCEnv"><span class="hs-identifier hs-type">CCEnv</span></a></span><span>
</span><span id="line-863"></span><span id="initCCEnv"><span class="annot"><span class="annottext">initCCEnv :: CCEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#initCCEnv"><span class="hs-identifier hs-var hs-var">initCCEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCEnv"><span class="hs-identifier hs-type">CCEnv</span></a></span><span>
</span><span id="line-864"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_ccNameSupply :: [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccNameSupply"><span class="hs-identifier hs-var">_ccNameSupply</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Nat -&gt; Name) -&gt; [Nat] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#V"><span class="hs-identifier hs-var">V</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- DON'T CHANGE THESE NAMES!</span><span>
</span><span id="line-865"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_ccContext :: [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccContext"><span class="hs-identifier hs-var">_ccContext</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-866"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-867"></span><span>
</span><span id="line-868"></span><span class="hs-comment">-- | Term variables are de Bruijn indices.</span><span>
</span><span id="line-869"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#lookupIndex"><span class="hs-identifier hs-type">lookupIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCContext"><span class="hs-identifier hs-type">CCContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Name"><span class="hs-identifier hs-type">HS.Name</span></a></span><span>
</span><span id="line-870"></span><span id="lookupIndex"><span class="annot"><span class="annottext">lookupIndex :: Nat -&gt; [Name] -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#lookupIndex"><span class="hs-identifier hs-var hs-var">lookupIndex</span></a></span></span><span> </span><span id="local-6989586621681133675"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133675"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681133674"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681133674"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name -&gt; Name
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Name
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Name -&gt; Name) -&gt; Maybe Name -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681133674"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Nat -&gt; Maybe Name
forall a. [a] -&gt; Nat -&gt; Maybe a
</span><a href="Agda.Utils.List.html#%21%21%21"><span class="hs-operator hs-var">!!!</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133675"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-871"></span><span>
</span><span id="line-872"></span><span class="hs-comment">-- | Constructor coverage monad transformer</span><span>
</span><span id="line-873"></span><span class="hs-keyword">type</span><span> </span><span id="CCT"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-var">CCT</span></a></span></span><span> </span><span id="local-6989586621681133672"><span class="annot"><a href="#local-6989586621681133672"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCEnv"><span class="hs-identifier hs-type">CCEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileT"><span class="hs-identifier hs-type">HsCompileT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133672"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-874"></span><span>
</span><span id="line-875"></span><span class="hs-comment">-- | Constructor coverage monad</span><span>
</span><span id="line-876"></span><span class="hs-keyword">type</span><span> </span><span id="CC"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CC"><span class="hs-identifier hs-var">CC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span>
</span><span id="line-877"></span><span>
</span><span id="line-878"></span><span id="local-6989586621681135638"><span id="local-6989586621681135639"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-type">liftCC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621681135639"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileT"><span class="hs-identifier hs-type">HsCompileT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681135639"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681135638"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681135639"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681135638"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-879"></span><span id="liftCC"><span class="annot"><span class="annottext">liftCC :: forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var hs-var">liftCC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriterT UsesFloat (HsCompileT m) a
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT m)) a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(WriterT UsesFloat (HsCompileT m) a
 -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT m)) a)
-&gt; (HsCompileT m a -&gt; WriterT UsesFloat (HsCompileT m) a)
-&gt; HsCompileT m a
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT m)) a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HsCompileT m a -&gt; WriterT UsesFloat (HsCompileT m) a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span>
</span><span id="line-880"></span><span>
</span><span id="line-881"></span><span id="local-6989586621681135627"><span id="local-6989586621681135628"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#freshNames"><span class="hs-identifier hs-type">freshNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621681135628"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Name"><span class="hs-identifier hs-type">HS.Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681135628"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681135627"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681135628"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681135627"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-882"></span><span id="freshNames"><span class="annot"><span class="annottext">freshNames :: forall (m :: * -&gt; *) a.
Monad m =&gt;
Nat -&gt; ([Name] -&gt; CCT m a) -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#freshNames"><span class="hs-identifier hs-var hs-var">freshNames</span></a></span></span><span> </span><span id="local-6989586621681133641"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133641"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; CCT m a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133641"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CCT m a
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-883"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#freshNames"><span class="hs-identifier hs-var">freshNames</span></a></span><span> </span><span id="local-6989586621681133639"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133639"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681133638"><span class="annot"><span class="annottext">[Name] -&gt; CCT m a
</span><a href="#local-6989586621681133638"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-884"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681133637"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681133637"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681133636"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681133636"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; [Name] -&gt; ([Name], [Name])
forall a. Nat -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133639"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; ([Name], [Name]))
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT m)) [Name]
-&gt; ReaderT
     CCEnv (WriterT UsesFloat (HsCompileT m)) ([Name], [Name])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Lens' [Name] CCEnv
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT m)) [Name]
forall o (m :: * -&gt; *) i. MonadReader o m =&gt; Lens' i o -&gt; m i
</span><a href="Agda.Utils.Lens.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' [Name] CCEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ccNameSupply"><span class="hs-identifier hs-var">ccNameSupply</span></a></span><span>
</span><span id="line-885"></span><span>  </span><span class="annot"><span class="annottext">(CCEnv -&gt; CCEnv) -&gt; CCT m a -&gt; CCT m a
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; r) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">local</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens' [Name] CCEnv -&gt; LensMap [Name] CCEnv
forall i o. Lens' i o -&gt; LensMap i o
</span><a href="Agda.Utils.Lens.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' [Name] CCEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ccNameSupply"><span class="hs-identifier hs-var">ccNameSupply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681133636"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CCT m a -&gt; CCT m a) -&gt; CCT m a -&gt; CCT m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; CCT m a
</span><a href="#local-6989586621681133638"><span class="hs-identifier hs-var">cont</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681133637"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-886"></span><span>
</span><span id="line-887"></span><span class="hs-comment">-- | Introduce n variables into the context.</span><span>
</span><span id="line-888"></span><span id="local-6989586621681133625"><span id="local-6989586621681133626"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#intros"><span class="hs-identifier hs-type">intros</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621681133626"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Name"><span class="hs-identifier hs-type">HS.Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133626"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133625"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133626"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133625"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-889"></span><span id="intros"><span class="annot"><span class="annottext">intros :: forall (m :: * -&gt; *) a.
Monad m =&gt;
Nat -&gt; ([Name] -&gt; CCT m a) -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#intros"><span class="hs-identifier hs-var hs-var">intros</span></a></span></span><span> </span><span id="local-6989586621681133617"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133617"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681133616"><span class="annot"><span class="annottext">[Name] -&gt; CCT m a
</span><a href="#local-6989586621681133616"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; ([Name] -&gt; CCT m a) -&gt; CCT m a
forall (m :: * -&gt; *) a.
Monad m =&gt;
Nat -&gt; ([Name] -&gt; CCT m a) -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#freshNames"><span class="hs-identifier hs-var">freshNames</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133617"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(([Name] -&gt; CCT m a) -&gt; CCT m a) -&gt; ([Name] -&gt; CCT m a) -&gt; CCT m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681133615"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681133615"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-890"></span><span>  </span><span class="annot"><span class="annottext">(CCEnv -&gt; CCEnv) -&gt; CCT m a -&gt; CCT m a
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; r) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">local</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens' [Name] CCEnv -&gt; LensMap [Name] CCEnv
forall i o. Lens' i o -&gt; LensMap i o
</span><a href="Agda.Utils.Lens.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' [Name] CCEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ccContext"><span class="hs-identifier hs-var">ccContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; [Name]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681133615"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CCT m a -&gt; CCT m a) -&gt; CCT m a -&gt; CCT m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; CCT m a
</span><a href="#local-6989586621681133616"><span class="hs-identifier hs-var">cont</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681133615"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-891"></span><span>
</span><span id="line-892"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#checkConstructorType"><span class="hs-identifier hs-type">checkConstructorType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HaskellCode"><span class="hs-identifier hs-type">HaskellCode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-893"></span><span id="checkConstructorType"><span class="annot"><span class="annottext">checkConstructorType :: QName
-&gt; FilePath
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#checkConstructorType"><span class="hs-identifier hs-var hs-var">checkConstructorType</span></a></span></span><span> </span><span id="local-6989586621681133611"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133611"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621681133610"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133610"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-894"></span><span>  </span><span id="local-6989586621681133609"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681133609"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; HsCompileM Type
</span><a href="Agda.Compiler.MAlonzo.HaskellTypes.html#haskellType"><span class="hs-identifier hs-var">haskellType</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133611"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-895"></span><span>  </span><span class="annot"><span class="annottext">[Decl] -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [Decl]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeSig"><span class="hs-identifier hs-var">HS.TypeSig</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#CheckK"><span class="hs-identifier hs-var">CheckK</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133611"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681133609"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-896"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#CheckK"><span class="hs-identifier hs-var">CheckK</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133611"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-897"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Rhs) -&gt; Exp -&gt; Rhs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#fakeExp"><span class="hs-identifier hs-var">fakeExp</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133610"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-898"></span><span>         </span><span class="hs-special">]</span><span>
</span><span id="line-899"></span><span>
</span><span id="line-900"></span><span id="local-6989586621681135643"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#checkCover"><span class="hs-identifier hs-type">checkCover</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#HasConstInfo"><span class="hs-identifier hs-type">HasConstInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681135643"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HaskellType"><span class="hs-identifier hs-type">HaskellType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HaskellCode"><span class="hs-identifier hs-type">HaskellCode</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681135643"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-901"></span><span id="checkCover"><span class="annot"><span class="annottext">checkCover :: forall (m :: * -&gt; *).
HasConstInfo m =&gt;
QName -&gt; FilePath -&gt; Nat -&gt; [QName] -&gt; [FilePath] -&gt; m [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#checkCover"><span class="hs-identifier hs-var hs-var">checkCover</span></a></span></span><span> </span><span id="local-6989586621681133590"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133590"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621681133589"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133589"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621681133588"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133588"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681133587"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681133587"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621681133586"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681133586"><span class="hs-identifier hs-var">hsCons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-902"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133585"><span class="annot"><span class="annottext">tvs :: [FilePath]
</span><a href="#local-6989586621681133585"><span class="hs-identifier hs-var hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;a&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133584"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681133584"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133584"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133588"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-903"></span><span>      </span><span id="local-6989586621681133577"><span class="annot"><span class="annottext">makeClause :: QName -&gt; FilePath -&gt; m Alt
</span><a href="#local-6989586621681133577"><span class="hs-identifier hs-var hs-var">makeClause</span></a></span></span><span> </span><span id="local-6989586621681133576"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133576"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621681133575"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133575"><span class="hs-identifier hs-var">hsc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-904"></span><span>        </span><span id="local-6989586621681133574"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133574"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; m Nat
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Nat
</span><a href="Agda.Compiler.MAlonzo.Coerce.html#erasedArity"><span class="hs-identifier hs-var">erasedArity</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133576"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-905"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133572"><span class="annot"><span class="annottext">pat :: Pat
</span><a href="#local-6989586621681133572"><span class="hs-identifier hs-var hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; [Pat] -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PApp"><span class="hs-identifier hs-var">HS.PApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-var">HS.UnQual</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133575"><span class="hs-identifier hs-var">hsc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Pat] -&gt; Pat) -&gt; [Pat] -&gt; Pat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Pat -&gt; [Pat]
forall a. Nat -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133574"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PWildCard"><span class="hs-identifier hs-var">HS.PWildCard</span></a></span><span>
</span><span id="line-906"></span><span>        </span><span class="annot"><span class="annottext">Alt -&gt; m Alt
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Alt -&gt; m Alt) -&gt; Alt -&gt; m Alt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Rhs -&gt; Maybe Binds -&gt; Alt
</span><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-var">HS.Alt</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621681133572"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Rhs) -&gt; Exp -&gt; Rhs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-var">HS.unit_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span>
</span><span id="line-907"></span><span>
</span><span id="line-908"></span><span>  </span><span id="local-6989586621681133568"><span class="annot"><span class="annottext">[Alt]
</span><a href="#local-6989586621681133568"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; FilePath -&gt; m Alt) -&gt; [QName] -&gt; [FilePath] -&gt; m [Alt]
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; b -&gt; m c) -&gt; [a] -&gt; [b] -&gt; m [c]
</span><span class="hs-identifier hs-var">zipWithM</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; FilePath -&gt; m Alt
forall {m :: * -&gt; *}. HasConstInfo m =&gt; QName -&gt; FilePath -&gt; m Alt
</span><a href="#local-6989586621681133577"><span class="hs-identifier hs-var">makeClause</span></a></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681133587"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681133586"><span class="hs-identifier hs-var">hsCons</span></a></span><span>
</span><span id="line-909"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133567"><span class="annot"><span class="annottext">rhs :: Exp
</span><a href="#local-6989586621681133567"><span class="hs-identifier hs-var hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Alt] -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Case"><span class="hs-identifier hs-var">HS.Case</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp) -&gt; QName -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-var">HS.UnQual</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;x&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Alt]
</span><a href="#local-6989586621681133568"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-910"></span><span>
</span><span id="line-911"></span><span>  </span><span class="annot"><span class="annottext">[Decl] -&gt; m [Decl]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeSig"><span class="hs-identifier hs-var">HS.TypeSig</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#CoverK"><span class="hs-identifier hs-var">CoverK</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133590"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Decl) -&gt; Type -&gt; Decl
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Type
</span><a href="Agda.Compiler.MAlonzo.Misc.html#fakeType"><span class="hs-identifier hs-var">fakeType</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Type) -&gt; FilePath -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; FilePath
</span><span class="hs-identifier hs-var">unwords</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133589"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; [FilePath]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681133585"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot; -&gt; ()&quot;</span></span><span>
</span><span id="line-912"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#CoverK"><span class="hs-identifier hs-var">CoverK</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133590"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-var">HS.PVar</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Pat) -&gt; Name -&gt; Pat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;x&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-913"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133567"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-914"></span><span>         </span><span class="hs-special">]</span><span>
</span><span id="line-915"></span><span>
</span><span id="line-916"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm_"><span class="hs-identifier hs-type">closedTerm_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TTerm"><span class="hs-identifier hs-type">T.TTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-917"></span><span id="closedTerm_"><span class="annot"><span class="annottext">closedTerm_ :: TTerm -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm_"><span class="hs-identifier hs-var hs-var">closedTerm_</span></a></span></span><span> </span><span id="local-6989586621681133562"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133562"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp, UsesFloat) -&gt; Exp
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Exp, UsesFloat) -&gt; Exp)
-&gt; HsCompileM (Exp, UsesFloat)
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; HsCompileM (Exp, UsesFloat)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm"><span class="hs-identifier hs-var">closedTerm</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133562"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-918"></span><span>
</span><span id="line-919"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm"><span class="hs-identifier hs-type">closedTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TTerm"><span class="hs-identifier hs-type">T.TTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-920"></span><span id="closedTerm"><span class="annot"><span class="annottext">closedTerm :: TTerm -&gt; HsCompileM (Exp, UsesFloat)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm"><span class="hs-identifier hs-var hs-var">closedTerm</span></a></span></span><span> </span><span id="local-6989586621681133561"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133561"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-921"></span><span>  </span><span id="local-6989586621681133560"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133560"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM TTerm -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) TTerm
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM TTerm
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) TTerm)
-&gt; TCM TTerm
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) TTerm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; TCM TTerm
forall (m :: * -&gt; *). HasConstInfo m =&gt; TTerm -&gt; m TTerm
</span><a href="Agda.Compiler.MAlonzo.Coerce.html#addCoercions"><span class="hs-identifier hs-var">addCoercions</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133561"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-922"></span><span>  </span><span class="annot"><span class="annottext">WriterT
  UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)) Exp
-&gt; HsCompileM (Exp, UsesFloat)
forall w (m :: * -&gt; *) a. WriterT w m a -&gt; m (a, w)
</span><span class="hs-identifier hs-var">runWriterT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133560"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">CC Exp
-&gt; CCEnv
-&gt; WriterT
     UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)) Exp
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-operator hs-var">`runReaderT`</span></span><span> </span><span class="annot"><span class="annottext">CCEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#initCCEnv"><span class="hs-identifier hs-var">initCCEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-923"></span><span>
</span><span id="line-924"></span><span class="hs-comment">-- Translate case on bool to if</span><span>
</span><span id="line-925"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#mkIf"><span class="hs-identifier hs-type">mkIf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TTerm"><span class="hs-identifier hs-type">T.TTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CC"><span class="hs-identifier hs-type">CC</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TTerm"><span class="hs-identifier hs-type">T.TTerm</span></a></span><span>
</span><span id="line-926"></span><span id="mkIf"><span class="annot"><span class="annottext">mkIf :: TTerm -&gt; CC TTerm
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#mkIf"><span class="hs-identifier hs-var hs-var">mkIf</span></a></span></span><span> </span><span id="local-6989586621681133556"><span class="annot"><span class="annottext">t :: TTerm
</span><a href="#local-6989586621681133556"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Treeless.html#TCase"><span class="hs-identifier hs-type">TCase</span></a></span><span> </span><span id="local-6989586621681133554"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133554"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">CaseInfo
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681133553"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133553"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Treeless.html#TACon"><span class="hs-identifier hs-type">TACon</span></a></span><span> </span><span id="local-6989586621681133551"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133551"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621681133550"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133550"><span class="hs-identifier hs-var">b1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TACon"><span class="hs-identifier hs-type">TACon</span></a></span><span> </span><span id="local-6989586621681133549"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133549"><span class="hs-identifier hs-var">c2</span></a></span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621681133548"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133548"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; Bool
forall a. Unreachable a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Treeless.html#isUnreachable"><span class="hs-identifier hs-var">T.isUnreachable</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133553"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-927"></span><span>  </span><span id="local-6989586621681133546"><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621681133546"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) GHCEnv
-&gt; CCT TCM GHCEnv
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) GHCEnv
forall (m :: * -&gt; *). ReadGHCModuleEnv m =&gt; m GHCEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#askGHCEnv"><span class="hs-identifier hs-var">askGHCEnv</span></a></span><span>
</span><span id="line-928"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133545"><span class="annot"><span class="annottext">isTrue :: QName -&gt; Bool
</span><a href="#local-6989586621681133545"><span class="hs-identifier hs-var hs-var">isTrue</span></a></span></span><span>  </span><span id="local-6989586621681133544"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133544"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133544"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; Maybe QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvTrue"><span class="hs-identifier hs-var">ghcEnvTrue</span></a></span><span>  </span><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621681133546"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-929"></span><span>      </span><span id="local-6989586621681133543"><span class="annot"><span class="annottext">isFalse :: QName -&gt; Bool
</span><a href="#local-6989586621681133543"><span class="hs-identifier hs-var hs-var">isFalse</span></a></span></span><span> </span><span id="local-6989586621681133542"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133542"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133542"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; Maybe QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvFalse"><span class="hs-identifier hs-var">ghcEnvFalse</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621681133546"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-930"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Bool
</span><a href="#local-6989586621681133545"><span class="hs-identifier hs-var">isTrue</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133551"><span class="hs-identifier hs-var">c1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Bool
</span><a href="#local-6989586621681133543"><span class="hs-identifier hs-var">isFalse</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133549"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC TTerm
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(TTerm -&gt; CC TTerm) -&gt; TTerm -&gt; CC TTerm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; TTerm -&gt; TTerm -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#tIfThenElse"><span class="hs-identifier hs-var">T.tIfThenElse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TTerm -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#TCoerce"><span class="hs-identifier hs-var">TCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">(TTerm -&gt; TTerm) -&gt; TTerm -&gt; TTerm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#TVar"><span class="hs-identifier hs-var">TVar</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133554"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133550"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133548"><span class="hs-identifier hs-var">b2</span></a></span><span>
</span><span id="line-931"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Bool
</span><a href="#local-6989586621681133545"><span class="hs-identifier hs-var">isTrue</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133549"><span class="hs-identifier hs-var">c2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Bool
</span><a href="#local-6989586621681133543"><span class="hs-identifier hs-var">isFalse</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133551"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC TTerm
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(TTerm -&gt; CC TTerm) -&gt; TTerm -&gt; CC TTerm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; TTerm -&gt; TTerm -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#tIfThenElse"><span class="hs-identifier hs-var">T.tIfThenElse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TTerm -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#TCoerce"><span class="hs-identifier hs-var">TCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">(TTerm -&gt; TTerm) -&gt; TTerm -&gt; TTerm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#TVar"><span class="hs-identifier hs-var">TVar</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133554"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133548"><span class="hs-identifier hs-var">b2</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133550"><span class="hs-identifier hs-var">b1</span></a></span><span>
</span><span id="line-932"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC TTerm
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133556"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-933"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#mkIf"><span class="hs-identifier hs-var">mkIf</span></a></span><span> </span><span id="local-6989586621681133538"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133538"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC TTerm
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133538"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-934"></span><span>
</span><span id="line-935"></span><span class="hs-comment">-- | Extract Agda term to Haskell expression.</span><span>
</span><span id="line-936"></span><span class="hs-comment">--   Erased arguments are extracted as @()@.</span><span>
</span><span id="line-937"></span><span class="hs-comment">--   Types are extracted as @()@.</span><span>
</span><span id="line-938"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-type">term</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TTerm"><span class="hs-identifier hs-type">T.TTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CC"><span class="hs-identifier hs-type">CC</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-939"></span><span id="term"><span class="annot"><span class="annottext">term :: TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var hs-var">term</span></a></span></span><span> </span><span id="local-6989586621681133537"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133537"><span class="hs-identifier hs-var">tm0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC TTerm
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#mkIf"><span class="hs-identifier hs-var">mkIf</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133537"><span class="hs-identifier hs-var">tm0</span></a></span><span> </span><span class="annot"><span class="annottext">CC TTerm -&gt; (TTerm -&gt; CC Exp) -&gt; CC Exp
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681133536"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133536"><span class="hs-identifier hs-var">tm0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-940"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681133535"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133535"><span class="hs-identifier hs-var">hasCoerce</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681133534"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133534"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681133533"><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621681133533"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; ((Bool, TTerm), [TTerm])
</span><a href="Agda.Syntax.Treeless.html#coerceAppView"><span class="hs-identifier hs-var">coerceAppView</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133536"><span class="hs-identifier hs-var">tm0</span></a></span><span>
</span><span id="line-941"></span><span>  </span><span class="hs-comment">-- let (t0, ts)       = tAppView tm0</span><span>
</span><span id="line-942"></span><span>  </span><span class="hs-comment">-- let (hasCoerce, t) = coerceView t0</span><span>
</span><span id="line-943"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133531"><span class="annot"><span class="annottext">coe :: Exp -&gt; Exp
</span><a href="#local-6989586621681133531"><span class="hs-identifier hs-var hs-var">coe</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (Exp -&gt; Exp) -&gt; Exp -&gt; Exp
forall a. Bool -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Agda.Utils.Function.html#applyWhen"><span class="hs-identifier hs-var">applyWhen</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133535"><span class="hs-identifier hs-var">hasCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hsCoerce"><span class="hs-identifier hs-var">hsCoerce</span></a></span><span>
</span><span id="line-944"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133534"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621681133533"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-945"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Treeless.html#TPrim"><span class="hs-identifier hs-type">T.TPrim</span></a></span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PIf"><span class="hs-identifier hs-var">T.PIf</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621681133527"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133527"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681133526"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133526"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681133525"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133525"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="#local-6989586621681133531"><span class="hs-identifier hs-var">coe</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp) -&gt; CC Exp -&gt; CC Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#If"><span class="hs-identifier hs-var">HS.If</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp -&gt; Exp -&gt; Exp)
-&gt; CC Exp
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     (Exp -&gt; Exp -&gt; Exp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133527"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT
  CCEnv
  (WriterT
     UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
  (Exp -&gt; Exp -&gt; Exp)
-&gt; CC Exp
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     (Exp -&gt; Exp)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133526"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT
  CCEnv
  (WriterT
     UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
  (Exp -&gt; Exp)
-&gt; CC Exp -&gt; CC Exp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133525"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-946"></span><span>
</span><span id="line-947"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Treeless.html#TDef"><span class="hs-identifier hs-type">T.TDef</span></a></span><span> </span><span id="local-6989586621681133522"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133522"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681133521"><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621681133521"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-948"></span><span>      </span><span id="local-6989586621681133520"><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621681133520"><span class="hs-identifier hs-var">used</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) [ArgUsage]
-&gt; CCT TCM [ArgUsage]
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT GHCModuleEnv (StateT HsCompileState TCM) [ArgUsage]
 -&gt; CCT TCM [ArgUsage])
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [ArgUsage]
-&gt; CCT TCM [ArgUsage]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ArgUsage] -&gt; Maybe [ArgUsage] -&gt; [ArgUsage]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Maybe [ArgUsage] -&gt; [ArgUsage])
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (Maybe [ArgUsage])
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) [ArgUsage]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (Maybe [ArgUsage])
forall (m :: * -&gt; *).
HasConstInfo m =&gt;
QName -&gt; m (Maybe [ArgUsage])
</span><a href="Agda.TypeChecking.Monad.Signature.html#getCompiledArgUse"><span class="hs-identifier hs-var">getCompiledArgUse</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133522"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-949"></span><span>      </span><span class="hs-comment">-- #2248: no unused argument pruning for COMPILE'd functions</span><span>
</span><span id="line-950"></span><span>      </span><span id="local-6989586621681133519"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133519"><span class="hs-identifier hs-var">isCompiled</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM Bool
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Bool
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM Bool
 -&gt; ReaderT
      CCEnv
      (WriterT
         UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
      Bool)
-&gt; TCM Bool
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe HaskellPragma -&gt; Bool)
-&gt; TCM (Maybe HaskellPragma) -&gt; TCM Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM (Maybe HaskellPragma)
</span><a href="Agda.Compiler.MAlonzo.Pragmas.html#getHaskellPragma"><span class="hs-identifier hs-var">getHaskellPragma</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133522"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-951"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133517"><span class="annot"><span class="annottext">given :: Nat
</span><a href="#local-6989586621681133517"><span class="hs-identifier hs-var hs-var">given</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TTerm] -&gt; Nat
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Nat
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621681133521"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-952"></span><span>          </span><span id="local-6989586621681133516"><span class="annot"><span class="annottext">needed :: Nat
</span><a href="#local-6989586621681133516"><span class="hs-identifier hs-var hs-var">needed</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ArgUsage] -&gt; Nat
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Nat
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621681133520"><span class="hs-identifier hs-var">used</span></a></span><span>
</span><span id="line-953"></span><span>          </span><span id="local-6989586621681133515"><span class="annot"><span class="annottext">missing :: [ArgUsage]
</span><a href="#local-6989586621681133515"><span class="hs-identifier hs-var hs-var">missing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; [ArgUsage] -&gt; [ArgUsage]
forall a. Nat -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133517"><span class="hs-identifier hs-var">given</span></a></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621681133520"><span class="hs-identifier hs-var">used</span></a></span><span>
</span><span id="line-954"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133519"><span class="hs-identifier hs-var">isCompiled</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">ArgUsage
</span><a href="Agda.Syntax.Treeless.html#ArgUnused"><span class="hs-identifier hs-var">ArgUnused</span></a></span><span> </span><span class="annot"><span class="annottext">ArgUsage -&gt; [ArgUsage] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621681133520"><span class="hs-identifier hs-var">used</span></a></span><span>
</span><span id="line-955"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ArgUsage
</span><a href="Agda.Syntax.Treeless.html#ArgUnused"><span class="hs-identifier hs-var">ArgUnused</span></a></span><span> </span><span class="annot"><span class="annottext">ArgUsage -&gt; [ArgUsage] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621681133515"><span class="hs-identifier hs-var">missing</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat -&gt; TTerm -&gt; TTerm
</span><a href="#local-6989586621681133513"><span class="hs-identifier hs-var">etaExpand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133516"><span class="hs-identifier hs-var">needed</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133517"><span class="hs-identifier hs-var">given</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133536"><span class="hs-identifier hs-var">tm0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-956"></span><span>          </span><span id="local-6989586621681133512"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133512"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp -&gt; CC Exp
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp -&gt; CC Exp)
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp)
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) QName
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NameKind
-&gt; QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#xhqn"><span class="hs-identifier hs-var">xhqn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunctionKind -&gt; NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#FunK"><span class="hs-identifier hs-var">FunK</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#NoUnused"><span class="hs-identifier hs-var">NoUnused</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133522"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-957"></span><span>                                   </span><span class="hs-comment">-- use stripped function</span><span>
</span><span id="line-958"></span><span>          </span><span class="hs-comment">-- Andreas, 2019-11-07, issue #4169.</span><span>
</span><span id="line-959"></span><span>          </span><span class="hs-comment">-- Insert coercion unconditionally as erasure of arguments</span><span>
</span><span id="line-960"></span><span>          </span><span class="hs-comment">-- that are matched upon might remove the unfolding of codomain types.</span><span>
</span><span id="line-961"></span><span>          </span><span class="hs-comment">-- (Hard to explain, see test/Compiler/simple/Issue4169.)</span><span>
</span><span id="line-962"></span><span>          </span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hsCoerce"><span class="hs-identifier hs-var">hsCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133512"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [TTerm] -&gt; CC Exp
</span><a href="#local-6989586621681133509"><span class="hs-operator hs-var">`apps`</span></a></span><span> </span><span class="annot"><span class="annottext">[ArgUsage] -&gt; [TTerm] -&gt; [TTerm]
forall a. [ArgUsage] -&gt; [a] -&gt; [a]
</span><a href="Agda.Syntax.Treeless.html#filterUsed"><span class="hs-identifier hs-var">filterUsed</span></a></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621681133520"><span class="hs-identifier hs-var">used</span></a></span><span> </span><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621681133521"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-963"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-964"></span><span>          </span><span id="local-6989586621681133508"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133508"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp -&gt; CC Exp
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp -&gt; CC Exp)
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp)
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) QName
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NameKind
-&gt; QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#xhqn"><span class="hs-identifier hs-var">xhqn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunctionKind -&gt; NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#FunK"><span class="hs-identifier hs-var">FunK</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#PossiblyUnused"><span class="hs-identifier hs-var">PossiblyUnused</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133522"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-965"></span><span>                                   </span><span class="hs-comment">-- use original (non-stripped) function</span><span>
</span><span id="line-966"></span><span>          </span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="#local-6989586621681133531"><span class="hs-identifier hs-var">coe</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133508"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [TTerm] -&gt; CC Exp
</span><a href="#local-6989586621681133509"><span class="hs-operator hs-var">`apps`</span></a></span><span> </span><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621681133521"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-967"></span><span>
</span><span id="line-968"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Treeless.html#TCon"><span class="hs-identifier hs-type">T.TCon</span></a></span><span> </span><span id="local-6989586621681133505"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133505"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681133504"><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621681133504"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-969"></span><span>      </span><span id="local-6989586621681133503"><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621681133503"><span class="hs-identifier hs-var">erased</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsCompileT TCM [Bool] -&gt; CCT TCM [Bool]
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">(HsCompileT TCM [Bool] -&gt; CCT TCM [Bool])
-&gt; HsCompileT TCM [Bool] -&gt; CCT TCM [Bool]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; HsCompileT TCM [Bool]
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m [Bool]
</span><a href="Agda.TypeChecking.Monad.Signature.html#getErasedConArgs"><span class="hs-identifier hs-var">getErasedConArgs</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133505"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-970"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133501"><span class="annot"><span class="annottext">missing :: [Bool]
</span><a href="#local-6989586621681133501"><span class="hs-identifier hs-var hs-var">missing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; [Bool] -&gt; [Bool]
forall a. Nat -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TTerm] -&gt; Nat
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Nat
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621681133504"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621681133503"><span class="hs-identifier hs-var">erased</span></a></span><span>
</span><span id="line-971"></span><span>          </span><span id="local-6989586621681133500"><span class="annot"><span class="annottext">notErased :: Bool -&gt; Bool
</span><a href="#local-6989586621681133500"><span class="hs-identifier hs-var hs-var">notErased</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span>
</span><span id="line-972"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; [Bool] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="#local-6989586621681133500"><span class="hs-identifier hs-var">notErased</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621681133501"><span class="hs-identifier hs-var">missing</span></a></span><span>
</span><span id="line-973"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-974"></span><span>                </span><span id="local-6989586621681133498"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133498"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp -&gt; CC Exp
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp -&gt; CC Exp)
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Con"><span class="hs-identifier hs-var">HS.Con</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp)
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) QName
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#conhqn"><span class="hs-identifier hs-var">conhqn</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133505"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-975"></span><span>                </span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hsCoerce"><span class="hs-identifier hs-var">hsCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133498"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [TTerm] -&gt; CC Exp
</span><a href="#local-6989586621681133509"><span class="hs-operator hs-var">`apps`</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133495"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681133495"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133495"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TTerm] -&gt; [Bool] -&gt; [(TTerm, Bool)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621681133504"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621681133503"><span class="hs-identifier hs-var">erased</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-976"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-977"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133494"><span class="annot"><span class="annottext">n :: Nat
</span><a href="#local-6989586621681133494"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Nat
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Nat
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621681133501"><span class="hs-identifier hs-var">missing</span></a></span><span>
</span><span id="line-978"></span><span>                </span><span class="annot"><span class="annottext">Bool
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     ()
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133494"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ReaderT
  CCEnv
  (WriterT
     UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
  ()
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>  </span><span class="hs-comment">-- We will add at least on TLam, not getting a busy loop here.</span><span>
</span><span id="line-979"></span><span>                </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">(TTerm -&gt; CC Exp) -&gt; TTerm -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TTerm -&gt; TTerm
</span><a href="#local-6989586621681133513"><span class="hs-identifier hs-var">etaExpand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Bool] -&gt; Nat
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Nat
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621681133501"><span class="hs-identifier hs-var">missing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133536"><span class="hs-identifier hs-var">tm0</span></a></span><span>
</span><span id="line-980"></span><span>
</span><span id="line-981"></span><span>    </span><span class="hs-comment">-- Other kind of application: fall back to apps.</span><span>
</span><span id="line-982"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681133492"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133492"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681133491"><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621681133491"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#noApplication"><span class="hs-identifier hs-var">noApplication</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133492"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">CC Exp -&gt; (Exp -&gt; CC Exp) -&gt; CC Exp
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681133489"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133489"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="#local-6989586621681133531"><span class="hs-identifier hs-var">coe</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133489"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [TTerm] -&gt; CC Exp
</span><a href="#local-6989586621681133509"><span class="hs-operator hs-var">`apps`</span></a></span><span> </span><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621681133491"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-983"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-984"></span><span>  </span><span id="local-6989586621681133509"><span class="annot"><span class="annottext">apps :: Exp -&gt; [TTerm] -&gt; CC Exp
</span><a href="#local-6989586621681133509"><span class="hs-identifier hs-var hs-var">apps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; TTerm -&gt; CC Exp) -&gt; Exp -&gt; [TTerm] -&gt; CC Exp
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681133473"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133473"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621681133472"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133472"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-identifier hs-var">HS.App</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133473"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp) -&gt; CC Exp -&gt; CC Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133472"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-985"></span><span>  </span><span id="local-6989586621681133513"><span class="annot"><span class="annottext">etaExpand :: Nat -&gt; TTerm -&gt; TTerm
</span><a href="#local-6989586621681133513"><span class="hs-identifier hs-var hs-var">etaExpand</span></a></span></span><span> </span><span id="local-6989586621681133467"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133467"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681133466"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133466"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TTerm -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#mkTLam"><span class="hs-identifier hs-var">mkTLam</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133467"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(TTerm -&gt; TTerm) -&gt; TTerm -&gt; TTerm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TTerm -&gt; TTerm
forall a. Subst a =&gt; Nat -&gt; a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#raise"><span class="hs-identifier hs-var">raise</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133467"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133466"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; [TTerm] -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#mkTApp"><span class="hs-operator hs-var">`T.mkTApp`</span></a></span><span> </span><span class="annot"><span class="annottext">(Nat -&gt; TTerm) -&gt; [Nat] -&gt; [TTerm]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#TVar"><span class="hs-identifier hs-var">T.TVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat -&gt; [Nat]
forall a. Integral a =&gt; a -&gt; [a]
</span><a href="Agda.Utils.List.html#downFrom"><span class="hs-identifier hs-var">downFrom</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133467"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-986"></span><span>
</span><span id="line-987"></span><span class="hs-comment">-- | Translate a non-application, non-coercion, non-constructor, non-definition term.</span><span>
</span><span id="line-988"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#noApplication"><span class="hs-identifier hs-type">noApplication</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TTerm"><span class="hs-identifier hs-type">T.TTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CC"><span class="hs-identifier hs-type">CC</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-989"></span><span id="noApplication"><span class="annot"><span class="annottext">noApplication :: TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#noApplication"><span class="hs-identifier hs-var hs-var">noApplication</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-990"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TApp"><span class="hs-identifier hs-type">T.TApp</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CC Exp
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-991"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TCoerce"><span class="hs-identifier hs-type">T.TCoerce</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CC Exp
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-992"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TCon"><span class="hs-identifier hs-type">T.TCon</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CC Exp
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-993"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TDef"><span class="hs-identifier hs-type">T.TDef</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CC Exp
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-994"></span><span>
</span><span id="line-995"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TVar"><span class="hs-identifier hs-type">T.TVar</span></a></span><span> </span><span id="local-6989586621681133460"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133460"><span class="hs-identifier hs-var">i</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsVarUQ"><span class="hs-identifier hs-var">hsVarUQ</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Exp) -&gt; ([Name] -&gt; Name) -&gt; [Name] -&gt; Exp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; [Name] -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#lookupIndex"><span class="hs-identifier hs-var">lookupIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133460"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; Exp)
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     [Name]
-&gt; CC Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Lens' [Name] CCEnv
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     [Name]
forall o (m :: * -&gt; *) i. MonadReader o m =&gt; Lens' i o -&gt; m i
</span><a href="Agda.Utils.Lens.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' [Name] CCEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ccContext"><span class="hs-identifier hs-var">ccContext</span></a></span><span>
</span><span id="line-996"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TLam"><span class="hs-identifier hs-type">T.TLam</span></a></span><span> </span><span id="local-6989586621681133457"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133457"><span class="hs-identifier hs-var">t</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; ([Name] -&gt; CC Exp) -&gt; CC Exp
forall (m :: * -&gt; *) a.
Monad m =&gt;
Nat -&gt; ([Name] -&gt; CCT m a) -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#intros"><span class="hs-identifier hs-var">intros</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(([Name] -&gt; CC Exp) -&gt; CC Exp) -&gt; ([Name] -&gt; CC Exp) -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">[</span><span id="local-6989586621681133456"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133456"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsLambda"><span class="hs-identifier hs-var">hsLambda</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-var">HS.PVar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133456"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp) -&gt; CC Exp -&gt; CC Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133457"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-997"></span><span>
</span><span id="line-998"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TLet"><span class="hs-identifier hs-type">T.TLet</span></a></span><span> </span><span id="local-6989586621681133453"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133453"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621681133452"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133452"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-999"></span><span>    </span><span id="local-6989586621681133451"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133451"><span class="hs-identifier hs-var">t1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133453"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-1000"></span><span>    </span><span class="annot"><span class="annottext">Nat -&gt; ([Name] -&gt; CC Exp) -&gt; CC Exp
forall (m :: * -&gt; *) a.
Monad m =&gt;
Nat -&gt; ([Name] -&gt; CCT m a) -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#intros"><span class="hs-identifier hs-var">intros</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(([Name] -&gt; CC Exp) -&gt; CC Exp) -&gt; ([Name] -&gt; CC Exp) -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">[</span><span id="local-6989586621681133450"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133450"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1001"></span><span>      </span><span class="annot"><span class="annottext">Name -&gt; Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsLet"><span class="hs-identifier hs-var">hsLet</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133450"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133451"><span class="hs-identifier hs-var">t1'</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp) -&gt; CC Exp -&gt; CC Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133452"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-1002"></span><span>
</span><span id="line-1003"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TCase"><span class="hs-identifier hs-type">T.TCase</span></a></span><span> </span><span id="local-6989586621681133448"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133448"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span id="local-6989586621681133447"><span class="annot"><span class="annottext">CaseInfo
</span><a href="#local-6989586621681133447"><span class="hs-identifier hs-var">ct</span></a></span></span><span> </span><span id="local-6989586621681133446"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133446"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span id="local-6989586621681133445"><span class="annot"><span class="annottext">[TAlt]
</span><a href="#local-6989586621681133445"><span class="hs-identifier hs-var">alts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1004"></span><span>    </span><span id="local-6989586621681133444"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133444"><span class="hs-identifier hs-var">sc'</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">(TTerm -&gt; CC Exp) -&gt; TTerm -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#TVar"><span class="hs-identifier hs-var">T.TVar</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133448"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-1005"></span><span>    </span><span id="local-6989586621681133443"><span class="annot"><span class="annottext">[Alt]
</span><a href="#local-6989586621681133443"><span class="hs-identifier hs-var">alts'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TAlt
 -&gt; ReaderT
      CCEnv
      (WriterT
         UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
      Alt)
-&gt; [TAlt]
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     [Alt]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat
-&gt; TAlt
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#alt"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133448"><span class="hs-identifier hs-var">sc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TAlt]
</span><a href="#local-6989586621681133445"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-1006"></span><span>    </span><span id="local-6989586621681133440"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133440"><span class="hs-identifier hs-var">def'</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133446"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-1007"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133439"><span class="annot"><span class="annottext">defAlt :: Alt
</span><a href="#local-6989586621681133439"><span class="hs-identifier hs-var hs-var">defAlt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Rhs -&gt; Maybe Binds -&gt; Alt
</span><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-var">HS.Alt</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PWildCard"><span class="hs-identifier hs-var">HS.PWildCard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133440"><span class="hs-identifier hs-var">def'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span>
</span><span id="line-1008"></span><span>    </span><span class="annot"><span class="annottext">Exp -&gt; CC Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CC Exp) -&gt; Exp -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Alt] -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Case"><span class="hs-identifier hs-var">HS.Case</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hsCoerce"><span class="hs-identifier hs-var">hsCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133444"><span class="hs-identifier hs-var">sc'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Alt]
</span><a href="#local-6989586621681133443"><span class="hs-identifier hs-var">alts'</span></a></span><span> </span><span class="annot"><span class="annottext">[Alt] -&gt; [Alt] -&gt; [Alt]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Alt
</span><a href="#local-6989586621681133439"><span class="hs-identifier hs-var">defAlt</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1009"></span><span>
</span><span id="line-1010"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TLit"><span class="hs-identifier hs-type">T.TLit</span></a></span><span> </span><span id="local-6989586621681133437"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621681133437"><span class="hs-identifier hs-var">l</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CC Exp
forall (m :: * -&gt; *). Monad m =&gt; Literal -&gt; CCT m Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621681133437"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1011"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TPrim"><span class="hs-identifier hs-type">T.TPrim</span></a></span><span> </span><span id="local-6989586621681133435"><span class="annot"><span class="annottext">TPrim
</span><a href="#local-6989586621681133435"><span class="hs-identifier hs-var">p</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CC Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CC Exp) -&gt; Exp -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TPrim -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compilePrim"><span class="hs-identifier hs-var">compilePrim</span></a></span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="#local-6989586621681133435"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1012"></span><span>  </span><span class="annot"><span class="annottext">TTerm
</span><a href="Agda.Syntax.Treeless.html#TUnit"><span class="hs-identifier hs-var">T.TUnit</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CC Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CC Exp) -&gt; Exp -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-var">HS.unit_con</span></a></span><span>
</span><span id="line-1013"></span><span>  </span><span class="annot"><span class="annottext">TTerm
</span><a href="Agda.Syntax.Treeless.html#TSort"><span class="hs-identifier hs-var">T.TSort</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CC Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CC Exp) -&gt; Exp -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-var">HS.unit_con</span></a></span><span>
</span><span id="line-1014"></span><span>  </span><span class="annot"><span class="annottext">TTerm
</span><a href="Agda.Syntax.Treeless.html#TErased"><span class="hs-identifier hs-var">T.TErased</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CC Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CC Exp) -&gt; Exp -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsVarUQ"><span class="hs-identifier hs-var">hsVarUQ</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Exp) -&gt; Name -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazErasedName"><span class="hs-identifier hs-var">mazErasedName</span></a></span><span>
</span><span id="line-1015"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TError"><span class="hs-identifier hs-type">T.TError</span></a></span><span> </span><span id="local-6989586621681133430"><span class="annot"><span class="annottext">TError
</span><a href="#local-6989586621681133430"><span class="hs-identifier hs-var">e</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CC Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CC Exp) -&gt; Exp -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TError
</span><a href="#local-6989586621681133430"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1016"></span><span>    </span><span class="annot"><span class="annottext">TError
</span><a href="Agda.Syntax.Treeless.html#TUnreachable"><span class="hs-identifier hs-var">T.TUnreachable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#rtmUnreachableError"><span class="hs-identifier hs-var">rtmUnreachableError</span></a></span><span>
</span><span id="line-1017"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TMeta"><span class="hs-identifier hs-type">T.TMeta</span></a></span><span> </span><span id="local-6989586621681133426"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133426"><span class="hs-identifier hs-var">s</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#rtmHole"><span class="hs-identifier hs-var">rtmHole</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133426"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1018"></span><span>
</span><span id="line-1019"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#hsCoerce"><span class="hs-identifier hs-type">hsCoerce</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-1020"></span><span id="hsCoerce"><span class="annot"><span class="annottext">hsCoerce :: Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hsCoerce"><span class="hs-identifier hs-var hs-var">hsCoerce</span></a></span></span><span> </span><span id="local-6989586621681133424"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133424"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-identifier hs-var">HS.App</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazCoerce"><span class="hs-identifier hs-var">mazCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133424"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1021"></span><span>
</span><span id="line-1022"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#compilePrim"><span class="hs-identifier hs-type">compilePrim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TPrim"><span class="hs-identifier hs-type">T.TPrim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-1023"></span><span id="compilePrim"><span class="annot"><span class="annottext">compilePrim :: TPrim -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compilePrim"><span class="hs-identifier hs-var hs-var">compilePrim</span></a></span></span><span> </span><span id="local-6989586621681133422"><span class="annot"><span class="annottext">TPrim
</span><a href="#local-6989586621681133422"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp) -&gt; QName -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsName"><span class="hs-identifier hs-var">hsName</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; QName) -&gt; FilePath -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TPrim -&gt; FilePath
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#treelessPrimName"><span class="hs-identifier hs-var">treelessPrimName</span></a></span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="#local-6989586621681133422"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1024"></span><span>
</span><span id="line-1025"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#alt"><span class="hs-identifier hs-type">alt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TAlt"><span class="hs-identifier hs-type">T.TAlt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CC"><span class="hs-identifier hs-type">CC</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-type">HS.Alt</span></a></span><span>
</span><span id="line-1026"></span><span id="alt"><span class="annot"><span class="annottext">alt :: Nat
-&gt; TAlt
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#alt"><span class="hs-identifier hs-var hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621681133420"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133420"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span id="local-6989586621681133419"><span class="annot"><span class="annottext">TAlt
</span><a href="#local-6989586621681133419"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1027"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TAlt
</span><a href="#local-6989586621681133419"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1028"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TACon"><span class="hs-identifier hs-type">T.TACon</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">aCon :: TAlt -&gt; QName
</span><a href="Agda.Syntax.Treeless.html#aCon"><span class="hs-identifier hs-var">T.aCon</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681133417"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133417"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1029"></span><span>      </span><span class="annot"><span class="annottext">Nat
-&gt; ([Name]
    -&gt; ReaderT
         CCEnv
         (WriterT
            UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
         Alt)
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
forall (m :: * -&gt; *) a.
Monad m =&gt;
Nat -&gt; ([Name] -&gt; CCT m a) -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#intros"><span class="hs-identifier hs-var">intros</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TAlt -&gt; Nat
</span><a href="Agda.Syntax.Treeless.html#aArity"><span class="hs-identifier hs-var">T.aArity</span></a></span><span> </span><span class="annot"><span class="annottext">TAlt
</span><a href="#local-6989586621681133419"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([Name]
  -&gt; ReaderT
       CCEnv
       (WriterT
          UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
       Alt)
 -&gt; ReaderT
      CCEnv
      (WriterT
         UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
      Alt)
-&gt; ([Name]
    -&gt; ReaderT
         CCEnv
         (WriterT
            UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
         Alt)
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681133415"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681133415"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1030"></span><span>        </span><span id="local-6989586621681133414"><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621681133414"><span class="hs-identifier hs-var">erased</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsCompileT TCM [Bool] -&gt; CCT TCM [Bool]
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">(HsCompileT TCM [Bool] -&gt; CCT TCM [Bool])
-&gt; HsCompileT TCM [Bool] -&gt; CCT TCM [Bool]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; HsCompileT TCM [Bool]
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m [Bool]
</span><a href="Agda.TypeChecking.Monad.Signature.html#getErasedConArgs"><span class="hs-identifier hs-var">getErasedConArgs</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133417"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-1031"></span><span>        </span><span id="local-6989586621681133413"><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621681133413"><span class="hs-identifier hs-var">env</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) GHCEnv
-&gt; CCT TCM GHCEnv
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) GHCEnv
forall (m :: * -&gt; *). ReadGHCModuleEnv m =&gt; m GHCEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#askGHCEnv"><span class="hs-identifier hs-var">askGHCEnv</span></a></span><span>
</span><span id="line-1032"></span><span>        </span><span id="local-6989586621681133412"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133412"><span class="hs-identifier hs-var">hConNm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-1033"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133417"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; Maybe QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvNil"><span class="hs-identifier hs-var">ghcEnvNil</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621681133413"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1034"></span><span>               </span><span class="annot"><span class="annottext">QName
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     QName
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(QName
 -&gt; ReaderT
      CCEnv
      (WriterT
         UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
      QName)
-&gt; QName
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-var">HS.UnQual</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;[]&quot;</span></span><span>
</span><span id="line-1035"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133417"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; Maybe QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">GHCEnv -&gt; Maybe QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ghcEnvCons"><span class="hs-identifier hs-var">ghcEnvCons</span></a></span><span> </span><span class="annot"><span class="annottext">GHCEnv
</span><a href="#local-6989586621681133413"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1036"></span><span>               </span><span class="annot"><span class="annottext">QName
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     QName
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(QName
 -&gt; ReaderT
      CCEnv
      (WriterT
         UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
      QName)
-&gt; QName
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-var">HS.UnQual</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Symbol"><span class="hs-identifier hs-var">HS.Symbol</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;:&quot;</span></span><span>
</span><span id="line-1037"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) QName
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     QName
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT GHCModuleEnv (StateT HsCompileState TCM) QName
 -&gt; ReaderT
      CCEnv
      (WriterT
         UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
      QName)
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) QName
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#conhqn"><span class="hs-identifier hs-var">conhqn</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133417"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-1038"></span><span>        </span><span class="annot"><span class="annottext">Pat
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
</span><a href="#local-6989586621681133410"><span class="hs-identifier hs-var">mkAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; [Pat] -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PApp"><span class="hs-identifier hs-var">HS.PApp</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133412"><span class="hs-identifier hs-var">hConNm</span></a></span><span> </span><span class="annot"><span class="annottext">([Pat] -&gt; Pat) -&gt; [Pat] -&gt; Pat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-var">HS.PVar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133409"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681133409"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133409"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Bool] -&gt; [(Name, Bool)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681133415"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621681133414"><span class="hs-identifier hs-var">erased</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1039"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TAGuard"><span class="hs-identifier hs-type">T.TAGuard</span></a></span><span> </span><span id="local-6989586621681133407"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133407"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621681133406"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133406"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1040"></span><span>      </span><span id="local-6989586621681133405"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133405"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133407"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-1041"></span><span>      </span><span id="local-6989586621681133404"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133404"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133406"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1042"></span><span>      </span><span class="annot"><span class="annottext">Alt
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Alt
 -&gt; ReaderT
      CCEnv
      (WriterT
         UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
      Alt)
-&gt; Alt
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Rhs -&gt; Maybe Binds -&gt; Alt
</span><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-var">HS.Alt</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PWildCard"><span class="hs-identifier hs-var">HS.PWildCard</span></a></span><span>
</span><span id="line-1043"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GuardedRhs] -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#GuardedRhss"><span class="hs-identifier hs-var">HS.GuardedRhss</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Stmt] -&gt; Exp -&gt; GuardedRhs
</span><a href="Agda.Utils.Haskell.Syntax.html#GuardedRhs"><span class="hs-identifier hs-var">HS.GuardedRhs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp -&gt; Stmt
</span><a href="Agda.Utils.Haskell.Syntax.html#Qualifier"><span class="hs-identifier hs-var">HS.Qualifier</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133405"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133404"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1044"></span><span>                      </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span>
</span><span id="line-1045"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TALit"><span class="hs-identifier hs-type">T.TALit</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">aLit :: TAlt -&gt; Literal
</span><a href="Agda.Syntax.Treeless.html#aLit"><span class="hs-identifier hs-var">T.aLit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitQName"><span class="hs-identifier hs-type">LitQName</span></a></span><span> </span><span id="local-6989586621681133397"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133397"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pat
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
</span><a href="#local-6989586621681133410"><span class="hs-identifier hs-var">mkAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Pat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#litqnamepat"><span class="hs-identifier hs-var">litqnamepat</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133397"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1046"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TALit"><span class="hs-identifier hs-type">T.TALit</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">aLit :: TAlt -&gt; Literal
</span><a href="Agda.Syntax.Treeless.html#aLit"><span class="hs-identifier hs-var">T.aLit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681133395"><span class="annot"><span class="annottext">l :: Literal
</span><a href="#local-6989586621681133395"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">aBody :: TAlt -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#aBody"><span class="hs-identifier hs-var">T.aBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681133392"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133392"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1047"></span><span>      </span><span class="annot"><span class="annottext">UsesFloat
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="annot"><span class="annottext">UsesFloat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#YesFloat"><span class="hs-identifier hs-var">YesFloat</span></a></span><span>
</span><span id="line-1048"></span><span>      </span><span id="local-6989586621681133390"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133390"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CC Exp
forall (m :: * -&gt; *). Monad m =&gt; Literal -&gt; CCT m Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621681133395"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1049"></span><span>      </span><span class="annot"><span class="annottext">FilePath
-&gt; Exp
-&gt; TTerm
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
</span><a href="#local-6989586621681133389"><span class="hs-identifier hs-var">mkGuarded</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TPrim -&gt; FilePath
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#treelessPrimName"><span class="hs-identifier hs-var">treelessPrimName</span></a></span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PEqF"><span class="hs-identifier hs-var">T.PEqF</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133390"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133392"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1050"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TALit"><span class="hs-identifier hs-type">T.TALit</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">aLit :: TAlt -&gt; Literal
</span><a href="Agda.Syntax.Treeless.html#aLit"><span class="hs-identifier hs-var">T.aLit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitString"><span class="hs-identifier hs-type">LitString</span></a></span><span> </span><span id="local-6989586621681133386"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681133386"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">aBody :: TAlt -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#aBody"><span class="hs-identifier hs-var">T.aBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681133385"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133385"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; Exp
-&gt; TTerm
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
</span><a href="#local-6989586621681133389"><span class="hs-identifier hs-var">mkGuarded</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;(==)&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#litString"><span class="hs-identifier hs-var">litString</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681133386"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133385"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1051"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TALit"><span class="hs-identifier hs-type">T.TALit</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pat
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
</span><a href="#local-6989586621681133410"><span class="hs-identifier hs-var">mkAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PLit"><span class="hs-identifier hs-var">HS.PLit</span></a></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Pat) -&gt; Literal -&gt; Pat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Literal
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hslit"><span class="hs-identifier hs-var">hslit</span></a></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Literal) -&gt; Literal -&gt; Literal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TAlt -&gt; Literal
</span><a href="Agda.Syntax.Treeless.html#aLit"><span class="hs-identifier hs-var">T.aLit</span></a></span><span> </span><span class="annot"><span class="annottext">TAlt
</span><a href="#local-6989586621681133419"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1052"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1053"></span><span>    </span><span id="local-6989586621681133389"><span class="annot"><span class="annottext">mkGuarded :: FilePath
-&gt; Exp
-&gt; TTerm
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
</span><a href="#local-6989586621681133389"><span class="hs-identifier hs-var hs-var">mkGuarded</span></a></span></span><span> </span><span id="local-6989586621681133373"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133373"><span class="hs-identifier hs-var">eq</span></a></span></span><span> </span><span id="local-6989586621681133372"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133372"><span class="hs-identifier hs-var">lit</span></a></span></span><span> </span><span id="local-6989586621681133371"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133371"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1054"></span><span>      </span><span id="local-6989586621681133370"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133370"><span class="hs-identifier hs-var">b</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621681133371"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1055"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133369"><span class="annot"><span class="annottext">varName :: Name
</span><a href="#local-6989586621681133369"><span class="hs-identifier hs-var hs-var">varName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;l&quot;</span></span><span> </span><span class="hs-comment">-- only used locally in the guard</span><span>
</span><span id="line-1056"></span><span>          </span><span id="local-6989586621681133368"><span class="annot"><span class="annottext">pv :: Pat
</span><a href="#local-6989586621681133368"><span class="hs-identifier hs-var hs-var">pv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-var">HS.PVar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133369"><span class="hs-identifier hs-var">varName</span></a></span><span>
</span><span id="line-1057"></span><span>          </span><span id="local-6989586621681133367"><span class="annot"><span class="annottext">v :: Exp
</span><a href="#local-6989586621681133367"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsVarUQ"><span class="hs-identifier hs-var">hsVarUQ</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133369"><span class="hs-identifier hs-var">varName</span></a></span><span>
</span><span id="line-1058"></span><span>          </span><span id="local-6989586621681133366"><span class="annot"><span class="annottext">guard :: Exp
</span><a href="#local-6989586621681133366"><span class="hs-identifier hs-var hs-var">guard</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1059"></span><span>            </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-var">HS.UnQual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133373"><span class="hs-identifier hs-var">eq</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-operator hs-var">`HS.App`</span></a></span><span>
</span><span id="line-1060"></span><span>              </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133367"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-operator hs-var">`HS.App`</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133372"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1061"></span><span>      </span><span class="annot"><span class="annottext">Alt
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Alt
 -&gt; ReaderT
      CCEnv
      (WriterT
         UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
      Alt)
-&gt; Alt
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Rhs -&gt; Maybe Binds -&gt; Alt
</span><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-var">HS.Alt</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621681133368"><span class="hs-identifier hs-var">pv</span></a></span><span>
</span><span id="line-1062"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GuardedRhs] -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#GuardedRhss"><span class="hs-identifier hs-var">HS.GuardedRhss</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Stmt] -&gt; Exp -&gt; GuardedRhs
</span><a href="Agda.Utils.Haskell.Syntax.html#GuardedRhs"><span class="hs-identifier hs-var">HS.GuardedRhs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp -&gt; Stmt
</span><a href="Agda.Utils.Haskell.Syntax.html#Qualifier"><span class="hs-identifier hs-var">HS.Qualifier</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133366"><span class="hs-identifier hs-var">guard</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133370"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1063"></span><span>                      </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span>
</span><span id="line-1064"></span><span>
</span><span id="line-1065"></span><span>    </span><span class="annot"><a href="#local-6989586621681133410"><span class="hs-identifier hs-type">mkAlt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Pat"><span class="hs-identifier hs-type">HS.Pat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CC"><span class="hs-identifier hs-type">CC</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-type">HS.Alt</span></a></span><span>
</span><span id="line-1066"></span><span>    </span><span id="local-6989586621681133410"><span class="annot"><span class="annottext">mkAlt :: Pat
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
</span><a href="#local-6989586621681133410"><span class="hs-identifier hs-var hs-var">mkAlt</span></a></span></span><span> </span><span id="local-6989586621681133365"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621681133365"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1067"></span><span>        </span><span id="local-6989586621681133364"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133364"><span class="hs-identifier hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">(TTerm -&gt; CC Exp) -&gt; TTerm -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TAlt -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#aBody"><span class="hs-identifier hs-var">T.aBody</span></a></span><span> </span><span class="annot"><span class="annottext">TAlt
</span><a href="#local-6989586621681133419"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1068"></span><span>        </span><span class="annot"><span class="annottext">Alt
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Alt
 -&gt; ReaderT
      CCEnv
      (WriterT
         UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
      Alt)
-&gt; Alt
-&gt; ReaderT
     CCEnv
     (WriterT
        UsesFloat (ReaderT GHCModuleEnv (StateT HsCompileState TCM)))
     Alt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Rhs -&gt; Maybe Binds -&gt; Alt
</span><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-var">HS.Alt</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621681133365"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133364"><span class="hs-identifier hs-var">body'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span>
</span><span id="line-1069"></span><span>
</span><span id="line-1070"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#literal"><span class="hs-identifier hs-type">literal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681135573"><span class="annot"><a href="#local-6989586621681135573"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621681135573"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681135573"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-1071"></span><span id="literal"><span class="annot"><span class="annottext">literal :: forall (m :: * -&gt; *). Monad m =&gt; Literal -&gt; CCT m Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#literal"><span class="hs-identifier hs-var hs-var">literal</span></a></span></span><span> </span><span id="local-6989586621681133346"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621681133346"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621681133346"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1072"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitNat"><span class="hs-identifier hs-type">LitNat</span></a></span><span>    </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CCT m Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CCT m Exp) -&gt; Exp -&gt; CCT m Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Exp
</span><a href="#local-6989586621681133344"><span class="hs-identifier hs-var">typed</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Integer&quot;</span></span><span>
</span><span id="line-1073"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitWord64"><span class="hs-identifier hs-type">LitWord64</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CCT m Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CCT m Exp) -&gt; Exp -&gt; CCT m Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Exp
</span><a href="#local-6989586621681133344"><span class="hs-identifier hs-var">typed</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;MAlonzo.RTE.Word64&quot;</span></span><span>
</span><span id="line-1074"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span>  </span><span id="local-6989586621681133342"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621681133342"><span class="hs-identifier hs-var">x</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; FilePath -&gt; CCT m Exp
</span><a href="#local-6989586621681133341"><span class="hs-identifier hs-var">floatExp</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621681133342"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Double&quot;</span></span><span>
</span><span id="line-1075"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitQName"><span class="hs-identifier hs-type">LitQName</span></a></span><span>  </span><span id="local-6989586621681133340"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133340"><span class="hs-identifier hs-var">x</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CCT m Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CCT m Exp) -&gt; Exp -&gt; CCT m Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#litqname"><span class="hs-identifier hs-var">litqname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133340"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1076"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitString"><span class="hs-identifier hs-type">LitString</span></a></span><span> </span><span id="local-6989586621681133338"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681133338"><span class="hs-identifier hs-var">s</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CCT m Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CCT m Exp) -&gt; Exp -&gt; CCT m Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#litString"><span class="hs-identifier hs-var">litString</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681133338"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1077"></span><span>  </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CCT m Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CCT m Exp) -&gt; Exp -&gt; CCT m Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133337"><span class="hs-identifier hs-var">l'</span></a></span><span>
</span><span id="line-1078"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1079"></span><span>    </span><span id="local-6989586621681133337"><span class="annot"><span class="annottext">l' :: Exp
</span><a href="#local-6989586621681133337"><span class="hs-identifier hs-var hs-var">l'</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Lit"><span class="hs-identifier hs-var">HS.Lit</span></a></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Exp) -&gt; Literal -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Literal
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hslit"><span class="hs-identifier hs-var">hslit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621681133346"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1080"></span><span>    </span><span id="local-6989586621681133344"><span class="annot"><span class="annottext">typed :: FilePath -&gt; Exp
</span><a href="#local-6989586621681133344"><span class="hs-identifier hs-var hs-var">typed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Type -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#ExpTypeSig"><span class="hs-identifier hs-var">HS.ExpTypeSig</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621681133337"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Exp) -&gt; (FilePath -&gt; Type) -&gt; FilePath -&gt; Exp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyCon"><span class="hs-identifier hs-var">HS.TyCon</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Type) -&gt; (FilePath -&gt; QName) -&gt; FilePath -&gt; Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#rtmQual"><span class="hs-identifier hs-var">rtmQual</span></a></span><span>
</span><span id="line-1081"></span><span>
</span><span id="line-1082"></span><span>    </span><span class="hs-comment">-- ASR (2016-09-14): See Issue #2169.</span><span>
</span><span id="line-1083"></span><span>    </span><span class="hs-comment">-- Ulf, 2016-09-28: and #2218.</span><span>
</span><span id="line-1084"></span><span>    </span><span class="annot"><a href="#local-6989586621681133341"><span class="hs-identifier hs-type">floatExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681135573"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-1085"></span><span>    </span><span id="local-6989586621681133341"><span class="annot"><span class="annottext">floatExp :: Double -&gt; FilePath -&gt; CCT m Exp
</span><a href="#local-6989586621681133341"><span class="hs-identifier hs-var hs-var">floatExp</span></a></span></span><span> </span><span id="local-6989586621681133333"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621681133333"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681133332"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133332"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-1086"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool
</span><a href="Agda.Utils.Float.html#isPosInf"><span class="hs-identifier hs-var">isPosInf</span></a></span><span>  </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621681133333"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; CCT m Exp
forall {m :: * -&gt; *}. MonadWriter UsesFloat m =&gt; FilePath -&gt; m Exp
</span><a href="#local-6989586621681133330"><span class="hs-identifier hs-var">rte</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;positiveInfinity&quot;</span></span><span>
</span><span id="line-1087"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool
</span><a href="Agda.Utils.Float.html#isNegInf"><span class="hs-identifier hs-var">isNegInf</span></a></span><span>  </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621681133333"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; CCT m Exp
forall {m :: * -&gt; *}. MonadWriter UsesFloat m =&gt; FilePath -&gt; m Exp
</span><a href="#local-6989586621681133330"><span class="hs-identifier hs-var">rte</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;negativeInfinity&quot;</span></span><span>
</span><span id="line-1088"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool
</span><a href="Agda.Utils.Float.html#isNegZero"><span class="hs-identifier hs-var">isNegZero</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621681133333"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; CCT m Exp
forall {m :: * -&gt; *}. MonadWriter UsesFloat m =&gt; FilePath -&gt; m Exp
</span><a href="#local-6989586621681133330"><span class="hs-identifier hs-var">rte</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;negativeZero&quot;</span></span><span>
</span><span id="line-1089"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool
forall a. RealFloat a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">isNaN</span></span><span>     </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621681133333"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; CCT m Exp
forall {m :: * -&gt; *}. MonadWriter UsesFloat m =&gt; FilePath -&gt; m Exp
</span><a href="#local-6989586621681133330"><span class="hs-identifier hs-var">rte</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;nan&quot;</span></span><span>
</span><span id="line-1090"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CCT m Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CCT m Exp) -&gt; Exp -&gt; CCT m Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Exp
</span><a href="#local-6989586621681133344"><span class="hs-identifier hs-var">typed</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133332"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1091"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1092"></span><span>        </span><span id="local-6989586621681133330"><span class="annot"><span class="annottext">rte :: FilePath -&gt; m Exp
</span><a href="#local-6989586621681133330"><span class="hs-identifier hs-var hs-var">rte</span></a></span></span><span> </span><span id="local-6989586621681133320"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133320"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">UsesFloat -&gt; m ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="annot"><span class="annottext">UsesFloat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#YesFloat"><span class="hs-identifier hs-var">YesFloat</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; m Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; m Exp) -&gt; Exp -&gt; m Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp) -&gt; QName -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#Qual"><span class="hs-identifier hs-var">HS.Qual</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTEFloat"><span class="hs-identifier hs-var">mazRTEFloat</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133320"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1093"></span><span>
</span><span id="line-1094"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#hslit"><span class="hs-identifier hs-type">hslit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Literal"><span class="hs-identifier hs-type">HS.Literal</span></a></span><span>
</span><span id="line-1095"></span><span id="hslit"><span class="annot"><span class="annottext">hslit :: Literal -&gt; Literal
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hslit"><span class="hs-identifier hs-var hs-var">hslit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1096"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitNat"><span class="hs-identifier hs-type">LitNat</span></a></span><span>    </span><span id="local-6989586621681133318"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681133318"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#Int"><span class="hs-identifier hs-var">HS.Int</span></a></span><span>    </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681133318"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1097"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitWord64"><span class="hs-identifier hs-type">LitWord64</span></a></span><span> </span><span id="local-6989586621681133316"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681133316"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#Int"><span class="hs-identifier hs-var">HS.Int</span></a></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681133316"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1098"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span>  </span><span id="local-6989586621681133315"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621681133315"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#Frac"><span class="hs-identifier hs-var">HS.Frac</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621681133315"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1099"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitChar"><span class="hs-identifier hs-type">LitChar</span></a></span><span>   </span><span id="local-6989586621681133312"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681133312"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#Char"><span class="hs-identifier hs-var">HS.Char</span></a></span><span>   </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681133312"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1100"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitQName"><span class="hs-identifier hs-type">LitQName</span></a></span><span>  </span><span id="local-6989586621681133310"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133310"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Literal
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-1101"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitString"><span class="hs-identifier hs-type">LitString</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Literal
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-1102"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitMeta"><span class="hs-identifier hs-type">LitMeta</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Literal
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-1103"></span><span>
</span><span id="line-1104"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#litString"><span class="hs-identifier hs-type">litString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-1105"></span><span id="litString"><span class="annot"><span class="annottext">litString :: Text -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#litString"><span class="hs-identifier hs-var hs-var">litString</span></a></span></span><span> </span><span id="local-6989586621681133308"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681133308"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Type -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Ann"><span class="hs-identifier hs-var">HS.Ann</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Lit"><span class="hs-identifier hs-var">HS.Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#String"><span class="hs-identifier hs-var">HS.String</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621681133308"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1106"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyCon"><span class="hs-identifier hs-var">HS.TyCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#Qual"><span class="hs-identifier hs-var">HS.Qual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; ModuleName
</span><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-var">HS.ModuleName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Data.Text&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Text&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1107"></span><span>
</span><span id="line-1108"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#litqname"><span class="hs-identifier hs-type">litqname</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-1109"></span><span id="litqname"><span class="annot"><span class="annottext">litqname :: QName -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#litqname"><span class="hs-identifier hs-var hs-var">litqname</span></a></span></span><span> </span><span id="local-6989586621681133304"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133304"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1110"></span><span>  </span><span class="annot"><span class="annottext">FilePath -&gt; Exp
</span><a href="#local-6989586621681133303"><span class="hs-identifier hs-var">rteCon</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;QName&quot;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Exp] -&gt; Exp
</span><a href="#local-6989586621681133302"><span class="hs-operator hs-var">`apps`</span></a></span><span>
</span><span id="line-1111"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Exp
forall a. Integral a =&gt; a -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsTypedInt"><span class="hs-identifier hs-var">hsTypedInt</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681133300"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1112"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Exp
forall a. Integral a =&gt; a -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsTypedInt"><span class="hs-identifier hs-var">hsTypedInt</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681133299"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1113"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Lit"><span class="hs-identifier hs-var">HS.Lit</span></a></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Exp) -&gt; Literal -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#String"><span class="hs-identifier hs-var">HS.String</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Literal) -&gt; Text -&gt; Literal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Text) -&gt; FilePath -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; FilePath
forall a. Pretty a =&gt; a -&gt; FilePath
</span><a href="Agda.Utils.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133304"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1114"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Exp
</span><a href="#local-6989586621681133303"><span class="hs-identifier hs-var">rteCon</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Fixity&quot;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Exp] -&gt; Exp
</span><a href="#local-6989586621681133302"><span class="hs-operator hs-var">`apps`</span></a></span><span>
</span><span id="line-1115"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Associativity -&gt; Exp
</span><a href="#local-6989586621681133298"><span class="hs-identifier hs-var">litAssoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fixity -&gt; Associativity
</span><a href="Agda.Syntax.Common.html#fixityAssoc"><span class="hs-identifier hs-var">fixityAssoc</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621681133296"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1116"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FixityLevel -&gt; Exp
</span><a href="#local-6989586621681133295"><span class="hs-identifier hs-var">litPrec</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fixity -&gt; FixityLevel
</span><a href="Agda.Syntax.Common.html#fixityLevel"><span class="hs-identifier hs-var">fixityLevel</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621681133296"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1117"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-1118"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-1119"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1120"></span><span>    </span><span id="local-6989586621681133302"><span class="annot"><span class="annottext">apps :: Exp -&gt; [Exp] -&gt; Exp
</span><a href="#local-6989586621681133302"><span class="hs-identifier hs-var hs-var">apps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp -&gt; Exp) -&gt; Exp -&gt; [Exp] -&gt; Exp
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-identifier hs-var">HS.App</span></a></span><span>
</span><span id="line-1121"></span><span>    </span><span id="local-6989586621681133303"><span class="annot"><span class="annottext">rteCon :: FilePath -&gt; Exp
</span><a href="#local-6989586621681133303"><span class="hs-identifier hs-var hs-var">rteCon</span></a></span></span><span> </span><span id="local-6989586621681133292"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133292"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Con"><span class="hs-identifier hs-var">HS.Con</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp) -&gt; QName -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#Qual"><span class="hs-identifier hs-var">HS.Qual</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTE"><span class="hs-identifier hs-var">mazRTE</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133292"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-1122"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Common.html#NameId"><span class="hs-identifier hs-type">NameId</span></a></span><span> </span><span id="local-6989586621681133300"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681133300"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#ModuleNameHash"><span class="hs-identifier hs-type">ModuleNameHash</span></a></span><span> </span><span id="local-6989586621681133299"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681133299"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; NameId
</span><a href="Agda.Syntax.Abstract.Name.html#nameId"><span class="hs-identifier hs-var">nameId</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; NameId) -&gt; Name -&gt; NameId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var">qnameName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133304"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1123"></span><span>    </span><span id="local-6989586621681133296"><span class="annot"><span class="annottext">fx :: Fixity
</span><a href="#local-6989586621681133296"><span class="hs-identifier hs-var hs-var">fx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fixity' -&gt; Fixity
</span><a href="Agda.Syntax.Common.html#theFixity"><span class="hs-identifier hs-var">theFixity</span></a></span><span> </span><span class="annot"><span class="annottext">(Fixity' -&gt; Fixity) -&gt; Fixity' -&gt; Fixity
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Fixity'
</span><a href="Agda.Syntax.Abstract.Name.html#nameFixity"><span class="hs-identifier hs-var">nameFixity</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Fixity') -&gt; Name -&gt; Fixity'
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var">qnameName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133304"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1124"></span><span>
</span><span id="line-1125"></span><span>    </span><span id="local-6989586621681133298"><span class="annot"><span class="annottext">litAssoc :: Associativity -&gt; Exp
</span><a href="#local-6989586621681133298"><span class="hs-identifier hs-var hs-var">litAssoc</span></a></span></span><span> </span><span class="annot"><span class="annottext">Associativity
</span><a href="Agda.Syntax.Common.html#NonAssoc"><span class="hs-identifier hs-var">NonAssoc</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Exp
</span><a href="#local-6989586621681133303"><span class="hs-identifier hs-var">rteCon</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;NonAssoc&quot;</span></span><span>
</span><span id="line-1126"></span><span>    </span><span class="annot"><a href="#local-6989586621681133298"><span class="hs-identifier hs-var">litAssoc</span></a></span><span> </span><span class="annot"><span class="annottext">Associativity
</span><a href="Agda.Syntax.Common.html#LeftAssoc"><span class="hs-identifier hs-var">LeftAssoc</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Exp
</span><a href="#local-6989586621681133303"><span class="hs-identifier hs-var">rteCon</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;LeftAssoc&quot;</span></span><span>
</span><span id="line-1127"></span><span>    </span><span class="annot"><a href="#local-6989586621681133298"><span class="hs-identifier hs-var">litAssoc</span></a></span><span> </span><span class="annot"><span class="annottext">Associativity
</span><a href="Agda.Syntax.Common.html#RightAssoc"><span class="hs-identifier hs-var">RightAssoc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Exp
</span><a href="#local-6989586621681133303"><span class="hs-identifier hs-var">rteCon</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;RightAssoc&quot;</span></span><span>
</span><span id="line-1128"></span><span>
</span><span id="line-1129"></span><span>    </span><span id="local-6989586621681133295"><span class="annot"><span class="annottext">litPrec :: FixityLevel -&gt; Exp
</span><a href="#local-6989586621681133295"><span class="hs-identifier hs-var hs-var">litPrec</span></a></span></span><span> </span><span class="annot"><span class="annottext">FixityLevel
</span><a href="Agda.Syntax.Common.html#Unrelated"><span class="hs-identifier hs-var">Unrelated</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Exp
</span><a href="#local-6989586621681133303"><span class="hs-identifier hs-var">rteCon</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Unrelated&quot;</span></span><span>
</span><span id="line-1130"></span><span>    </span><span class="annot"><a href="#local-6989586621681133295"><span class="hs-identifier hs-var">litPrec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Related"><span class="hs-identifier hs-type">Related</span></a></span><span> </span><span id="local-6989586621681133279"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621681133279"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Exp
</span><a href="#local-6989586621681133303"><span class="hs-identifier hs-var">rteCon</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Related&quot;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-operator hs-var">`HS.App`</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Exp
forall a. Real a =&gt; a -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsTypedDouble"><span class="hs-identifier hs-var">hsTypedDouble</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621681133279"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1131"></span><span>
</span><span id="line-1132"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#litqnamepat"><span class="hs-identifier hs-type">litqnamepat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Pat"><span class="hs-identifier hs-type">HS.Pat</span></a></span><span>
</span><span id="line-1133"></span><span id="litqnamepat"><span class="annot"><span class="annottext">litqnamepat :: QName -&gt; Pat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#litqnamepat"><span class="hs-identifier hs-var hs-var">litqnamepat</span></a></span></span><span> </span><span id="local-6989586621681133277"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133277"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1134"></span><span>  </span><span class="annot"><span class="annottext">QName -&gt; [Pat] -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PApp"><span class="hs-identifier hs-var">HS.PApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#Qual"><span class="hs-identifier hs-var">HS.Qual</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTE"><span class="hs-identifier hs-var">mazRTE</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;QName&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1135"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PLit"><span class="hs-identifier hs-var">HS.PLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#Int"><span class="hs-identifier hs-var">HS.Int</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Literal) -&gt; Integer -&gt; Literal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681133276"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1136"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PLit"><span class="hs-identifier hs-var">HS.PLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#Int"><span class="hs-identifier hs-var">HS.Int</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Literal) -&gt; Integer -&gt; Literal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681133275"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1137"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PWildCard"><span class="hs-identifier hs-var">HS.PWildCard</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PWildCard"><span class="hs-identifier hs-var">HS.PWildCard</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1138"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1139"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Common.html#NameId"><span class="hs-identifier hs-type">NameId</span></a></span><span> </span><span id="local-6989586621681133276"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681133276"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#ModuleNameHash"><span class="hs-identifier hs-type">ModuleNameHash</span></a></span><span> </span><span id="local-6989586621681133275"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681133275"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; NameId
</span><a href="Agda.Syntax.Abstract.Name.html#nameId"><span class="hs-identifier hs-var">nameId</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; NameId) -&gt; Name -&gt; NameId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var">qnameName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133277"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1140"></span><span>
</span><span id="line-1141"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#condecl"><span class="hs-identifier hs-type">condecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Induction"><span class="hs-identifier hs-type">Induction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ConDecl"><span class="hs-identifier hs-type">HS.ConDecl</span></a></span><span>
</span><span id="line-1142"></span><span id="condecl"><span class="annot"><span class="annottext">condecl :: QName
-&gt; Induction
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ConDecl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#condecl"><span class="hs-identifier hs-var hs-var">condecl</span></a></span></span><span> </span><span id="local-6989586621681133274"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133274"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621681133273"><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621681133273"><span class="hs-identifier hs-var">_ind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1143"></span><span>  </span><span id="local-6989586621681133272"><span class="annot"><span class="annottext">GHCOptions
</span><a href="#local-6989586621681133272"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv (StateT HsCompileState TCM) GHCOptions
forall (m :: * -&gt; *). ReadGHCOpts m =&gt; m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var">askGhcOpts</span></a></span><span>
</span><span id="line-1144"></span><span>  </span><span id="local-6989586621681133271"><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681133271"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Definition
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Definition
</span><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo"><span class="hs-identifier hs-var">getConstInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133274"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-1145"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Constructor"><span class="hs-identifier hs-type">Constructor</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">conPars :: Defn -&gt; Nat
</span><a href="Agda.TypeChecking.Monad.Base.html#conPars"><span class="hs-identifier hs-var">conPars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681133269"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133269"><span class="hs-identifier hs-var">np</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">conErased :: Defn -&gt; Maybe [Bool]
</span><a href="Agda.TypeChecking.Monad.Base.html#conErased"><span class="hs-identifier hs-var">conErased</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681133267"><span class="annot"><span class="annottext">Maybe [Bool]
</span><a href="#local-6989586621681133267"><span class="hs-identifier hs-var">erased</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Defn
</span><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var">theDef</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681133271"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-1146"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681133266"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681133266"><span class="hs-identifier hs-var">argTypes0</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; HsCompileM ([Type], Type)
</span><a href="Agda.Compiler.MAlonzo.HaskellTypes.html#hsTelApproximation"><span class="hs-identifier hs-var">hsTelApproximation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Definition -&gt; Type
</span><a href="Agda.TypeChecking.Monad.Base.html#defType"><span class="hs-identifier hs-var">defType</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681133271"><span class="hs-identifier hs-var">def</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1147"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133265"><span class="annot"><span class="annottext">strict :: Strictness
</span><a href="#local-6989586621681133265"><span class="hs-identifier hs-var hs-var">strict</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Defn -&gt; Induction
</span><a href="Agda.TypeChecking.Monad.Base.html#conInd"><span class="hs-identifier hs-var">conInd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Definition -&gt; Defn
</span><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var">theDef</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681133271"><span class="hs-identifier hs-var">def</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Induction -&gt; Induction -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.html#Inductive"><span class="hs-identifier hs-var">Inductive</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-1148"></span><span>                      </span><span class="annot"><span class="annottext">GHCOptions -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcStrictData"><span class="hs-identifier hs-var">optGhcStrictData</span></a></span><span> </span><span class="annot"><span class="annottext">GHCOptions
</span><a href="#local-6989586621681133272"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-1149"></span><span>                   </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Strictness
</span><a href="Agda.Utils.Haskell.Syntax.html#Strict"><span class="hs-identifier hs-var">HS.Strict</span></a></span><span>
</span><span id="line-1150"></span><span>                   </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Strictness
</span><a href="Agda.Utils.Haskell.Syntax.html#Lazy"><span class="hs-identifier hs-var">HS.Lazy</span></a></span><span>
</span><span id="line-1151"></span><span>      </span><span id="local-6989586621681133261"><span class="annot"><span class="annottext">argTypes :: [(Maybe Strictness, Type)]
</span><a href="#local-6989586621681133261"><span class="hs-identifier hs-var hs-var">argTypes</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Strictness -&gt; Maybe Strictness
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Strictness
</span><a href="#local-6989586621681133265"><span class="hs-identifier hs-var">strict</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681133260"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1152"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681133260"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681133260"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Bool] -&gt; [(Type, Bool)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat -&gt; [Type] -&gt; [Type]
forall a. Nat -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133269"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621681133266"><span class="hs-identifier hs-var">argTypes0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1153"></span><span>                                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Bool] -&gt; Maybe [Bool] -&gt; [Bool]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe [Bool]
</span><a href="#local-6989586621681133267"><span class="hs-identifier hs-var">erased</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; [Bool] -&gt; [Bool]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Bool]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-1154"></span><span>                   </span><span class="hs-special">]</span><span>
</span><span id="line-1155"></span><span>  </span><span class="annot"><span class="annottext">ConDecl -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ConDecl
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ConDecl
 -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ConDecl)
-&gt; ConDecl
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) ConDecl
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [(Maybe Strictness, Type)] -&gt; ConDecl
</span><a href="Agda.Utils.Haskell.Syntax.html#ConDecl"><span class="hs-identifier hs-var">HS.ConDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ConK"><span class="hs-identifier hs-var">ConK</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133274"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Maybe Strictness, Type)]
</span><a href="#local-6989586621681133261"><span class="hs-identifier hs-var">argTypes</span></a></span><span>
</span><span id="line-1156"></span><span>
</span><span id="line-1157"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-type">compiledcondecl</span></a></span><span>
</span><span id="line-1158"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span>  </span><span class="hs-comment">-- ^ The constructor's arity (after erasure).</span><span>
</span><span id="line-1159"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span>
</span><span id="line-1160"></span><span id="compiledcondecl"><span class="annot"><span class="annottext">compiledcondecl :: Maybe Nat
-&gt; QName -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-var hs-var">compiledcondecl</span></a></span></span><span> </span><span id="local-6989586621681133256"><span class="annot"><span class="annottext">Maybe Nat
</span><a href="#local-6989586621681133256"><span class="hs-identifier hs-var">mar</span></a></span></span><span> </span><span id="local-6989586621681133255"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133255"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1161"></span><span>  </span><span id="local-6989586621681133254"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133254"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Nat
</span><a href="#local-6989586621681133256"><span class="hs-identifier hs-var">mar</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1162"></span><span>    </span><span class="annot"><span class="annottext">Maybe Nat
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCM Nat -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Nat
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM Nat -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Nat)
-&gt; TCM Nat -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Nat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM Nat
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Nat
</span><a href="Agda.Compiler.MAlonzo.Coerce.html#erasedArity"><span class="hs-identifier hs-var">erasedArity</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133255"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-1163"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681133253"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133253"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Nat
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133253"><span class="hs-identifier hs-var">ar</span></a></span><span>
</span><span id="line-1164"></span><span>  </span><span id="local-6989586621681133252"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133252"><span class="hs-identifier hs-var">hsCon</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath -&gt; FilePath
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">FilePath
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe FilePath -&gt; FilePath)
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (Maybe FilePath)
-&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) FilePath
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName
-&gt; ReaderT
     GHCModuleEnv (StateT HsCompileState TCM) (Maybe FilePath)
</span><a href="Agda.Compiler.MAlonzo.Pragmas.html#getHaskellConstructor"><span class="hs-identifier hs-var">getHaskellConstructor</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133255"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-1165"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133250"><span class="annot"><span class="annottext">patVars :: [Pat]
</span><a href="#local-6989586621681133250"><span class="hs-identifier hs-var hs-var">patVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Nat -&gt; Pat) -&gt; [Nat] -&gt; [Pat]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-var">HS.PVar</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Pat) -&gt; (Nat -&gt; Name) -&gt; Nat -&gt; Pat
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-var">A</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133254"><span class="hs-identifier hs-var">ar</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-1166"></span><span>  </span><span class="annot"><span class="annottext">Decl -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Decl
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Decl -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Decl)
-&gt; Decl -&gt; ReaderT GHCModuleEnv (StateT HsCompileState TCM) Decl
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Pat -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#PatSyn"><span class="hs-identifier hs-var">HS.PatSyn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; [Pat] -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PApp"><span class="hs-identifier hs-var">HS.PApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-var">HS.UnQual</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ConK"><span class="hs-identifier hs-var">ConK</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133255"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621681133250"><span class="hs-identifier hs-var">patVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1167"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; [Pat] -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PApp"><span class="hs-identifier hs-var">HS.PApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsName"><span class="hs-identifier hs-var">hsName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133252"><span class="hs-identifier hs-var">hsCon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621681133250"><span class="hs-identifier hs-var">patVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1168"></span><span>
</span><span id="line-1169"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledTypeSynonym"><span class="hs-identifier hs-type">compiledTypeSynonym</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span>
</span><span id="line-1170"></span><span id="compiledTypeSynonym"><span class="annot"><span class="annottext">compiledTypeSynonym :: QName -&gt; FilePath -&gt; Nat -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledTypeSynonym"><span class="hs-identifier hs-var hs-var">compiledTypeSynonym</span></a></span></span><span> </span><span id="local-6989586621681133248"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133248"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621681133247"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133247"><span class="hs-identifier hs-var">hsT</span></a></span></span><span> </span><span id="local-6989586621681133246"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133246"><span class="hs-identifier hs-var">arity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1171"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; [TyVarBind] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeDecl"><span class="hs-identifier hs-var">HS.TypeDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#TypeK"><span class="hs-identifier hs-var">TypeK</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133248"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; TyVarBind) -&gt; [Name] -&gt; [TyVarBind]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; TyVarBind
</span><a href="Agda.Utils.Haskell.Syntax.html#UnkindedVar"><span class="hs-identifier hs-var">HS.UnkindedVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681133245"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1172"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; [Type] -&gt; Type
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyApp"><span class="hs-identifier hs-var">HS.TyApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeType"><span class="hs-identifier hs-var">HS.FakeType</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133247"><span class="hs-identifier hs-var">hsT</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Type] -&gt; Type) -&gt; [Type] -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Type) -&gt; [Name] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyVar"><span class="hs-identifier hs-var">HS.TyVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621681133245"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1173"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1174"></span><span>    </span><span id="local-6989586621681133245"><span class="annot"><span class="annottext">vs :: [Name]
</span><a href="#local-6989586621681133245"><span class="hs-identifier hs-var hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133244"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681133244"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133244"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133246"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1175"></span><span>
</span><span id="line-1176"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#tvaldecl"><span class="hs-identifier hs-type">tvaldecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span>
</span><span id="line-1177"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Induction"><span class="hs-identifier hs-type">Induction</span></a></span><span>
</span><span id="line-1178"></span><span>            </span><span class="hs-comment">-- ^ Is the type inductive or coinductive?</span><span>
</span><span id="line-1179"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ConDecl"><span class="hs-identifier hs-type">HS.ConDecl</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Clause"><span class="hs-identifier hs-type">Clause</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1180"></span><span id="tvaldecl"><span class="annot"><span class="annottext">tvaldecl :: QName -&gt; Induction -&gt; Nat -&gt; [ConDecl] -&gt; Maybe Clause -&gt; [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#tvaldecl"><span class="hs-identifier hs-var hs-var">tvaldecl</span></a></span></span><span> </span><span id="local-6989586621681133243"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133243"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621681133242"><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621681133242"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span id="local-6989586621681133241"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133241"><span class="hs-identifier hs-var">npar</span></a></span></span><span> </span><span id="local-6989586621681133240"><span class="annot"><span class="annottext">[ConDecl]
</span><a href="#local-6989586621681133240"><span class="hs-identifier hs-var">cds</span></a></span></span><span> </span><span id="local-6989586621681133239"><span class="annot"><span class="annottext">Maybe Clause
</span><a href="#local-6989586621681133239"><span class="hs-identifier hs-var">cl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1181"></span><span>  </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133238"><span class="hs-identifier hs-var">vn</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621681133237"><span class="hs-identifier hs-var">pvs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-var">HS.unit_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Decl -&gt; [Decl] -&gt; [Decl]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-1182"></span><span>  </span><span class="annot"><span class="annottext">[Decl] -&gt; (Clause -&gt; [Decl]) -&gt; Maybe Clause -&gt; [Decl]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DataOrNew -&gt; Name -&gt; [TyVarBind] -&gt; [ConDecl] -&gt; [Deriving] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#DataDecl"><span class="hs-identifier hs-var">HS.DataDecl</span></a></span><span> </span><span class="annot"><span class="annottext">DataOrNew
</span><a href="#local-6989586621681133234"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133233"><span class="hs-identifier hs-var">tn</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[ConDecl]
</span><a href="#local-6989586621681133232"><span class="hs-identifier hs-var">cds'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1183"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Decl] -&gt; Clause -&gt; [Decl]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Clause
</span><a href="#local-6989586621681133239"><span class="hs-identifier hs-var">cl</span></a></span><span>
</span><span id="line-1184"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1185"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681133233"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133233"><span class="hs-identifier hs-var">tn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681133238"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133238"><span class="hs-identifier hs-var">vn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameKind -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">NameKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#TypeK"><span class="hs-identifier hs-var">TypeK</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133243"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133243"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1186"></span><span>  </span><span id="local-6989586621681133237"><span class="annot"><span class="annottext">pvs :: [Pat]
</span><a href="#local-6989586621681133237"><span class="hs-identifier hs-var hs-var">pvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-var">HS.PVar</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Pat) -&gt; Name -&gt; Pat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VariableKind -&gt; Nat -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">VariableKind
</span><a href="Agda.Compiler.MAlonzo.Misc.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133231"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621681133231"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133231"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681133241"><span class="hs-identifier hs-var">npar</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1187"></span><span>
</span><span id="line-1188"></span><span>  </span><span class="hs-comment">-- Inductive data types consisting of a single constructor with a</span><span>
</span><span id="line-1189"></span><span>  </span><span class="hs-comment">-- single argument are translated into newtypes.</span><span>
</span><span id="line-1190"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681133234"><span class="annot"><span class="annottext">DataOrNew
</span><a href="#local-6989586621681133234"><span class="hs-identifier hs-var">kind</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681133232"><span class="annot"><span class="annottext">[ConDecl]
</span><a href="#local-6989586621681133232"><span class="hs-identifier hs-var">cds'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621681133242"><span class="hs-identifier hs-var">ind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[ConDecl]
</span><a href="#local-6989586621681133240"><span class="hs-identifier hs-var">cds</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1191"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.html#Inductive"><span class="hs-identifier hs-var">Inductive</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ConDecl"><span class="hs-identifier hs-type">HS.ConDecl</span></a></span><span> </span><span id="local-6989586621681133230"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133230"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Strictness
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681133229"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681133229"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1192"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataOrNew
</span><a href="Agda.Utils.Haskell.Syntax.html#NewType"><span class="hs-identifier hs-var">HS.NewType</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [(Maybe Strictness, Type)] -&gt; ConDecl
</span><a href="Agda.Utils.Haskell.Syntax.html#ConDecl"><span class="hs-identifier hs-var">HS.ConDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133230"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Strictness
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681133229"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1193"></span><span>      </span><span class="hs-comment">-- The strictness annotations are removed for newtype</span><span>
</span><span id="line-1194"></span><span>      </span><span class="hs-comment">-- constructors.</span><span>
</span><span id="line-1195"></span><span>    </span><span class="annot"><span class="annottext">(Induction, [ConDecl])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataOrNew
</span><a href="Agda.Utils.Haskell.Syntax.html#DataType"><span class="hs-identifier hs-var">HS.DataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[ConDecl]
</span><a href="#local-6989586621681133240"><span class="hs-identifier hs-var">cds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1196"></span><span>
</span><span id="line-1197"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#infodecl"><span class="hs-identifier hs-type">infodecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1198"></span><span id="infodecl"><span class="annot"><span class="annottext">infodecl :: QName -&gt; [Decl] -&gt; [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#infodecl"><span class="hs-identifier hs-var hs-var">infodecl</span></a></span></span><span> </span><span class="annot"><span class="annottext">QName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1199"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#infodecl"><span class="hs-identifier hs-var">infodecl</span></a></span><span> </span><span id="local-6989586621681133226"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133226"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621681133225"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133225"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#Comment"><span class="hs-identifier hs-var">HS.Comment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; FilePath
forall a. Pretty a =&gt; a -&gt; FilePath
</span><a href="Agda.Utils.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681133226"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Decl -&gt; [Decl] -&gt; [Decl]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133225"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-1200"></span><span>
</span><span id="line-1201"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-1202"></span><span class="hs-comment">-- Writing out a haskell module</span><span>
</span><span id="line-1203"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-1204"></span><span>
</span><span id="line-1205"></span><span class="hs-keyword">type</span><span> </span><span id="MonadGHCIO"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#MonadGHCIO"><span class="hs-identifier hs-var">MonadGHCIO</span></a></span></span><span> </span><span id="local-6989586621681133223"><span class="annot"><a href="#local-6989586621681133223"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621681133223"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ReadGHCOpts"><span class="hs-identifier hs-type">ReadGHCOpts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681133223"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1206"></span><span>
</span><span id="line-1207"></span><span id="local-6989586621681135798"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#copyRTEModules"><span class="hs-identifier hs-type">copyRTEModules</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#MonadGHCIO"><span class="hs-identifier hs-type">MonadGHCIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681135798"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681135798"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-1208"></span><span id="copyRTEModules"><span class="annot"><span class="annottext">copyRTEModules :: forall (m :: * -&gt; *). MonadGHCIO m =&gt; m ()
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#copyRTEModules"><span class="hs-identifier hs-var hs-var">copyRTEModules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1209"></span><span>  </span><span id="local-6989586621681133209"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133209"><span class="hs-identifier hs-var">dataDir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO FilePath -&gt; m FilePath
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO FilePath
</span><a href="Paths_Agda.html#getDataDir"><span class="hs-identifier hs-var">getDataDir</span></a></span><span>
</span><span id="line-1210"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133207"><span class="annot"><span class="annottext">srcDir :: FilePath
</span><a href="#local-6989586621681133207"><span class="hs-identifier hs-var hs-var">srcDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133209"><span class="hs-identifier hs-var">dataDir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;MAlonzo&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;src&quot;</span></span><span>
</span><span id="line-1211"></span><span>  </span><span id="local-6989586621681133205"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133205"><span class="hs-identifier hs-var">dstDir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GHCOptions -&gt; FilePath
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcCompileDir"><span class="hs-identifier hs-var">optGhcCompileDir</span></a></span><span> </span><span class="annot"><span class="annottext">(GHCOptions -&gt; FilePath) -&gt; m GHCOptions -&gt; m FilePath
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m GHCOptions
forall (m :: * -&gt; *). ReadGHCOpts m =&gt; m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var">askGhcOpts</span></a></span><span>
</span><span id="line-1212"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; IO () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><a href="Agda.Utils.IO.Directory.html#copyDirContent"><span class="hs-identifier hs-var">copyDirContent</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133207"><span class="hs-identifier hs-var">srcDir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133205"><span class="hs-identifier hs-var">dstDir</span></a></span><span>
</span><span id="line-1213"></span><span>
</span><span id="line-1214"></span><span id="local-6989586621681135763"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#writeModule"><span class="hs-identifier hs-type">writeModule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#MonadGHCIO"><span class="hs-identifier hs-type">MonadGHCIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681135763"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Module"><span class="hs-identifier hs-type">HS.Module</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681135763"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-1215"></span><span id="writeModule"><span class="annot"><span class="annottext">writeModule :: forall (m :: * -&gt; *). MonadGHCIO m =&gt; Module -&gt; m ()
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#writeModule"><span class="hs-identifier hs-var hs-var">writeModule</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Module"><span class="hs-identifier hs-type">HS.Module</span></a></span><span> </span><span id="local-6989586621681133168"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681133168"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681133167"><span class="annot"><span class="annottext">[ModulePragma]
</span><a href="#local-6989586621681133167"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621681133166"><span class="annot"><span class="annottext">[ImportDecl]
</span><a href="#local-6989586621681133166"><span class="hs-identifier hs-var">imp</span></a></span></span><span> </span><span id="local-6989586621681133165"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133165"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1216"></span><span>  </span><span class="hs-comment">-- Note that GHC assumes that sources use ASCII or UTF-8.</span><span>
</span><span id="line-1217"></span><span>  </span><span id="local-6989586621681133164"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133164"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FilePath, FilePath) -&gt; FilePath
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((FilePath, FilePath) -&gt; FilePath)
-&gt; m (FilePath, FilePath) -&gt; m FilePath
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; m (FilePath, FilePath)
forall (m :: * -&gt; *).
MonadGHCIO m =&gt;
ModuleName -&gt; m (FilePath, FilePath)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#outFileAndDir"><span class="hs-identifier hs-var">outFileAndDir</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681133168"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1218"></span><span>  </span><span id="local-6989586621681133162"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133162"><span class="hs-identifier hs-var">strict</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GHCOptions -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcStrict"><span class="hs-identifier hs-var">optGhcStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(GHCOptions -&gt; Bool) -&gt; m GHCOptions -&gt; m Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m GHCOptions
forall (m :: * -&gt; *). ReadGHCOpts m =&gt; m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var">askGhcOpts</span></a></span><span>
</span><span id="line-1219"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133161"><span class="annot"><span class="annottext">languagePragmas :: [ModulePragma]
</span><a href="#local-6989586621681133161"><span class="hs-identifier hs-var hs-var">languagePragmas</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1220"></span><span>        </span><span class="annot"><span class="annottext">(FilePath -&gt; ModulePragma) -&gt; [FilePath] -&gt; [ModulePragma]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">List.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; ModulePragma
</span><a href="Agda.Utils.Haskell.Syntax.html#LanguagePragma"><span class="hs-identifier hs-var">HS.LanguagePragma</span></a></span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; ModulePragma)
-&gt; (FilePath -&gt; [Name]) -&gt; FilePath -&gt; ModulePragma
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name]
forall el coll. Singleton el coll =&gt; el -&gt; coll
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; [Name]) -&gt; (FilePath -&gt; Name) -&gt; FilePath -&gt; [Name]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([FilePath] -&gt; [ModulePragma]) -&gt; [FilePath] -&gt; [ModulePragma]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1221"></span><span>          </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.sort</span></span><span> </span><span class="annot"><span class="annottext">([FilePath] -&gt; [FilePath]) -&gt; [FilePath] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1222"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;QualifiedDo&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133162"><span class="hs-identifier hs-var">strict</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-1223"></span><span>                </span><span class="hs-comment">-- If --ghc-strict is used, then the language extension</span><span>
</span><span id="line-1224"></span><span>                </span><span class="hs-comment">-- QualifiedDo is activated. At the time of writing no</span><span>
</span><span id="line-1225"></span><span>                </span><span class="hs-comment">-- code is generated that depends on this extension</span><span>
</span><span id="line-1226"></span><span>                </span><span class="hs-comment">-- (except for the pragmas), but --ghc-strict is broken</span><span>
</span><span id="line-1227"></span><span>                </span><span class="hs-comment">-- with at least some versions of GHC prior to version 9,</span><span>
</span><span id="line-1228"></span><span>                </span><span class="hs-comment">-- and QualifiedDo was introduced with GHC 9.</span><span>
</span><span id="line-1229"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;BangPatterns&quot;</span></span><span>
</span><span id="line-1230"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;EmptyDataDecls&quot;</span></span><span>
</span><span id="line-1231"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;EmptyCase&quot;</span></span><span>
</span><span id="line-1232"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;ExistentialQuantification&quot;</span></span><span>
</span><span id="line-1233"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;ScopedTypeVariables&quot;</span></span><span>
</span><span id="line-1234"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;NoMonomorphismRestriction&quot;</span></span><span>
</span><span id="line-1235"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;RankNTypes&quot;</span></span><span>
</span><span id="line-1236"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;PatternSynonyms&quot;</span></span><span>
</span><span id="line-1237"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;OverloadedStrings&quot;</span></span><span>
</span><span id="line-1238"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-1239"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133155"><span class="annot"><span class="annottext">ghcOptions :: [ModulePragma]
</span><a href="#local-6989586621681133155"><span class="hs-identifier hs-var hs-var">ghcOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1240"></span><span>        </span><span class="annot"><span class="annottext">(FilePath -&gt; ModulePragma) -&gt; [FilePath] -&gt; [ModulePragma]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">List.map</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ModulePragma
</span><a href="Agda.Utils.Haskell.Syntax.html#OtherPragma"><span class="hs-identifier hs-var">HS.OtherPragma</span></a></span><span>
</span><span id="line-1241"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span>  </span><span class="hs-comment">-- to separate from LANGUAGE pragmas</span><span>
</span><span id="line-1242"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;{-# OPTIONS_GHC -Wno-overlapping-patterns #-}&quot;</span></span><span>
</span><span id="line-1243"></span><span>              </span><span class="hs-comment">-- Andreas, 2022-01-26, issue #5758:</span><span>
</span><span id="line-1244"></span><span>              </span><span class="hs-comment">-- Place this in generated file rather than</span><span>
</span><span id="line-1245"></span><span>              </span><span class="hs-comment">-- passing it only when calling GHC from within Agda.</span><span>
</span><span id="line-1246"></span><span>              </span><span class="hs-comment">-- This will silence the warning for the Agda-generated .hs</span><span>
</span><span id="line-1247"></span><span>              </span><span class="hs-comment">-- files while it can be on for other .hs files in the same</span><span>
</span><span id="line-1248"></span><span>              </span><span class="hs-comment">-- project.  (E.g., when using cabal/stack to compile.)</span><span>
</span><span id="line-1249"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-1250"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; IO () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><a href="Agda.Utils.IO.UTF8.html#writeFile"><span class="hs-identifier hs-var">UTF8.writeFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133164"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; FilePath -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Module -&gt; FilePath
forall a. Pretty a =&gt; a -&gt; FilePath
</span><a href="Agda.Compiler.MAlonzo.Pretty.html#prettyPrint"><span class="hs-identifier hs-var">prettyPrint</span></a></span><span> </span><span class="annot"><span class="annottext">(Module -&gt; FilePath) -&gt; Module -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1251"></span><span>    </span><span class="hs-comment">-- TODO: It might make sense to skip bang patterns for the unused</span><span>
</span><span id="line-1252"></span><span>    </span><span class="hs-comment">-- arguments of the &quot;non-stripped&quot; functions.</span><span>
</span><span id="line-1253"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; (Module -&gt; Module) -&gt; Module -&gt; Module
forall a. Bool -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Agda.Utils.Function.html#applyWhen"><span class="hs-identifier hs-var">applyWhen</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133162"><span class="hs-identifier hs-var">strict</span></a></span><span> </span><span class="annot"><span class="annottext">Module -&gt; Module
forall a. MakeStrict a =&gt; a -&gt; a
</span><a href="Agda.Compiler.MAlonzo.Strict.html#makeStrict"><span class="hs-identifier hs-var">makeStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(Module -&gt; Module) -&gt; Module -&gt; Module
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1254"></span><span>    </span><span class="annot"><span class="annottext">ModuleName -&gt; [ModulePragma] -&gt; [ImportDecl] -&gt; [Decl] -&gt; Module
</span><a href="Agda.Utils.Haskell.Syntax.html#Module"><span class="hs-identifier hs-var">HS.Module</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681133168"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[ModulePragma]] -&gt; [ModulePragma]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[ModulePragma]
</span><a href="#local-6989586621681133161"><span class="hs-identifier hs-var">languagePragmas</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[ModulePragma]
</span><a href="#local-6989586621681133155"><span class="hs-identifier hs-var">ghcOptions</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[ModulePragma]
</span><a href="#local-6989586621681133167"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ImportDecl]
</span><a href="#local-6989586621681133166"><span class="hs-identifier hs-var">imp</span></a></span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621681133165"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-1255"></span><span>
</span><span id="line-1256"></span><span id="local-6989586621681135537"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#outFileAndDir"><span class="hs-identifier hs-type">outFileAndDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#MonadGHCIO"><span class="hs-identifier hs-type">MonadGHCIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681135537"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-type">HS.ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681135537"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-1257"></span><span id="outFileAndDir"><span class="annot"><span class="annottext">outFileAndDir :: forall (m :: * -&gt; *).
MonadGHCIO m =&gt;
ModuleName -&gt; m (FilePath, FilePath)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#outFileAndDir"><span class="hs-identifier hs-var hs-var">outFileAndDir</span></a></span></span><span> </span><span id="local-6989586621681133138"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681133138"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1258"></span><span>  </span><span id="local-6989586621681133137"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133137"><span class="hs-identifier hs-var">mdir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GHCOptions -&gt; FilePath
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcCompileDir"><span class="hs-identifier hs-var">optGhcCompileDir</span></a></span><span> </span><span class="annot"><span class="annottext">(GHCOptions -&gt; FilePath) -&gt; m GHCOptions -&gt; m FilePath
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m GHCOptions
forall (m :: * -&gt; *). ReadGHCOpts m =&gt; m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var">askGhcOpts</span></a></span><span>
</span><span id="line-1259"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681133136"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133136"><span class="hs-identifier hs-var">fdir</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681133135"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133135"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; (FilePath, FilePath)
</span><span class="hs-identifier hs-var">splitFileName</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; (FilePath, FilePath))
-&gt; FilePath -&gt; (FilePath, FilePath)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
</span><a href="#local-6989586621681133133"><span class="hs-identifier hs-var">repldot</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier hs-var">pathSeparator</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; FilePath -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1260"></span><span>                   </span><span class="annot"><span class="annottext">ModuleName -&gt; FilePath
forall a. Pretty a =&gt; a -&gt; FilePath
</span><a href="Agda.Compiler.MAlonzo.Pretty.html#prettyPrint"><span class="hs-identifier hs-var">prettyPrint</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681133138"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1261"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133131"><span class="annot"><span class="annottext">dir :: FilePath
</span><a href="#local-6989586621681133131"><span class="hs-identifier hs-var hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133137"><span class="hs-identifier hs-var">mdir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133136"><span class="hs-identifier hs-var">fdir</span></a></span><span>
</span><span id="line-1262"></span><span>      </span><span id="local-6989586621681133130"><span class="annot"><span class="annottext">fp :: FilePath
</span><a href="#local-6989586621681133130"><span class="hs-identifier hs-var hs-var">fp</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133131"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-identifier hs-var">replaceExtension</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133135"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;hs&quot;</span></span><span>
</span><span id="line-1263"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; IO () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">createDirectoryIfMissing</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133131"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-1264"></span><span>  </span><span class="annot"><span class="annottext">(FilePath, FilePath) -&gt; m (FilePath, FilePath)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133137"><span class="hs-identifier hs-var">mdir</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133130"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1265"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1266"></span><span>  </span><span id="local-6989586621681133133"><span class="annot"><span class="annottext">repldot :: Char -&gt; FilePath -&gt; FilePath
</span><a href="#local-6989586621681133133"><span class="hs-identifier hs-var hs-var">repldot</span></a></span></span><span> </span><span id="local-6989586621681133126"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681133126"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; FilePath -&gt; FilePath
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">List.map</span></span><span> </span><span class="annot"><span class="annottext">((Char -&gt; Char) -&gt; FilePath -&gt; FilePath)
-&gt; (Char -&gt; Char) -&gt; FilePath -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681133125"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681133125"><span class="hs-identifier hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681133125"><span class="hs-identifier hs-var">c'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681133126"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621681133125"><span class="hs-identifier hs-var">c'</span></a></span><span>
</span><span id="line-1267"></span><span>
</span><span id="line-1268"></span><span id="local-6989586621681135526"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFileAndDir"><span class="hs-identifier hs-type">curOutFileAndDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#MonadGHCIO"><span class="hs-identifier hs-type">MonadGHCIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681135526"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadGHCModuleEnv"><span class="hs-identifier hs-type">ReadGHCModuleEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681135526"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681135526"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-1269"></span><span id="curOutFileAndDir"><span class="annot"><span class="annottext">curOutFileAndDir :: forall (m :: * -&gt; *).
(MonadGHCIO m, ReadGHCModuleEnv m) =&gt;
m (FilePath, FilePath)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFileAndDir"><span class="hs-identifier hs-var hs-var">curOutFileAndDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; m (FilePath, FilePath)
forall (m :: * -&gt; *).
MonadGHCIO m =&gt;
ModuleName -&gt; m (FilePath, FilePath)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#outFileAndDir"><span class="hs-identifier hs-var">outFileAndDir</span></a></span><span> </span><span class="annot"><span class="annottext">(ModuleName -&gt; m (FilePath, FilePath))
-&gt; m ModuleName -&gt; m (FilePath, FilePath)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">m ModuleName
forall (m :: * -&gt; *). ReadGHCModuleEnv m =&gt; m ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#curHsMod"><span class="hs-identifier hs-var">curHsMod</span></a></span><span>
</span><span id="line-1270"></span><span>
</span><span id="line-1271"></span><span id="local-6989586621681135788"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFile"><span class="hs-identifier hs-type">curOutFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#MonadGHCIO"><span class="hs-identifier hs-type">MonadGHCIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681135788"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadGHCModuleEnv"><span class="hs-identifier hs-type">ReadGHCModuleEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681135788"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681135788"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span></span><span>
</span><span id="line-1272"></span><span id="curOutFile"><span class="annot"><span class="annottext">curOutFile :: forall (m :: * -&gt; *).
(MonadGHCIO m, ReadGHCModuleEnv m) =&gt;
m FilePath
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFile"><span class="hs-identifier hs-var hs-var">curOutFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath, FilePath) -&gt; FilePath
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((FilePath, FilePath) -&gt; FilePath)
-&gt; m (FilePath, FilePath) -&gt; m FilePath
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m (FilePath, FilePath)
forall (m :: * -&gt; *).
(MonadGHCIO m, ReadGHCModuleEnv m) =&gt;
m (FilePath, FilePath)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFileAndDir"><span class="hs-identifier hs-var">curOutFileAndDir</span></a></span><span>
</span><span id="line-1273"></span><span>
</span><span id="line-1274"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#callGHC"><span class="hs-identifier hs-type">callGHC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-type">GHCModule</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1275"></span><span id="callGHC"><span class="annot"><span class="annottext">callGHC :: ReaderT GHCModule TCM ()
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#callGHC"><span class="hs-identifier hs-var hs-var">callGHC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1276"></span><span>  </span><span id="local-6989586621681133107"><span class="annot"><span class="annottext">GHCOptions
</span><a href="#local-6989586621681133107"><span class="hs-identifier hs-var">opts</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModule TCM GHCOptions
forall (m :: * -&gt; *). ReadGHCOpts m =&gt; m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var">askGhcOpts</span></a></span><span>
</span><span id="line-1277"></span><span>  </span><span id="local-6989586621681133106"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133106"><span class="hs-identifier hs-var">hsmod</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; FilePath
forall a. Pretty a =&gt; a -&gt; FilePath
</span><a href="Agda.Compiler.MAlonzo.Pretty.html#prettyPrint"><span class="hs-identifier hs-var">prettyPrint</span></a></span><span> </span><span class="annot"><span class="annottext">(ModuleName -&gt; FilePath)
-&gt; ReaderT GHCModule TCM ModuleName
-&gt; ReaderT GHCModule TCM FilePath
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModule TCM ModuleName
forall (m :: * -&gt; *). ReadGHCModuleEnv m =&gt; m ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#curHsMod"><span class="hs-identifier hs-var">curHsMod</span></a></span><span>
</span><span id="line-1278"></span><span>  </span><span id="local-6989586621681133105"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681133105"><span class="hs-identifier hs-var">agdaMod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModule TCM ModuleName
forall (m :: * -&gt; *). ReadGHCModuleEnv m =&gt; m ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#curAgdaMod"><span class="hs-identifier hs-var">curAgdaMod</span></a></span><span>
</span><span id="line-1279"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133103"><span class="annot"><span class="annottext">outputName :: Name
</span><a href="#local-6989586621681133103"><span class="hs-identifier hs-var hs-var">outputName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; Name
forall a. a -&gt; [a] -&gt; a
</span><a href="Agda.Utils.List.html#lastWithDefault"><span class="hs-identifier hs-var">lastWithDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Name
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; Name) -&gt; [Name] -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; [Name]
</span><a href="Agda.Syntax.Abstract.Name.html#mnameToList"><span class="hs-identifier hs-var">mnameToList</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681133105"><span class="hs-identifier hs-var">agdaMod</span></a></span><span>
</span><span id="line-1280"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681133100"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133100"><span class="hs-identifier hs-var">mdir</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681133099"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133099"><span class="hs-identifier hs-var">fp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModule TCM (FilePath, FilePath)
forall (m :: * -&gt; *).
(MonadGHCIO m, ReadGHCModuleEnv m) =&gt;
m (FilePath, FilePath)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFileAndDir"><span class="hs-identifier hs-var">curOutFileAndDir</span></a></span><span>
</span><span id="line-1281"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133098"><span class="annot"><span class="annottext">ghcopts :: [FilePath]
</span><a href="#local-6989586621681133098"><span class="hs-identifier hs-var hs-var">ghcopts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCOptions -&gt; [FilePath]
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcFlags"><span class="hs-identifier hs-var">optGhcFlags</span></a></span><span> </span><span class="annot"><span class="annottext">GHCOptions
</span><a href="#local-6989586621681133107"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-1282"></span><span>
</span><span id="line-1283"></span><span>  </span><span id="local-6989586621681133097"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133097"><span class="hs-identifier hs-var">modIsMain</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModule TCM Bool
forall (m :: * -&gt; *). ReadGHCModuleEnv m =&gt; m Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#curIsMainModule"><span class="hs-identifier hs-var">curIsMainModule</span></a></span><span>
</span><span id="line-1284"></span><span>  </span><span id="local-6989586621681133096"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133096"><span class="hs-identifier hs-var">modHasMainFunc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GHCModule -&gt; Bool) -&gt; ReaderT GHCModule TCM Bool
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (GHCModule -&gt; Bool) -&gt; GHCModule -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[MainFunctionDef] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">([MainFunctionDef] -&gt; Bool)
-&gt; (GHCModule -&gt; [MainFunctionDef]) -&gt; GHCModule -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GHCModule -&gt; [MainFunctionDef]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcModMainFuncs"><span class="hs-identifier hs-var">ghcModMainFuncs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1285"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133094"><span class="annot"><span class="annottext">isMain :: Bool
</span><a href="#local-6989586621681133094"><span class="hs-identifier hs-var hs-var">isMain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133097"><span class="hs-identifier hs-var">modIsMain</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133096"><span class="hs-identifier hs-var">modHasMainFunc</span></a></span><span>  </span><span class="hs-comment">-- both need to be IsMain</span><span>
</span><span id="line-1286"></span><span>
</span><span id="line-1287"></span><span>  </span><span class="hs-comment">-- Warn if no main function and not --no-main</span><span>
</span><span id="line-1288"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; ReaderT GHCModule TCM () -&gt; ReaderT GHCModule TCM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133097"><span class="hs-identifier hs-var">modIsMain</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133094"><span class="hs-identifier hs-var">isMain</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ReaderT GHCModule TCM () -&gt; ReaderT GHCModule TCM ())
-&gt; ReaderT GHCModule TCM () -&gt; ReaderT GHCModule TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1289"></span><span>    </span><span class="annot"><span class="annottext">Doc -&gt; ReaderT GHCModule TCM ()
forall (m :: * -&gt; *). MonadWarning m =&gt; Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Warnings.html#genericWarning"><span class="hs-identifier hs-var">genericWarning</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; ReaderT GHCModule TCM ())
-&gt; ReaderT GHCModule TCM Doc -&gt; ReaderT GHCModule TCM ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">[ReaderT GHCModule TCM Doc] -&gt; ReaderT GHCModule TCM Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#fsep"><span class="hs-identifier hs-var">fsep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; [ReaderT GHCModule TCM Doc]
forall (m :: * -&gt; *). Applicative m =&gt; FilePath -&gt; [m Doc]
</span><a href="Agda.TypeChecking.Pretty.html#pwords"><span class="hs-identifier hs-var">pwords</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;No main function defined in&quot;</span></span><span> </span><span class="annot"><span class="annottext">[ReaderT GHCModule TCM Doc]
-&gt; [ReaderT GHCModule TCM Doc] -&gt; [ReaderT GHCModule TCM Doc]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ModuleName -&gt; ReaderT GHCModule TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681133105"><span class="hs-identifier hs-var">agdaMod</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModule TCM Doc
-&gt; ReaderT GHCModule TCM Doc -&gt; ReaderT GHCModule TCM Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModule TCM Doc
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[ReaderT GHCModule TCM Doc]
-&gt; [ReaderT GHCModule TCM Doc] -&gt; [ReaderT GHCModule TCM Doc]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-1290"></span><span>                             </span><span class="annot"><span class="annottext">FilePath -&gt; [ReaderT GHCModule TCM Doc]
forall (m :: * -&gt; *). Applicative m =&gt; FilePath -&gt; [m Doc]
</span><a href="Agda.TypeChecking.Pretty.html#pwords"><span class="hs-identifier hs-var">pwords</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Use --no-main to suppress this warning.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1291"></span><span>
</span><span id="line-1292"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133091"><span class="annot"><span class="annottext">overridableArgs :: [FilePath]
</span><a href="#local-6989586621681133091"><span class="hs-identifier hs-var hs-var">overridableArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1293"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-O&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-1294"></span><span>        </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133094"><span class="hs-identifier hs-var">isMain</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-o&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133100"><span class="hs-identifier hs-var">mdir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; FilePath
forall a. Pretty a =&gt; a -&gt; FilePath
</span><a href="Agda.Utils.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#nameConcrete"><span class="hs-identifier hs-var">nameConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681133103"><span class="hs-identifier hs-var">outputName</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-1295"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-Werror&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-1296"></span><span>      </span><span id="local-6989586621681133089"><span class="annot"><span class="annottext">otherArgs :: [FilePath]
</span><a href="#local-6989586621681133089"><span class="hs-identifier hs-var hs-var">otherArgs</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span>
</span><span id="line-1297"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-i&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133100"><span class="hs-identifier hs-var">mdir</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-1298"></span><span>        </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133094"><span class="hs-identifier hs-var">isMain</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-main-is&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133106"><span class="hs-identifier hs-var">hsmod</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-1299"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133099"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-1300"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;--make&quot;</span></span><span>
</span><span id="line-1301"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-fwarn-incomplete-patterns&quot;</span></span><span>
</span><span id="line-1302"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-1303"></span><span>      </span><span id="local-6989586621681133088"><span class="annot"><span class="annottext">args :: [FilePath]
</span><a href="#local-6989586621681133088"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681133091"><span class="hs-identifier hs-var">overridableArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681133098"><span class="hs-identifier hs-var">ghcopts</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681133089"><span class="hs-identifier hs-var">otherArgs</span></a></span><span>
</span><span id="line-1304"></span><span>
</span><span id="line-1305"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133087"><span class="annot"><span class="annottext">ghcBin :: FilePath
</span><a href="#local-6989586621681133087"><span class="hs-identifier hs-var hs-var">ghcBin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCOptions -&gt; FilePath
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcBin"><span class="hs-identifier hs-var">optGhcBin</span></a></span><span> </span><span class="annot"><span class="annottext">GHCOptions
</span><a href="#local-6989586621681133107"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-1306"></span><span>
</span><span id="line-1307"></span><span>  </span><span class="hs-comment">-- Make GHC use UTF-8 when writing to stdout and stderr.</span><span>
</span><span id="line-1308"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; ReaderT GHCModule TCM ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ReaderT GHCModule TCM ())
-&gt; IO () -&gt; ReaderT GHCModule TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">setEnv</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GHC_CHARENC&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;UTF-8&quot;</span></span><span>
</span><span id="line-1309"></span><span>  </span><span class="hs-comment">-- Note: Some versions of GHC use stderr for progress reports. For</span><span>
</span><span id="line-1310"></span><span>  </span><span class="hs-comment">-- those versions of GHC we don't print any progress information</span><span>
</span><span id="line-1311"></span><span>  </span><span class="hs-comment">-- unless an error is encountered.</span><span>
</span><span id="line-1312"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681133086"><span class="annot"><span class="annottext">doCall :: Bool
</span><a href="#local-6989586621681133086"><span class="hs-identifier hs-var hs-var">doCall</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCOptions -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#optGhcCallGhc"><span class="hs-identifier hs-var">optGhcCallGhc</span></a></span><span> </span><span class="annot"><span class="annottext">GHCOptions
</span><a href="#local-6989586621681133107"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-1313"></span><span>  </span><span class="annot"><span class="annottext">TCM () -&gt; ReaderT GHCModule TCM ()
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; ReaderT GHCModule TCM ())
-&gt; TCM () -&gt; ReaderT GHCModule TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; FilePath -&gt; [FilePath] -&gt; Maybe TextEncoding -&gt; TCM ()
</span><a href="Agda.Compiler.CallCompiler.html#callCompiler"><span class="hs-identifier hs-var">callCompiler</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681133086"><span class="hs-identifier hs-var">doCall</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681133087"><span class="hs-identifier hs-var">ghcBin</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681133088"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TextEncoding -&gt; Maybe TextEncoding
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TextEncoding
</span><span class="hs-identifier hs-var">utf8</span></span><span class="hs-special">)</span><span>
</span><span id="line-1314"></span></pre></body></html>