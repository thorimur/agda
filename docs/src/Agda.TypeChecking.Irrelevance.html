<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE NondecreasingIndentation #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">{-| Compile-time irrelevance.

In type theory with compile-time irrelevance &#224; la Pfenning (LiCS 2001),
variables in the context are annotated with relevance attributes.
@@
  &#915; = r&#8321;x&#8321;:A&#8321;, ..., r&#11388;x&#11388;:A&#11388;
@@
To handle irrelevant projections, we also record the current relevance
attribute in the judgement.  For instance, this attribute is equal to
to 'Irrelevant' if we are in an irrelevant position, like an
irrelevant argument.
@@
  &#915; &#8866;r t : A
@@
Only relevant variables can be used:
@@

  (Relevant x : A) &#8712; &#915;
  --------------------
  &#915;  &#8866;r  x  :  A
@@
Irrelevant global declarations can only be used if @r = Irrelevant@.

When we enter a @r'@-relevant function argument, we compose the @r@ with @r'@
and (left-)divide the attributes in the context by @r'@.
@@
  &#915;  &#8866;r  t  :  (r' x : A) &#8594; B      r' \ &#915;  &#8866;(r'&#183;r)  u  :  A
  ---------------------------------------------------------
  &#915;  &#8866;r  t u  :  B[u/x]
@@
No surprises for abstraction:
@@

  &#915;, (r' x : A)  &#8866;r  :  B
  -----------------------------
  &#915;  &#8866;r  &#955;xt  :  (r' x : A) &#8594; B
@@

This is different for runtime irrelevance (erasure) which is ``flat'',
meaning that once one is in an irrelevant context, all new assumptions will
be usable, since they are turned relevant once entering the context.
See Conor McBride (WadlerFest 2016), for a type system in this spirit:

We use such a rule for runtime-irrelevance:
@@
  &#915;, (q \ q') x : A  &#8866;q  t  :  B
  ------------------------------
  &#915;  &#8866;q  &#955;xt  :  (q' x : A) &#8594; B
@@

Conor's system is however set up differently, with a very different
variable rule:

@@

  (q x : A) &#8712; &#915;
  --------------
  &#915;  &#8866;q  x  :  A

  &#915;, (q&#183;p) x : A  &#8866;q  t  :  B
  -----------------------------
  &#915;  &#8866;q  &#955;xt  :  (p x : A) &#8594; B

  &#915;  &#8866;q  t  :  (p x : A) &#8594; B       &#915;'  &#8866;qp  u  :  A
  -------------------------------------------------
  &#915; + &#915;'  &#8866;q  t u  :  B[u/x]
@@


-}</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Agda.TypeChecking.Irrelevance</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.html"><span class="hs-identifier">Agda.Interaction.Options</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html"><span class="hs-identifier">Agda.Syntax.Common</span></a></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html"><span class="hs-identifier">Agda.Syntax.Internal</span></a></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.html"><span class="hs-identifier">Agda.TypeChecking.Monad</span></a></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html"><span class="hs-identifier">Agda.TypeChecking.Pretty</span></a></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Reduce.html"><span class="hs-identifier">Agda.TypeChecking.Reduce</span></a></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html"><span class="hs-identifier">Agda.TypeChecking.Substitute.Class</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Function.html"><span class="hs-identifier">Agda.Utils.Function</span></a></span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html"><span class="hs-identifier">Agda.Utils.Lens</span></a></span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Maybe.html"><span class="hs-identifier">Agda.Utils.Maybe</span></a></span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html"><span class="hs-identifier">Agda.Utils.Monad</span></a></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-comment">-- | data 'Relevance'</span><span>
</span><span id="line-98"></span><span class="hs-comment">--   see &quot;Agda.Syntax.Common&quot;.</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- * Operations on 'Dom'.</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- | Prepare parts of a parameter telescope for abstraction in constructors</span><span>
</span><span id="line-103"></span><span class="hs-comment">--   and projections.</span><span>
</span><span id="line-104"></span><span id="local-6989586621681011303"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#hideAndRelParams"><span class="hs-identifier hs-type">hideAndRelParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#LensHiding"><span class="hs-identifier hs-type">LensHiding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011303"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#LensRelevance"><span class="hs-identifier hs-type">LensRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011303"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011303"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011303"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-105"></span><span id="hideAndRelParams"><span class="annot"><span class="annottext">hideAndRelParams :: forall a. (LensHiding a, LensRelevance a) =&gt; a -&gt; a
</span><a href="Agda.TypeChecking.Irrelevance.html#hideAndRelParams"><span class="hs-identifier hs-var hs-var">hideAndRelParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. LensHiding a =&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#hideOrKeepInstance"><span class="hs-identifier hs-var">hideOrKeepInstance</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; (a -&gt; a) -&gt; a -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Relevance -&gt; Relevance) -&gt; a -&gt; a
forall a. LensRelevance a =&gt; (Relevance -&gt; Relevance) -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#mapRelevance"><span class="hs-identifier hs-var">mapRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#nonStrictToIrr"><span class="hs-identifier hs-var">nonStrictToIrr</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-comment">-- * Operations on 'Context'.</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | Modify the context whenever going from the l.h.s. (term side)</span><span>
</span><span id="line-110"></span><span class="hs-comment">--   of the typing judgement to the r.h.s. (type side).</span><span>
</span><span id="line-111"></span><span id="local-6989586621681011289"><span id="local-6989586621681011293"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#workOnTypes"><span class="hs-identifier hs-type">workOnTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCEnv"><span class="hs-identifier hs-type">MonadTCEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011293"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.HasOptions.html#HasOptions"><span class="hs-identifier hs-type">HasOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011293"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#MonadDebug"><span class="hs-identifier hs-type">MonadDebug</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011293"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011293"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011289"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011293"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011289"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-113"></span><span id="workOnTypes"><span class="annot"><span class="annottext">workOnTypes :: forall (m :: * -&gt; *) a.
(MonadTCEnv m, HasOptions m, MonadDebug m) =&gt;
m a -&gt; m a
</span><a href="Agda.TypeChecking.Irrelevance.html#workOnTypes"><span class="hs-identifier hs-var hs-var">workOnTypes</span></a></span></span><span> </span><span id="local-6989586621681010879"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621681010879"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-114"></span><span>  </span><span id="local-6989586621681010878"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681010878"><span class="hs-identifier hs-var">allowed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PragmaOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Base.html#optExperimentalIrrelevance"><span class="hs-identifier hs-var">optExperimentalIrrelevance</span></a></span><span> </span><span class="annot"><span class="annottext">(PragmaOptions -&gt; Bool) -&gt; m PragmaOptions -&gt; m Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m PragmaOptions
forall (m :: * -&gt; *). HasOptions m =&gt; m PragmaOptions
</span><a href="Agda.Interaction.Options.HasOptions.html#pragmaOptions"><span class="hs-identifier hs-var">pragmaOptions</span></a></span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseLevel -&gt; VerboseKey -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadDebug m =&gt;
VerboseKey -&gt; VerboseLevel -&gt; VerboseKey -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Debug.html#verboseBracket"><span class="hs-identifier hs-var">verboseBracket</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;tc.irr&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">60</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;workOnTypes&quot;</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; m a) -&gt; m a -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a. MonadTCEnv m =&gt; Bool -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Irrelevance.html#workOnTypes%27"><span class="hs-identifier hs-var">workOnTypes'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681010878"><span class="hs-identifier hs-var">allowed</span></a></span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621681010879"><span class="hs-identifier hs-var">cont</span></a></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-comment">-- | Internal workhorse, expects value of --experimental-irrelevance flag</span><span>
</span><span id="line-118"></span><span class="hs-comment">--   as argument.</span><span>
</span><span id="line-119"></span><span id="local-6989586621681011270"><span id="local-6989586621681011271"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#workOnTypes%27"><span class="hs-identifier hs-type">workOnTypes'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCEnv"><span class="hs-identifier hs-type">MonadTCEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011271"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011271"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011270"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011271"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011270"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-120"></span><span id="workOnTypes%27"><span class="annot"><span class="annottext">workOnTypes' :: forall (m :: * -&gt; *) a. MonadTCEnv m =&gt; Bool -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Irrelevance.html#workOnTypes%27"><span class="hs-identifier hs-var hs-var">workOnTypes'</span></a></span></span><span> </span><span id="local-6989586621681010865"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681010865"><span class="hs-identifier hs-var">experimental</span></a></span></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681010865"><span class="hs-identifier hs-var">experimental</span></a></span><span>
</span><span id="line-122"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(forall e. Dom e -&gt; Dom e) -&gt; m a -&gt; m a
forall (tcm :: * -&gt; *) a.
MonadTCEnv tcm =&gt;
(forall e. Dom e -&gt; Dom e) -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Context.html#modifyContextInfo"><span class="hs-identifier hs-var">modifyContextInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Relevance -&gt; Relevance) -&gt; Dom e -&gt; Dom e
forall a. LensRelevance a =&gt; (Relevance -&gt; Relevance) -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#mapRelevance"><span class="hs-identifier hs-var">mapRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#irrToNonStrict"><span class="hs-identifier hs-var">irrToNonStrict</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">m a -&gt; m a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>  </span><span class="annot"><span class="annottext">(m a -&gt; m a) -&gt; (m a -&gt; m a) -&gt; m a -&gt; m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Quantity -&gt; m a -&gt; m a
forall (tcm :: * -&gt; *) q a.
(MonadTCEnv tcm, LensQuantity q) =&gt;
q -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyQuantityToContext"><span class="hs-identifier hs-var">applyQuantityToContext</span></a></span><span> </span><span class="annot"><span class="annottext">Quantity
</span><a href="Agda.Syntax.Common.html#zeroQuantity"><span class="hs-identifier hs-var">zeroQuantity</span></a></span><span>
</span><span id="line-125"></span><span>  </span><span class="annot"><span class="annottext">(m a -&gt; m a) -&gt; (m a -&gt; m a) -&gt; m a -&gt; m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">m a -&gt; m a
forall (m :: * -&gt; *) a. MonadTCEnv m =&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Env.html#typeLevelReductions"><span class="hs-identifier hs-var">typeLevelReductions</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><span class="annottext">(m a -&gt; m a) -&gt; (m a -&gt; m a) -&gt; m a -&gt; m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(TCEnv -&gt; TCEnv) -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadTCEnv m =&gt;
(TCEnv -&gt; TCEnv) -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#localTC"><span class="hs-identifier hs-var">localTC</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681010855"><span class="annot"><span class="annottext">TCEnv
</span><a href="#local-6989586621681010855"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCEnv
</span><a href="#local-6989586621681010855"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">envWorkingOnTypes :: Bool
</span><a href="Agda.TypeChecking.Monad.Base.html#envWorkingOnTypes"><span class="hs-identifier hs-var">envWorkingOnTypes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-comment">-- | (Conditionally) wake up irrelevant variables and make them relevant.</span><span>
</span><span id="line-129"></span><span class="hs-comment">--   For instance,</span><span>
</span><span id="line-130"></span><span class="hs-comment">--   in an irrelevant function argument otherwise irrelevant variables</span><span>
</span><span id="line-131"></span><span class="hs-comment">--   may be used, so they are awoken before type checking the argument.</span><span>
</span><span id="line-132"></span><span class="hs-comment">--</span><span>
</span><span id="line-133"></span><span class="hs-comment">--   Also allow the use of irrelevant definitions.</span><span>
</span><span id="line-134"></span><span id="local-6989586621681011247"><span id="local-6989586621681011248"><span id="local-6989586621681011249"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#applyRelevanceToContext"><span class="hs-identifier hs-type">applyRelevanceToContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCEnv"><span class="hs-identifier hs-type">MonadTCEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011249"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#LensRelevance"><span class="hs-identifier hs-type">LensRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011248"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011248"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011249"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011247"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011249"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011247"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-135"></span><span id="applyRelevanceToContext"><span class="annot"><span class="annottext">applyRelevanceToContext :: forall (tcm :: * -&gt; *) r a.
(MonadTCEnv tcm, LensRelevance r) =&gt;
r -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyRelevanceToContext"><span class="hs-identifier hs-var hs-var">applyRelevanceToContext</span></a></span></span><span> </span><span id="local-6989586621681010847"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621681010847"><span class="hs-identifier hs-var">thing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">r -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621681010847"><span class="hs-identifier hs-var">thing</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><span class="annottext">Relevance
</span><a href="Agda.Syntax.Common.html#Relevant"><span class="hs-identifier hs-var">Relevant</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">tcm a -&gt; tcm a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-138"></span><span>    </span><span id="local-6989586621681010844"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010844"><span class="hs-identifier hs-var">rel</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; tcm a -&gt; tcm a
forall (tcm :: * -&gt; *) a.
MonadTCEnv tcm =&gt;
Relevance -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyRelevanceToContextOnly"><span class="hs-identifier hs-var">applyRelevanceToContextOnly</span></a></span><span>   </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010844"><span class="hs-identifier hs-var">rel</span></a></span><span>
</span><span id="line-139"></span><span>              </span><span class="annot"><span class="annottext">(tcm a -&gt; tcm a) -&gt; (tcm a -&gt; tcm a) -&gt; tcm a -&gt; tcm a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; tcm a -&gt; tcm a
forall (tcm :: * -&gt; *) a.
MonadTCEnv tcm =&gt;
Relevance -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyRelevanceToJudgementOnly"><span class="hs-identifier hs-var">applyRelevanceToJudgementOnly</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010844"><span class="hs-identifier hs-var">rel</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- | (Conditionally) wake up irrelevant variables and make them relevant.</span><span>
</span><span id="line-142"></span><span class="hs-comment">--   For instance,</span><span>
</span><span id="line-143"></span><span class="hs-comment">--   in an irrelevant function argument otherwise irrelevant variables</span><span>
</span><span id="line-144"></span><span class="hs-comment">--   may be used, so they are awoken before type checking the argument.</span><span>
</span><span id="line-145"></span><span class="hs-comment">--</span><span>
</span><span id="line-146"></span><span class="hs-comment">--   Precondition: @Relevance /= Relevant@</span><span>
</span><span id="line-147"></span><span id="local-6989586621681011242"><span id="local-6989586621681011243"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#applyRelevanceToContextOnly"><span class="hs-identifier hs-type">applyRelevanceToContextOnly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCEnv"><span class="hs-identifier hs-type">MonadTCEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011243"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Relevance"><span class="hs-identifier hs-type">Relevance</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011243"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011242"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011243"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011242"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-148"></span><span id="applyRelevanceToContextOnly"><span class="annot"><span class="annottext">applyRelevanceToContextOnly :: forall (tcm :: * -&gt; *) a.
MonadTCEnv tcm =&gt;
Relevance -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyRelevanceToContextOnly"><span class="hs-identifier hs-var hs-var">applyRelevanceToContextOnly</span></a></span></span><span> </span><span id="local-6989586621681010833"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010833"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TCEnv -&gt; TCEnv) -&gt; tcm a -&gt; tcm a
forall (m :: * -&gt; *) a.
MonadTCEnv m =&gt;
(TCEnv -&gt; TCEnv) -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#localTC"><span class="hs-identifier hs-var">localTC</span></a></span><span>
</span><span id="line-149"></span><span>  </span><span class="annot"><span class="annottext">((TCEnv -&gt; TCEnv) -&gt; tcm a -&gt; tcm a)
-&gt; (TCEnv -&gt; TCEnv) -&gt; tcm a -&gt; tcm a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lens' [ContextEntry] TCEnv -&gt; LensMap [ContextEntry] TCEnv
forall i o. Lens' i o -&gt; LensMap i o
</span><a href="Agda.Utils.Lens.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' [ContextEntry] TCEnv
</span><a href="Agda.TypeChecking.Monad.Base.html#eContext"><span class="hs-identifier hs-var">eContext</span></a></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ContextEntry -&gt; ContextEntry) -&gt; [ContextEntry] -&gt; [ContextEntry]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">((ContextEntry -&gt; ContextEntry)
 -&gt; [ContextEntry] -&gt; [ContextEntry])
-&gt; (ContextEntry -&gt; ContextEntry)
-&gt; [ContextEntry]
-&gt; [ContextEntry]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; ContextEntry -&gt; ContextEntry
forall a. LensRelevance a =&gt; Relevance -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#inverseApplyRelevance"><span class="hs-identifier hs-var">inverseApplyRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010833"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><span class="annottext">(TCEnv -&gt; TCEnv) -&gt; (TCEnv -&gt; TCEnv) -&gt; TCEnv -&gt; TCEnv
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Lens' (Map Name (Open (Term, Dom Type))) TCEnv
-&gt; LensMap (Map Name (Open (Term, Dom Type))) TCEnv
forall i o. Lens' i o -&gt; LensMap i o
</span><a href="Agda.Utils.Lens.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' (Map Name (Open (Term, Dom Type))) TCEnv
</span><a href="Agda.TypeChecking.Monad.Base.html#eLetBindings"><span class="hs-identifier hs-var">eLetBindings</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Open (Term, Dom Type) -&gt; Open (Term, Dom Type))
-&gt; Map Name (Open (Term, Dom Type))
-&gt; Map Name (Open (Term, Dom Type))
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="annot"><span class="annottext">((Open (Term, Dom Type) -&gt; Open (Term, Dom Type))
 -&gt; Map Name (Open (Term, Dom Type))
 -&gt; Map Name (Open (Term, Dom Type)))
-&gt; ((Dom Type -&gt; Dom Type)
    -&gt; Open (Term, Dom Type) -&gt; Open (Term, Dom Type))
-&gt; (Dom Type -&gt; Dom Type)
-&gt; Map Name (Open (Term, Dom Type))
-&gt; Map Name (Open (Term, Dom Type))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Term, Dom Type) -&gt; (Term, Dom Type))
-&gt; Open (Term, Dom Type) -&gt; Open (Term, Dom Type)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(((Term, Dom Type) -&gt; (Term, Dom Type))
 -&gt; Open (Term, Dom Type) -&gt; Open (Term, Dom Type))
-&gt; ((Dom Type -&gt; Dom Type) -&gt; (Term, Dom Type) -&gt; (Term, Dom Type))
-&gt; (Dom Type -&gt; Dom Type)
-&gt; Open (Term, Dom Type)
-&gt; Open (Term, Dom Type)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Dom Type -&gt; Dom Type) -&gt; (Term, Dom Type) -&gt; (Term, Dom Type)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">((Dom Type -&gt; Dom Type)
 -&gt; Map Name (Open (Term, Dom Type))
 -&gt; Map Name (Open (Term, Dom Type)))
-&gt; (Dom Type -&gt; Dom Type)
-&gt; Map Name (Open (Term, Dom Type))
-&gt; Map Name (Open (Term, Dom Type))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Dom Type -&gt; Dom Type
forall a. LensRelevance a =&gt; Relevance -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#inverseApplyRelevance"><span class="hs-identifier hs-var">inverseApplyRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010833"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">-- | Apply relevance @rel@ the the relevance annotation of the (typing/equality)</span><span>
</span><span id="line-153"></span><span class="hs-comment">--   judgement.  This is part of the work done when going into a @rel@-context.</span><span>
</span><span id="line-154"></span><span class="hs-comment">--</span><span>
</span><span id="line-155"></span><span class="hs-comment">--   Precondition: @Relevance /= Relevant@</span><span>
</span><span id="line-156"></span><span id="local-6989586621681010822"><span id="local-6989586621681010823"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#applyRelevanceToJudgementOnly"><span class="hs-identifier hs-type">applyRelevanceToJudgementOnly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCEnv"><span class="hs-identifier hs-type">MonadTCEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010823"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Relevance"><span class="hs-identifier hs-type">Relevance</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681010823"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010822"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681010823"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010822"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-157"></span><span id="applyRelevanceToJudgementOnly"><span class="annot"><span class="annottext">applyRelevanceToJudgementOnly :: forall (tcm :: * -&gt; *) a.
MonadTCEnv tcm =&gt;
Relevance -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyRelevanceToJudgementOnly"><span class="hs-identifier hs-var hs-var">applyRelevanceToJudgementOnly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TCEnv -&gt; TCEnv) -&gt; tcm a -&gt; tcm a
forall (m :: * -&gt; *) a.
MonadTCEnv m =&gt;
(TCEnv -&gt; TCEnv) -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#localTC"><span class="hs-identifier hs-var">localTC</span></a></span><span> </span><span class="annot"><span class="annottext">((TCEnv -&gt; TCEnv) -&gt; tcm a -&gt; tcm a)
-&gt; (Relevance -&gt; TCEnv -&gt; TCEnv) -&gt; Relevance -&gt; tcm a -&gt; tcm a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Lens' Relevance TCEnv -&gt; LensMap Relevance TCEnv
forall i o. Lens' i o -&gt; LensMap i o
</span><a href="Agda.Utils.Lens.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' Relevance TCEnv
</span><a href="Agda.TypeChecking.Monad.Base.html#eRelevance"><span class="hs-identifier hs-var">eRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">LensMap Relevance TCEnv
-&gt; (Relevance -&gt; Relevance -&gt; Relevance)
-&gt; Relevance
-&gt; TCEnv
-&gt; TCEnv
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Relevance -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#composeRelevance"><span class="hs-identifier hs-var">composeRelevance</span></a></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">-- | Like 'applyRelevanceToContext', but only act on context if</span><span>
</span><span id="line-160"></span><span class="hs-comment">--   @--irrelevant-projections@.</span><span>
</span><span id="line-161"></span><span class="hs-comment">--   See issue #2170.</span><span>
</span><span id="line-162"></span><span id="local-6989586621681011207"><span id="local-6989586621681011208"><span id="local-6989586621681011210"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#applyRelevanceToContextFunBody"><span class="hs-identifier hs-type">applyRelevanceToContextFunBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCM"><span class="hs-identifier hs-type">MonadTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011210"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#LensRelevance"><span class="hs-identifier hs-type">LensRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011208"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011208"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011210"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011207"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011210"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011207"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-163"></span><span id="applyRelevanceToContextFunBody"><span class="annot"><span class="annottext">applyRelevanceToContextFunBody :: forall (tcm :: * -&gt; *) r a.
(MonadTCM tcm, LensRelevance r) =&gt;
r -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyRelevanceToContextFunBody"><span class="hs-identifier hs-var hs-var">applyRelevanceToContextFunBody</span></a></span></span><span> </span><span id="local-6989586621681010795"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621681010795"><span class="hs-identifier hs-var">thing</span></a></span></span><span> </span><span id="local-6989586621681010794"><span class="annot"><span class="annottext">tcm a
</span><a href="#local-6989586621681010794"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">r -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621681010795"><span class="hs-identifier hs-var">thing</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-165"></span><span>    </span><span class="annot"><span class="annottext">Relevance
</span><a href="Agda.Syntax.Common.html#Relevant"><span class="hs-identifier hs-var">Relevant</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">tcm a
</span><a href="#local-6989586621681010794"><span class="hs-identifier hs-var">cont</span></a></span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621681010793"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010793"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">tcm Bool -&gt; (tcm a -&gt; tcm a) -&gt; tcm a -&gt; tcm a
forall (m :: * -&gt; *) a.
Monad m =&gt;
m Bool -&gt; (m a -&gt; m a) -&gt; m a -&gt; m a
</span><a href="Agda.Utils.Function.html#applyWhenM"><span class="hs-identifier hs-var">applyWhenM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PragmaOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Base.html#optIrrelevantProjections"><span class="hs-identifier hs-var">optIrrelevantProjections</span></a></span><span> </span><span class="annot"><span class="annottext">(PragmaOptions -&gt; Bool) -&gt; tcm PragmaOptions -&gt; tcm Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">tcm PragmaOptions
forall (m :: * -&gt; *). HasOptions m =&gt; m PragmaOptions
</span><a href="Agda.Interaction.Options.HasOptions.html#pragmaOptions"><span class="hs-identifier hs-var">pragmaOptions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Relevance -&gt; tcm a -&gt; tcm a
forall (tcm :: * -&gt; *) a.
MonadTCEnv tcm =&gt;
Relevance -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyRelevanceToContextOnly"><span class="hs-identifier hs-var">applyRelevanceToContextOnly</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010793"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(tcm a -&gt; tcm a) -&gt; tcm a -&gt; tcm a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>    </span><span class="hs-comment">-- enable local irr. defs only when option</span><span>
</span><span id="line-168"></span><span>      </span><span class="annot"><span class="annottext">Relevance -&gt; tcm a -&gt; tcm a
forall (tcm :: * -&gt; *) a.
MonadTCEnv tcm =&gt;
Relevance -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyRelevanceToJudgementOnly"><span class="hs-identifier hs-var">applyRelevanceToJudgementOnly</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010793"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">tcm a
</span><a href="#local-6989586621681010794"><span class="hs-identifier hs-var">cont</span></a></span><span> </span><span class="hs-comment">-- enable global irr. defs alway</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">-- | Sets the current quantity (unless the given quantity is 1).</span><span>
</span><span id="line-171"></span><span id="local-6989586621681011254"><span id="local-6989586621681011255"><span id="local-6989586621681011256"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#applyQuantityToContext"><span class="hs-identifier hs-type">applyQuantityToContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCEnv"><span class="hs-identifier hs-type">MonadTCEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011256"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#LensQuantity"><span class="hs-identifier hs-type">LensQuantity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011255"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011255"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011256"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011254"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011256"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011254"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-172"></span><span id="applyQuantityToContext"><span class="annot"><span class="annottext">applyQuantityToContext :: forall (tcm :: * -&gt; *) q a.
(MonadTCEnv tcm, LensQuantity q) =&gt;
q -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyQuantityToContext"><span class="hs-identifier hs-var hs-var">applyQuantityToContext</span></a></span></span><span> </span><span id="local-6989586621681010786"><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621681010786"><span class="hs-identifier hs-var">thing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">q -&gt; Quantity
forall a. LensQuantity a =&gt; a -&gt; Quantity
</span><a href="Agda.Syntax.Common.html#getQuantity"><span class="hs-identifier hs-var">getQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621681010786"><span class="hs-identifier hs-var">thing</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Common.html#Quantity1"><span class="hs-identifier hs-type">Quantity1</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">tcm a -&gt; tcm a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-175"></span><span>    </span><span id="local-6989586621681010783"><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621681010783"><span class="hs-identifier hs-var">q</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Quantity -&gt; tcm a -&gt; tcm a
forall (tcm :: * -&gt; *) a.
MonadTCEnv tcm =&gt;
Quantity -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyQuantityToJudgementOnly"><span class="hs-identifier hs-var">applyQuantityToJudgementOnly</span></a></span><span> </span><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621681010783"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-comment">-- | Apply quantity @q@ the the quantity annotation of the (typing/equality)</span><span>
</span><span id="line-178"></span><span class="hs-comment">--   judgement.  This is part of the work done when going into a @q@-context.</span><span>
</span><span id="line-179"></span><span class="hs-comment">--</span><span>
</span><span id="line-180"></span><span class="hs-comment">--   Precondition: @Quantity /= Quantity1@</span><span>
</span><span id="line-181"></span><span id="local-6989586621681011193"><span id="local-6989586621681011194"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#applyQuantityToJudgementOnly"><span class="hs-identifier hs-type">applyQuantityToJudgementOnly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCEnv"><span class="hs-identifier hs-type">MonadTCEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011194"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Quantity"><span class="hs-identifier hs-type">Quantity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011194"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011193"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011194"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011193"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-182"></span><span id="applyQuantityToJudgementOnly"><span class="annot"><span class="annottext">applyQuantityToJudgementOnly :: forall (tcm :: * -&gt; *) a.
MonadTCEnv tcm =&gt;
Quantity -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyQuantityToJudgementOnly"><span class="hs-identifier hs-var hs-var">applyQuantityToJudgementOnly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TCEnv -&gt; TCEnv) -&gt; tcm a -&gt; tcm a
forall (m :: * -&gt; *) a.
MonadTCEnv m =&gt;
(TCEnv -&gt; TCEnv) -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#localTC"><span class="hs-identifier hs-var">localTC</span></a></span><span> </span><span class="annot"><span class="annottext">((TCEnv -&gt; TCEnv) -&gt; tcm a -&gt; tcm a)
-&gt; (Quantity -&gt; TCEnv -&gt; TCEnv) -&gt; Quantity -&gt; tcm a -&gt; tcm a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Lens' Quantity TCEnv -&gt; LensMap Quantity TCEnv
forall i o. Lens' i o -&gt; LensMap i o
</span><a href="Agda.Utils.Lens.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' Quantity TCEnv
</span><a href="Agda.TypeChecking.Monad.Base.html#eQuantity"><span class="hs-identifier hs-var">eQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">LensMap Quantity TCEnv
-&gt; (Quantity -&gt; Quantity -&gt; Quantity) -&gt; Quantity -&gt; TCEnv -&gt; TCEnv
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Quantity -&gt; Quantity -&gt; Quantity
</span><a href="Agda.Syntax.Common.html#composeQuantity"><span class="hs-identifier hs-var">composeQuantity</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-comment">-- | Apply inverse composition with the given cohesion to the typing context.</span><span>
</span><span id="line-185"></span><span id="local-6989586621681011186"><span id="local-6989586621681011188"><span id="local-6989586621681011189"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#applyCohesionToContext"><span class="hs-identifier hs-type">applyCohesionToContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCEnv"><span class="hs-identifier hs-type">MonadTCEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011189"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#LensCohesion"><span class="hs-identifier hs-type">LensCohesion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011188"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011188"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011189"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011186"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011189"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011186"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-186"></span><span id="applyCohesionToContext"><span class="annot"><span class="annottext">applyCohesionToContext :: forall (tcm :: * -&gt; *) m a.
(MonadTCEnv tcm, LensCohesion m) =&gt;
m -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyCohesionToContext"><span class="hs-identifier hs-var hs-var">applyCohesionToContext</span></a></span></span><span> </span><span id="local-6989586621681010768"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621681010768"><span class="hs-identifier hs-var">thing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">m -&gt; Cohesion
forall a. LensCohesion a =&gt; a -&gt; Cohesion
</span><a href="Agda.Syntax.Common.html#getCohesion"><span class="hs-identifier hs-var">getCohesion</span></a></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621681010768"><span class="hs-identifier hs-var">thing</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621681010766"><span class="annot"><span class="annottext">Cohesion
</span><a href="#local-6989586621681010766"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Cohesion
</span><a href="#local-6989586621681010766"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Cohesion -&gt; Cohesion -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Cohesion
</span><a href="Agda.Syntax.Common.html#unitCohesion"><span class="hs-identifier hs-var">unitCohesion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">tcm a -&gt; tcm a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-189"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cohesion -&gt; tcm a -&gt; tcm a
forall (tcm :: * -&gt; *) a.
MonadTCEnv tcm =&gt;
Cohesion -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyCohesionToContextOnly"><span class="hs-identifier hs-var">applyCohesionToContextOnly</span></a></span><span>   </span><span class="annot"><span class="annottext">Cohesion
</span><a href="#local-6989586621681010766"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-190"></span><span>                             </span><span class="hs-comment">-- Cohesion does not apply to the judgment.</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span id="local-6989586621681011178"><span id="local-6989586621681011179"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#applyCohesionToContextOnly"><span class="hs-identifier hs-type">applyCohesionToContextOnly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCEnv"><span class="hs-identifier hs-type">MonadTCEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011179"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Cohesion"><span class="hs-identifier hs-type">Cohesion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011179"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011178"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011179"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011178"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-193"></span><span id="applyCohesionToContextOnly"><span class="annot"><span class="annottext">applyCohesionToContextOnly :: forall (tcm :: * -&gt; *) a.
MonadTCEnv tcm =&gt;
Cohesion -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyCohesionToContextOnly"><span class="hs-identifier hs-var hs-var">applyCohesionToContextOnly</span></a></span></span><span> </span><span id="local-6989586621681010756"><span class="annot"><span class="annottext">Cohesion
</span><a href="#local-6989586621681010756"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TCEnv -&gt; TCEnv) -&gt; tcm a -&gt; tcm a
forall (m :: * -&gt; *) a.
MonadTCEnv m =&gt;
(TCEnv -&gt; TCEnv) -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#localTC"><span class="hs-identifier hs-var">localTC</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span class="annot"><span class="annottext">((TCEnv -&gt; TCEnv) -&gt; tcm a -&gt; tcm a)
-&gt; (TCEnv -&gt; TCEnv) -&gt; tcm a -&gt; tcm a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lens' [ContextEntry] TCEnv -&gt; LensMap [ContextEntry] TCEnv
forall i o. Lens' i o -&gt; LensMap i o
</span><a href="Agda.Utils.Lens.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' [ContextEntry] TCEnv
</span><a href="Agda.TypeChecking.Monad.Base.html#eContext"><span class="hs-identifier hs-var">eContext</span></a></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ContextEntry -&gt; ContextEntry) -&gt; [ContextEntry] -&gt; [ContextEntry]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">((ContextEntry -&gt; ContextEntry)
 -&gt; [ContextEntry] -&gt; [ContextEntry])
-&gt; (ContextEntry -&gt; ContextEntry)
-&gt; [ContextEntry]
-&gt; [ContextEntry]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Cohesion -&gt; ContextEntry -&gt; ContextEntry
forall a. LensCohesion a =&gt; Cohesion -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#inverseApplyCohesion"><span class="hs-identifier hs-var">inverseApplyCohesion</span></a></span><span> </span><span class="annot"><span class="annottext">Cohesion
</span><a href="#local-6989586621681010756"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>  </span><span class="annot"><span class="annottext">(TCEnv -&gt; TCEnv) -&gt; (TCEnv -&gt; TCEnv) -&gt; TCEnv -&gt; TCEnv
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Lens' (Map Name (Open (Term, Dom Type))) TCEnv
-&gt; LensMap (Map Name (Open (Term, Dom Type))) TCEnv
forall i o. Lens' i o -&gt; LensMap i o
</span><a href="Agda.Utils.Lens.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' (Map Name (Open (Term, Dom Type))) TCEnv
</span><a href="Agda.TypeChecking.Monad.Base.html#eLetBindings"><span class="hs-identifier hs-var">eLetBindings</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Open (Term, Dom Type) -&gt; Open (Term, Dom Type))
-&gt; Map Name (Open (Term, Dom Type))
-&gt; Map Name (Open (Term, Dom Type))
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="annot"><span class="annottext">((Open (Term, Dom Type) -&gt; Open (Term, Dom Type))
 -&gt; Map Name (Open (Term, Dom Type))
 -&gt; Map Name (Open (Term, Dom Type)))
-&gt; ((Dom Type -&gt; Dom Type)
    -&gt; Open (Term, Dom Type) -&gt; Open (Term, Dom Type))
-&gt; (Dom Type -&gt; Dom Type)
-&gt; Map Name (Open (Term, Dom Type))
-&gt; Map Name (Open (Term, Dom Type))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Term, Dom Type) -&gt; (Term, Dom Type))
-&gt; Open (Term, Dom Type) -&gt; Open (Term, Dom Type)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(((Term, Dom Type) -&gt; (Term, Dom Type))
 -&gt; Open (Term, Dom Type) -&gt; Open (Term, Dom Type))
-&gt; ((Dom Type -&gt; Dom Type) -&gt; (Term, Dom Type) -&gt; (Term, Dom Type))
-&gt; (Dom Type -&gt; Dom Type)
-&gt; Open (Term, Dom Type)
-&gt; Open (Term, Dom Type)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Dom Type -&gt; Dom Type) -&gt; (Term, Dom Type) -&gt; (Term, Dom Type)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">((Dom Type -&gt; Dom Type)
 -&gt; Map Name (Open (Term, Dom Type))
 -&gt; Map Name (Open (Term, Dom Type)))
-&gt; (Dom Type -&gt; Dom Type)
-&gt; Map Name (Open (Term, Dom Type))
-&gt; Map Name (Open (Term, Dom Type))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Cohesion -&gt; Dom Type -&gt; Dom Type
forall a. LensCohesion a =&gt; Cohesion -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#inverseApplyCohesion"><span class="hs-identifier hs-var">inverseApplyCohesion</span></a></span><span> </span><span class="annot"><span class="annottext">Cohesion
</span><a href="#local-6989586621681010756"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-comment">-- | Can we split on arguments of the given cohesion?</span><span>
</span><span id="line-198"></span><span id="local-6989586621681011169"><span id="local-6989586621681011170"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#splittableCohesion"><span class="hs-identifier hs-type">splittableCohesion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.Options.HasOptions.html#HasOptions"><span class="hs-identifier hs-type">HasOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011170"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#LensCohesion"><span class="hs-identifier hs-type">LensCohesion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011169"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011169"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011170"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-199"></span><span id="splittableCohesion"><span class="annot"><span class="annottext">splittableCohesion :: forall (m :: * -&gt; *) a.
(HasOptions m, LensCohesion a) =&gt;
a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#splittableCohesion"><span class="hs-identifier hs-var hs-var">splittableCohesion</span></a></span></span><span> </span><span id="local-6989586621681010731"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681010731"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681010730"><span class="annot"><span class="annottext">c :: Cohesion
</span><a href="#local-6989586621681010730"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Cohesion
forall a. LensCohesion a =&gt; a -&gt; Cohesion
</span><a href="Agda.Syntax.Common.html#getCohesion"><span class="hs-identifier hs-var">getCohesion</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681010731"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-201"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cohesion -&gt; Bool
forall a. LensCohesion a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#usableCohesion"><span class="hs-identifier hs-var">usableCohesion</span></a></span><span> </span><span class="annot"><span class="annottext">Cohesion
</span><a href="#local-6989586621681010730"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-var">`and2M`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cohesion
</span><a href="#local-6989586621681010730"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Cohesion -&gt; Cohesion -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Cohesion
</span><a href="Agda.Syntax.Common.html#Flat"><span class="hs-identifier hs-var">Flat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#or2M"><span class="hs-operator hs-var">`or2M`</span></a></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">PragmaOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Base.html#optFlatSplit"><span class="hs-identifier hs-var">optFlatSplit</span></a></span><span> </span><span class="annot"><span class="annottext">(PragmaOptions -&gt; Bool) -&gt; m PragmaOptions -&gt; m Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m PragmaOptions
forall (m :: * -&gt; *). HasOptions m =&gt; m PragmaOptions
</span><a href="Agda.Interaction.Options.HasOptions.html#pragmaOptions"><span class="hs-identifier hs-var">pragmaOptions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-comment">-- | (Conditionally) wake up irrelevant variables and make them relevant.</span><span>
</span><span id="line-204"></span><span class="hs-comment">--   For instance,</span><span>
</span><span id="line-205"></span><span class="hs-comment">--   in an irrelevant function argument otherwise irrelevant variables</span><span>
</span><span id="line-206"></span><span class="hs-comment">--   may be used, so they are awoken before type checking the argument.</span><span>
</span><span id="line-207"></span><span class="hs-comment">--</span><span>
</span><span id="line-208"></span><span class="hs-comment">--   Also allow the use of irrelevant definitions.</span><span>
</span><span id="line-209"></span><span class="hs-comment">--</span><span>
</span><span id="line-210"></span><span class="hs-comment">--   This function might also do something for other modalities.</span><span>
</span><span id="line-211"></span><span id="local-6989586621681011160"><span id="local-6989586621681011162"><span id="local-6989586621681011163"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#applyModalityToContext"><span class="hs-identifier hs-type">applyModalityToContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCEnv"><span class="hs-identifier hs-type">MonadTCEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011163"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#LensModality"><span class="hs-identifier hs-type">LensModality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011162"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011162"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011163"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011160"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011163"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011160"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-212"></span><span id="applyModalityToContext"><span class="annot"><span class="annottext">applyModalityToContext :: forall (tcm :: * -&gt; *) m a.
(MonadTCEnv tcm, LensModality m) =&gt;
m -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyModalityToContext"><span class="hs-identifier hs-var hs-var">applyModalityToContext</span></a></span></span><span> </span><span id="local-6989586621681010715"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621681010715"><span class="hs-identifier hs-var">thing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">m -&gt; Modality
forall a. LensModality a =&gt; a -&gt; Modality
</span><a href="Agda.Syntax.Common.html#getModality"><span class="hs-identifier hs-var">getModality</span></a></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621681010715"><span class="hs-identifier hs-var">thing</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621681010713"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681010713"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681010713"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Modality -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="Agda.Syntax.Common.html#unitModality"><span class="hs-identifier hs-var">unitModality</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">tcm a -&gt; tcm a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-215"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modality -&gt; tcm a -&gt; tcm a
forall (tcm :: * -&gt; *) a.
MonadTCEnv tcm =&gt;
Modality -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyModalityToContextOnly"><span class="hs-identifier hs-var">applyModalityToContextOnly</span></a></span><span>   </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681010713"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-216"></span><span>                           </span><span class="annot"><span class="annottext">(tcm a -&gt; tcm a) -&gt; (tcm a -&gt; tcm a) -&gt; tcm a -&gt; tcm a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; tcm a -&gt; tcm a
forall (tcm :: * -&gt; *) a.
MonadTCEnv tcm =&gt;
Modality -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyModalityToJudgementOnly"><span class="hs-identifier hs-var">applyModalityToJudgementOnly</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681010713"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="hs-comment">-- | (Conditionally) wake up irrelevant variables and make them relevant.</span><span>
</span><span id="line-219"></span><span class="hs-comment">--   For instance,</span><span>
</span><span id="line-220"></span><span class="hs-comment">--   in an irrelevant function argument otherwise irrelevant variables</span><span>
</span><span id="line-221"></span><span class="hs-comment">--   may be used, so they are awoken before type checking the</span><span>
</span><span id="line-222"></span><span class="hs-comment">--   argument.</span><span>
</span><span id="line-223"></span><span class="hs-comment">--</span><span>
</span><span id="line-224"></span><span class="hs-comment">--   This function might also do something for other modalities, but</span><span>
</span><span id="line-225"></span><span class="hs-comment">--   not for quantities.</span><span>
</span><span id="line-226"></span><span class="hs-comment">--</span><span>
</span><span id="line-227"></span><span class="hs-comment">--   Precondition: @Modality /= Relevant@</span><span>
</span><span id="line-228"></span><span id="local-6989586621681011153"><span id="local-6989586621681011154"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#applyModalityToContextOnly"><span class="hs-identifier hs-type">applyModalityToContextOnly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCEnv"><span class="hs-identifier hs-type">MonadTCEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011154"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Modality"><span class="hs-identifier hs-type">Modality</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011154"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011153"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011154"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011153"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-229"></span><span id="applyModalityToContextOnly"><span class="annot"><span class="annottext">applyModalityToContextOnly :: forall (tcm :: * -&gt; *) a.
MonadTCEnv tcm =&gt;
Modality -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyModalityToContextOnly"><span class="hs-identifier hs-var hs-var">applyModalityToContextOnly</span></a></span></span><span> </span><span id="local-6989586621681010702"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681010702"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TCEnv -&gt; TCEnv) -&gt; tcm a -&gt; tcm a
forall (m :: * -&gt; *) a.
MonadTCEnv m =&gt;
(TCEnv -&gt; TCEnv) -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#localTC"><span class="hs-identifier hs-var">localTC</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><span class="annottext">((TCEnv -&gt; TCEnv) -&gt; tcm a -&gt; tcm a)
-&gt; (TCEnv -&gt; TCEnv) -&gt; tcm a -&gt; tcm a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lens' [ContextEntry] TCEnv -&gt; LensMap [ContextEntry] TCEnv
forall i o. Lens' i o -&gt; LensMap i o
</span><a href="Agda.Utils.Lens.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' [ContextEntry] TCEnv
</span><a href="Agda.TypeChecking.Monad.Base.html#eContext"><span class="hs-identifier hs-var">eContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ContextEntry -&gt; ContextEntry) -&gt; [ContextEntry] -&gt; [ContextEntry]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">((ContextEntry -&gt; ContextEntry)
 -&gt; [ContextEntry] -&gt; [ContextEntry])
-&gt; (ContextEntry -&gt; ContextEntry)
-&gt; [ContextEntry]
-&gt; [ContextEntry]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; ContextEntry -&gt; ContextEntry
forall a. LensModality a =&gt; Modality -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#inverseApplyModalityButNotQuantity"><span class="hs-identifier hs-var">inverseApplyModalityButNotQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681010702"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><span class="annottext">(TCEnv -&gt; TCEnv) -&gt; (TCEnv -&gt; TCEnv) -&gt; TCEnv -&gt; TCEnv
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Lens' (Map Name (Open (Term, Dom Type))) TCEnv
-&gt; LensMap (Map Name (Open (Term, Dom Type))) TCEnv
forall i o. Lens' i o -&gt; LensMap i o
</span><a href="Agda.Utils.Lens.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' (Map Name (Open (Term, Dom Type))) TCEnv
</span><a href="Agda.TypeChecking.Monad.Base.html#eLetBindings"><span class="hs-identifier hs-var">eLetBindings</span></a></span><span>
</span><span id="line-232"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Open (Term, Dom Type) -&gt; Open (Term, Dom Type))
-&gt; Map Name (Open (Term, Dom Type))
-&gt; Map Name (Open (Term, Dom Type))
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="annot"><span class="annottext">((Open (Term, Dom Type) -&gt; Open (Term, Dom Type))
 -&gt; Map Name (Open (Term, Dom Type))
 -&gt; Map Name (Open (Term, Dom Type)))
-&gt; ((Dom Type -&gt; Dom Type)
    -&gt; Open (Term, Dom Type) -&gt; Open (Term, Dom Type))
-&gt; (Dom Type -&gt; Dom Type)
-&gt; Map Name (Open (Term, Dom Type))
-&gt; Map Name (Open (Term, Dom Type))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Term, Dom Type) -&gt; (Term, Dom Type))
-&gt; Open (Term, Dom Type) -&gt; Open (Term, Dom Type)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(((Term, Dom Type) -&gt; (Term, Dom Type))
 -&gt; Open (Term, Dom Type) -&gt; Open (Term, Dom Type))
-&gt; ((Dom Type -&gt; Dom Type) -&gt; (Term, Dom Type) -&gt; (Term, Dom Type))
-&gt; (Dom Type -&gt; Dom Type)
-&gt; Open (Term, Dom Type)
-&gt; Open (Term, Dom Type)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Dom Type -&gt; Dom Type) -&gt; (Term, Dom Type) -&gt; (Term, Dom Type)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">((Dom Type -&gt; Dom Type)
 -&gt; Map Name (Open (Term, Dom Type))
 -&gt; Map Name (Open (Term, Dom Type)))
-&gt; (Dom Type -&gt; Dom Type)
-&gt; Map Name (Open (Term, Dom Type))
-&gt; Map Name (Open (Term, Dom Type))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Dom Type -&gt; Dom Type
forall a. LensModality a =&gt; Modality -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#inverseApplyModalityButNotQuantity"><span class="hs-identifier hs-var">inverseApplyModalityButNotQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681010702"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-comment">-- | Apply modality @m@ the the modality annotation of the (typing/equality)</span><span>
</span><span id="line-235"></span><span class="hs-comment">--   judgement.  This is part of the work done when going into a @m@-context.</span><span>
</span><span id="line-236"></span><span class="hs-comment">--</span><span>
</span><span id="line-237"></span><span class="hs-comment">--   Precondition: @Modality /= Relevant@</span><span>
</span><span id="line-238"></span><span id="local-6989586621681010695"><span id="local-6989586621681010696"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#applyModalityToJudgementOnly"><span class="hs-identifier hs-type">applyModalityToJudgementOnly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCEnv"><span class="hs-identifier hs-type">MonadTCEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010696"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Modality"><span class="hs-identifier hs-type">Modality</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681010696"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010695"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681010696"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010695"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-239"></span><span id="applyModalityToJudgementOnly"><span class="annot"><span class="annottext">applyModalityToJudgementOnly :: forall (tcm :: * -&gt; *) a.
MonadTCEnv tcm =&gt;
Modality -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyModalityToJudgementOnly"><span class="hs-identifier hs-var hs-var">applyModalityToJudgementOnly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TCEnv -&gt; TCEnv) -&gt; tcm a -&gt; tcm a
forall (m :: * -&gt; *) a.
MonadTCEnv m =&gt;
(TCEnv -&gt; TCEnv) -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#localTC"><span class="hs-identifier hs-var">localTC</span></a></span><span> </span><span class="annot"><span class="annottext">((TCEnv -&gt; TCEnv) -&gt; tcm a -&gt; tcm a)
-&gt; (Modality -&gt; TCEnv -&gt; TCEnv) -&gt; Modality -&gt; tcm a -&gt; tcm a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Lens' Modality TCEnv -&gt; LensMap Modality TCEnv
forall i o. Lens' i o -&gt; LensMap i o
</span><a href="Agda.Utils.Lens.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' Modality TCEnv
</span><a href="Agda.TypeChecking.Monad.Base.html#eModality"><span class="hs-identifier hs-var">eModality</span></a></span><span> </span><span class="annot"><span class="annottext">LensMap Modality TCEnv
-&gt; (Modality -&gt; Modality -&gt; Modality) -&gt; Modality -&gt; TCEnv -&gt; TCEnv
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Modality -&gt; Modality
</span><a href="Agda.Syntax.Common.html#composeModality"><span class="hs-identifier hs-var">composeModality</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-comment">-- | Like 'applyModalityToContext', but only act on context (for Relevance) if</span><span>
</span><span id="line-242"></span><span class="hs-comment">--   @--irrelevant-projections@.</span><span>
</span><span id="line-243"></span><span class="hs-comment">--   See issue #2170.</span><span>
</span><span id="line-244"></span><span id="local-6989586621681011140"><span id="local-6989586621681011141"><span id="local-6989586621681011142"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#applyModalityToContextFunBody"><span class="hs-identifier hs-type">applyModalityToContextFunBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCM"><span class="hs-identifier hs-type">MonadTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011142"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#LensModality"><span class="hs-identifier hs-type">LensModality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011141"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011141"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011142"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011140"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011142"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011140"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-245"></span><span id="applyModalityToContextFunBody"><span class="annot"><span class="annottext">applyModalityToContextFunBody :: forall (tcm :: * -&gt; *) r a.
(MonadTCM tcm, LensModality r) =&gt;
r -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyModalityToContextFunBody"><span class="hs-identifier hs-var hs-var">applyModalityToContextFunBody</span></a></span></span><span> </span><span id="local-6989586621681010659"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621681010659"><span class="hs-identifier hs-var">thing</span></a></span></span><span> </span><span id="local-6989586621681010658"><span class="annot"><span class="annottext">tcm a
</span><a href="#local-6989586621681010658"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><span class="annottext">tcm Bool -&gt; tcm a -&gt; tcm a -&gt; tcm a
forall (m :: * -&gt; *) a. Monad m =&gt; m Bool -&gt; m a -&gt; m a -&gt; m a
</span><a href="Agda.Utils.Monad.html#ifM"><span class="hs-identifier hs-var">ifM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PragmaOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Base.html#optIrrelevantProjections"><span class="hs-identifier hs-var">optIrrelevantProjections</span></a></span><span> </span><span class="annot"><span class="annottext">(PragmaOptions -&gt; Bool) -&gt; tcm PragmaOptions -&gt; tcm Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">tcm PragmaOptions
forall (m :: * -&gt; *). HasOptions m =&gt; m PragmaOptions
</span><a href="Agda.Interaction.Options.HasOptions.html#pragmaOptions"><span class="hs-identifier hs-var">pragmaOptions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>      </span><span class="hs-comment">{-then-}</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality -&gt; tcm a -&gt; tcm a
forall (tcm :: * -&gt; *) m a.
(MonadTCEnv tcm, LensModality m) =&gt;
m -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyModalityToContext"><span class="hs-identifier hs-var">applyModalityToContext</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681010656"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">tcm a
</span><a href="#local-6989586621681010658"><span class="hs-identifier hs-var">cont</span></a></span><span class="hs-special">)</span><span>                </span><span class="hs-comment">-- enable global irr. defs always</span><span>
</span><span id="line-248"></span><span>      </span><span class="hs-comment">{-else-}</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Relevance -&gt; tcm a -&gt; tcm a
forall (tcm :: * -&gt; *) r a.
(MonadTCM tcm, LensRelevance r) =&gt;
r -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyRelevanceToContextFunBody"><span class="hs-identifier hs-var">applyRelevanceToContextFunBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681010656"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>               </span><span class="annot"><span class="annottext">(tcm a -&gt; tcm a) -&gt; tcm a -&gt; tcm a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Cohesion -&gt; tcm a -&gt; tcm a
forall (tcm :: * -&gt; *) m a.
(MonadTCEnv tcm, LensCohesion m) =&gt;
m -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyCohesionToContext"><span class="hs-identifier hs-var">applyCohesionToContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality -&gt; Cohesion
forall a. LensCohesion a =&gt; a -&gt; Cohesion
</span><a href="Agda.Syntax.Common.html#getCohesion"><span class="hs-identifier hs-var">getCohesion</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681010656"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>               </span><span class="annot"><span class="annottext">(tcm a -&gt; tcm a) -&gt; tcm a -&gt; tcm a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Quantity -&gt; tcm a -&gt; tcm a
forall (tcm :: * -&gt; *) q a.
(MonadTCEnv tcm, LensQuantity q) =&gt;
q -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyQuantityToContext"><span class="hs-identifier hs-var">applyQuantityToContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality -&gt; Quantity
forall a. LensQuantity a =&gt; a -&gt; Quantity
</span><a href="Agda.Syntax.Common.html#getQuantity"><span class="hs-identifier hs-var">getQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681010656"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">tcm a
</span><a href="#local-6989586621681010658"><span class="hs-identifier hs-var">cont</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- enable local irr. defs only when option</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-252"></span><span>    </span><span id="local-6989586621681010656"><span class="annot"><span class="annottext">m :: Modality
</span><a href="#local-6989586621681010656"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; Modality
forall a. LensModality a =&gt; a -&gt; Modality
</span><a href="Agda.Syntax.Common.html#getModality"><span class="hs-identifier hs-var">getModality</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621681010659"><span class="hs-identifier hs-var">thing</span></a></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">-- | Wake up irrelevant variables and make them relevant. This is used</span><span>
</span><span id="line-255"></span><span class="hs-comment">--   when type checking terms in a hole, in which case you want to be able to</span><span>
</span><span id="line-256"></span><span class="hs-comment">--   (for instance) infer the type of an irrelevant variable. In the course</span><span>
</span><span id="line-257"></span><span class="hs-comment">--   of type checking an irrelevant function argument 'applyRelevanceToContext'</span><span>
</span><span id="line-258"></span><span class="hs-comment">--   is used instead, which also sets the context relevance to 'Irrelevant'.</span><span>
</span><span id="line-259"></span><span class="hs-comment">--   This is not the right thing to do when type checking interactively in a</span><span>
</span><span id="line-260"></span><span class="hs-comment">--   hole since it also marks all metas created during type checking as</span><span>
</span><span id="line-261"></span><span class="hs-comment">--   irrelevant (issue #2568).</span><span>
</span><span id="line-262"></span><span class="hs-comment">--</span><span>
</span><span id="line-263"></span><span class="hs-comment">--   Also set the current quantity to 0.</span><span>
</span><span id="line-264"></span><span id="local-6989586621681010654"><span id="local-6989586621681010655"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#wakeIrrelevantVars"><span class="hs-identifier hs-type">wakeIrrelevantVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCEnv"><span class="hs-identifier hs-type">MonadTCEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010655"><span class="hs-identifier hs-type">tcm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681010655"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010654"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681010655"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010654"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-265"></span><span id="wakeIrrelevantVars"><span class="annot"><span class="annottext">wakeIrrelevantVars :: forall (m :: * -&gt; *) a. MonadTCEnv m =&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Irrelevance.html#wakeIrrelevantVars"><span class="hs-identifier hs-var hs-var">wakeIrrelevantVars</span></a></span></span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; tcm a -&gt; tcm a
forall (tcm :: * -&gt; *) a.
MonadTCEnv tcm =&gt;
Relevance -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyRelevanceToContextOnly"><span class="hs-identifier hs-var">applyRelevanceToContextOnly</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="Agda.Syntax.Common.html#Irrelevant"><span class="hs-identifier hs-var">Irrelevant</span></a></span><span>
</span><span id="line-267"></span><span>  </span><span class="annot"><span class="annottext">(tcm a -&gt; tcm a) -&gt; (tcm a -&gt; tcm a) -&gt; tcm a -&gt; tcm a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Quantity -&gt; tcm a -&gt; tcm a
forall (tcm :: * -&gt; *) a.
MonadTCEnv tcm =&gt;
Quantity -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Irrelevance.html#applyQuantityToJudgementOnly"><span class="hs-identifier hs-var">applyQuantityToJudgementOnly</span></a></span><span> </span><span class="annot"><span class="annottext">Quantity
</span><a href="Agda.Syntax.Common.html#zeroQuantity"><span class="hs-identifier hs-var">zeroQuantity</span></a></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-comment">-- | Check whether something can be used in a position of the given relevance.</span><span>
</span><span id="line-270"></span><span class="hs-comment">--</span><span>
</span><span id="line-271"></span><span class="hs-comment">--   This is a substitute for double-checking that only makes sure</span><span>
</span><span id="line-272"></span><span class="hs-comment">--   relevances are correct.  See issue #2640.</span><span>
</span><span id="line-273"></span><span class="hs-comment">--</span><span>
</span><span id="line-274"></span><span class="hs-comment">--   Used in unifier (@ unifyStep Solution{}@).</span><span>
</span><span id="line-275"></span><span class="hs-comment">--</span><span>
</span><span id="line-276"></span><span class="hs-comment">--   At the moment, this implements McBride-style irrelevance,</span><span>
</span><span id="line-277"></span><span class="hs-comment">--   where Pfenning-style would be the most accurate thing.</span><span>
</span><span id="line-278"></span><span class="hs-comment">--   However, these two notions only differ how they handle</span><span>
</span><span id="line-279"></span><span class="hs-comment">--   bound variables in a term.  Here, we are only concerned</span><span>
</span><span id="line-280"></span><span class="hs-comment">--   in the free variables, used meta-variables, and used</span><span>
</span><span id="line-281"></span><span class="hs-comment">--   (irrelevant) definitions.</span><span>
</span><span id="line-282"></span><span class="hs-comment">--</span><span>
</span><span id="line-283"></span><span class="hs-keyword">class</span><span> </span><span id="UsableRelevance"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-var">UsableRelevance</span></a></span></span><span> </span><span id="local-6989586621681011127"><span class="annot"><a href="#local-6989586621681011127"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-284"></span><span>  </span><span id="usableRel"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-type">usableRel</span></a></span></span><span>
</span><span id="line-285"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621681011132"><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011132"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#HasConstInfo"><span class="hs-identifier hs-type">HasConstInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011132"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCEnv"><span class="hs-identifier hs-type">MonadTCEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011132"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#MonadAddContext"><span class="hs-identifier hs-type">MonadAddContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011132"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#MonadDebug"><span class="hs-identifier hs-type">MonadDebug</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011132"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Relevance"><span class="hs-identifier hs-type">Relevance</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011127"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011132"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-289"></span><span>  </span><span id="local-6989586621681010498"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadTCEnv m, MonadAddContext m,
 MonadDebug m) =&gt;
Relevance -&gt; Term -&gt; m Bool
</span><a href="#local-6989586621681010498"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621681010497"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010497"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-290"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621681010495"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681010495"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681010494"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681010494"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-291"></span><span>      </span><span id="local-6989586621681010493"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010493"><span class="hs-identifier hs-var">irel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">(Dom Type -&gt; Relevance) -&gt; m (Dom Type) -&gt; m Relevance
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; m (Dom Type)
forall (m :: * -&gt; *).
(Applicative m, MonadFail m, MonadTCEnv m) =&gt;
VerboseLevel -&gt; m (Dom Type)
</span><a href="Agda.TypeChecking.Monad.Context.html#domOfBV"><span class="hs-identifier hs-var">domOfBV</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681010495"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-292"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681010491"><span class="annot"><span class="annottext">ok :: Bool
</span><a href="#local-6989586621681010491"><span class="hs-identifier hs-var hs-var">ok</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010493"><span class="hs-identifier hs-var">irel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Relevance -&gt; Bool
</span><a href="Agda.Syntax.Common.html#moreRelevant"><span class="hs-operator hs-var">`moreRelevant`</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010497"><span class="hs-identifier hs-var">rel</span></a></span><span>
</span><span id="line-293"></span><span>      </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
VerboseKey -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;tc.irr&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; m ()) -&gt; TCMT IO Doc -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-294"></span><span>        </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;Variable&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel -&gt; Term
</span><a href="Agda.Syntax.Internal.html#var"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681010495"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-295"></span><span>        </span><span class="annot"><span class="annottext">VerboseKey -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; VerboseKey -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;has relevance &quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; VerboseKey
forall a. Show a =&gt; a -&gt; VerboseKey
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010493"><span class="hs-identifier hs-var">irel</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;, which is &quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-296"></span><span>              </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681010491"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;NOT &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;more relevant than &quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; VerboseKey
forall a. Show a =&gt; a -&gt; VerboseKey
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010497"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681010491"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-var">`and2M`</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Elims -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010497"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681010494"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-298"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-type">Def</span></a></span><span> </span><span id="local-6989586621681010482"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681010482"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681010481"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681010481"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-299"></span><span>      </span><span id="local-6989586621681010480"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010480"><span class="hs-identifier hs-var">frel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; m Relevance
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Relevance
</span><a href="Agda.TypeChecking.Monad.Signature.html#relOfConst"><span class="hs-identifier hs-var">relOfConst</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681010482"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-300"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010480"><span class="hs-identifier hs-var">frel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Relevance -&gt; Bool
</span><a href="Agda.Syntax.Common.html#moreRelevant"><span class="hs-operator hs-var">`moreRelevant`</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010497"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-var">`and2M`</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Elims -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010497"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681010481"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Con"><span class="hs-identifier hs-type">Con</span></a></span><span> </span><span id="local-6989586621681010477"><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681010477"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConInfo
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681010476"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681010476"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Elims -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010497"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681010476"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-302"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621681010474"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621681010474"><span class="hs-identifier hs-var">l</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-303"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681010472"><span class="annot"><span class="annottext">Abs Term
</span><a href="#local-6989586621681010472"><span class="hs-identifier hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Abs Term -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010497"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Term
</span><a href="#local-6989586621681010472"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-304"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Pi"><span class="hs-identifier hs-type">Pi</span></a></span><span> </span><span id="local-6989586621681010470"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681010470"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621681010469"><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681010469"><span class="hs-identifier hs-var">b</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; (Dom Type, Abs Type) -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010497"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681010470"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681010469"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-type">Sort</span></a></span><span> </span><span id="local-6989586621681010467"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681010467"><span class="hs-identifier hs-var">s</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Sort -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010497"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681010467"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Level"><span class="hs-identifier hs-type">Level</span></a></span><span> </span><span id="local-6989586621681010465"><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621681010465"><span class="hs-identifier hs-var">l</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-307"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaV"><span class="hs-identifier hs-type">MetaV</span></a></span><span> </span><span id="local-6989586621681010463"><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681010463"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681010462"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681010462"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-308"></span><span>      </span><span id="local-6989586621681010461"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010461"><span class="hs-identifier hs-var">mrel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">(Modality -&gt; Relevance) -&gt; m Modality -&gt; m Relevance
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; m Modality
forall (m :: * -&gt; *). ReadTCState m =&gt; MetaId -&gt; m Modality
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#lookupMetaModality"><span class="hs-identifier hs-var">lookupMetaModality</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681010463"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-309"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010461"><span class="hs-identifier hs-var">mrel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Relevance -&gt; Bool
</span><a href="Agda.Syntax.Common.html#moreRelevant"><span class="hs-operator hs-var">`moreRelevant`</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010497"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-var">`and2M`</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Elims -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010497"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681010462"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-310"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#DontCare"><span class="hs-identifier hs-type">DontCare</span></a></span><span> </span><span id="local-6989586621681010458"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681010458"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Term -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010497"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681010458"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-comment">-- TODO: allow irrelevant things to be used in DontCare position?</span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Dummy"><span class="hs-identifier hs-type">Dummy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681011091"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011091"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Type%27"><span class="hs-identifier hs-type">Type'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011091"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-314"></span><span>  </span><span id="local-6989586621681010441"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadTCEnv m, MonadAddContext m,
 MonadDebug m) =&gt;
Relevance -&gt; Type' a -&gt; m Bool
</span><a href="#local-6989586621681010441"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621681010440"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010440"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#El"><span class="hs-identifier hs-type">El</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681010438"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681010438"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010440"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681010438"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-type">Sort</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-317"></span><span>  </span><span id="local-6989586621681010364"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadTCEnv m, MonadAddContext m,
 MonadDebug m) =&gt;
Relevance -&gt; Sort -&gt; m Bool
</span><a href="#local-6989586621681010364"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621681010363"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010363"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-318"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span id="local-6989586621681010361"><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621681010361"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Level -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010363"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621681010361"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span><span> </span><span id="local-6989586621681010359"><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621681010359"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Level -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010363"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621681010359"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Inf"><span class="hs-identifier hs-type">Inf</span></a></span><span> </span><span id="local-6989586621681010357"><span class="annot"><span class="annottext">IsFibrant
</span><a href="#local-6989586621681010357"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681010356"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681010356"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-321"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span> </span><span id="local-6989586621681010354"><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621681010354"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Level -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010363"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621681010354"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><span class="annottext">Sort
</span><a href="Agda.Syntax.Internal.html#SizeUniv"><span class="hs-identifier hs-var">SizeUniv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-323"></span><span>    </span><span class="annot"><span class="annottext">Sort
</span><a href="Agda.Syntax.Internal.html#LockUniv"><span class="hs-identifier hs-var">LockUniv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-324"></span><span>    </span><span class="annot"><span class="annottext">Sort
</span><a href="Agda.Syntax.Internal.html#IntervalUniv"><span class="hs-identifier hs-var">IntervalUniv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-325"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#PiSort"><span class="hs-identifier hs-type">PiSort</span></a></span><span> </span><span id="local-6989586621681010349"><span class="annot"><span class="annottext">Dom' Term Term
</span><a href="#local-6989586621681010349"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621681010348"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681010348"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621681010347"><span class="annot"><span class="annottext">Abs Sort
</span><a href="#local-6989586621681010347"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; (Dom' Term Term, Sort, Abs Sort) -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010363"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dom' Term Term
</span><a href="#local-6989586621681010349"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681010348"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Abs Sort
</span><a href="#local-6989586621681010347"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#FunSort"><span class="hs-identifier hs-type">FunSort</span></a></span><span> </span><span id="local-6989586621681010345"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681010345"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621681010344"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681010344"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; (Sort, Sort) -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010363"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681010345"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681010344"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#UnivSort"><span class="hs-identifier hs-type">UnivSort</span></a></span><span> </span><span id="local-6989586621681010342"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681010342"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Sort -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010363"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681010342"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-328"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaS"><span class="hs-identifier hs-type">MetaS</span></a></span><span> </span><span id="local-6989586621681010340"><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681010340"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681010339"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681010339"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Elims -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010363"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681010339"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-329"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#DefS"><span class="hs-identifier hs-type">DefS</span></a></span><span> </span><span id="local-6989586621681010337"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681010337"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621681010336"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681010336"><span class="hs-identifier hs-var">es</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Term -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010363"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; m Bool) -&gt; Term -&gt; m Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-var">Def</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681010337"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681010336"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-330"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#DummyS"><span class="hs-identifier hs-type">DummyS</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Level"><span class="hs-identifier hs-type">Level</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-333"></span><span>  </span><span id="local-6989586621681010318"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadTCEnv m, MonadAddContext m,
 MonadDebug m) =&gt;
Relevance -&gt; Level -&gt; m Bool
</span><a href="#local-6989586621681010318"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621681010317"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010317"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Max"><span class="hs-identifier hs-type">Max</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681010315"><span class="annot"><span class="annottext">[PlusLevel' Term]
</span><a href="#local-6989586621681010315"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; [PlusLevel' Term] -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010317"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">[PlusLevel' Term]
</span><a href="#local-6989586621681010315"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#PlusLevel"><span class="hs-identifier hs-type">PlusLevel</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-336"></span><span>  </span><span id="local-6989586621681010299"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadTCEnv m, MonadAddContext m,
 MonadDebug m) =&gt;
Relevance -&gt; PlusLevel' Term -&gt; m Bool
</span><a href="#local-6989586621681010299"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621681010298"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010298"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Plus"><span class="hs-identifier hs-type">Plus</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681010296"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681010296"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Term -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010298"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681010296"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681011092"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011092"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681011092"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-339"></span><span>  </span><span id="local-6989586621681010276"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadTCEnv m, MonadAddContext m,
 MonadDebug m) =&gt;
Relevance -&gt; [a] -&gt; m Bool
</span><a href="#local-6989586621681010276"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621681010275"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010275"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[m Bool] -&gt; m Bool
forall (f :: * -&gt; *) (m :: * -&gt; *).
(Foldable f, Monad m) =&gt;
f (m Bool) -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#andM"><span class="hs-identifier hs-var">andM</span></a></span><span> </span><span class="annot"><span class="annottext">([m Bool] -&gt; m Bool) -&gt; ([a] -&gt; [m Bool]) -&gt; [a] -&gt; m Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; m Bool) -&gt; [a] -&gt; [m Bool]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Relevance -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010275"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681011093"><span id="local-6989586621681011094"><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011094"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011093"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681011094"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621681011093"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-342"></span><span>  </span><span id="local-6989586621681010249"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadTCEnv m, MonadAddContext m,
 MonadDebug m) =&gt;
Relevance -&gt; (a, b) -&gt; m Bool
</span><a href="#local-6989586621681010249"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621681010248"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010248"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681010247"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681010247"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681010246"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681010246"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010248"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681010247"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-var">`and2M`</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; b -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010248"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681010246"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681011064"><span id="local-6989586621681011065"><span id="local-6989586621681011066"><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011066"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011065"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011064"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681011066"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621681011065"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621681011064"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-345"></span><span>  </span><span id="local-6989586621681010213"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadTCEnv m, MonadAddContext m,
 MonadDebug m) =&gt;
Relevance -&gt; (a, b, c) -&gt; m Bool
</span><a href="#local-6989586621681010213"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621681010212"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010212"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681010211"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681010211"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681010210"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681010210"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681010209"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621681010209"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010212"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681010211"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-var">`and2M`</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; b -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010212"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681010210"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-var">`and2M`</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; c -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010212"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621681010209"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681011095"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011095"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#Elim%27"><span class="hs-identifier hs-type">Elim'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011095"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-348"></span><span>  </span><span id="local-6989586621681010178"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadTCEnv m, MonadAddContext m,
 MonadDebug m) =&gt;
Relevance -&gt; Elim' a -&gt; m Bool
</span><a href="#local-6989586621681010178"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621681010177"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010177"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#Apply"><span class="hs-identifier hs-type">Apply</span></a></span><span> </span><span id="local-6989586621681010175"><span class="annot"><span class="annottext">Arg a
</span><a href="#local-6989586621681010175"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Arg a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010177"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Arg a
</span><a href="#local-6989586621681010175"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-349"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span id="local-6989586621681010174"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010174"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#Proj"><span class="hs-identifier hs-type">Proj</span></a></span><span> </span><span class="annot"><span class="annottext">ProjOrigin
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681010172"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681010172"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-350"></span><span>    </span><span id="local-6989586621681010171"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010171"><span class="hs-identifier hs-var">prel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; m Relevance
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Relevance
</span><a href="Agda.TypeChecking.Monad.Signature.html#relOfConst"><span class="hs-identifier hs-var">relOfConst</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681010172"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-351"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; m Bool) -&gt; Bool -&gt; m Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010171"><span class="hs-identifier hs-var">prel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Relevance -&gt; Bool
</span><a href="Agda.Syntax.Common.html#moreRelevant"><span class="hs-operator hs-var">`moreRelevant`</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010174"><span class="hs-identifier hs-var">rel</span></a></span><span>
</span><span id="line-352"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span id="local-6989586621681010170"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010170"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#IApply"><span class="hs-identifier hs-type">IApply</span></a></span><span> </span><span id="local-6989586621681010168"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681010168"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681010167"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681010167"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621681010166"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681010166"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; (a -&gt; m Bool) -&gt; m Bool
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Functor f, Foldable f, Monad m) =&gt;
f a -&gt; (a -&gt; m Bool) -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#allM"><span class="hs-identifier hs-var">allM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681010168"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681010167"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681010166"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">((a -&gt; m Bool) -&gt; m Bool) -&gt; (a -&gt; m Bool) -&gt; m Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010170"><span class="hs-identifier hs-var">rel</span></a></span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681011045"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011045"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011045"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-355"></span><span>  </span><span id="local-6989586621681010147"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadTCEnv m, MonadAddContext m,
 MonadDebug m) =&gt;
Relevance -&gt; Arg a -&gt; m Bool
</span><a href="#local-6989586621681010147"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621681010146"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010146"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span id="local-6989586621681010144"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681010144"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621681010143"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681010143"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681010142"><span class="annot"><span class="annottext">rel' :: Relevance
</span><a href="#local-6989586621681010142"><span class="hs-identifier hs-var hs-var">rel'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681010144"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-357"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Relevance -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010146"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Relevance -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#composeRelevance"><span class="hs-operator hs-var">`composeRelevance`</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010142"><span class="hs-identifier hs-var">rel'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681010143"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681011096"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011096"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011096"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-360"></span><span>  </span><span id="local-6989586621681010126"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadTCEnv m, MonadAddContext m,
 MonadDebug m) =&gt;
Relevance -&gt; Dom a -&gt; m Bool
</span><a href="#local-6989586621681010126"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621681010125"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010125"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">unDom :: forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681010122"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681010122"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010125"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681010122"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681011097"><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011097"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011097"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Abs"><span class="hs-identifier hs-type">Abs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011097"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-363"></span><span>  </span><span id="local-6989586621681010103"><span class="annot"><span class="annottext">usableRel :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadTCEnv m, MonadAddContext m,
 MonadDebug m) =&gt;
Relevance -&gt; Abs a -&gt; m Bool
</span><a href="#local-6989586621681010103"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableRel</span></a></span></span><span> </span><span id="local-6989586621681010102"><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010102"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span id="local-6989586621681010101"><span class="annot"><span class="annottext">Abs a
</span><a href="#local-6989586621681010101"><span class="hs-identifier hs-var">abs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Abs a -&gt; (a -&gt; m Bool) -&gt; m Bool
forall a (m :: * -&gt; *) b.
(Subst a, MonadAddContext m) =&gt;
Abs a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="Agda.TypeChecking.Monad.Context.html#underAbstraction_"><span class="hs-identifier hs-var">underAbstraction_</span></a></span><span> </span><span class="annot"><span class="annottext">Abs a
</span><a href="#local-6989586621681010101"><span class="hs-identifier hs-var">abs</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; m Bool) -&gt; m Bool) -&gt; (a -&gt; m Bool) -&gt; m Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681010099"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681010099"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681010102"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681010099"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="hs-comment">-- | Check whether something can be used in a position of the given modality.</span><span>
</span><span id="line-366"></span><span class="hs-comment">--</span><span>
</span><span id="line-367"></span><span class="hs-comment">--   This is a substitute for double-checking that only makes sure</span><span>
</span><span id="line-368"></span><span class="hs-comment">--   modalities are correct.  See issue #2640.</span><span>
</span><span id="line-369"></span><span class="hs-comment">--</span><span>
</span><span id="line-370"></span><span class="hs-comment">--   Used in unifier (@ unifyStep Solution{}@).</span><span>
</span><span id="line-371"></span><span class="hs-comment">--</span><span>
</span><span id="line-372"></span><span class="hs-comment">--   This uses McBride-style modality checking.</span><span>
</span><span id="line-373"></span><span class="hs-comment">--   It does not differ from Pfenning-style if we</span><span>
</span><span id="line-374"></span><span class="hs-comment">--   are only interested in the modality of the</span><span>
</span><span id="line-375"></span><span class="hs-comment">--   free variables, used meta-variables, and used</span><span>
</span><span id="line-376"></span><span class="hs-comment">--   definitions.</span><span>
</span><span id="line-377"></span><span class="hs-comment">--</span><span>
</span><span id="line-378"></span><span class="hs-keyword">class</span><span> </span><span id="UsableModality"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-var">UsableModality</span></a></span></span><span> </span><span id="local-6989586621681011024"><span class="annot"><a href="#local-6989586621681011024"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-379"></span><span>  </span><span id="usableMod"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-type">usableMod</span></a></span></span><span>
</span><span id="line-380"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621681011029"><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011029"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#HasConstInfo"><span class="hs-identifier hs-type">HasConstInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011029"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCEnv"><span class="hs-identifier hs-type">MonadTCEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011029"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#MonadAddContext"><span class="hs-identifier hs-type">MonadAddContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011029"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#MonadDebug"><span class="hs-identifier hs-type">MonadDebug</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011029"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadReduce"><span class="hs-identifier hs-type">MonadReduce</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011029"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.Blockers.html#Blocker"><span class="hs-identifier hs-type">Blocker</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011029"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Modality"><span class="hs-identifier hs-type">Modality</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011024"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011029"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-384"></span><span>  </span><span id="local-6989586621681009881"><span class="annot"><span class="annottext">usableMod :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadTCEnv m, MonadAddContext m,
 MonadDebug m, MonadReduce m, MonadError Blocker m) =&gt;
Modality -&gt; Term -&gt; m Bool
</span><a href="#local-6989586621681009881"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableMod</span></a></span></span><span> </span><span id="local-6989586621681009880"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009880"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span id="local-6989586621681009879"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681009879"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-385"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681009879"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-386"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621681009878"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681009878"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681009877"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681009877"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-387"></span><span>      </span><span id="local-6989586621681009876"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009876"><span class="hs-identifier hs-var">imod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Modality
forall a. LensModality a =&gt; a -&gt; Modality
</span><a href="Agda.Syntax.Common.html#getModality"><span class="hs-identifier hs-var">getModality</span></a></span><span> </span><span class="annot"><span class="annottext">(Dom Type -&gt; Modality) -&gt; m (Dom Type) -&gt; m Modality
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; m (Dom Type)
forall (m :: * -&gt; *).
(Applicative m, MonadFail m, MonadTCEnv m) =&gt;
VerboseLevel -&gt; m (Dom Type)
</span><a href="Agda.TypeChecking.Monad.Context.html#domOfBV"><span class="hs-identifier hs-var">domOfBV</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681009878"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-388"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681009875"><span class="annot"><span class="annottext">ok :: Bool
</span><a href="#local-6989586621681009875"><span class="hs-identifier hs-var hs-var">ok</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009876"><span class="hs-identifier hs-var">imod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Modality -&gt; Bool
</span><a href="Agda.Syntax.Common.html#moreUsableModality"><span class="hs-operator hs-var">`moreUsableModality`</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009880"><span class="hs-identifier hs-var">mod</span></a></span><span>
</span><span id="line-389"></span><span>      </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
VerboseKey -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;tc.irr&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; m ()) -&gt; TCMT IO Doc -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-390"></span><span>        </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;Variable&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel -&gt; Term
</span><a href="Agda.Syntax.Internal.html#var"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621681009878"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-391"></span><span>        </span><span class="annot"><span class="annottext">VerboseKey -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; VerboseKey -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;has modality &quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; VerboseKey
forall a. Show a =&gt; a -&gt; VerboseKey
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009876"><span class="hs-identifier hs-var">imod</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;, which is a &quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-392"></span><span>              </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681009875"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;NOT &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;more usable modality than &quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; VerboseKey
forall a. Show a =&gt; a -&gt; VerboseKey
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009880"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681009875"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-var">`and2M`</span></a></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Elims -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009880"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681009877"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-394"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-type">Def</span></a></span><span> </span><span id="local-6989586621681009873"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681009873"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681009872"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681009872"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-395"></span><span>      </span><span id="local-6989586621681009871"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009871"><span class="hs-identifier hs-var">fmod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; m Modality
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Modality
</span><a href="Agda.TypeChecking.Monad.Signature.html#modalityOfConst"><span class="hs-identifier hs-var">modalityOfConst</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681009873"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-396"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681009869"><span class="annot"><span class="annottext">ok :: Bool
</span><a href="#local-6989586621681009869"><span class="hs-identifier hs-var hs-var">ok</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009871"><span class="hs-identifier hs-var">fmod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Modality -&gt; Bool
</span><a href="Agda.Syntax.Common.html#moreUsableModality"><span class="hs-operator hs-var">`moreUsableModality`</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009880"><span class="hs-identifier hs-var">mod</span></a></span><span>
</span><span id="line-397"></span><span>      </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
VerboseKey -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;tc.irr&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; m ()) -&gt; TCMT IO Doc -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-398"></span><span>        </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;Definition&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-var">Def</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681009873"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-399"></span><span>        </span><span class="annot"><span class="annottext">VerboseKey -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; VerboseKey -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;has modality &quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; VerboseKey
forall a. Show a =&gt; a -&gt; VerboseKey
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009871"><span class="hs-identifier hs-var">fmod</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;, which is a &quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-400"></span><span>              </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681009869"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;NOT &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;more usable modality than &quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; VerboseKey
forall a. Show a =&gt; a -&gt; VerboseKey
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009880"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681009869"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-var">`and2M`</span></a></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Elims -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009880"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681009872"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-402"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Con"><span class="hs-identifier hs-type">Con</span></a></span><span> </span><span id="local-6989586621681009868"><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681009868"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621681009867"><span class="annot"><span class="annottext">ConInfo
</span><a href="#local-6989586621681009867"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621681009866"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681009866"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-403"></span><span>      </span><span id="local-6989586621681009865"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009865"><span class="hs-identifier hs-var">cmod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; m Modality
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Modality
</span><a href="Agda.TypeChecking.Monad.Signature.html#modalityOfConst"><span class="hs-identifier hs-var">modalityOfConst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConHead -&gt; QName
</span><a href="Agda.Syntax.Internal.html#conName"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681009868"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681009863"><span class="annot"><span class="annottext">ok :: Bool
</span><a href="#local-6989586621681009863"><span class="hs-identifier hs-var hs-var">ok</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009865"><span class="hs-identifier hs-var">cmod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Modality -&gt; Bool
</span><a href="Agda.Syntax.Common.html#moreUsableModality"><span class="hs-operator hs-var">`moreUsableModality`</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009880"><span class="hs-identifier hs-var">mod</span></a></span><span>
</span><span id="line-405"></span><span>      </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
VerboseKey -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;tc.irr&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; m ()) -&gt; TCMT IO Doc -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-406"></span><span>        </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;The constructor&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConHead -&gt; ConInfo -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Con"><span class="hs-identifier hs-var">Con</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681009868"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ConInfo
</span><a href="#local-6989586621681009867"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-407"></span><span>        </span><span class="annot"><span class="annottext">VerboseKey -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; VerboseKey -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;has the modality &quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; VerboseKey
forall a. Show a =&gt; a -&gt; VerboseKey
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009865"><span class="hs-identifier hs-var">cmod</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;, which is &quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-408"></span><span>              </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681009863"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;NOT &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-409"></span><span>              </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;more usable than the modality &quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; VerboseKey
forall a. Show a =&gt; a -&gt; VerboseKey
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009880"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681009863"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-var">`and2M`</span></a></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Elims -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009880"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681009866"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-411"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621681009862"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621681009862"><span class="hs-identifier hs-var">l</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-412"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Lam"><span class="hs-identifier hs-type">Lam</span></a></span><span> </span><span id="local-6989586621681009861"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681009861"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621681009860"><span class="annot"><span class="annottext">Abs Term
</span><a href="#local-6989586621681009860"><span class="hs-identifier hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; Modality -&gt; Abs Term -&gt; m Bool
forall a (m :: * -&gt; *).
(Subst a, MonadAddContext m, UsableModality a, ReadTCState m,
 HasConstInfo m, MonadReduce m, MonadError Blocker m) =&gt;
ArgInfo -&gt; Modality -&gt; Abs a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableModAbs"><span class="hs-identifier hs-var">usableModAbs</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681009861"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009880"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Term
</span><a href="#local-6989586621681009860"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-413"></span><span>    </span><span class="hs-comment">-- Even if Pi contains Type, here we check it as a constructor for terms in the universe.</span><span>
</span><span id="line-414"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Pi"><span class="hs-identifier hs-type">Pi</span></a></span><span> </span><span id="local-6989586621681009858"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681009858"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621681009857"><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681009857"><span class="hs-identifier hs-var">b</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Term -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009856"><span class="hs-identifier hs-var">domMod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Term
forall t a. Type'' t a -&gt; a
</span><a href="Agda.Syntax.Internal.html#unEl"><span class="hs-identifier hs-var">unEl</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Term) -&gt; Type -&gt; Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Type
forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681009858"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-var">`and2M`</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; Modality -&gt; Abs Term -&gt; m Bool
forall a (m :: * -&gt; *).
(Subst a, MonadAddContext m, UsableModality a, ReadTCState m,
 HasConstInfo m, MonadReduce m, MonadError Blocker m) =&gt;
ArgInfo -&gt; Modality -&gt; Abs a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableModAbs"><span class="hs-identifier hs-var">usableModAbs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dom Type -&gt; ArgInfo
forall a. LensArgInfo a =&gt; a -&gt; ArgInfo
</span><a href="Agda.Syntax.Common.html#getArgInfo"><span class="hs-identifier hs-var">getArgInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681009858"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009880"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Term
forall t a. Type'' t a -&gt; a
</span><a href="Agda.Syntax.Internal.html#unEl"><span class="hs-identifier hs-var">unEl</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Term) -&gt; Abs Type -&gt; Abs Term
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Abs Type
</span><a href="#local-6989586621681009857"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-416"></span><span>        </span><span id="local-6989586621681009856"><span class="annot"><span class="annottext">domMod :: Modality
</span><a href="#local-6989586621681009856"><span class="hs-identifier hs-var hs-var">domMod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Quantity -&gt; Quantity) -&gt; Modality -&gt; Modality
forall a. LensQuantity a =&gt; (Quantity -&gt; Quantity) -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#mapQuantity"><span class="hs-identifier hs-var">mapQuantity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Quantity -&gt; Quantity -&gt; Quantity
</span><a href="Agda.Syntax.Common.html#composeQuantity"><span class="hs-identifier hs-var">composeQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">(Quantity -&gt; Quantity -&gt; Quantity)
-&gt; Quantity -&gt; Quantity -&gt; Quantity
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Quantity
forall a. LensQuantity a =&gt; a -&gt; Quantity
</span><a href="Agda.Syntax.Common.html#getQuantity"><span class="hs-identifier hs-var">getQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681009858"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Modality -&gt; Modality) -&gt; Modality -&gt; Modality
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-417"></span><span>                 </span><span class="annot"><span class="annottext">(Cohesion -&gt; Cohesion) -&gt; Modality -&gt; Modality
forall a. LensCohesion a =&gt; (Cohesion -&gt; Cohesion) -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#mapCohesion"><span class="hs-identifier hs-var">mapCohesion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cohesion -&gt; Cohesion -&gt; Cohesion
</span><a href="Agda.Syntax.Common.html#composeCohesion"><span class="hs-identifier hs-var">composeCohesion</span></a></span><span> </span><span class="annot"><span class="annottext">(Cohesion -&gt; Cohesion -&gt; Cohesion)
-&gt; Cohesion -&gt; Cohesion -&gt; Cohesion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Cohesion
forall a. LensCohesion a =&gt; a -&gt; Cohesion
</span><a href="Agda.Syntax.Common.html#getCohesion"><span class="hs-identifier hs-var">getCohesion</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681009858"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009880"><span class="hs-identifier hs-var">mod</span></a></span><span>
</span><span id="line-418"></span><span>    </span><span class="hs-comment">-- Andrea 15/10/2020 not updating these cases yet, but they are quite suspicious,</span><span>
</span><span id="line-419"></span><span>    </span><span class="hs-comment">-- do we have special typing rules for Sort and Level?</span><span>
</span><span id="line-420"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-type">Sort</span></a></span><span> </span><span id="local-6989586621681009850"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681009850"><span class="hs-identifier hs-var">s</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Sort -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009880"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681009850"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-421"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Level"><span class="hs-identifier hs-type">Level</span></a></span><span> </span><span id="local-6989586621681009849"><span class="annot"><span class="annottext">Level
</span><a href="#local-6989586621681009849"><span class="hs-identifier hs-var">l</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-422"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaV"><span class="hs-identifier hs-type">MetaV</span></a></span><span> </span><span id="local-6989586621681009848"><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681009848"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681009847"><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681009847"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-423"></span><span>      </span><span id="local-6989586621681009846"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009846"><span class="hs-identifier hs-var">mmod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; m Modality
forall (m :: * -&gt; *). ReadTCState m =&gt; MetaId -&gt; m Modality
</span><a href="Agda.TypeChecking.Monad.MetaVars.html#lookupMetaModality"><span class="hs-identifier hs-var">lookupMetaModality</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681009848"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-424"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681009845"><span class="annot"><span class="annottext">ok :: Bool
</span><a href="#local-6989586621681009845"><span class="hs-identifier hs-var hs-var">ok</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009846"><span class="hs-identifier hs-var">mmod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Modality -&gt; Bool
</span><a href="Agda.Syntax.Common.html#moreUsableModality"><span class="hs-operator hs-var">`moreUsableModality`</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009880"><span class="hs-identifier hs-var">mod</span></a></span><span>
</span><span id="line-425"></span><span>      </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
VerboseKey -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;tc.irr&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; m ()) -&gt; TCMT IO Doc -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-426"></span><span>        </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;Metavariable&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MetaId -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#MetaV"><span class="hs-identifier hs-var">MetaV</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681009848"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-427"></span><span>        </span><span class="annot"><span class="annottext">VerboseKey -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; VerboseKey -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;has modality &quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; VerboseKey
forall a. Show a =&gt; a -&gt; VerboseKey
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009846"><span class="hs-identifier hs-var">mmod</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;, which is a &quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-428"></span><span>              </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681009845"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;NOT &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;more usable modality than &quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseKey -&gt; VerboseKey
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; VerboseKey
forall a. Show a =&gt; a -&gt; VerboseKey
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009880"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681009845"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-var">`and2M`</span></a></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Elims -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009880"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">Elims
</span><a href="#local-6989586621681009847"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#or2M"><span class="hs-operator hs-var">`or2M`</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-430"></span><span>        </span><span id="local-6989586621681009844"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681009844"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Term -&gt; m Term
forall a (m :: * -&gt; *). (Instantiate a, MonadReduce m) =&gt; a -&gt; m a
</span><a href="Agda.TypeChecking.Reduce.html#instantiate"><span class="hs-identifier hs-var">instantiate</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681009879"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-431"></span><span>        </span><span class="annot"><span class="annottext">Maybe MetaId -&gt; m Bool -&gt; (MetaId -&gt; m Bool) -&gt; m Bool
forall a b. Maybe a -&gt; b -&gt; (a -&gt; b) -&gt; b
</span><a href="Agda.Utils.Maybe.html#caseMaybe"><span class="hs-identifier hs-var">caseMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term -&gt; Maybe MetaId
forall a. IsMeta a =&gt; a -&gt; Maybe MetaId
</span><a href="Agda.TypeChecking.Reduce.html#isMeta"><span class="hs-identifier hs-var">isMeta</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681009844"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality -&gt; Term -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009880"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681009844"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((MetaId -&gt; m Bool) -&gt; m Bool) -&gt; (MetaId -&gt; m Bool) -&gt; m Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681009840"><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681009840"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Blocker -&gt; m Bool
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MetaId -&gt; Blocker
</span><a href="Agda.Syntax.Internal.Blockers.html#UnblockOnMeta"><span class="hs-identifier hs-var">UnblockOnMeta</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681009840"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#DontCare"><span class="hs-identifier hs-type">DontCare</span></a></span><span> </span><span id="local-6989586621681009837"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681009837"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Term -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009880"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681009837"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-433"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Dummy"><span class="hs-identifier hs-type">Dummy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span id="local-6989586621681011009"><span id="local-6989586621681011010"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableModAbs"><span class="hs-identifier hs-type">usableModAbs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Substitute.Class.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011010"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Context.html#MonadAddContext"><span class="hs-identifier hs-type">MonadAddContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011009"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011010"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-436"></span><span>                       </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011009"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#HasConstInfo"><span class="hs-identifier hs-type">HasConstInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011009"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadReduce"><span class="hs-identifier hs-type">MonadReduce</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011009"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.Blockers.html#Blocker"><span class="hs-identifier hs-type">Blocker</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011009"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-437"></span><span>                      </span><span class="annot"><a href="Agda.Syntax.Common.html#ArgInfo"><span class="hs-identifier hs-type">ArgInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Modality"><span class="hs-identifier hs-type">Modality</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Abs"><span class="hs-identifier hs-type">Abs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011010"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681011009"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-438"></span><span id="usableModAbs"><span class="annot"><span class="annottext">usableModAbs :: forall a (m :: * -&gt; *).
(Subst a, MonadAddContext m, UsableModality a, ReadTCState m,
 HasConstInfo m, MonadReduce m, MonadError Blocker m) =&gt;
ArgInfo -&gt; Modality -&gt; Abs a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableModAbs"><span class="hs-identifier hs-var hs-var">usableModAbs</span></a></span></span><span> </span><span id="local-6989586621681009812"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681009812"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621681009811"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009811"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span id="local-6989586621681009810"><span class="annot"><span class="annottext">Abs a
</span><a href="#local-6989586621681009810"><span class="hs-identifier hs-var">abs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Abs a -&gt; (a -&gt; m Bool) -&gt; m Bool
forall a (m :: * -&gt; *) b.
(Subst a, MonadAddContext m) =&gt;
Dom Type -&gt; Abs a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="Agda.TypeChecking.Monad.Context.html#underAbstraction"><span class="hs-identifier hs-var">underAbstraction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgInfo -&gt; Dom Type -&gt; Dom Type
forall a. LensArgInfo a =&gt; ArgInfo -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#setArgInfo"><span class="hs-identifier hs-var">setArgInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681009812"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">(Dom Type -&gt; Dom Type) -&gt; Dom Type -&gt; Dom Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type
HasCallStack =&gt; Dom Type
</span><a href="Agda.Syntax.Internal.html#__DUMMY_DOM__"><span class="hs-identifier hs-var">__DUMMY_DOM__</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Abs a
</span><a href="#local-6989586621681009810"><span class="hs-identifier hs-var">abs</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; m Bool) -&gt; m Bool) -&gt; (a -&gt; m Bool) -&gt; m Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681009806"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009806"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Modality -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009811"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009806"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681010989"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableRelevance"><span class="hs-identifier hs-type">UsableRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010989"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Type%27"><span class="hs-identifier hs-type">Type'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010989"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-441"></span><span>  </span><span id="local-6989586621681009785"><span class="annot"><span class="annottext">usableMod :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadTCEnv m, MonadAddContext m,
 MonadDebug m, MonadReduce m, MonadError Blocker m) =&gt;
Modality -&gt; Type' a -&gt; m Bool
</span><a href="#local-6989586621681009785"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableMod</span></a></span></span><span> </span><span id="local-6989586621681009784"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009784"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#El"><span class="hs-identifier hs-type">El</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681009783"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009783"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009784"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009783"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Sort"><span class="hs-identifier hs-type">Sort</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-444"></span><span>  </span><span id="local-6989586621681009764"><span class="annot"><span class="annottext">usableMod :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadTCEnv m, MonadAddContext m,
 MonadDebug m, MonadReduce m, MonadError Blocker m) =&gt;
Modality -&gt; Sort -&gt; m Bool
</span><a href="#local-6989586621681009764"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableMod</span></a></span></span><span> </span><span id="local-6989586621681009763"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009763"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span id="local-6989586621681009762"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681009762"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Sort -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009763"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681009762"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-comment">-- usableMod mod s = case s of</span><span>
</span><span id="line-446"></span><span>  </span><span class="hs-comment">--   Type l -&gt; usableMod mod l</span><span>
</span><span id="line-447"></span><span>  </span><span class="hs-comment">--   Prop l -&gt; usableMod mod l</span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-comment">--   Inf    -&gt; return True</span><span>
</span><span id="line-449"></span><span>  </span><span class="hs-comment">--   SizeUniv -&gt; return True</span><span>
</span><span id="line-450"></span><span>  </span><span class="hs-comment">--   PiSort a s -&gt; usableMod mod (a,s)</span><span>
</span><span id="line-451"></span><span>  </span><span class="hs-comment">--   UnivSort s -&gt; usableMod mod s</span><span>
</span><span id="line-452"></span><span>  </span><span class="hs-comment">--   MetaS x es -&gt; usableMod mod es</span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-comment">--   DummyS{} -&gt; return True</span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Level"><span class="hs-identifier hs-type">Level</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-456"></span><span>  </span><span id="local-6989586621681009741"><span class="annot"><span class="annottext">usableMod :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadTCEnv m, MonadAddContext m,
 MonadDebug m, MonadReduce m, MonadError Blocker m) =&gt;
Modality -&gt; Level -&gt; m Bool
</span><a href="#local-6989586621681009741"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableMod</span></a></span></span><span> </span><span id="local-6989586621681009740"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009740"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Max"><span class="hs-identifier hs-type">Max</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681009739"><span class="annot"><span class="annottext">[PlusLevel' Term]
</span><a href="#local-6989586621681009739"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; [PlusLevel' Term] -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableRelevance a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m) =&gt;
Relevance -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableRel"><span class="hs-identifier hs-var">usableRel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009740"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PlusLevel' Term]
</span><a href="#local-6989586621681009739"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="hs-comment">-- instance UsableModality PlusLevel where</span><span>
</span><span id="line-459"></span><span class="hs-comment">--   usableMod mod ClosedLevel{} = return True</span><span>
</span><span id="line-460"></span><span class="hs-comment">--   usableMod mod (Plus _ l)    = usableMod mod l</span><span>
</span><span id="line-461"></span><span>
</span><span id="line-462"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681011013"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011013"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681011013"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-463"></span><span>  </span><span id="local-6989586621681009715"><span class="annot"><span class="annottext">usableMod :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadTCEnv m, MonadAddContext m,
 MonadDebug m, MonadReduce m, MonadError Blocker m) =&gt;
Modality -&gt; [a] -&gt; m Bool
</span><a href="#local-6989586621681009715"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableMod</span></a></span></span><span> </span><span id="local-6989586621681009714"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009714"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[m Bool] -&gt; m Bool
forall (f :: * -&gt; *) (m :: * -&gt; *).
(Foldable f, Monad m) =&gt;
f (m Bool) -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#andM"><span class="hs-identifier hs-var">andM</span></a></span><span> </span><span class="annot"><span class="annottext">([m Bool] -&gt; m Bool) -&gt; ([a] -&gt; [m Bool]) -&gt; [a] -&gt; m Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; m Bool) -&gt; [a] -&gt; [m Bool]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009714"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681010980"><span id="local-6989586621681010981"><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010981"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010980"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681010981"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621681010980"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-466"></span><span>  </span><span id="local-6989586621681009681"><span class="annot"><span class="annottext">usableMod :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadTCEnv m, MonadAddContext m,
 MonadDebug m, MonadReduce m, MonadError Blocker m) =&gt;
Modality -&gt; (a, b) -&gt; m Bool
</span><a href="#local-6989586621681009681"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableMod</span></a></span></span><span> </span><span id="local-6989586621681009680"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009680"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681009679"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009679"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681009678"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681009678"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modality -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009680"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009679"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-var">`and2M`</span></a></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; b -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009680"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621681009678"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681011014"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011014"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#Elim%27"><span class="hs-identifier hs-type">Elim'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681011014"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-469"></span><span>  </span><span id="local-6989586621681009641"><span class="annot"><span class="annottext">usableMod :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadTCEnv m, MonadAddContext m,
 MonadDebug m, MonadReduce m, MonadError Blocker m) =&gt;
Modality -&gt; Elim' a -&gt; m Bool
</span><a href="#local-6989586621681009641"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableMod</span></a></span></span><span> </span><span id="local-6989586621681009640"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009640"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#Apply"><span class="hs-identifier hs-type">Apply</span></a></span><span> </span><span id="local-6989586621681009639"><span class="annot"><span class="annottext">Arg a
</span><a href="#local-6989586621681009639"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Arg a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009640"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">Arg a
</span><a href="#local-6989586621681009639"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-470"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span id="local-6989586621681009638"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009638"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#Proj"><span class="hs-identifier hs-type">Proj</span></a></span><span> </span><span class="annot"><span class="annottext">ProjOrigin
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681009637"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681009637"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-471"></span><span>    </span><span id="local-6989586621681009636"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009636"><span class="hs-identifier hs-var">pmod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; m Modality
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Modality
</span><a href="Agda.TypeChecking.Monad.Signature.html#modalityOfConst"><span class="hs-identifier hs-var">modalityOfConst</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681009637"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-472"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; m Bool) -&gt; Bool -&gt; m Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009636"><span class="hs-identifier hs-var">pmod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Modality -&gt; Bool
</span><a href="Agda.Syntax.Common.html#moreUsableModality"><span class="hs-operator hs-var">`moreUsableModality`</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009638"><span class="hs-identifier hs-var">mod</span></a></span><span>
</span><span id="line-473"></span><span>  </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span id="local-6989586621681009635"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009635"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.Elim.html#IApply"><span class="hs-identifier hs-type">IApply</span></a></span><span> </span><span id="local-6989586621681009634"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009634"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681009633"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009633"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621681009632"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009632"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; (a -&gt; m Bool) -&gt; m Bool
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Functor f, Foldable f, Monad m) =&gt;
f a -&gt; (a -&gt; m Bool) -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#allM"><span class="hs-identifier hs-var">allM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009634"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009633"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009632"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">((a -&gt; m Bool) -&gt; m Bool) -&gt; (a -&gt; m Bool) -&gt; m Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009635"><span class="hs-identifier hs-var">mod</span></a></span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681010976"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010976"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010976"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-476"></span><span>  </span><span id="local-6989586621681009609"><span class="annot"><span class="annottext">usableMod :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadTCEnv m, MonadAddContext m,
 MonadDebug m, MonadReduce m, MonadError Blocker m) =&gt;
Modality -&gt; Arg a -&gt; m Bool
</span><a href="#local-6989586621681009609"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableMod</span></a></span></span><span> </span><span id="local-6989586621681009608"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009608"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span id="local-6989586621681009607"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681009607"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621681009606"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009606"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-477"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681009605"><span class="annot"><span class="annottext">mod' :: Modality
</span><a href="#local-6989586621681009605"><span class="hs-identifier hs-var hs-var">mod'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; Modality
forall a. LensModality a =&gt; a -&gt; Modality
</span><a href="Agda.Syntax.Common.html#getModality"><span class="hs-identifier hs-var">getModality</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681009607"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-478"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Modality -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009608"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Modality -&gt; Modality
</span><a href="Agda.Syntax.Common.html#composeModality"><span class="hs-operator hs-var">`composeModality`</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009605"><span class="hs-identifier hs-var">mod'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009606"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681010972"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010972"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#UsableModality"><span class="hs-identifier hs-type">UsableModality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010972"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-481"></span><span>  </span><span id="local-6989586621681009583"><span class="annot"><span class="annottext">usableMod :: forall (m :: * -&gt; *).
(ReadTCState m, HasConstInfo m, MonadTCEnv m, MonadAddContext m,
 MonadDebug m, MonadReduce m, MonadError Blocker m) =&gt;
Modality -&gt; Dom a -&gt; m Bool
</span><a href="#local-6989586621681009583"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableMod</span></a></span></span><span> </span><span id="local-6989586621681009582"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009582"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">unDom :: forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681009581"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009581"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Modality -&gt; a -&gt; m Bool
forall a (m :: * -&gt; *).
(UsableModality a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009582"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009581"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#usableAtModality"><span class="hs-identifier hs-type">usableAtModality</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Constraints.html#MonadConstraint"><span class="hs-identifier hs-type">MonadConstraint</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Modality"><span class="hs-identifier hs-type">Modality</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span id="usableAtModality"><span class="annot"><span class="annottext">usableAtModality :: MonadConstraint (TCMT IO) =&gt; Modality -&gt; Term -&gt; TCM ()
</span><a href="Agda.TypeChecking.Irrelevance.html#usableAtModality"><span class="hs-identifier hs-var hs-var">usableAtModality</span></a></span></span><span> </span><span id="local-6989586621681009517"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009517"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span id="local-6989586621681009516"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681009516"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Constraint -&gt; TCM () -&gt; TCM ()
forall (m :: * -&gt; *).
MonadConstraint m =&gt;
Constraint -&gt; m () -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Constraints.html#catchConstraint"><span class="hs-identifier hs-var">catchConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality -&gt; Term -&gt; Constraint
</span><a href="Agda.TypeChecking.Monad.Base.html#UsableAtModality"><span class="hs-identifier hs-var">UsableAtModality</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009517"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681009516"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-485"></span><span>  </span><span id="local-6989586621681009513"><span class="annot"><span class="annottext">Either Blocker Bool
</span><a href="#local-6989586621681009513"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ExceptT Blocker (TCMT IO) Bool -&gt; TCMT IO (Either Blocker Bool)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT Blocker (TCMT IO) Bool -&gt; TCMT IO (Either Blocker Bool))
-&gt; ExceptT Blocker (TCMT IO) Bool -&gt; TCMT IO (Either Blocker Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Term -&gt; ExceptT Blocker (TCMT IO) Bool
forall a (m :: * -&gt; *).
(UsableModality a, ReadTCState m, HasConstInfo m, MonadTCEnv m,
 MonadAddContext m, MonadDebug m, MonadReduce m,
 MonadError Blocker m) =&gt;
Modality -&gt; a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#usableMod"><span class="hs-identifier hs-var">usableMod</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009517"><span class="hs-identifier hs-var">mod</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681009516"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-486"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either Blocker Bool
</span><a href="#local-6989586621681009513"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-487"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621681009511"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681009511"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-488"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; TCM () -&gt; TCM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681009511"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-489"></span><span>        </span><span class="annot"><span class="annottext">TypeError -&gt; TCM ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
TypeError -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-var">typeError</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeError -&gt; TCM ()) -&gt; (Doc -&gt; TypeError) -&gt; Doc -&gt; TCM ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#GenericDocError"><span class="hs-identifier hs-var">GenericDocError</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681009516"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;is not usable at the required modality&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Modality -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621681009517"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621681009506"><span class="annot"><span class="annottext">Blocker
</span><a href="#local-6989586621681009506"><span class="hs-identifier hs-var">blocker</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Blocker -&gt; TCM ()
forall (m :: * -&gt; *) a. MonadBlock m =&gt; Blocker -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#patternViolation"><span class="hs-identifier hs-var">patternViolation</span></a></span><span> </span><span class="annot"><span class="annottext">Blocker
</span><a href="#local-6989586621681009506"><span class="hs-identifier hs-var">blocker</span></a></span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span>
</span><span id="line-493"></span><span class="hs-comment">-- * Propositions</span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span class="hs-comment">-- | Is a type a proposition?  (Needs reduction.)</span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span id="local-6989586621681010932"><span id="local-6989586621681010934"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#isPropM"><span class="hs-identifier hs-type">isPropM</span></a></span><span>
</span><span id="line-498"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#LensSort"><span class="hs-identifier hs-type">LensSort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010934"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#PrettyTCM"><span class="hs-identifier hs-type">PrettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010934"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Pure.html#PureTCM"><span class="hs-identifier hs-type">PureTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010932"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadBlock"><span class="hs-identifier hs-type">MonadBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010932"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681010934"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681010932"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-500"></span><span id="isPropM"><span class="annot"><span class="annottext">isPropM :: forall a (m :: * -&gt; *).
(LensSort a, PrettyTCM a, PureTCM m, MonadBlock m) =&gt;
a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#isPropM"><span class="hs-identifier hs-var hs-var">isPropM</span></a></span></span><span> </span><span id="local-6989586621681009456"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009456"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-501"></span><span>  </span><span class="annot"><span class="annottext">VerboseKey -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *) a.
MonadDebug m =&gt;
VerboseKey -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Debug.html#traceSDoc"><span class="hs-identifier hs-var">traceSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseKey
</span><span class="hs-string">&quot;tc.prop&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">80</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;Is &quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009456"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;of sort&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Sort -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Sort
forall a. LensSort a =&gt; a -&gt; Sort
</span><a href="Agda.Syntax.Internal.html#getSort"><span class="hs-identifier hs-var">getSort</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009456"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;in Prop?&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m Bool -&gt; m Bool) -&gt; m Bool -&gt; m Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-502"></span><span>  </span><span class="annot"><span class="annottext">Sort -&gt; m Sort
forall (m :: * -&gt; *) t.
(MonadReduce m, MonadBlock m, IsMeta t, Reduce t) =&gt;
t -&gt; m t
</span><a href="Agda.TypeChecking.Reduce.html#abortIfBlocked"><span class="hs-identifier hs-var">abortIfBlocked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Sort
forall a. LensSort a =&gt; a -&gt; Sort
</span><a href="Agda.Syntax.Internal.html#getSort"><span class="hs-identifier hs-var">getSort</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009456"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m Sort -&gt; (Sort -&gt; Bool) -&gt; m Bool
forall (m :: * -&gt; *) a b. Functor m =&gt; m a -&gt; (a -&gt; b) -&gt; m b
</span><a href="Agda.Utils.Functor.html#%3C%26%3E"><span class="hs-operator hs-var">&lt;&amp;&gt;</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-503"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-504"></span><span>    </span><span class="annot"><span class="annottext">Sort
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-505"></span><span>
</span><span id="line-506"></span><span id="local-6989586621681010915"><span id="local-6989586621681010916"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#isIrrelevantOrPropM"><span class="hs-identifier hs-type">isIrrelevantOrPropM</span></a></span><span>
</span><span id="line-507"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#LensRelevance"><span class="hs-identifier hs-type">LensRelevance</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010916"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#LensSort"><span class="hs-identifier hs-type">LensSort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010916"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#PrettyTCM"><span class="hs-identifier hs-type">PrettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010916"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Pure.html#PureTCM"><span class="hs-identifier hs-type">PureTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010915"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadBlock"><span class="hs-identifier hs-type">MonadBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010915"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681010916"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681010915"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-509"></span><span id="isIrrelevantOrPropM"><span class="annot"><span class="annottext">isIrrelevantOrPropM :: forall a (m :: * -&gt; *).
(LensRelevance a, LensSort a, PrettyTCM a, PureTCM m,
 MonadBlock m) =&gt;
a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#isIrrelevantOrPropM"><span class="hs-identifier hs-var hs-var">isIrrelevantOrPropM</span></a></span></span><span> </span><span id="local-6989586621681009433"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009433"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Bool
forall a. LensRelevance a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#isIrrelevant"><span class="hs-identifier hs-var">isIrrelevant</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009433"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m Bool -&gt; m Bool -&gt; m Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#or2M"><span class="hs-operator hs-var">`or2M`</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; m Bool
forall a (m :: * -&gt; *).
(LensSort a, PrettyTCM a, PureTCM m, MonadBlock m) =&gt;
a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#isPropM"><span class="hs-identifier hs-var">isPropM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009433"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-510"></span><span>
</span><span id="line-511"></span><span class="hs-comment">-- * Fibrant types</span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span class="hs-comment">-- | Is a type fibrant (i.e. Type, Prop)?</span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span id="local-6989586621681010909"><span id="local-6989586621681010910"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#isFibrant"><span class="hs-identifier hs-type">isFibrant</span></a></span><span>
</span><span id="line-516"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#LensSort"><span class="hs-identifier hs-type">LensSort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010910"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Pure.html#PureTCM"><span class="hs-identifier hs-type">PureTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010909"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadBlock"><span class="hs-identifier hs-type">MonadBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681010909"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681010910"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681010909"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-518"></span><span id="isFibrant"><span class="annot"><span class="annottext">isFibrant :: forall a (m :: * -&gt; *).
(LensSort a, PureTCM m, MonadBlock m) =&gt;
a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#isFibrant"><span class="hs-identifier hs-var hs-var">isFibrant</span></a></span></span><span> </span><span id="local-6989586621681009415"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009415"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sort -&gt; m Sort
forall (m :: * -&gt; *) t.
(MonadReduce m, MonadBlock m, IsMeta t, Reduce t) =&gt;
t -&gt; m t
</span><a href="Agda.TypeChecking.Reduce.html#abortIfBlocked"><span class="hs-identifier hs-var">abortIfBlocked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Sort
forall a. LensSort a =&gt; a -&gt; Sort
</span><a href="Agda.Syntax.Internal.html#getSort"><span class="hs-identifier hs-var">getSort</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009415"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m Sort -&gt; (Sort -&gt; Bool) -&gt; m Bool
forall (m :: * -&gt; *) a b. Functor m =&gt; m a -&gt; (a -&gt; b) -&gt; m b
</span><a href="Agda.Utils.Functor.html#%3C%26%3E"><span class="hs-operator hs-var">&lt;&amp;&gt;</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-519"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-520"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-521"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#Inf"><span class="hs-identifier hs-type">Inf</span></a></span><span> </span><span id="local-6989586621681009414"><span class="annot"><span class="annottext">IsFibrant
</span><a href="#local-6989586621681009414"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IsFibrant
</span><a href="#local-6989586621681009414"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">IsFibrant -&gt; IsFibrant -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">IsFibrant
</span><a href="Agda.Syntax.Internal.html#IsFibrant"><span class="hs-identifier hs-var">IsFibrant</span></a></span><span>
</span><span id="line-522"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-523"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#SizeUniv"><span class="hs-identifier hs-type">SizeUniv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-524"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#LockUniv"><span class="hs-identifier hs-type">LockUniv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-525"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#IntervalUniv"><span class="hs-identifier hs-type">IntervalUniv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-526"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#PiSort"><span class="hs-identifier hs-type">PiSort</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-527"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#FunSort"><span class="hs-identifier hs-type">FunSort</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-528"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#UnivSort"><span class="hs-identifier hs-type">UnivSort</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-529"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaS"><span class="hs-identifier hs-type">MetaS</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-530"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#DefS"><span class="hs-identifier hs-type">DefS</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-531"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#DummyS"><span class="hs-identifier hs-type">DummyS</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-532"></span><span>
</span><span id="line-533"></span><span>
</span><span id="line-534"></span><span class="hs-comment">-- | Cofibrant types are those that could be the domain of a fibrant</span><span>
</span><span id="line-535"></span><span class="hs-comment">--   pi type. (Notion by C. Sattler).</span><span>
</span><span id="line-536"></span><span id="local-6989586621681009411"><span id="local-6989586621681009412"><span class="annot"><a href="Agda.TypeChecking.Irrelevance.html#isCoFibrantSort"><span class="hs-identifier hs-type">isCoFibrantSort</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#LensSort"><span class="hs-identifier hs-type">LensSort</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681009412"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Pure.html#PureTCM"><span class="hs-identifier hs-type">PureTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681009411"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadBlock"><span class="hs-identifier hs-type">MonadBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681009411"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681009412"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681009411"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-537"></span><span id="isCoFibrantSort"><span class="annot"><span class="annottext">isCoFibrantSort :: forall a (m :: * -&gt; *).
(LensSort a, PureTCM m, MonadBlock m) =&gt;
a -&gt; m Bool
</span><a href="Agda.TypeChecking.Irrelevance.html#isCoFibrantSort"><span class="hs-identifier hs-var hs-var">isCoFibrantSort</span></a></span></span><span> </span><span id="local-6989586621681009395"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009395"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sort -&gt; m Sort
forall (m :: * -&gt; *) t.
(MonadReduce m, MonadBlock m, IsMeta t, Reduce t) =&gt;
t -&gt; m t
</span><a href="Agda.TypeChecking.Reduce.html#abortIfBlocked"><span class="hs-identifier hs-var">abortIfBlocked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Sort
forall a. LensSort a =&gt; a -&gt; Sort
</span><a href="Agda.Syntax.Internal.html#getSort"><span class="hs-identifier hs-var">getSort</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681009395"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m Sort -&gt; (Sort -&gt; Bool) -&gt; m Bool
forall (m :: * -&gt; *) a b. Functor m =&gt; m a -&gt; (a -&gt; b) -&gt; m b
</span><a href="Agda.Utils.Functor.html#%3C%26%3E"><span class="hs-operator hs-var">&lt;&amp;&gt;</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-538"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-539"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-540"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#Inf"><span class="hs-identifier hs-type">Inf</span></a></span><span> </span><span id="local-6989586621681009394"><span class="annot"><span class="annottext">IsFibrant
</span><a href="#local-6989586621681009394"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IsFibrant
</span><a href="#local-6989586621681009394"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">IsFibrant -&gt; IsFibrant -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">IsFibrant
</span><a href="Agda.Syntax.Internal.html#IsFibrant"><span class="hs-identifier hs-var">IsFibrant</span></a></span><span>
</span><span id="line-541"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#SSet"><span class="hs-identifier hs-type">SSet</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-542"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#SizeUniv"><span class="hs-identifier hs-type">SizeUniv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-543"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#LockUniv"><span class="hs-identifier hs-type">LockUniv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-544"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#IntervalUniv"><span class="hs-identifier hs-type">IntervalUniv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-545"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#PiSort"><span class="hs-identifier hs-type">PiSort</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-546"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#FunSort"><span class="hs-identifier hs-type">FunSort</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-547"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#UnivSort"><span class="hs-identifier hs-type">UnivSort</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-548"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaS"><span class="hs-identifier hs-type">MetaS</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-549"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#DefS"><span class="hs-identifier hs-type">DefS</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-550"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Internal.html#DummyS"><span class="hs-identifier hs-type">DummyS</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-551"></span></pre></body></html>