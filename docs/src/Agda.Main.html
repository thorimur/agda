<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-comment">{-| Agda main module.
-}</span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Agda.Main</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">null</span></span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">void</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MonadError</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ExceptT</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runExceptT</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MonadIO</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Environment</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Console.GetOpt</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IO</span></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Paths_Agda.html"><span class="hs-identifier">Paths_Agda</span></a></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Paths_Agda.html#getDataDir"><span class="hs-identifier">getDataDir</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.CommandLine.html"><span class="hs-identifier">Agda.Interaction.CommandLine</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.ExitCode.html"><span class="hs-identifier">Agda.Interaction.ExitCode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.ExitCode.html#AgdaError"><span class="hs-identifier">AgdaError</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">exitSuccess</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Interaction.ExitCode.html#exitAgdaWith"><span class="hs-identifier">exitAgdaWith</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.html"><span class="hs-identifier">Agda.Interaction.Options</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Help.html"><span class="hs-identifier">Agda.Interaction.Options.Help</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.Options.Help.html#Help"><span class="hs-identifier">Help</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.EmacsTop.html"><span class="hs-identifier">Agda.Interaction.EmacsTop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.EmacsTop.html#mimicGHCi"><span class="hs-identifier">mimicGHCi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.JSONTop.html"><span class="hs-identifier">Agda.Interaction.JSONTop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.JSONTop.html#jsonREPL"><span class="hs-identifier">jsonREPL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.FindFile.html"><span class="hs-identifier">Agda.Interaction.FindFile</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.Interaction.FindFile.html#SourceFile"><span class="hs-identifier">SourceFile</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.FindFile.html#SourceFile"><span class="hs-identifier">SourceFile</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Interaction.Imports.html"><span class="hs-identifier">Agda.Interaction.Imports</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Imp</span></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.html"><span class="hs-identifier">Agda.TypeChecking.Monad</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Benchmark.html"><span class="hs-identifier">Agda.TypeChecking.Monad.Benchmark</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Bench</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Errors.html"><span class="hs-identifier">Agda.TypeChecking.Errors</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Warnings.html"><span class="hs-identifier">Agda.TypeChecking.Warnings</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html"><span class="hs-identifier">Agda.TypeChecking.Pretty</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.Backend.html"><span class="hs-identifier">Agda.Compiler.Backend</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.Builtin.html"><span class="hs-identifier">Agda.Compiler.Builtin</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.VersionCommit.html"><span class="hs-identifier">Agda.VersionCommit</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.FileName.html"><span class="hs-identifier">Agda.Utils.FileName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.FileName.html#absolute"><span class="hs-identifier">absolute</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.FileName.html#filePath"><span class="hs-identifier">filePath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.FileName.html#AbsolutePath"><span class="hs-identifier">AbsolutePath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html"><span class="hs-identifier">Agda.Utils.Monad</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Null.html"><span class="hs-identifier">Agda.Utils.Null</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.String.html"><span class="hs-identifier">Agda.Utils.String</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.Benchmark.html"><span class="hs-identifier">Agda.Utils.Benchmark</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UtilsBench</span></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html"><span class="hs-identifier">Agda.Utils.Impossible</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">-- | The main function</span><span>
</span><span id="line-50"></span><span class="annot"><a href="Agda.Main.html#runAgda"><span class="hs-identifier hs-type">runAgda</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Compiler.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span id="runAgda"><span class="annot"><span class="annottext">runAgda :: [Backend] -&gt; IO ()
</span><a href="Agda.Main.html#runAgda"><span class="hs-identifier hs-var hs-var">runAgda</span></a></span></span><span> </span><span id="local-6989586621681163365"><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621681163365"><span class="hs-identifier hs-var">backends</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Backend] -&gt; IO ()
</span><a href="Agda.Main.html#runAgda%27"><span class="hs-identifier hs-var">runAgda'</span></a></span><span> </span><span class="annot"><span class="annottext">([Backend] -&gt; IO ()) -&gt; [Backend] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="Agda.Compiler.Builtin.html#builtinBackends"><span class="hs-identifier hs-var">builtinBackends</span></a></span><span> </span><span class="annot"><span class="annottext">[Backend] -&gt; [Backend] -&gt; [Backend]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621681163365"><span class="hs-identifier hs-var">backends</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">-- | The main function without importing built-in backends</span><span>
</span><span id="line-54"></span><span class="annot"><a href="Agda.Main.html#runAgda%27"><span class="hs-identifier hs-type">runAgda'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Compiler.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span id="runAgda%27"><span class="annot"><span class="annottext">runAgda' :: [Backend] -&gt; IO ()
</span><a href="Agda.Main.html#runAgda%27"><span class="hs-identifier hs-var hs-var">runAgda'</span></a></span></span><span> </span><span id="local-6989586621681163362"><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621681163362"><span class="hs-identifier hs-var">backends</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCM () -&gt; IO ()
</span><a href="Agda.Main.html#runTCMPrettyErrors"><span class="hs-identifier hs-var">runTCMPrettyErrors</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; IO ()) -&gt; TCM () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-56"></span><span>  </span><span id="local-6989586621681163360"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163360"><span class="hs-identifier hs-var">progName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [Char] -&gt; TCMT IO [Char]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO [Char]
</span><span class="hs-identifier hs-var">getProgName</span></span><span>
</span><span id="line-57"></span><span>  </span><span id="local-6989586621681163357"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621681163357"><span class="hs-identifier hs-var">argv</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [[Char]] -&gt; TCMT IO [[Char]]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO [[Char]]
</span><span class="hs-identifier hs-var">getArgs</span></span><span>
</span><span id="line-58"></span><span>  </span><span id="local-6989586621681163355"><span class="annot"><span class="annottext">Either [Char] ([Backend], CommandLineOptions, MainMode)
</span><a href="#local-6989586621681163355"><span class="hs-identifier hs-var">conf</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Either [Char] ([Backend], CommandLineOptions, MainMode))
-&gt; TCMT
     IO (Either [Char] ([Backend], CommandLineOptions, MainMode))
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either [Char] ([Backend], CommandLineOptions, MainMode))
 -&gt; TCMT
      IO (Either [Char] ([Backend], CommandLineOptions, MainMode)))
-&gt; IO (Either [Char] ([Backend], CommandLineOptions, MainMode))
-&gt; TCMT
     IO (Either [Char] ([Backend], CommandLineOptions, MainMode))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExceptT [Char] IO ([Backend], CommandLineOptions, MainMode)
-&gt; IO (Either [Char] ([Backend], CommandLineOptions, MainMode))
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT [Char] IO ([Backend], CommandLineOptions, MainMode)
 -&gt; IO (Either [Char] ([Backend], CommandLineOptions, MainMode)))
-&gt; ExceptT [Char] IO ([Backend], CommandLineOptions, MainMode)
-&gt; IO (Either [Char] ([Backend], CommandLineOptions, MainMode))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621681163354"><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621681163354"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681163353"><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163353"><span class="hs-identifier hs-var">opts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Either [Char] ([Backend], CommandLineOptions))
-&gt; ExceptT [Char] IO ([Backend], CommandLineOptions)
forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">ExceptT</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either [Char] ([Backend], CommandLineOptions))
 -&gt; ExceptT [Char] IO ([Backend], CommandLineOptions))
-&gt; IO (Either [Char] ([Backend], CommandLineOptions))
-&gt; ExceptT [Char] IO ([Backend], CommandLineOptions)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">OptM ([Backend], CommandLineOptions)
-&gt; IO (Either [Char] ([Backend], CommandLineOptions))
forall (m :: * -&gt; *) opts.
Monad m =&gt;
OptM opts -&gt; m (Either [Char] opts)
</span><a href="Agda.Interaction.Options.Base.html#runOptM"><span class="hs-identifier hs-var">runOptM</span></a></span><span> </span><span class="annot"><span class="annottext">(OptM ([Backend], CommandLineOptions)
 -&gt; IO (Either [Char] ([Backend], CommandLineOptions)))
-&gt; OptM ([Backend], CommandLineOptions)
-&gt; IO (Either [Char] ([Backend], CommandLineOptions))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Backend]
-&gt; [[Char]]
-&gt; CommandLineOptions
-&gt; OptM ([Backend], CommandLineOptions)
</span><a href="Agda.Compiler.Backend.html#parseBackendOptions"><span class="hs-identifier hs-var">parseBackendOptions</span></a></span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621681163362"><span class="hs-identifier hs-var">backends</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621681163357"><span class="hs-identifier hs-var">argv</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="Agda.Interaction.Options.Base.html#defaultOptions"><span class="hs-identifier hs-var">defaultOptions</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-comment">-- The absolute path of the input file, if provided</span><span>
</span><span id="line-61"></span><span>    </span><span id="local-6989586621681163348"><span class="annot"><span class="annottext">Maybe AbsolutePath
</span><a href="#local-6989586621681163348"><span class="hs-identifier hs-var">inputFile</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe AbsolutePath) -&gt; ExceptT [Char] IO (Maybe AbsolutePath)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe AbsolutePath) -&gt; ExceptT [Char] IO (Maybe AbsolutePath))
-&gt; IO (Maybe AbsolutePath)
-&gt; ExceptT [Char] IO (Maybe AbsolutePath)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO AbsolutePath)
-&gt; Maybe [Char] -&gt; IO (Maybe AbsolutePath)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO AbsolutePath
</span><a href="Agda.Utils.FileName.html#absolute"><span class="hs-identifier hs-var">absolute</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe [Char] -&gt; IO (Maybe AbsolutePath))
-&gt; Maybe [Char] -&gt; IO (Maybe AbsolutePath)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Maybe [Char]
</span><a href="Agda.Interaction.Options.Base.html#optInputFile"><span class="hs-identifier hs-var">optInputFile</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163353"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span id="local-6989586621681163345"><span class="annot"><span class="annottext">MainMode
</span><a href="#local-6989586621681163345"><span class="hs-identifier hs-var">mode</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Backend]
-&gt; Maybe AbsolutePath
-&gt; CommandLineOptions
-&gt; ExceptT [Char] IO MainMode
forall (m :: * -&gt; *).
MonadError [Char] m =&gt;
[Backend] -&gt; Maybe AbsolutePath -&gt; CommandLineOptions -&gt; m MainMode
</span><a href="Agda.Main.html#getMainMode"><span class="hs-identifier hs-var">getMainMode</span></a></span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621681163354"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe AbsolutePath
</span><a href="#local-6989586621681163348"><span class="hs-identifier hs-var">inputFile</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163353"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><span class="annottext">([Backend], CommandLineOptions, MainMode)
-&gt; ExceptT [Char] IO ([Backend], CommandLineOptions, MainMode)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621681163354"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163353"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MainMode
</span><a href="#local-6989586621681163345"><span class="hs-identifier hs-var">mode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either [Char] ([Backend], CommandLineOptions, MainMode)
</span><a href="#local-6989586621681163355"><span class="hs-identifier hs-var">conf</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621681163343"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163343"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; TCM ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; TCM ()) -&gt; IO () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><a href="Agda.Main.html#optionError"><span class="hs-identifier hs-var">optionError</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163343"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681163341"><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621681163341"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681163340"><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163340"><span class="hs-identifier hs-var">opts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681163339"><span class="annot"><span class="annottext">MainMode
</span><a href="#local-6989586621681163339"><span class="hs-identifier hs-var">mode</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; TCM () -&gt; TCM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Base.html#optTransliterate"><span class="hs-identifier hs-var">optTransliterate</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163340"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; TCM ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; TCM ()) -&gt; IO () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-70"></span><span>        </span><span class="hs-comment">-- When --interaction or --interaction-json is used, then we</span><span>
</span><span id="line-71"></span><span>        </span><span class="hs-comment">-- use UTF-8 when writing to stdout (and when reading from</span><span>
</span><span id="line-72"></span><span>        </span><span class="hs-comment">-- stdin).</span><span>
</span><span id="line-73"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Base.html#optGHCiInteraction"><span class="hs-identifier hs-var">optGHCiInteraction</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163340"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Base.html#optJSONInteraction"><span class="hs-identifier hs-var">optJSONInteraction</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163340"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-74"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><a href="Agda.Main.html#optionError"><span class="hs-identifier hs-var">optionError</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-75"></span><span>               </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;The option --transliterate must not be combined with &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-76"></span><span>               </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;--interaction or --interaction-json&quot;</span></span><span>
</span><span id="line-77"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-78"></span><span>          </span><span class="hs-comment">-- Transliterate unsupported code points.</span><span>
</span><span id="line-79"></span><span>          </span><span id="local-6989586621681163333"><span class="annot"><span class="annottext">TextEncoding
</span><a href="#local-6989586621681163333"><span class="hs-identifier hs-var">enc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO TextEncoding
</span><span class="hs-identifier hs-var">IO.mkTextEncoding</span></span><span>
</span><span id="line-80"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TextEncoding -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">TextEncoding
</span><span class="hs-identifier hs-var">IO.localeEncoding</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;//TRANSLIT&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>          </span><span class="annot"><span class="annottext">Handle -&gt; TextEncoding -&gt; IO ()
</span><span class="hs-identifier hs-var">IO.hSetEncoding</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">IO.stdout</span></span><span> </span><span class="annot"><span class="annottext">TextEncoding
</span><a href="#local-6989586621681163333"><span class="hs-identifier hs-var">enc</span></a></span><span>
</span><span id="line-82"></span><span>          </span><span class="annot"><span class="annottext">Handle -&gt; TextEncoding -&gt; IO ()
</span><span class="hs-identifier hs-var">IO.hSetEncoding</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">IO.stderr</span></span><span> </span><span class="annot"><span class="annottext">TextEncoding
</span><a href="#local-6989586621681163333"><span class="hs-identifier hs-var">enc</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MainMode
</span><a href="#local-6989586621681163339"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-85"></span><span>        </span><span class="annot"><a href="Agda.Main.html#MainModePrintHelp"><span class="hs-identifier hs-type">MainModePrintHelp</span></a></span><span> </span><span id="local-6989586621681163325"><span class="annot"><span class="annottext">Help
</span><a href="#local-6989586621681163325"><span class="hs-identifier hs-var">hp</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; TCM ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; TCM ()) -&gt; IO () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Backend] -&gt; Help -&gt; IO ()
</span><a href="Agda.Main.html#printUsage"><span class="hs-identifier hs-var">printUsage</span></a></span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621681163341"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Help
</span><a href="#local-6989586621681163325"><span class="hs-identifier hs-var">hp</span></a></span><span>
</span><span id="line-86"></span><span>        </span><span class="annot"><span class="annottext">MainMode
</span><a href="Agda.Main.html#MainModePrintVersion"><span class="hs-identifier hs-var">MainModePrintVersion</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; TCM ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; TCM ()) -&gt; IO () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Backend] -&gt; IO ()
</span><a href="Agda.Main.html#printVersion"><span class="hs-identifier hs-var">printVersion</span></a></span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621681163341"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-87"></span><span>        </span><span class="annot"><span class="annottext">MainMode
</span><a href="Agda.Main.html#MainModePrintAgdaDir"><span class="hs-identifier hs-var">MainModePrintAgdaDir</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; TCM ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; TCM ()) -&gt; IO () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="Agda.Main.html#printAgdaDir"><span class="hs-identifier hs-var">printAgdaDir</span></a></span><span>
</span><span id="line-88"></span><span>        </span><span class="annot"><a href="Agda.Main.html#MainModeRun"><span class="hs-identifier hs-type">MainModeRun</span></a></span><span> </span><span id="local-6989586621681163318"><span class="annot"><span class="annottext">Interactor ()
</span><a href="#local-6989586621681163318"><span class="hs-identifier hs-var">interactor</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-89"></span><span>          </span><span class="annot"><span class="annottext">Lens' [Backend] TCState -&gt; [Backend] -&gt; TCM ()
forall (m :: * -&gt; *) a.
MonadTCState m =&gt;
Lens' a TCState -&gt; a -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#setTCLens"><span class="hs-identifier hs-var">setTCLens</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' [Backend] TCState
</span><a href="Agda.TypeChecking.Monad.Base.html#stBackends"><span class="hs-identifier hs-var">stBackends</span></a></span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621681163341"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-90"></span><span>          </span><span class="annot"><span class="annottext">Interactor () -&gt; [Char] -&gt; CommandLineOptions -&gt; TCM ()
forall a. Interactor a -&gt; [Char] -&gt; CommandLineOptions -&gt; TCM a
</span><a href="Agda.Main.html#runAgdaWithOptions"><span class="hs-identifier hs-var">runAgdaWithOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Interactor ()
</span><a href="#local-6989586621681163318"><span class="hs-identifier hs-var">interactor</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163360"><span class="hs-identifier hs-var">progName</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163340"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">-- | Main execution mode</span><span>
</span><span id="line-93"></span><span class="hs-keyword">data</span><span> </span><span id="MainMode"><span class="annot"><a href="Agda.Main.html#MainMode"><span class="hs-identifier hs-var">MainMode</span></a></span></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="MainModeRun"><span class="annot"><a href="Agda.Main.html#MainModeRun"><span class="hs-identifier hs-var">MainModeRun</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Main.html#Interactor"><span class="hs-identifier hs-type">Interactor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MainModePrintHelp"><span class="annot"><a href="Agda.Main.html#MainModePrintHelp"><span class="hs-identifier hs-var">MainModePrintHelp</span></a></span></span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Help.html#Help"><span class="hs-identifier hs-type">Help</span></a></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MainModePrintVersion"><span class="annot"><a href="Agda.Main.html#MainModePrintVersion"><span class="hs-identifier hs-var">MainModePrintVersion</span></a></span></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MainModePrintAgdaDir"><span class="annot"><a href="Agda.Main.html#MainModePrintAgdaDir"><span class="hs-identifier hs-var">MainModePrintAgdaDir</span></a></span></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">-- | Determine the main execution mode to run, based on the configured backends and command line options.</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- | This is pure.</span><span>
</span><span id="line-101"></span><span id="local-6989586621681163662"><span class="annot"><a href="Agda.Main.html#getMainMode"><span class="hs-identifier hs-type">getMainMode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621681163662"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Compiler.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Utils.FileName.html#AbsolutePath"><span class="hs-identifier hs-type">AbsolutePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Base.html#CommandLineOptions"><span class="hs-identifier hs-type">CommandLineOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681163662"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Main.html#MainMode"><span class="hs-identifier hs-type">MainMode</span></a></span></span><span>
</span><span id="line-102"></span><span id="getMainMode"><span class="annot"><span class="annottext">getMainMode :: forall (m :: * -&gt; *).
MonadError [Char] m =&gt;
[Backend] -&gt; Maybe AbsolutePath -&gt; CommandLineOptions -&gt; m MainMode
</span><a href="Agda.Main.html#getMainMode"><span class="hs-identifier hs-var hs-var">getMainMode</span></a></span></span><span> </span><span id="local-6989586621681163303"><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621681163303"><span class="hs-identifier hs-var">configuredBackends</span></a></span></span><span> </span><span id="local-6989586621681163302"><span class="annot"><span class="annottext">Maybe AbsolutePath
</span><a href="#local-6989586621681163302"><span class="hs-identifier hs-var">maybeInputFile</span></a></span></span><span> </span><span id="local-6989586621681163301"><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163301"><span class="hs-identifier hs-var">opts</span></a></span></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681163300"><span class="annot"><span class="annottext">Help
</span><a href="#local-6989586621681163300"><span class="hs-identifier hs-var">hp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Maybe Help
</span><a href="Agda.Interaction.Options.Base.html#optPrintHelp"><span class="hs-identifier hs-var">optPrintHelp</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163301"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MainMode -&gt; m MainMode
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MainMode -&gt; m MainMode) -&gt; MainMode -&gt; m MainMode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Help -&gt; MainMode
</span><a href="Agda.Main.html#MainModePrintHelp"><span class="hs-identifier hs-var">MainModePrintHelp</span></a></span><span> </span><span class="annot"><span class="annottext">Help
</span><a href="#local-6989586621681163300"><span class="hs-identifier hs-var">hp</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Base.html#optPrintVersion"><span class="hs-identifier hs-var">optPrintVersion</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163301"><span class="hs-identifier hs-var">opts</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MainMode -&gt; m MainMode
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MainMode -&gt; m MainMode) -&gt; MainMode -&gt; m MainMode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MainMode
</span><a href="Agda.Main.html#MainModePrintVersion"><span class="hs-identifier hs-var">MainModePrintVersion</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Base.html#optPrintAgdaDir"><span class="hs-identifier hs-var">optPrintAgdaDir</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163301"><span class="hs-identifier hs-var">opts</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MainMode -&gt; m MainMode
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MainMode -&gt; m MainMode) -&gt; MainMode -&gt; m MainMode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MainMode
</span><a href="Agda.Main.html#MainModePrintAgdaDir"><span class="hs-identifier hs-var">MainModePrintAgdaDir</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-107"></span><span>      </span><span id="local-6989586621681163296"><span class="annot"><span class="annottext">Maybe (Interactor ())
</span><a href="#local-6989586621681163296"><span class="hs-identifier hs-var">mi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Backend]
-&gt; Maybe AbsolutePath
-&gt; CommandLineOptions
-&gt; m (Maybe (Interactor ()))
forall (m :: * -&gt; *).
MonadError [Char] m =&gt;
[Backend]
-&gt; Maybe AbsolutePath
-&gt; CommandLineOptions
-&gt; m (Maybe (Interactor ()))
</span><a href="Agda.Main.html#getInteractor"><span class="hs-identifier hs-var">getInteractor</span></a></span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621681163303"><span class="hs-identifier hs-var">configuredBackends</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe AbsolutePath
</span><a href="#local-6989586621681163302"><span class="hs-identifier hs-var">maybeInputFile</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163301"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-108"></span><span>      </span><span class="hs-comment">-- If there was no selection whatsoever (e.g. just invoked &quot;agda&quot;), we just show help and exit.</span><span>
</span><span id="line-109"></span><span>      </span><span class="annot"><span class="annottext">MainMode -&gt; m MainMode
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MainMode -&gt; m MainMode) -&gt; MainMode -&gt; m MainMode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MainMode
-&gt; (Interactor () -&gt; MainMode) -&gt; Maybe (Interactor ()) -&gt; MainMode
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Help -&gt; MainMode
</span><a href="Agda.Main.html#MainModePrintHelp"><span class="hs-identifier hs-var">MainModePrintHelp</span></a></span><span> </span><span class="annot"><span class="annottext">Help
</span><a href="Agda.Interaction.Options.Help.html#GeneralHelp"><span class="hs-identifier hs-var">GeneralHelp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Interactor () -&gt; MainMode
</span><a href="Agda.Main.html#MainModeRun"><span class="hs-identifier hs-var">MainModeRun</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Interactor ())
</span><a href="#local-6989586621681163296"><span class="hs-identifier hs-var">mi</span></a></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-keyword">type</span><span> </span><span id="Interactor"><span class="annot"><a href="Agda.Main.html#Interactor"><span class="hs-identifier hs-var">Interactor</span></a></span></span><span> </span><span id="local-6989586621681163292"><span class="annot"><a href="#local-6989586621681163292"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-comment">-- Setup/initialization action.</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-comment">-- This is separated so that errors can be reported in the appropriate format.</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-comment">-- Type-checking action</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.FileName.html#AbsolutePath"><span class="hs-identifier hs-type">AbsolutePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.Interaction.Imports.html#CheckResult"><span class="hs-identifier hs-type">CheckResult</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-comment">-- Main transformed action.</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681163292"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-keyword">data</span><span> </span><span id="FrontendType"><span class="annot"><a href="Agda.Main.html#FrontendType"><span class="hs-identifier hs-var">FrontendType</span></a></span></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="FrontEndEmacs"><span class="annot"><a href="Agda.Main.html#FrontEndEmacs"><span class="hs-identifier hs-var">FrontEndEmacs</span></a></span></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FrontEndJson"><span class="annot"><a href="Agda.Main.html#FrontEndJson"><span class="hs-identifier hs-var">FrontEndJson</span></a></span></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FrontEndRepl"><span class="annot"><a href="Agda.Main.html#FrontEndRepl"><span class="hs-identifier hs-var">FrontEndRepl</span></a></span></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">-- Emacs mode. Note that it ignores the &quot;check&quot; action because it calls typeCheck directly.</span><span>
</span><span id="line-126"></span><span class="annot"><a href="Agda.Main.html#emacsModeInteractor"><span class="hs-identifier hs-type">emacsModeInteractor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Main.html#Interactor"><span class="hs-identifier hs-type">Interactor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span id="emacsModeInteractor"><span class="annot"><span class="annottext">emacsModeInteractor :: Interactor ()
</span><a href="Agda.Main.html#emacsModeInteractor"><span class="hs-identifier hs-var hs-var">emacsModeInteractor</span></a></span></span><span> </span><span id="local-6989586621681163287"><span class="annot"><span class="annottext">TCM ()
</span><a href="#local-6989586621681163287"><span class="hs-identifier hs-var">setup</span></a></span></span><span> </span><span id="local-6989586621681163286"><span class="annot"><span class="annottext">AbsolutePath -&gt; TCM CheckResult
</span><a href="#local-6989586621681163286"><span class="hs-identifier hs-var">_check</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCM () -&gt; TCM ()
</span><a href="Agda.Interaction.EmacsTop.html#mimicGHCi"><span class="hs-identifier hs-var">mimicGHCi</span></a></span><span> </span><span class="annot"><span class="annottext">TCM ()
</span><a href="#local-6989586621681163287"><span class="hs-identifier hs-var">setup</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- JSON mode. Note that it ignores the &quot;check&quot; action because it calls typeCheck directly.</span><span>
</span><span id="line-130"></span><span class="annot"><a href="Agda.Main.html#jsonModeInteractor"><span class="hs-identifier hs-type">jsonModeInteractor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Main.html#Interactor"><span class="hs-identifier hs-type">Interactor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span id="jsonModeInteractor"><span class="annot"><span class="annottext">jsonModeInteractor :: Interactor ()
</span><a href="Agda.Main.html#jsonModeInteractor"><span class="hs-identifier hs-var hs-var">jsonModeInteractor</span></a></span></span><span> </span><span id="local-6989586621681163284"><span class="annot"><span class="annottext">TCM ()
</span><a href="#local-6989586621681163284"><span class="hs-identifier hs-var">setup</span></a></span></span><span> </span><span id="local-6989586621681163283"><span class="annot"><span class="annottext">AbsolutePath -&gt; TCM CheckResult
</span><a href="#local-6989586621681163283"><span class="hs-identifier hs-var">_check</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCM () -&gt; TCM ()
</span><a href="Agda.Interaction.JSONTop.html#jsonREPL"><span class="hs-identifier hs-var">jsonREPL</span></a></span><span> </span><span class="annot"><span class="annottext">TCM ()
</span><a href="#local-6989586621681163284"><span class="hs-identifier hs-var">setup</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">-- The deprecated repl mode.</span><span>
</span><span id="line-134"></span><span class="annot"><a href="Agda.Main.html#replInteractor"><span class="hs-identifier hs-type">replInteractor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Utils.FileName.html#AbsolutePath"><span class="hs-identifier hs-type">AbsolutePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Main.html#Interactor"><span class="hs-identifier hs-type">Interactor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span id="replInteractor"><span class="annot"><span class="annottext">replInteractor :: Maybe AbsolutePath -&gt; Interactor ()
</span><a href="Agda.Main.html#replInteractor"><span class="hs-identifier hs-var hs-var">replInteractor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe AbsolutePath -&gt; Interactor ()
</span><a href="Agda.Interaction.CommandLine.html#runInteractionLoop"><span class="hs-identifier hs-var">runInteractionLoop</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- The interactor to use when there are no frontends or backends specified.</span><span>
</span><span id="line-138"></span><span class="annot"><a href="Agda.Main.html#defaultInteractor"><span class="hs-identifier hs-type">defaultInteractor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.FileName.html#AbsolutePath"><span class="hs-identifier hs-type">AbsolutePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Main.html#Interactor"><span class="hs-identifier hs-type">Interactor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span id="defaultInteractor"><span class="annot"><span class="annottext">defaultInteractor :: AbsolutePath -&gt; Interactor ()
</span><a href="Agda.Main.html#defaultInteractor"><span class="hs-identifier hs-var hs-var">defaultInteractor</span></a></span></span><span> </span><span id="local-6989586621681163279"><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621681163279"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span id="local-6989586621681163278"><span class="annot"><span class="annottext">TCM ()
</span><a href="#local-6989586621681163278"><span class="hs-identifier hs-var">setup</span></a></span></span><span> </span><span id="local-6989586621681163277"><span class="annot"><span class="annottext">AbsolutePath -&gt; TCM CheckResult
</span><a href="#local-6989586621681163277"><span class="hs-identifier hs-var">check</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">TCM ()
</span><a href="#local-6989586621681163278"><span class="hs-identifier hs-var">setup</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">TCM CheckResult -&gt; TCM ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(TCM CheckResult -&gt; TCM ()) -&gt; TCM CheckResult -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AbsolutePath -&gt; TCM CheckResult
</span><a href="#local-6989586621681163277"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621681163279"><span class="hs-identifier hs-var">file</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span id="local-6989586621681163646"><span class="annot"><a href="Agda.Main.html#getInteractor"><span class="hs-identifier hs-type">getInteractor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621681163646"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Compiler.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Utils.FileName.html#AbsolutePath"><span class="hs-identifier hs-type">AbsolutePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Base.html#CommandLineOptions"><span class="hs-identifier hs-type">CommandLineOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681163646"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Main.html#Interactor"><span class="hs-identifier hs-type">Interactor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-142"></span><span id="getInteractor"><span class="annot"><span class="annottext">getInteractor :: forall (m :: * -&gt; *).
MonadError [Char] m =&gt;
[Backend]
-&gt; Maybe AbsolutePath
-&gt; CommandLineOptions
-&gt; m (Maybe (Interactor ()))
</span><a href="Agda.Main.html#getInteractor"><span class="hs-identifier hs-var hs-var">getInteractor</span></a></span></span><span> </span><span id="local-6989586621681163252"><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621681163252"><span class="hs-identifier hs-var">configuredBackends</span></a></span></span><span> </span><span id="local-6989586621681163251"><span class="annot"><span class="annottext">Maybe AbsolutePath
</span><a href="#local-6989586621681163251"><span class="hs-identifier hs-var">maybeInputFile</span></a></span></span><span> </span><span id="local-6989586621681163250"><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163250"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe AbsolutePath
</span><a href="#local-6989586621681163251"><span class="hs-identifier hs-var">maybeInputFile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[FrontendType]
</span><a href="#local-6989586621681163249"><span class="hs-identifier hs-var">enabledFrontends</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621681163248"><span class="hs-identifier hs-var">enabledBackends</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681163247"><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621681163247"><span class="hs-identifier hs-var">inputFile</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>             </span><span class="annot"><span class="annottext">Backend
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Backend]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Interactor ()) -&gt; m (Maybe (Interactor ()))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Interactor ()) -&gt; m (Maybe (Interactor ())))
-&gt; Maybe (Interactor ()) -&gt; m (Maybe (Interactor ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Interactor () -&gt; Maybe (Interactor ())
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Interactor () -&gt; Maybe (Interactor ()))
-&gt; Interactor () -&gt; Maybe (Interactor ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AbsolutePath -&gt; [Backend] -&gt; Interactor ()
</span><a href="Agda.Compiler.Backend.html#backendInteraction"><span class="hs-identifier hs-var">backendInteraction</span></a></span><span> </span><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621681163247"><span class="hs-identifier hs-var">inputFile</span></a></span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621681163248"><span class="hs-identifier hs-var">enabledBackends</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681163245"><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621681163245"><span class="hs-identifier hs-var">inputFile</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>              </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Interactor ()) -&gt; m (Maybe (Interactor ()))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Interactor ()) -&gt; m (Maybe (Interactor ())))
-&gt; Maybe (Interactor ()) -&gt; m (Maybe (Interactor ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Interactor () -&gt; Maybe (Interactor ())
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Interactor () -&gt; Maybe (Interactor ()))
-&gt; Interactor () -&gt; Maybe (Interactor ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AbsolutePath -&gt; Interactor ()
</span><a href="Agda.Main.html#defaultInteractor"><span class="hs-identifier hs-var">defaultInteractor</span></a></span><span> </span><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621681163245"><span class="hs-identifier hs-var">inputFile</span></a></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe AbsolutePath
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>              </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Interactor ()) -&gt; m (Maybe (Interactor ()))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Interactor ())
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- No backends, frontends, or input files specified.</span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe AbsolutePath
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>             </span><span class="annot"><span class="annottext">Backend
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Backend]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; m (Maybe (Interactor ()))
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; m (Maybe (Interactor ())))
-&gt; [Char] -&gt; m (Maybe (Interactor ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;No input file specified for &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163242"><span class="hs-identifier hs-var">enabledBackendNames</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe AbsolutePath
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span>              </span><span class="annot"><span class="annottext">FrontendType
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[FrontendType]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">Backend
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Backend]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; m (Maybe (Interactor ()))
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; m (Maybe (Interactor ())))
-&gt; [Char] -&gt; m (Maybe (Interactor ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Cannot mix &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163241"><span class="hs-identifier hs-var">enabledFrontendNames</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; with &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163242"><span class="hs-identifier hs-var">enabledBackendNames</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe AbsolutePath
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span>              </span><span class="annot"><span class="annottext">FrontendType
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">FrontendType
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[FrontendType]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span>           </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; m (Maybe (Interactor ()))
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; m (Maybe (Interactor ())))
-&gt; [Char] -&gt; m (Maybe (Interactor ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Must not specify multiple &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163241"><span class="hs-identifier hs-var">enabledFrontendNames</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe AbsolutePath
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span>              </span><span class="hs-special">[</span><span id="local-6989586621681163240"><span class="annot"><span class="annottext">FrontendType
</span><a href="#local-6989586621681163240"><span class="hs-identifier hs-var">fe</span></a></span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Base.html#optOnlyScopeChecking"><span class="hs-identifier hs-var">optOnlyScopeChecking</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163250"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FrontendType -&gt; m (Maybe (Interactor ()))
forall {m :: * -&gt; *} {a}.
MonadError [Char] m =&gt;
FrontendType -&gt; m a
</span><a href="#local-6989586621681163238"><span class="hs-identifier hs-var">errorFrontendScopeChecking</span></a></span><span> </span><span class="annot"><span class="annottext">FrontendType
</span><a href="#local-6989586621681163240"><span class="hs-identifier hs-var">fe</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe AbsolutePath
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FrontendType
</span><a href="Agda.Main.html#FrontEndRepl"><span class="hs-identifier hs-var">FrontEndRepl</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Interactor ()) -&gt; m (Maybe (Interactor ()))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Interactor ()) -&gt; m (Maybe (Interactor ())))
-&gt; Maybe (Interactor ()) -&gt; m (Maybe (Interactor ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Interactor () -&gt; Maybe (Interactor ())
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Interactor () -&gt; Maybe (Interactor ()))
-&gt; Interactor () -&gt; Maybe (Interactor ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe AbsolutePath -&gt; Interactor ()
</span><a href="Agda.Main.html#replInteractor"><span class="hs-identifier hs-var">replInteractor</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe AbsolutePath
</span><a href="#local-6989586621681163251"><span class="hs-identifier hs-var">maybeInputFile</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe AbsolutePath
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FrontendType
</span><a href="Agda.Main.html#FrontEndEmacs"><span class="hs-identifier hs-var">FrontEndEmacs</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Interactor ()) -&gt; m (Maybe (Interactor ()))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Interactor ()) -&gt; m (Maybe (Interactor ())))
-&gt; Maybe (Interactor ()) -&gt; m (Maybe (Interactor ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Interactor () -&gt; Maybe (Interactor ())
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Interactor () -&gt; Maybe (Interactor ()))
-&gt; Interactor () -&gt; Maybe (Interactor ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Interactor ()
</span><a href="Agda.Main.html#emacsModeInteractor"><span class="hs-identifier hs-var">emacsModeInteractor</span></a></span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe AbsolutePath
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FrontendType
</span><a href="Agda.Main.html#FrontEndJson"><span class="hs-identifier hs-var">FrontEndJson</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Interactor ()) -&gt; m (Maybe (Interactor ()))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Interactor ()) -&gt; m (Maybe (Interactor ())))
-&gt; Maybe (Interactor ()) -&gt; m (Maybe (Interactor ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Interactor () -&gt; Maybe (Interactor ())
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Interactor () -&gt; Maybe (Interactor ()))
-&gt; Interactor () -&gt; Maybe (Interactor ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Interactor ()
</span><a href="Agda.Main.html#jsonModeInteractor"><span class="hs-identifier hs-var">jsonModeInteractor</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681163237"><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621681163237"><span class="hs-identifier hs-var">inputFile</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FrontendType
</span><a href="Agda.Main.html#FrontEndEmacs"><span class="hs-identifier hs-var">FrontEndEmacs</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AbsolutePath -&gt; FrontendType -&gt; m (Maybe (Interactor ()))
forall {m :: * -&gt; *} {a}.
MonadError [Char] m =&gt;
AbsolutePath -&gt; FrontendType -&gt; m a
</span><a href="#local-6989586621681163236"><span class="hs-identifier hs-var">errorFrontendFileDisallowed</span></a></span><span> </span><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621681163237"><span class="hs-identifier hs-var">inputFile</span></a></span><span> </span><span class="annot"><span class="annottext">FrontendType
</span><a href="Agda.Main.html#FrontEndEmacs"><span class="hs-identifier hs-var">FrontEndEmacs</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681163235"><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621681163235"><span class="hs-identifier hs-var">inputFile</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FrontendType
</span><a href="Agda.Main.html#FrontEndJson"><span class="hs-identifier hs-var">FrontEndJson</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AbsolutePath -&gt; FrontendType -&gt; m (Maybe (Interactor ()))
forall {m :: * -&gt; *} {a}.
MonadError [Char] m =&gt;
AbsolutePath -&gt; FrontendType -&gt; m a
</span><a href="#local-6989586621681163236"><span class="hs-identifier hs-var">errorFrontendFileDisallowed</span></a></span><span> </span><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621681163235"><span class="hs-identifier hs-var">inputFile</span></a></span><span> </span><span class="annot"><span class="annottext">FrontendType
</span><a href="Agda.Main.html#FrontEndJson"><span class="hs-identifier hs-var">FrontEndJson</span></a></span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-comment">-- NOTE: The notion of a backend being &quot;enabled&quot; *just* refers to this top-level interaction mode selection. The</span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-comment">-- interaction/interactive front-ends may still invoke available backends even if they are not &quot;enabled&quot;.</span><span>
</span><span id="line-159"></span><span>    </span><span id="local-6989586621681163234"><span class="annot"><span class="annottext">isBackendEnabled :: Backend -&gt; Bool
</span><a href="#local-6989586621681163234"><span class="hs-identifier hs-var hs-var">isBackendEnabled</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span id="local-6989586621681163231"><span class="annot"><span class="annottext">Backend' opts env menv mod def
</span><a href="#local-6989586621681163231"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Backend' opts env menv mod def -&gt; opts -&gt; Bool
forall opts env menv mod def.
Backend' opts env menv mod def -&gt; opts -&gt; Bool
</span><a href="Agda.Compiler.Backend.html#isEnabled"><span class="hs-identifier hs-var">isEnabled</span></a></span><span> </span><span class="annot"><span class="annottext">Backend' opts env menv mod def
</span><a href="#local-6989586621681163231"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Backend' opts env menv mod def -&gt; opts
forall opts env menv mod def.
Backend' opts env menv mod def -&gt; opts
</span><a href="Agda.Compiler.Backend.html#options"><span class="hs-identifier hs-var">options</span></a></span><span> </span><span class="annot"><span class="annottext">Backend' opts env menv mod def
</span><a href="#local-6989586621681163231"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>    </span><span id="local-6989586621681163248"><span class="annot"><span class="annottext">enabledBackends :: [Backend]
</span><a href="#local-6989586621681163248"><span class="hs-identifier hs-var hs-var">enabledBackends</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Backend -&gt; Bool) -&gt; [Backend] -&gt; [Backend]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Backend -&gt; Bool
</span><a href="#local-6989586621681163234"><span class="hs-identifier hs-var">isBackendEnabled</span></a></span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621681163252"><span class="hs-identifier hs-var">configuredBackends</span></a></span><span>
</span><span id="line-161"></span><span>    </span><span id="local-6989586621681163249"><span class="annot"><span class="annottext">enabledFrontends :: [FrontendType]
</span><a href="#local-6989586621681163249"><span class="hs-identifier hs-var hs-var">enabledFrontends</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[FrontendType]] -&gt; [FrontendType]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-162"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FrontendType
</span><a href="Agda.Main.html#FrontEndRepl"><span class="hs-identifier hs-var">FrontEndRepl</span></a></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Base.html#optInteractive"><span class="hs-identifier hs-var">optInteractive</span></a></span><span>     </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163250"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-163"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FrontendType
</span><a href="Agda.Main.html#FrontEndEmacs"><span class="hs-identifier hs-var">FrontEndEmacs</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Base.html#optGHCiInteraction"><span class="hs-identifier hs-var">optGHCiInteraction</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163250"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-164"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FrontendType
</span><a href="Agda.Main.html#FrontEndJson"><span class="hs-identifier hs-var">FrontEndJson</span></a></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Base.html#optJSONInteraction"><span class="hs-identifier hs-var">optJSONInteraction</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163250"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-165"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-comment">-- Constructs messages like &quot;(no backend)&quot;, &quot;backend ghc&quot;, &quot;backends (ghc, ocaml)&quot;</span><span>
</span><span id="line-167"></span><span>    </span><span id="local-6989586621681163216"><span class="annot"><span class="annottext">pluralize :: [Char] -&gt; [[Char]] -&gt; [Char]
</span><a href="#local-6989586621681163216"><span class="hs-identifier hs-var hs-var">pluralize</span></a></span></span><span> </span><span id="local-6989586621681163215"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163215"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(no &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163215"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><a href="#local-6989586621681163216"><span class="hs-identifier hs-var">pluralize</span></a></span><span> </span><span id="local-6989586621681163214"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163214"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621681163213"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163213"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163214"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163213"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><a href="#local-6989586621681163216"><span class="hs-identifier hs-var">pluralize</span></a></span><span> </span><span id="local-6989586621681163212"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163212"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621681163211"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621681163211"><span class="hs-identifier hs-var">xs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163212"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;s (&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [Char]
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">List.intercalate</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621681163211"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-170"></span><span>    </span><span id="local-6989586621681163242"><span class="annot"><span class="annottext">enabledBackendNames :: [Char]
</span><a href="#local-6989586621681163242"><span class="hs-identifier hs-var hs-var">enabledBackendNames</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [Char]
</span><a href="#local-6989586621681163216"><span class="hs-identifier hs-var">pluralize</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;backend&quot;</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Backend' opts env menv mod def -&gt; [Char]
forall opts env menv mod def.
Backend' opts env menv mod def -&gt; [Char]
</span><a href="Agda.Compiler.Backend.html#backendName"><span class="hs-identifier hs-var">backendName</span></a></span><span> </span><span class="annot"><span class="annottext">Backend' opts env menv mod def
</span><a href="#local-6989586621681163208"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Agda.Compiler.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span id="local-6989586621681163208"><span class="annot"><span class="annottext">Backend' opts env menv mod def
</span><a href="#local-6989586621681163208"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621681163248"><span class="hs-identifier hs-var">enabledBackends</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-171"></span><span>    </span><span id="local-6989586621681163241"><span class="annot"><span class="annottext">enabledFrontendNames :: [Char]
</span><a href="#local-6989586621681163241"><span class="hs-identifier hs-var hs-var">enabledFrontendNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [Char]
</span><a href="#local-6989586621681163216"><span class="hs-identifier hs-var">pluralize</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;frontend&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FrontendType -&gt; [Char]
</span><a href="#local-6989586621681163206"><span class="hs-identifier hs-var">frontendFlagName</span></a></span><span> </span><span class="annot"><span class="annottext">(FrontendType -&gt; [Char]) -&gt; [FrontendType] -&gt; [[Char]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[FrontendType]
</span><a href="#local-6989586621681163249"><span class="hs-identifier hs-var">enabledFrontends</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>    </span><span id="local-6989586621681163206"><span class="annot"><span class="annottext">frontendFlagName :: FrontendType -&gt; [Char]
</span><a href="#local-6989586621681163206"><span class="hs-identifier hs-var hs-var">frontendFlagName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;--&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char])
-&gt; (FrontendType -&gt; [Char]) -&gt; FrontendType -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-173"></span><span>      </span><span class="annot"><span class="annottext">FrontendType
</span><a href="Agda.Main.html#FrontEndEmacs"><span class="hs-identifier hs-var">FrontEndEmacs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;interaction&quot;</span></span><span>
</span><span id="line-174"></span><span>      </span><span class="annot"><span class="annottext">FrontendType
</span><a href="Agda.Main.html#FrontEndJson"><span class="hs-identifier hs-var">FrontEndJson</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;interaction-json&quot;</span></span><span>
</span><span id="line-175"></span><span>      </span><span class="annot"><span class="annottext">FrontendType
</span><a href="Agda.Main.html#FrontEndRepl"><span class="hs-identifier hs-var">FrontEndRepl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;interactive&quot;</span></span><span>
</span><span id="line-176"></span><span>    </span><span id="local-6989586621681163238"><span class="annot"><span class="annottext">errorFrontendScopeChecking :: FrontendType -&gt; m a
</span><a href="#local-6989586621681163238"><span class="hs-identifier hs-var hs-var">errorFrontendScopeChecking</span></a></span></span><span> </span><span id="local-6989586621681163192"><span class="annot"><span class="annottext">FrontendType
</span><a href="#local-6989586621681163192"><span class="hs-identifier hs-var">fe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; m a) -&gt; [Char] -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-177"></span><span>      </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;The --only-scope-checking flag cannot be combined with &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FrontendType -&gt; [Char]
</span><a href="#local-6989586621681163206"><span class="hs-identifier hs-var">frontendFlagName</span></a></span><span> </span><span class="annot"><span class="annottext">FrontendType
</span><a href="#local-6989586621681163192"><span class="hs-identifier hs-var">fe</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-178"></span><span>    </span><span id="local-6989586621681163236"><span class="annot"><span class="annottext">errorFrontendFileDisallowed :: AbsolutePath -&gt; FrontendType -&gt; m a
</span><a href="#local-6989586621681163236"><span class="hs-identifier hs-var hs-var">errorFrontendFileDisallowed</span></a></span></span><span> </span><span id="local-6989586621681163185"><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621681163185"><span class="hs-identifier hs-var">inputFile</span></a></span></span><span> </span><span id="local-6989586621681163184"><span class="annot"><span class="annottext">FrontendType
</span><a href="#local-6989586621681163184"><span class="hs-identifier hs-var">fe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; m a) -&gt; [Char] -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-179"></span><span>      </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Must not specify an input file (&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AbsolutePath -&gt; [Char]
</span><a href="Agda.Utils.FileName.html#filePath"><span class="hs-identifier hs-var">filePath</span></a></span><span> </span><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621681163185"><span class="hs-identifier hs-var">inputFile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;) with &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FrontendType -&gt; [Char]
</span><a href="#local-6989586621681163206"><span class="hs-identifier hs-var">frontendFlagName</span></a></span><span> </span><span class="annot"><span class="annottext">FrontendType
</span><a href="#local-6989586621681163184"><span class="hs-identifier hs-var">fe</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-comment">-- | Run Agda with parsed command line options</span><span>
</span><span id="line-182"></span><span id="local-6989586621681163650"><span class="annot"><a href="Agda.Main.html#runAgdaWithOptions"><span class="hs-identifier hs-type">runAgdaWithOptions</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Main.html#Interactor"><span class="hs-identifier hs-type">Interactor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681163650"><span class="hs-identifier hs-type">a</span></a></span><span>       </span><span class="hs-comment">-- ^ Backend interaction</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>             </span><span class="hs-comment">-- ^ program name</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Base.html#CommandLineOptions"><span class="hs-identifier hs-type">CommandLineOptions</span></a></span><span> </span><span class="hs-comment">-- ^ parsed command line options</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681163650"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-187"></span><span id="runAgdaWithOptions"><span class="annot"><span class="annottext">runAgdaWithOptions :: forall a. Interactor a -&gt; [Char] -&gt; CommandLineOptions -&gt; TCM a
</span><a href="Agda.Main.html#runAgdaWithOptions"><span class="hs-identifier hs-var hs-var">runAgdaWithOptions</span></a></span></span><span> </span><span id="local-6989586621681163111"><span class="annot"><span class="annottext">Interactor a
</span><a href="#local-6989586621681163111"><span class="hs-identifier hs-var">interactor</span></a></span></span><span> </span><span id="local-6989586621681163110"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163110"><span class="hs-identifier hs-var">progName</span></a></span></span><span> </span><span id="local-6989586621681163109"><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163109"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-188"></span><span>          </span><span class="hs-comment">-- Main function.</span><span>
</span><span id="line-189"></span><span>          </span><span class="hs-comment">-- Bill everything to root of Benchmark trie.</span><span>
</span><span id="line-190"></span><span>          </span><span class="annot"><span class="annottext">BenchmarkOn (BenchPhase (TCMT IO)) -&gt; TCM ()
forall (m :: * -&gt; *).
MonadBench m =&gt;
BenchmarkOn (BenchPhase m) -&gt; m ()
</span><a href="Agda.Utils.Benchmark.html#setBenchmarking"><span class="hs-identifier hs-var">UtilsBench.setBenchmarking</span></a></span><span> </span><span class="annot"><span class="annottext">BenchmarkOn (BenchPhase (TCMT IO))
forall a. BenchmarkOn a
</span><a href="Agda.Utils.Benchmark.html#BenchmarkOn"><span class="hs-identifier hs-var">UtilsBench.BenchmarkOn</span></a></span><span>
</span><span id="line-191"></span><span>            </span><span class="hs-comment">-- Andreas, Nisse, 2016-10-11 AIM XXIV</span><span>
</span><span id="line-192"></span><span>            </span><span class="hs-comment">-- Turn benchmarking on provisionally, otherwise we lose track of time spent</span><span>
</span><span id="line-193"></span><span>            </span><span class="hs-comment">-- on e.g. LaTeX-code generation.</span><span>
</span><span id="line-194"></span><span>            </span><span class="hs-comment">-- Benchmarking might be turned off later by setCommandlineOptions</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span>          </span><span class="annot"><span class="annottext">Account (BenchPhase (TCMT IO)) -&gt; TCM a -&gt; TCM a
forall (m :: * -&gt; *) c.
MonadBench m =&gt;
Account (BenchPhase m) -&gt; m c -&gt; m c
</span><a href="Agda.Utils.Benchmark.html#billTo"><span class="hs-identifier hs-var">Bench.billTo</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(TCM a -&gt; TCM a) -&gt; TCM a -&gt; TCM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-197"></span><span>            </span><span class="annot"><span class="annottext">Interactor a
</span><a href="#local-6989586621681163111"><span class="hs-identifier hs-var">interactor</span></a></span><span> </span><span class="annot"><span class="annottext">TCM ()
</span><a href="#local-6989586621681163105"><span class="hs-identifier hs-var">initialSetup</span></a></span><span> </span><span class="annot"><span class="annottext">AbsolutePath -&gt; TCM CheckResult
</span><a href="#local-6989586621681163104"><span class="hs-identifier hs-var">checkFile</span></a></span><span>
</span><span id="line-198"></span><span>          </span><span class="annot"><span class="annottext">TCM a -&gt; TCM () -&gt; TCM a
forall a b. TCM a -&gt; TCM b -&gt; TCM a
</span><a href="Agda.TypeChecking.Monad.Base.html#finally_"><span class="hs-operator hs-var">`finally_`</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-199"></span><span>            </span><span class="hs-comment">-- Print benchmarks.</span><span>
</span><span id="line-200"></span><span>            </span><span class="annot"><span class="annottext">TCM ()
forall (tcm :: * -&gt; *). MonadTCM tcm =&gt; tcm ()
</span><a href="Agda.TypeChecking.Monad.Benchmark.html#print"><span class="hs-identifier hs-var">Bench.print</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span>            </span><span class="hs-comment">-- Print accumulated statistics.</span><span>
</span><span id="line-203"></span><span>            </span><span class="annot"><span class="annottext">Maybe TopLevelModuleName -&gt; Statistics -&gt; TCM ()
forall (m :: * -&gt; *).
(MonadDebug m, MonadTCEnv m, HasOptions m) =&gt;
Maybe TopLevelModuleName -&gt; Statistics -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Statistics.html#printStatistics"><span class="hs-identifier hs-var">printStatistics</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TopLevelModuleName
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">(Statistics -&gt; TCM ()) -&gt; TCMT IO Statistics -&gt; TCM ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Lens' Statistics TCState -&gt; TCMT IO Statistics
forall (m :: * -&gt; *) a. ReadTCState m =&gt; Lens' a TCState -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#useTC"><span class="hs-identifier hs-var">useTC</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' Statistics TCState
</span><a href="Agda.TypeChecking.Monad.State.html#lensAccumStatistics"><span class="hs-identifier hs-var">lensAccumStatistics</span></a></span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-comment">-- Options are fleshed out here so that (most) errors like</span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-comment">-- &quot;bad library path&quot; are validated within the interactor,</span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-comment">-- so that they are reported with the appropriate protocol/formatting.</span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><a href="#local-6989586621681163105"><span class="hs-identifier hs-type">initialSetup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>    </span><span id="local-6989586621681163105"><span class="annot"><span class="annottext">initialSetup :: TCM ()
</span><a href="#local-6989586621681163105"><span class="hs-identifier hs-var hs-var">initialSetup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-210"></span><span>      </span><span id="local-6989586621681163095"><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163095"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; TCM CommandLineOptions
</span><a href="Agda.TypeChecking.Monad.Options.html#addTrustedExecutables"><span class="hs-identifier hs-var">addTrustedExecutables</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163109"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-211"></span><span>      </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.Options.html#setCommandLineOptions"><span class="hs-identifier hs-var">setCommandLineOptions</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163095"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><a href="#local-6989586621681163104"><span class="hs-identifier hs-type">checkFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.FileName.html#AbsolutePath"><span class="hs-identifier hs-type">AbsolutePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.Interaction.Imports.html#CheckResult"><span class="hs-identifier hs-type">CheckResult</span></a></span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621681163104"><span class="annot"><span class="annottext">checkFile :: AbsolutePath -&gt; TCM CheckResult
</span><a href="#local-6989586621681163104"><span class="hs-identifier hs-var hs-var">checkFile</span></a></span></span><span> </span><span id="local-6989586621681163092"><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621681163092"><span class="hs-identifier hs-var">inputFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-215"></span><span>        </span><span class="hs-comment">-- Andreas, 2013-10-30 The following 'resetState' kills the</span><span>
</span><span id="line-216"></span><span>        </span><span class="hs-comment">-- verbosity options.  That does not make sense (see fail/Issue641).</span><span>
</span><span id="line-217"></span><span>        </span><span class="hs-comment">-- 'resetState' here does not seem to serve any purpose,</span><span>
</span><span id="line-218"></span><span>        </span><span class="hs-comment">-- thus, I am removing it.</span><span>
</span><span id="line-219"></span><span>        </span><span class="hs-comment">-- resetState</span><span>
</span><span id="line-220"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681163091"><span class="annot"><span class="annottext">mode :: Mode
</span><a href="#local-6989586621681163091"><span class="hs-identifier hs-var hs-var">mode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CommandLineOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Base.html#optOnlyScopeChecking"><span class="hs-identifier hs-var">optOnlyScopeChecking</span></a></span><span> </span><span class="annot"><span class="annottext">CommandLineOptions
</span><a href="#local-6989586621681163109"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-221"></span><span>                     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Agda.Interaction.Imports.html#ScopeCheck"><span class="hs-identifier hs-var">Imp.ScopeCheck</span></a></span><span>
</span><span id="line-222"></span><span>                     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Agda.Interaction.Imports.html#TypeCheck"><span class="hs-identifier hs-var">Imp.TypeCheck</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span>          </span><span id="local-6989586621681163088"><span class="annot"><span class="annottext">CheckResult
</span><a href="#local-6989586621681163088"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Mode -&gt; Source -&gt; TCM CheckResult
</span><a href="Agda.Interaction.Imports.html#typeCheckMain"><span class="hs-identifier hs-var">Imp.typeCheckMain</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621681163091"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">(Source -&gt; TCM CheckResult) -&gt; TCMT IO Source -&gt; TCM CheckResult
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">SourceFile -&gt; TCMT IO Source
</span><a href="Agda.Interaction.Imports.html#parseSource"><span class="hs-identifier hs-var">Imp.parseSource</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AbsolutePath -&gt; SourceFile
</span><a href="Agda.Interaction.FindFile.html#SourceFile"><span class="hs-identifier hs-var">SourceFile</span></a></span><span> </span><span class="annot"><span class="annottext">AbsolutePath
</span><a href="#local-6989586621681163092"><span class="hs-identifier hs-var">inputFile</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; TCM () -&gt; TCM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckResult -&gt; ModuleCheckMode
</span><a href="Agda.Interaction.Imports.html#crMode"><span class="hs-identifier hs-var">crMode</span></a></span><span> </span><span class="annot"><span class="annottext">CheckResult
</span><a href="#local-6989586621681163088"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleCheckMode -&gt; ModuleCheckMode -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ModuleCheckMode
</span><a href="Agda.TypeChecking.Monad.Base.html#ModuleScopeChecked"><span class="hs-identifier hs-var">ModuleScopeChecked</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-227"></span><span>            </span><span class="annot"><span class="annottext">TCMT IO [TCWarning] -&gt; ([TCWarning] -&gt; TCM ()) -&gt; TCM ()
forall (m :: * -&gt; *) a.
(Monad m, Null a) =&gt;
m a -&gt; (a -&gt; m ()) -&gt; m ()
</span><a href="Agda.Utils.Null.html#unlessNullM"><span class="hs-identifier hs-var">unlessNullM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TCWarning] -&gt; TCMT IO [TCWarning]
forall (m :: * -&gt; *). HasOptions m =&gt; [TCWarning] -&gt; m [TCWarning]
</span><a href="Agda.TypeChecking.Pretty.Warning.html#applyFlagsToTCWarnings"><span class="hs-identifier hs-var">applyFlagsToTCWarnings</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckResult -&gt; [TCWarning]
</span><a href="Agda.Interaction.Imports.html#crWarnings"><span class="hs-identifier hs-var">crWarnings</span></a></span><span> </span><span class="annot"><span class="annottext">CheckResult
</span><a href="#local-6989586621681163088"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([TCWarning] -&gt; TCM ()) -&gt; TCM ())
-&gt; ([TCWarning] -&gt; TCM ()) -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681163079"><span class="annot"><span class="annottext">[TCWarning]
</span><a href="#local-6989586621681163079"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-228"></span><span>              </span><span class="annot"><span class="annottext">TypeError -&gt; TCM ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
TypeError -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-var">typeError</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeError -&gt; TCM ()) -&gt; TypeError -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCWarning] -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#NonFatalErrors"><span class="hs-identifier hs-var">NonFatalErrors</span></a></span><span> </span><span class="annot"><span class="annottext">[TCWarning]
</span><a href="#local-6989586621681163079"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681163076"><span class="annot"><span class="annottext">i :: Interface
</span><a href="#local-6989586621681163076"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CheckResult -&gt; Interface
</span><a href="Agda.Interaction.Imports.html#crInterface"><span class="hs-identifier hs-var">crInterface</span></a></span><span> </span><span class="annot"><span class="annottext">CheckResult
</span><a href="#local-6989586621681163088"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-231"></span><span>          </span><span class="annot"><span class="annottext">[Char] -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;main&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Interface -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Interface
</span><a href="#local-6989586621681163076"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span>          </span><span class="hs-comment">-- Print accumulated warnings</span><span>
</span><span id="line-234"></span><span>          </span><span class="annot"><span class="annottext">TCMT IO [TCWarning] -&gt; ([TCWarning] -&gt; TCM ()) -&gt; TCM ()
forall (m :: * -&gt; *) a.
(Monad m, Null a) =&gt;
m a -&gt; (a -&gt; m ()) -&gt; m ()
</span><a href="Agda.Utils.Null.html#unlessNullM"><span class="hs-identifier hs-var">unlessNullM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WarningsAndNonFatalErrors -&gt; [TCWarning]
</span><a href="Agda.TypeChecking.Warnings.html#tcWarnings"><span class="hs-identifier hs-var">tcWarnings</span></a></span><span> </span><span class="annot"><span class="annottext">(WarningsAndNonFatalErrors -&gt; [TCWarning])
-&gt; ([TCWarning] -&gt; WarningsAndNonFatalErrors)
-&gt; [TCWarning]
-&gt; [TCWarning]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[TCWarning] -&gt; WarningsAndNonFatalErrors
</span><a href="Agda.TypeChecking.Warnings.html#classifyWarnings"><span class="hs-identifier hs-var">classifyWarnings</span></a></span><span> </span><span class="annot"><span class="annottext">([TCWarning] -&gt; [TCWarning])
-&gt; TCMT IO [TCWarning] -&gt; TCMT IO [TCWarning]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">WhichWarnings -&gt; TCMT IO [TCWarning]
forall (m :: * -&gt; *).
(MonadFail m, ReadTCState m, MonadWarning m) =&gt;
WhichWarnings -&gt; m [TCWarning]
</span><a href="Agda.TypeChecking.Pretty.Warning.html#getAllWarnings"><span class="hs-identifier hs-var">getAllWarnings</span></a></span><span> </span><span class="annot"><span class="annottext">WhichWarnings
</span><a href="Agda.TypeChecking.Warnings.html#AllWarnings"><span class="hs-identifier hs-var">AllWarnings</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([TCWarning] -&gt; TCM ()) -&gt; TCM ())
-&gt; ([TCWarning] -&gt; TCM ()) -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681163068"><span class="annot"><span class="annottext">[TCWarning]
</span><a href="#local-6989586621681163068"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-235"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681163064"><span class="annot"><span class="annottext">banner :: TCMT IO Doc
</span><a href="#local-6989586621681163064"><span class="hs-identifier hs-var hs-var">banner</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; [Char] -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; TCMT IO Doc) -&gt; [Char] -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><a href="Agda.Utils.String.html#delimiter"><span class="hs-identifier hs-var">delimiter</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;All done; warnings encountered&quot;</span></span><span>
</span><span id="line-236"></span><span>            </span><span class="annot"><span class="annottext">[Char] -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; VerboseLevel -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;warning&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-237"></span><span>              </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="annot"><span class="annottext">([TCMT IO Doc] -&gt; TCMT IO Doc) -&gt; [TCMT IO Doc] -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; [TCMT IO Doc] -&gt; [TCMT IO Doc]
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Semigroup (m Doc), Foldable t) =&gt;
m Doc -&gt; t (m Doc) -&gt; [m Doc]
</span><a href="Agda.TypeChecking.Pretty.html#punctuate"><span class="hs-identifier hs-var">punctuate</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">([TCMT IO Doc] -&gt; [TCMT IO Doc]) -&gt; [TCMT IO Doc] -&gt; [TCMT IO Doc]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><a href="#local-6989586621681163064"><span class="hs-identifier hs-var">banner</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; [TCMT IO Doc] -&gt; [TCMT IO Doc]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCWarning -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCWarning -&gt; TCMT IO Doc) -&gt; [TCWarning] -&gt; [TCMT IO Doc]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[TCWarning]
</span><a href="#local-6989586621681163068"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span>          </span><span class="annot"><span class="annottext">CheckResult -&gt; TCM CheckResult
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">CheckResult
</span><a href="#local-6989586621681163088"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">-- | Print usage information.</span><span>
</span><span id="line-244"></span><span class="annot"><a href="Agda.Main.html#printUsage"><span class="hs-identifier hs-type">printUsage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Compiler.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Help.html#Help"><span class="hs-identifier hs-type">Help</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span id="printUsage"><span class="annot"><span class="annottext">printUsage :: [Backend] -&gt; Help -&gt; IO ()
</span><a href="Agda.Main.html#printUsage"><span class="hs-identifier hs-var hs-var">printUsage</span></a></span></span><span> </span><span id="local-6989586621681163058"><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621681163058"><span class="hs-identifier hs-var">backends</span></a></span></span><span> </span><span id="local-6989586621681163057"><span class="annot"><span class="annottext">Help
</span><a href="#local-6989586621681163057"><span class="hs-identifier hs-var">hp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-246"></span><span>  </span><span id="local-6989586621681163056"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163056"><span class="hs-identifier hs-var">progName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [Char]
</span><span class="hs-identifier hs-var">getProgName</span></span><span>
</span><span id="line-247"></span><span>  </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStr</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[OptDescr ()] -&gt; [Char] -&gt; Help -&gt; [Char]
</span><a href="Agda.Interaction.Options.Base.html#usage"><span class="hs-identifier hs-var">usage</span></a></span><span> </span><span class="annot"><span class="annottext">[OptDescr ()]
</span><a href="Agda.Interaction.Options.Base.html#standardOptions_"><span class="hs-identifier hs-var">standardOptions_</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163056"><span class="hs-identifier hs-var">progName</span></a></span><span> </span><span class="annot"><span class="annottext">Help
</span><a href="#local-6989586621681163057"><span class="hs-identifier hs-var">hp</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Help
</span><a href="#local-6989586621681163057"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Help -&gt; Help -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Help
</span><a href="Agda.Interaction.Options.Help.html#GeneralHelp"><span class="hs-identifier hs-var">GeneralHelp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Backend -&gt; IO ()) -&gt; [Backend] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStr</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; (Backend -&gt; [Char]) -&gt; Backend -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Backend -&gt; [Char]
</span><a href="Agda.Main.html#backendUsage"><span class="hs-identifier hs-var">backendUsage</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621681163058"><span class="hs-identifier hs-var">backends</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="annot"><a href="Agda.Main.html#backendUsage"><span class="hs-identifier hs-type">backendUsage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-251"></span><span id="backendUsage"><span class="annot"><span class="annottext">backendUsage :: Backend -&gt; [Char]
</span><a href="Agda.Main.html#backendUsage"><span class="hs-identifier hs-var hs-var">backendUsage</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span id="local-6989586621681163045"><span class="annot"><span class="annottext">Backend' opts env menv mod def
</span><a href="#local-6989586621681163045"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-252"></span><span>  </span><span class="annot"><span class="annottext">[Char] -&gt; [OptDescr ()] -&gt; [Char]
forall a. [Char] -&gt; [OptDescr a] -&gt; [Char]
</span><span class="hs-identifier hs-var">usageInfo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Backend' opts env menv mod def -&gt; [Char]
forall opts env menv mod def.
Backend' opts env menv mod def -&gt; [Char]
</span><a href="Agda.Compiler.Backend.html#backendName"><span class="hs-identifier hs-var">backendName</span></a></span><span> </span><span class="annot"><span class="annottext">Backend' opts env menv mod def
</span><a href="#local-6989586621681163045"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; backend options&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([OptDescr ()] -&gt; [Char]) -&gt; [OptDescr ()] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-253"></span><span>    </span><span class="annot"><span class="annottext">(OptDescr (Flag opts) -&gt; OptDescr ())
-&gt; [OptDescr (Flag opts)] -&gt; [OptDescr ()]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">OptDescr (Flag opts) -&gt; OptDescr ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Backend' opts env menv mod def -&gt; [OptDescr (Flag opts)]
forall opts env menv mod def.
Backend' opts env menv mod def -&gt; [OptDescr (Flag opts)]
</span><a href="Agda.Compiler.Backend.html#commandLineFlags"><span class="hs-identifier hs-var">commandLineFlags</span></a></span><span> </span><span class="annot"><span class="annottext">Backend' opts env menv mod def
</span><a href="#local-6989586621681163045"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="hs-comment">-- | Print version information.</span><span>
</span><span id="line-256"></span><span class="annot"><a href="Agda.Main.html#printVersion"><span class="hs-identifier hs-type">printVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Compiler.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span id="printVersion"><span class="annot"><span class="annottext">printVersion :: [Backend] -&gt; IO ()
</span><a href="Agda.Main.html#printVersion"><span class="hs-identifier hs-var hs-var">printVersion</span></a></span></span><span> </span><span id="local-6989586621681163042"><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621681163042"><span class="hs-identifier hs-var">backends</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Agda version &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="Agda.VersionCommit.html#versionWithCommitInfo"><span class="hs-identifier hs-var">versionWithCommitInfo</span></a></span><span>
</span><span id="line-259"></span><span>  </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [[Char]] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  - &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163039"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; backend version &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163038"><span class="hs-identifier hs-var">ver</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Agda.Compiler.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.Backend.html#Backend%27"><span class="hs-identifier hs-type">Backend'</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">backendName :: forall opts env menv mod def.
Backend' opts env menv mod def -&gt; [Char]
</span><a href="Agda.Compiler.Backend.html#backendName"><span class="hs-identifier hs-var">backendName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681163039"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163039"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">backendVersion :: forall opts env menv mod def.
Backend' opts env menv mod def -&gt; Maybe [Char]
</span><a href="Agda.Compiler.Backend.html#backendVersion"><span class="hs-identifier hs-var">backendVersion</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681163038"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163038"><span class="hs-identifier hs-var">ver</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Backend]
</span><a href="#local-6989586621681163042"><span class="hs-identifier hs-var">backends</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="annot"><a href="Agda.Main.html#printAgdaDir"><span class="hs-identifier hs-type">printAgdaDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span id="printAgdaDir"><span class="annot"><span class="annottext">printAgdaDir :: IO ()
</span><a href="Agda.Main.html#printAgdaDir"><span class="hs-identifier hs-var hs-var">printAgdaDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; IO [Char] -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">IO [Char]
</span><a href="Paths_Agda.html#getDataDir"><span class="hs-identifier hs-var">getDataDir</span></a></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="hs-comment">-- | What to do for bad options.</span><span>
</span><span id="line-267"></span><span class="annot"><a href="Agda.Main.html#optionError"><span class="hs-identifier hs-type">optionError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span id="optionError"><span class="annot"><span class="annottext">optionError :: [Char] -&gt; IO ()
</span><a href="Agda.Main.html#optionError"><span class="hs-identifier hs-var hs-var">optionError</span></a></span></span><span> </span><span id="local-6989586621681163032"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163032"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-269"></span><span>  </span><span id="local-6989586621681163031"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163031"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [Char]
</span><span class="hs-identifier hs-var">getProgName</span></span><span>
</span><span id="line-270"></span><span>  </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Error: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163032"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\nRun '&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163031"><span class="hs-identifier hs-var">prog</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; --help' for help on command line options.&quot;</span></span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><span class="annottext">AgdaError -&gt; IO ()
</span><a href="Agda.Interaction.ExitCode.html#exitAgdaWith"><span class="hs-identifier hs-var">exitAgdaWith</span></a></span><span> </span><span class="annot"><span class="annottext">AgdaError
</span><a href="Agda.Interaction.ExitCode.html#OptionError"><span class="hs-identifier hs-var">OptionError</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">-- | Run a TCM action in IO; catch and pretty print errors.</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-comment">-- If some error message cannot be printed due to locale issues, then</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- one may get the &quot;Error when handling error&quot; error message. There is</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- currently no test case for this error, but on some systems one can</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- (at the time of writing) trigger it by running @LC_CTYPE=C agda</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- --no-libraries Bug.agda@, where @Bug.agda@ contains the following</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- code (if there is some other file in the same directory, for</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- instance @Bug.lagda@, then the error message may be different):</span><span>
</span><span id="line-282"></span><span class="hs-comment">--</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- _ : Set</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- _ = Set</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="annot"><a href="Agda.Main.html#runTCMPrettyErrors"><span class="hs-identifier hs-type">runTCMPrettyErrors</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span id="runTCMPrettyErrors"><span class="annot"><span class="annottext">runTCMPrettyErrors :: TCM () -&gt; IO ()
</span><a href="Agda.Main.html#runTCMPrettyErrors"><span class="hs-identifier hs-var hs-var">runTCMPrettyErrors</span></a></span></span><span> </span><span id="local-6989586621681163029"><span class="annot"><span class="annottext">TCM ()
</span><a href="#local-6989586621681163029"><span class="hs-identifier hs-var">tcm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-290"></span><span>  </span><span id="local-6989586621681163028"><span class="annot"><span class="annottext">Either TCErr (Maybe AgdaError)
</span><a href="#local-6989586621681163028"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM (Maybe AgdaError) -&gt; IO (Either TCErr (Maybe AgdaError))
forall a. TCM a -&gt; IO (Either TCErr a)
</span><a href="Agda.TypeChecking.Monad.Base.html#runTCMTop"><span class="hs-identifier hs-var">runTCMTop</span></a></span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe AgdaError
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe AgdaError -&gt; TCM () -&gt; TCM (Maybe AgdaError)
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">TCM ()
</span><a href="#local-6989586621681163029"><span class="hs-identifier hs-var">tcm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>          </span><span class="annot"><span class="annottext">TCM (Maybe AgdaError)
-&gt; (TCErr -&gt; TCM (Maybe AgdaError)) -&gt; TCM (Maybe AgdaError)
forall e (m :: * -&gt; *) a.
MonadError e m =&gt;
m a -&gt; (e -&gt; m a) -&gt; m a
</span><span class="hs-operator hs-var">`catchError`</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681163024"><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621681163024"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-293"></span><span>            </span><span id="local-6989586621681163023"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621681163023"><span class="hs-identifier hs-var">s2s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TCWarning] -&gt; TCMT IO [[Char]]
</span><a href="Agda.TypeChecking.Pretty.Warning.html#prettyTCWarnings%27"><span class="hs-identifier hs-var">prettyTCWarnings'</span></a></span><span> </span><span class="annot"><span class="annottext">([TCWarning] -&gt; TCMT IO [[Char]])
-&gt; TCMT IO [TCWarning] -&gt; TCMT IO [[Char]]
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">TCErr -&gt; TCMT IO [TCWarning]
</span><a href="Agda.TypeChecking.Pretty.Warning.html#getAllWarningsOfTCErr"><span class="hs-identifier hs-var">getAllWarningsOfTCErr</span></a></span><span> </span><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621681163024"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-294"></span><span>            </span><span id="local-6989586621681163020"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163020"><span class="hs-identifier hs-var">s1</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCErr -&gt; TCMT IO [Char]
forall (tcm :: * -&gt; *). MonadTCM tcm =&gt; TCErr -&gt; tcm [Char]
</span><a href="Agda.TypeChecking.Errors.html#prettyError"><span class="hs-identifier hs-var">prettyError</span></a></span><span> </span><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621681163024"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-295"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681163018"><span class="annot"><span class="annottext">ss :: [[Char]]
</span><a href="#local-6989586621681163018"><span class="hs-identifier hs-var hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Bool) -&gt; [[Char]] -&gt; [[Char]]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; ([Char] -&gt; Bool) -&gt; [Char] -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; [[Char]]) -&gt; [[Char]] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621681163023"><span class="hs-identifier hs-var">s2s</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [[Char]] -&gt; [[Char]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163020"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-296"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; TCM () -&gt; TCM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681163020"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO () -&gt; TCM ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; TCM ()) -&gt; IO () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStr</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
</span><span class="hs-identifier hs-var">unlines</span></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621681163018"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>            </span><span class="annot"><span class="annottext">IO () -&gt; TCM ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; TCM ()) -&gt; IO () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCErr -&gt; IO ()
</span><a href="Agda.Main.html#helpForLocaleError"><span class="hs-identifier hs-var">helpForLocaleError</span></a></span><span> </span><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621681163024"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-298"></span><span>            </span><span class="annot"><span class="annottext">Maybe AgdaError -&gt; TCM (Maybe AgdaError)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AgdaError -&gt; Maybe AgdaError
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">AgdaError
</span><a href="Agda.Interaction.ExitCode.html#TCMError"><span class="hs-identifier hs-var">TCMError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>      </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCM (Maybe AgdaError)
-&gt; (Impossible -&gt; TCM (Maybe AgdaError)) -&gt; TCM (Maybe AgdaError)
forall (m :: * -&gt; *) a.
CatchImpossible m =&gt;
m a -&gt; (Impossible -&gt; m a) -&gt; m a
</span><a href="Agda.Utils.Impossible.html#catchImpossible"><span class="hs-operator hs-var">`catchImpossible`</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681163011"><span class="annot"><span class="annottext">Impossible
</span><a href="#local-6989586621681163011"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-300"></span><span>          </span><span class="annot"><span class="annottext">IO () -&gt; TCM ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; TCM ()) -&gt; IO () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStr</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Impossible -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Impossible
</span><a href="#local-6989586621681163011"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-301"></span><span>          </span><span class="annot"><span class="annottext">Maybe AgdaError -&gt; TCM (Maybe AgdaError)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AgdaError -&gt; Maybe AgdaError
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">AgdaError
</span><a href="Agda.Interaction.ExitCode.html#ImpossibleError"><span class="hs-identifier hs-var">ImpossibleError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either TCErr (Maybe AgdaError)
</span><a href="#local-6989586621681163028"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-304"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">Maybe AgdaError
</span><span class="hs-identifier hs-var">Nothing</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO ()
forall a. IO a
</span><span class="hs-identifier hs-var">exitSuccess</span></span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681163009"><span class="annot"><span class="annottext">AgdaError
</span><a href="#local-6989586621681163009"><span class="hs-identifier hs-var">reason</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AgdaError -&gt; IO ()
</span><a href="Agda.Interaction.ExitCode.html#exitAgdaWith"><span class="hs-identifier hs-var">exitAgdaWith</span></a></span><span> </span><span class="annot"><span class="annottext">AgdaError
</span><a href="#local-6989586621681163009"><span class="hs-identifier hs-var">reason</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621681163008"><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621681163008"><span class="hs-identifier hs-var">err</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-307"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-308"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n\nError when handling error:&quot;</span></span><span>
</span><span id="line-309"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCErr -&gt; [Char]
</span><a href="Agda.TypeChecking.Errors.html#tcErrString"><span class="hs-identifier hs-var">tcErrString</span></a></span><span> </span><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621681163008"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-310"></span><span>        </span><span class="annot"><span class="annottext">TCErr -&gt; IO ()
</span><a href="Agda.Main.html#helpForLocaleError"><span class="hs-identifier hs-var">helpForLocaleError</span></a></span><span> </span><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621681163008"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-311"></span><span>      </span><span class="annot"><span class="annottext">AgdaError -&gt; IO ()
</span><a href="Agda.Interaction.ExitCode.html#exitAgdaWith"><span class="hs-identifier hs-var">exitAgdaWith</span></a></span><span> </span><span class="annot"><span class="annottext">AgdaError
</span><a href="Agda.Interaction.ExitCode.html#UnknownError"><span class="hs-identifier hs-var">UnknownError</span></a></span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="hs-comment">-- | If the error is an IO error, and the error message suggests that</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- the problem is related to locales or code pages, print out some</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- extra information.</span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="annot"><a href="Agda.Main.html#helpForLocaleError"><span class="hs-identifier hs-type">helpForLocaleError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCErr"><span class="hs-identifier hs-type">TCErr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span id="helpForLocaleError"><span class="annot"><span class="annottext">helpForLocaleError :: TCErr -&gt; IO ()
</span><a href="Agda.Main.html#helpForLocaleError"><span class="hs-identifier hs-var hs-var">helpForLocaleError</span></a></span></span><span> </span><span id="local-6989586621681163005"><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621681163005"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621681163005"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-319"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#IOException"><span class="hs-identifier hs-type">IOException</span></a></span><span> </span><span class="annot"><span class="annottext">TCState
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681163003"><span class="annot"><span class="annottext">IOException
</span><a href="#local-6989586621681163003"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;invalid argument&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-operator hs-var">`List.isInfixOf`</span></span><span> </span><span class="annot"><span class="annottext">IOException -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">IOException
</span><a href="#local-6989586621681163003"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621681163001"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-321"></span><span>  </span><span class="annot"><span class="annottext">TCErr
</span><span class="hs-identifier">_</span></span><span>                                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-323"></span><span>  </span><span id="local-6989586621681163001"><span class="annot"><span class="annottext">msg :: IO ()
</span><a href="#local-6989586621681163001"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStr</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
</span><span class="hs-identifier hs-var">unlines</span></span><span>
</span><span id="line-324"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;This error may be due to the use of a locale or code page that does not&quot;</span></span><span>
</span><span id="line-326"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;support some character used in the program being type-checked.&quot;</span></span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;If it is, then one option is to use the option --transliterate, in which&quot;</span></span><span>
</span><span id="line-329"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;case unsupported characters are (hopefully) replaced with something else,&quot;</span></span><span>
</span><span id="line-330"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;perhaps question marks. However, that could make the output harder to&quot;</span></span><span>
</span><span id="line-331"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;read.&quot;</span></span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-333"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;If you want to fix the problem \&quot;properly\&quot;, then you could try one of the&quot;</span></span><span>
</span><span id="line-334"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;following suggestions:&quot;</span></span><span>
</span><span id="line-335"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-336"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;* If you are using Windows, try switching to a different code page (for&quot;</span></span><span>
</span><span id="line-337"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  instance by running the command 'CHCP 65001').&quot;</span></span><span>
</span><span id="line-338"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;* If you are using a Unix-like system, try using a different locale. The&quot;</span></span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  installed locales are perhaps printed by the command 'locale -a'. If&quot;</span></span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  you have a UTF-8 locale installed (for instance sv_SE.UTF-8), then you&quot;</span></span><span>
</span><span id="line-342"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  can perhaps make Agda use this locale by running something like&quot;</span></span><span>
</span><span id="line-343"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  'LC_ALL=sv_SE.UTF-8 agda &lt;...&gt;'.&quot;</span></span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-345"></span></pre></body></html>